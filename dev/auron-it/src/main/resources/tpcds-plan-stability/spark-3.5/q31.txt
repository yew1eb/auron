AdaptiveSparkPlan isFinalPlan=true
+- == Final Plan ==
   NativeSort [ca_county#1 ASC NULLS FIRST], true
   +- InputAdapter
      +- AQEShuffleRead coalesced
         +- ShuffleQueryStage 48
            +- NativeShuffleExchange rangepartitioning(ca_county#1 ASC NULLS FIRST, 100), ENSURE_REQUIREMENTS, [plan_id=1]
               +- ConvertToNative
                  +- *(2) Project [ca_county#1, d_year#2, (web_sales#3 / web_sales#4) AS web_q1_q2_increase#5, (store_sales#6 / store_sales#7) AS store_q1_q2_increase#8, (web_sales#9 / web_sales#3) AS web_q2_q3_increase#10, (store_sales#11 / store_sales#6) AS store_q2_q3_increase#12]
                     +- *(2) SortMergeJoin [ca_county#13], [ca_county#14], Inner, (CASE WHEN (web_sales#3 > 0.00) THEN (web_sales#9 / web_sales#3) END > CASE WHEN (store_sales#6 > 0.00) THEN (store_sales#11 / store_sales#6) END)
                        :- *(1) Project [ca_county#1, d_year#2, store_sales#7, store_sales#6, store_sales#11, ca_county#13, web_sales#4, web_sales#3]
                        :  +- *(1) SortMergeJoin [ca_county#13], [ca_county#15], Inner, (CASE WHEN (web_sales#4 > 0.00) THEN (web_sales#3 / web_sales#4) END > CASE WHEN (store_sales#7 > 0.00) THEN (store_sales#6 / store_sales#7) END)
                        :     :- NativeSortMergeJoin [ca_county#1], [ca_county#13], Inner
                        :     :  :- NativeProject [ca_county#1, d_year#2, store_sales#7, store_sales#6, store_sales#11]
                        :     :  :  +- NativeSortMergeJoin [ca_county#16], [ca_county#17], Inner
                        :     :  :     :- NativeSortMergeJoin [ca_county#1], [ca_county#16], Inner
                        :     :  :     :  :- NativeSort [ca_county#1 ASC NULLS FIRST], false
                        :     :  :     :  :  +- InputAdapter
                        :     :  :     :  :     +- AQEShuffleRead coalesced
                        :     :  :     :  :        +- ShuffleQueryStage 42
                        :     :  :     :  :           +- NativeShuffleExchange hashpartitioning(ca_county#1, 100), ENSURE_REQUIREMENTS, [plan_id=2]
                        :     :  :     :  :              +- NativeProject [ca_county#1, d_year#2, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#18))#19,17,2) AS store_sales#7]
                        :     :  :     :  :                 +- NativeHashAggregate HashAgg, ArrayBuffer(ca_county#1, d_qoy#20, d_year#2), [ca_county#1, d_qoy#20, d_year#2], [sum(UnscaledValue(ss_ext_sales_price#18))], [sum(UnscaledValue(ss_ext_sales_price#18))#19], 3
                        :     :  :     :  :                    +- InputAdapter
                        :     :  :     :  :                       +- AQEShuffleRead coalesced
                        :     :  :     :  :                          +- ShuffleQueryStage 36
                        :     :  :     :  :                             +- NativeShuffleExchange hashpartitioning(ca_county#1, d_qoy#20, d_year#2, 100), ENSURE_REQUIREMENTS, [plan_id=3]
                        :     :  :     :  :                                +- NativeHashAggregate HashAgg, [ca_county#1, d_qoy#20, d_year#2], [partial_sum(_c3#21)], [sum#22], 0
                        :     :  :     :  :                                   +- NativeProject [ca_county#1 AS ca_county#1, d_qoy#20 AS d_qoy#20, d_year#2 AS d_year#2, UnscaledValue(ss_ext_sales_price#18) AS _c3#21]
                        :     :  :     :  :                                      +- NativeProject [ss_ext_sales_price#18, d_year#2, d_qoy#20, ca_county#1]
                        :     :  :     :  :                                         +- NativeSortMergeJoin [ss_addr_sk#23], [ca_address_sk#24], Inner
                        :     :  :     :  :                                            :- NativeSort [ss_addr_sk#23 ASC NULLS FIRST], false
                        :     :  :     :  :                                            :  +- InputAdapter
                        :     :  :     :  :                                            :     +- AQEShuffleRead coalesced
                        :     :  :     :  :                                            :        +- ShuffleQueryStage 30
                        :     :  :     :  :                                            :           +- NativeShuffleExchange hashpartitioning(ss_addr_sk#23, 100), ENSURE_REQUIREMENTS, [plan_id=4]
                        :     :  :     :  :                                            :              +- NativeProject [ss_addr_sk#23, ss_ext_sales_price#18, d_year#2, d_qoy#20]
                        :     :  :     :  :                                            :                 +- NativeSortMergeJoin [ss_sold_date_sk#25], [d_date_sk#26], Inner
                        :     :  :     :  :                                            :                    :- NativeSort [ss_sold_date_sk#25 ASC NULLS FIRST], false
                        :     :  :     :  :                                            :                    :  +- InputAdapter
                        :     :  :     :  :                                            :                    :     +- AQEShuffleRead coalesced
                        :     :  :     :  :                                            :                    :        +- ShuffleQueryStage 0
                        :     :  :     :  :                                            :                    :           +- NativeShuffleExchange hashpartitioning(ss_sold_date_sk#25, 100), ENSURE_REQUIREMENTS, [plan_id=5]
                        :     :  :     :  :                                            :                    :              +- NativeFilter (isnotnull(ss_sold_date_sk#25) AND isnotnull(ss_addr_sk#23))
                        :     :  :     :  :                                            :                    :                 +- InputAdapter [#25, #23, #18]
                        :     :  :     :  :                                            :                    :                    +- NativeParquetScan  (FileScan parquet [ss_sold_date_sk#25,ss_addr_sk#23,ss_ext_sales_price#18] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#25), isnotnull(ss_addr_sk#23)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_addr_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_addr_sk:int,ss_ext_sales_price:decimal(7,2)>)
                        :     :  :     :  :                                            :                    +- NativeSort [d_date_sk#26 ASC NULLS FIRST], false
                        :     :  :     :  :                                            :                       +- InputAdapter
                        :     :  :     :  :                                            :                          +- AQEShuffleRead coalesced
                        :     :  :     :  :                                            :                             +- ShuffleQueryStage 1
                        :     :  :     :  :                                            :                                +- NativeShuffleExchange hashpartitioning(d_date_sk#26, 100), ENSURE_REQUIREMENTS, [plan_id=6]
                        :     :  :     :  :                                            :                                   +- NativeFilter ((((isnotnull(d_qoy#20) AND isnotnull(d_year#2)) AND (d_qoy#20 = 1)) AND (d_year#2 = 2000)) AND isnotnull(d_date_sk#26))
                        :     :  :     :  :                                            :                                      +- InputAdapter [#26, #2, #20]
                        :     :  :     :  :                                            :                                         +- NativeParquetScan  (FileScan parquet [d_date_sk#26,d_year#2,d_qoy#20] Batched: true, DataFilters: [isnotnull(d_qoy#20), isnotnull(d_year#2), (d_qoy#20 = 1), (d_year#2 = 2000), isnot..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_qoy), IsNotNull(d_year), EqualTo(d_qoy,1), EqualTo(d_year,2000), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_qoy:int>)
                        :     :  :     :  :                                            +- NativeSort [ca_address_sk#24 ASC NULLS FIRST], false
                        :     :  :     :  :                                               +- InputAdapter
                        :     :  :     :  :                                                  +- AQEShuffleRead coalesced
                        :     :  :     :  :                                                     +- ShuffleQueryStage 2
                        :     :  :     :  :                                                        +- NativeShuffleExchange hashpartitioning(ca_address_sk#24, 100), ENSURE_REQUIREMENTS, [plan_id=7]
                        :     :  :     :  :                                                           +- NativeFilter (isnotnull(ca_address_sk#24) AND isnotnull(ca_county#1))
                        :     :  :     :  :                                                              +- InputAdapter [#24, #1]
                        :     :  :     :  :                                                                 +- NativeParquetScan  (FileScan parquet [ca_address_sk#24,ca_county#1] Batched: true, DataFilters: [isnotnull(ca_address_sk#24), isnotnull(ca_county#1)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk), IsNotNull(ca_county)], ReadSchema: struct<ca_address_sk:int,ca_county:string>)
                        :     :  :     :  +- NativeSort [ca_county#16 ASC NULLS FIRST], false
                        :     :  :     :     +- InputAdapter
                        :     :  :     :        +- AQEShuffleRead coalesced
                        :     :  :     :           +- ShuffleQueryStage 43
                        :     :  :     :              +- NativeShuffleExchange hashpartitioning(ca_county#16, 100), ENSURE_REQUIREMENTS, [plan_id=8]
                        :     :  :     :                 +- NativeProject [ca_county#16, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#27))#19,17,2) AS store_sales#6]
                        :     :  :     :                    +- NativeHashAggregate HashAgg, ArrayBuffer(ca_county#16, d_qoy#28, d_year#29), [ca_county#16, d_qoy#28, d_year#29], [sum(UnscaledValue(ss_ext_sales_price#27))], [sum(UnscaledValue(ss_ext_sales_price#27))#19], 3
                        :     :  :     :                       +- InputAdapter
                        :     :  :     :                          +- AQEShuffleRead coalesced
                        :     :  :     :                             +- ShuffleQueryStage 37
                        :     :  :     :                                +- NativeShuffleExchange hashpartitioning(ca_county#16, d_qoy#28, d_year#29, 100), ENSURE_REQUIREMENTS, [plan_id=9]
                        :     :  :     :                                   +- NativeHashAggregate HashAgg, [ca_county#16, d_qoy#28, d_year#29], [partial_sum(_c3#30)], [sum#31], 0
                        :     :  :     :                                      +- NativeProject [ca_county#16 AS ca_county#16, d_qoy#28 AS d_qoy#28, d_year#29 AS d_year#29, UnscaledValue(ss_ext_sales_price#27) AS _c3#30]
                        :     :  :     :                                         +- NativeProject [ss_ext_sales_price#27, d_year#29, d_qoy#28, ca_county#16]
                        :     :  :     :                                            +- NativeSortMergeJoin [ss_addr_sk#32], [ca_address_sk#33], Inner
                        :     :  :     :                                               :- NativeSort [ss_addr_sk#32 ASC NULLS FIRST], false
                        :     :  :     :                                               :  +- InputAdapter
                        :     :  :     :                                               :     +- AQEShuffleRead coalesced
                        :     :  :     :                                               :        +- ShuffleQueryStage 31
                        :     :  :     :                                               :           +- NativeShuffleExchange hashpartitioning(ss_addr_sk#32, 100), ENSURE_REQUIREMENTS, [plan_id=10]
                        :     :  :     :                                               :              +- NativeProject [ss_addr_sk#32, ss_ext_sales_price#27, d_year#29, d_qoy#28]
                        :     :  :     :                                               :                 +- NativeSortMergeJoin [ss_sold_date_sk#34], [d_date_sk#35], Inner
                        :     :  :     :                                               :                    :- NativeSort [ss_sold_date_sk#34 ASC NULLS FIRST], false
                        :     :  :     :                                               :                    :  +- InputAdapter
                        :     :  :     :                                               :                    :     +- InputAdapter [#34, #32, #27]
                        :     :  :     :                                               :                    :        +- AQEShuffleRead coalesced
                        :     :  :     :                                               :                    :           +- ShuffleQueryStage 4
                        :     :  :     :                                               :                    :              +- ReusedExchange [ss_sold_date_sk#34, ss_addr_sk#32, ss_ext_sales_price#27], NativeShuffleExchange hashpartitioning(ss_sold_date_sk#25, 100), ENSURE_REQUIREMENTS, [plan_id=5]
                        :     :  :     :                                               :                    +- NativeSort [d_date_sk#35 ASC NULLS FIRST], false
                        :     :  :     :                                               :                       +- InputAdapter
                        :     :  :     :                                               :                          +- AQEShuffleRead coalesced
                        :     :  :     :                                               :                             +- ShuffleQueryStage 5
                        :     :  :     :                                               :                                +- NativeShuffleExchange hashpartitioning(d_date_sk#35, 100), ENSURE_REQUIREMENTS, [plan_id=11]
                        :     :  :     :                                               :                                   +- NativeFilter ((((isnotnull(d_qoy#28) AND isnotnull(d_year#29)) AND (d_qoy#28 = 2)) AND (d_year#29 = 2000)) AND isnotnull(d_date_sk#35))
                        :     :  :     :                                               :                                      +- InputAdapter [#35, #29, #28]
                        :     :  :     :                                               :                                         +- NativeParquetScan  (FileScan parquet [d_date_sk#35,d_year#29,d_qoy#28] Batched: true, DataFilters: [isnotnull(d_qoy#28), isnotnull(d_year#29), (d_qoy#28 = 2), (d_year#29 = 2000), isnot..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_qoy), IsNotNull(d_year), EqualTo(d_qoy,2), EqualTo(d_year,2000), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_qoy:int>)
                        :     :  :     :                                               +- NativeSort [ca_address_sk#33 ASC NULLS FIRST], false
                        :     :  :     :                                                  +- InputAdapter
                        :     :  :     :                                                     +- InputAdapter [#33, #16]
                        :     :  :     :                                                        +- AQEShuffleRead coalesced
                        :     :  :     :                                                           +- ShuffleQueryStage 7
                        :     :  :     :                                                              +- ReusedExchange [ca_address_sk#33, ca_county#16], NativeShuffleExchange hashpartitioning(ca_address_sk#24, 100), ENSURE_REQUIREMENTS, [plan_id=7]
                        :     :  :     +- NativeSort [ca_county#17 ASC NULLS FIRST], false
                        :     :  :        +- InputAdapter
                        :     :  :           +- AQEShuffleRead coalesced
                        :     :  :              +- ShuffleQueryStage 45
                        :     :  :                 +- NativeShuffleExchange hashpartitioning(ca_county#17, 100), ENSURE_REQUIREMENTS, [plan_id=12]
                        :     :  :                    +- NativeProject [ca_county#17, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#36))#19,17,2) AS store_sales#11]
                        :     :  :                       +- NativeHashAggregate HashAgg, ArrayBuffer(ca_county#17, d_qoy#37, d_year#38), [ca_county#17, d_qoy#37, d_year#38], [sum(UnscaledValue(ss_ext_sales_price#36))], [sum(UnscaledValue(ss_ext_sales_price#36))#19], 3
                        :     :  :                          +- InputAdapter
                        :     :  :                             +- AQEShuffleRead coalesced
                        :     :  :                                +- ShuffleQueryStage 38
                        :     :  :                                   +- NativeShuffleExchange hashpartitioning(ca_county#17, d_qoy#37, d_year#38, 100), ENSURE_REQUIREMENTS, [plan_id=13]
                        :     :  :                                      +- NativeHashAggregate HashAgg, [ca_county#17, d_qoy#37, d_year#38], [partial_sum(_c3#39)], [sum#40], 0
                        :     :  :                                         +- NativeProject [ca_county#17 AS ca_county#17, d_qoy#37 AS d_qoy#37, d_year#38 AS d_year#38, UnscaledValue(ss_ext_sales_price#36) AS _c3#39]
                        :     :  :                                            +- NativeProject [ss_ext_sales_price#36, d_year#38, d_qoy#37, ca_county#17]
                        :     :  :                                               +- NativeSortMergeJoin [ss_addr_sk#41], [ca_address_sk#42], Inner
                        :     :  :                                                  :- NativeSort [ss_addr_sk#41 ASC NULLS FIRST], false
                        :     :  :                                                  :  +- InputAdapter
                        :     :  :                                                  :     +- AQEShuffleRead coalesced
                        :     :  :                                                  :        +- ShuffleQueryStage 32
                        :     :  :                                                  :           +- NativeShuffleExchange hashpartitioning(ss_addr_sk#41, 100), ENSURE_REQUIREMENTS, [plan_id=14]
                        :     :  :                                                  :              +- NativeProject [ss_addr_sk#41, ss_ext_sales_price#36, d_year#38, d_qoy#37]
                        :     :  :                                                  :                 +- NativeSortMergeJoin [ss_sold_date_sk#43], [d_date_sk#44], Inner
                        :     :  :                                                  :                    :- NativeSort [ss_sold_date_sk#43 ASC NULLS FIRST], false
                        :     :  :                                                  :                    :  +- InputAdapter
                        :     :  :                                                  :                    :     +- InputAdapter [#43, #41, #36]
                        :     :  :                                                  :                    :        +- AQEShuffleRead coalesced
                        :     :  :                                                  :                    :           +- ShuffleQueryStage 9
                        :     :  :                                                  :                    :              +- ReusedExchange [ss_sold_date_sk#43, ss_addr_sk#41, ss_ext_sales_price#36], NativeShuffleExchange hashpartitioning(ss_sold_date_sk#25, 100), ENSURE_REQUIREMENTS, [plan_id=5]
                        :     :  :                                                  :                    +- NativeSort [d_date_sk#44 ASC NULLS FIRST], false
                        :     :  :                                                  :                       +- InputAdapter
                        :     :  :                                                  :                          +- AQEShuffleRead coalesced
                        :     :  :                                                  :                             +- ShuffleQueryStage 10
                        :     :  :                                                  :                                +- NativeShuffleExchange hashpartitioning(d_date_sk#44, 100), ENSURE_REQUIREMENTS, [plan_id=15]
                        :     :  :                                                  :                                   +- NativeFilter ((((isnotnull(d_qoy#37) AND isnotnull(d_year#38)) AND (d_qoy#37 = 3)) AND (d_year#38 = 2000)) AND isnotnull(d_date_sk#44))
                        :     :  :                                                  :                                      +- InputAdapter [#44, #38, #37]
                        :     :  :                                                  :                                         +- NativeParquetScan  (FileScan parquet [d_date_sk#44,d_year#38,d_qoy#37] Batched: true, DataFilters: [isnotnull(d_qoy#37), isnotnull(d_year#38), (d_qoy#37 = 3), (d_year#38 = 2000), isnot..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_qoy), IsNotNull(d_year), EqualTo(d_qoy,3), EqualTo(d_year,2000), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_qoy:int>)
                        :     :  :                                                  +- NativeSort [ca_address_sk#42 ASC NULLS FIRST], false
                        :     :  :                                                     +- InputAdapter
                        :     :  :                                                        +- InputAdapter [#42, #17]
                        :     :  :                                                           +- AQEShuffleRead coalesced
                        :     :  :                                                              +- ShuffleQueryStage 12
                        :     :  :                                                                 +- ReusedExchange [ca_address_sk#42, ca_county#17], NativeShuffleExchange hashpartitioning(ca_address_sk#24, 100), ENSURE_REQUIREMENTS, [plan_id=7]
                        :     :  +- NativeSort [ca_county#13 ASC NULLS FIRST], false
                        :     :     +- InputAdapter
                        :     :        +- AQEShuffleRead coalesced
                        :     :           +- ShuffleQueryStage 44
                        :     :              +- NativeShuffleExchange hashpartitioning(ca_county#13, 100), ENSURE_REQUIREMENTS, [plan_id=16]
                        :     :                 +- NativeProject [ca_county#13, MakeDecimal(sum(UnscaledValue(ws_ext_sales_price#45))#46,17,2) AS web_sales#4]
                        :     :                    +- NativeHashAggregate HashAgg, ArrayBuffer(ca_county#13, d_qoy#47, d_year#48), [ca_county#13, d_qoy#47, d_year#48], [sum(UnscaledValue(ws_ext_sales_price#45))], [sum(UnscaledValue(ws_ext_sales_price#45))#46], 3
                        :     :                       +- InputAdapter
                        :     :                          +- AQEShuffleRead coalesced
                        :     :                             +- ShuffleQueryStage 39
                        :     :                                +- NativeShuffleExchange hashpartitioning(ca_county#13, d_qoy#47, d_year#48, 100), ENSURE_REQUIREMENTS, [plan_id=17]
                        :     :                                   +- NativeHashAggregate HashAgg, [ca_county#13, d_qoy#47, d_year#48], [partial_sum(_c3#49)], [sum#50], 0
                        :     :                                      +- NativeProject [ca_county#13 AS ca_county#13, d_qoy#47 AS d_qoy#47, d_year#48 AS d_year#48, UnscaledValue(ws_ext_sales_price#45) AS _c3#49]
                        :     :                                         +- NativeProject [ws_ext_sales_price#45, d_year#48, d_qoy#47, ca_county#13]
                        :     :                                            +- NativeSortMergeJoin [ws_bill_addr_sk#51], [ca_address_sk#52], Inner
                        :     :                                               :- NativeSort [ws_bill_addr_sk#51 ASC NULLS FIRST], false
                        :     :                                               :  +- InputAdapter
                        :     :                                               :     +- AQEShuffleRead coalesced
                        :     :                                               :        +- ShuffleQueryStage 33
                        :     :                                               :           +- NativeShuffleExchange hashpartitioning(ws_bill_addr_sk#51, 100), ENSURE_REQUIREMENTS, [plan_id=18]
                        :     :                                               :              +- NativeProject [ws_bill_addr_sk#51, ws_ext_sales_price#45, d_year#48, d_qoy#47]
                        :     :                                               :                 +- NativeSortMergeJoin [ws_sold_date_sk#53], [d_date_sk#54], Inner
                        :     :                                               :                    :- NativeSort [ws_sold_date_sk#53 ASC NULLS FIRST], false
                        :     :                                               :                    :  +- InputAdapter
                        :     :                                               :                    :     +- AQEShuffleRead coalesced
                        :     :                                               :                    :        +- ShuffleQueryStage 13
                        :     :                                               :                    :           +- NativeShuffleExchange hashpartitioning(ws_sold_date_sk#53, 100), ENSURE_REQUIREMENTS, [plan_id=19]
                        :     :                                               :                    :              +- NativeFilter (isnotnull(ws_sold_date_sk#53) AND isnotnull(ws_bill_addr_sk#51))
                        :     :                                               :                    :                 +- InputAdapter [#53, #51, #45]
                        :     :                                               :                    :                    +- NativeParquetScan  (FileScan parquet [ws_sold_date_sk#53,ws_bill_addr_sk#51,ws_ext_sales_price#45] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#53), isnotnull(ws_bill_addr_sk#51)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk), IsNotNull(ws_bill_addr_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_bill_addr_sk:int,ws_ext_sales_price:decimal(7,2)>)
                        :     :                                               :                    +- NativeSort [d_date_sk#54 ASC NULLS FIRST], false
                        :     :                                               :                       +- InputAdapter
                        :     :                                               :                          +- InputAdapter [#54, #48, #47]
                        :     :                                               :                             +- AQEShuffleRead coalesced
                        :     :                                               :                                +- ShuffleQueryStage 15
                        :     :                                               :                                   +- ReusedExchange [d_date_sk#54, d_year#48, d_qoy#47], NativeShuffleExchange hashpartitioning(d_date_sk#26, 100), ENSURE_REQUIREMENTS, [plan_id=6]
                        :     :                                               +- NativeSort [ca_address_sk#52 ASC NULLS FIRST], false
                        :     :                                                  +- InputAdapter
                        :     :                                                     +- InputAdapter [#52, #13]
                        :     :                                                        +- AQEShuffleRead coalesced
                        :     :                                                           +- ShuffleQueryStage 17
                        :     :                                                              +- ReusedExchange [ca_address_sk#52, ca_county#13], NativeShuffleExchange hashpartitioning(ca_address_sk#24, 100), ENSURE_REQUIREMENTS, [plan_id=7]
                        :     +- NativeSort [ca_county#15 ASC NULLS FIRST], false
                        :        +- InputAdapter
                        :           +- AQEShuffleRead coalesced
                        :              +- ShuffleQueryStage 46
                        :                 +- NativeShuffleExchange hashpartitioning(ca_county#15, 100), ENSURE_REQUIREMENTS, [plan_id=20]
                        :                    +- NativeProject [ca_county#15, MakeDecimal(sum(UnscaledValue(ws_ext_sales_price#55))#46,17,2) AS web_sales#3]
                        :                       +- NativeHashAggregate HashAgg, ArrayBuffer(ca_county#15, d_qoy#56, d_year#57), [ca_county#15, d_qoy#56, d_year#57], [sum(UnscaledValue(ws_ext_sales_price#55))], [sum(UnscaledValue(ws_ext_sales_price#55))#46], 3
                        :                          +- InputAdapter
                        :                             +- AQEShuffleRead coalesced
                        :                                +- ShuffleQueryStage 40
                        :                                   +- NativeShuffleExchange hashpartitioning(ca_county#15, d_qoy#56, d_year#57, 100), ENSURE_REQUIREMENTS, [plan_id=21]
                        :                                      +- NativeHashAggregate HashAgg, [ca_county#15, d_qoy#56, d_year#57], [partial_sum(_c3#58)], [sum#59], 0
                        :                                         +- NativeProject [ca_county#15 AS ca_county#15, d_qoy#56 AS d_qoy#56, d_year#57 AS d_year#57, UnscaledValue(ws_ext_sales_price#55) AS _c3#58]
                        :                                            +- NativeProject [ws_ext_sales_price#55, d_year#57, d_qoy#56, ca_county#15]
                        :                                               +- NativeSortMergeJoin [ws_bill_addr_sk#60], [ca_address_sk#61], Inner
                        :                                                  :- NativeSort [ws_bill_addr_sk#60 ASC NULLS FIRST], false
                        :                                                  :  +- InputAdapter
                        :                                                  :     +- AQEShuffleRead coalesced
                        :                                                  :        +- ShuffleQueryStage 34
                        :                                                  :           +- NativeShuffleExchange hashpartitioning(ws_bill_addr_sk#60, 100), ENSURE_REQUIREMENTS, [plan_id=22]
                        :                                                  :              +- NativeProject [ws_bill_addr_sk#60, ws_ext_sales_price#55, d_year#57, d_qoy#56]
                        :                                                  :                 +- NativeSortMergeJoin [ws_sold_date_sk#62], [d_date_sk#63], Inner
                        :                                                  :                    :- NativeSort [ws_sold_date_sk#62 ASC NULLS FIRST], false
                        :                                                  :                    :  +- InputAdapter
                        :                                                  :                    :     +- InputAdapter [#62, #60, #55]
                        :                                                  :                    :        +- AQEShuffleRead coalesced
                        :                                                  :                    :           +- ShuffleQueryStage 19
                        :                                                  :                    :              +- ReusedExchange [ws_sold_date_sk#62, ws_bill_addr_sk#60, ws_ext_sales_price#55], NativeShuffleExchange hashpartitioning(ws_sold_date_sk#53, 100), ENSURE_REQUIREMENTS, [plan_id=19]
                        :                                                  :                    +- NativeSort [d_date_sk#63 ASC NULLS FIRST], false
                        :                                                  :                       +- InputAdapter
                        :                                                  :                          +- InputAdapter [#63, #57, #56]
                        :                                                  :                             +- AQEShuffleRead coalesced
                        :                                                  :                                +- ShuffleQueryStage 21
                        :                                                  :                                   +- ReusedExchange [d_date_sk#63, d_year#57, d_qoy#56], NativeShuffleExchange hashpartitioning(d_date_sk#35, 100), ENSURE_REQUIREMENTS, [plan_id=11]
                        :                                                  +- NativeSort [ca_address_sk#61 ASC NULLS FIRST], false
                        :                                                     +- InputAdapter
                        :                                                        +- InputAdapter [#61, #15]
                        :                                                           +- AQEShuffleRead coalesced
                        :                                                              +- ShuffleQueryStage 23
                        :                                                                 +- ReusedExchange [ca_address_sk#61, ca_county#15], NativeShuffleExchange hashpartitioning(ca_address_sk#24, 100), ENSURE_REQUIREMENTS, [plan_id=7]
                        +- NativeSort [ca_county#14 ASC NULLS FIRST], false
                           +- InputAdapter
                              +- AQEShuffleRead coalesced
                                 +- ShuffleQueryStage 47
                                    +- NativeShuffleExchange hashpartitioning(ca_county#14, 100), ENSURE_REQUIREMENTS, [plan_id=23]
                                       +- NativeProject [ca_county#14, MakeDecimal(sum(UnscaledValue(ws_ext_sales_price#64))#46,17,2) AS web_sales#9]
                                          +- NativeHashAggregate HashAgg, ArrayBuffer(ca_county#14, d_qoy#65, d_year#66), [ca_county#14, d_qoy#65, d_year#66], [sum(UnscaledValue(ws_ext_sales_price#64))], [sum(UnscaledValue(ws_ext_sales_price#64))#46], 3
                                             +- InputAdapter
                                                +- AQEShuffleRead coalesced
                                                   +- ShuffleQueryStage 41
                                                      +- NativeShuffleExchange hashpartitioning(ca_county#14, d_qoy#65, d_year#66, 100), ENSURE_REQUIREMENTS, [plan_id=24]
                                                         +- NativeHashAggregate HashAgg, [ca_county#14, d_qoy#65, d_year#66], [partial_sum(_c3#67)], [sum#68], 0
                                                            +- NativeProject [ca_county#14 AS ca_county#14, d_qoy#65 AS d_qoy#65, d_year#66 AS d_year#66, UnscaledValue(ws_ext_sales_price#64) AS _c3#67]
                                                               +- NativeProject [ws_ext_sales_price#64, d_year#66, d_qoy#65, ca_county#14]
                                                                  +- NativeSortMergeJoin [ws_bill_addr_sk#69], [ca_address_sk#70], Inner
                                                                     :- NativeSort [ws_bill_addr_sk#69 ASC NULLS FIRST], false
                                                                     :  +- InputAdapter
                                                                     :     +- AQEShuffleRead coalesced
                                                                     :        +- ShuffleQueryStage 35
                                                                     :           +- NativeShuffleExchange hashpartitioning(ws_bill_addr_sk#69, 100), ENSURE_REQUIREMENTS, [plan_id=25]
                                                                     :              +- NativeProject [ws_bill_addr_sk#69, ws_ext_sales_price#64, d_year#66, d_qoy#65]
                                                                     :                 +- NativeSortMergeJoin [ws_sold_date_sk#71], [d_date_sk#72], Inner
                                                                     :                    :- NativeSort [ws_sold_date_sk#71 ASC NULLS FIRST], false
                                                                     :                    :  +- InputAdapter
                                                                     :                    :     +- InputAdapter [#71, #69, #64]
                                                                     :                    :        +- AQEShuffleRead coalesced
                                                                     :                    :           +- ShuffleQueryStage 25
                                                                     :                    :              +- ReusedExchange [ws_sold_date_sk#71, ws_bill_addr_sk#69, ws_ext_sales_price#64], NativeShuffleExchange hashpartitioning(ws_sold_date_sk#53, 100), ENSURE_REQUIREMENTS, [plan_id=19]
                                                                     :                    +- NativeSort [d_date_sk#72 ASC NULLS FIRST], false
                                                                     :                       +- InputAdapter
                                                                     :                          +- InputAdapter [#72, #66, #65]
                                                                     :                             +- AQEShuffleRead coalesced
                                                                     :                                +- ShuffleQueryStage 27
                                                                     :                                   +- ReusedExchange [d_date_sk#72, d_year#66, d_qoy#65], NativeShuffleExchange hashpartitioning(d_date_sk#44, 100), ENSURE_REQUIREMENTS, [plan_id=15]
                                                                     +- NativeSort [ca_address_sk#70 ASC NULLS FIRST], false
                                                                        +- InputAdapter
                                                                           +- InputAdapter [#70, #14]
                                                                              +- AQEShuffleRead coalesced
                                                                                 +- ShuffleQueryStage 29
                                                                                    +- ReusedExchange [ca_address_sk#70, ca_county#14], NativeShuffleExchange hashpartitioning(ca_address_sk#24, 100), ENSURE_REQUIREMENTS, [plan_id=7]
+- == Initial Plan ==
   Sort [ca_county#1 ASC NULLS FIRST], true, 0
   +- Exchange rangepartitioning(ca_county#1 ASC NULLS FIRST, 100), ENSURE_REQUIREMENTS, [plan_id=26]
      +- Project [ca_county#1, d_year#2, (web_sales#3 / web_sales#4) AS web_q1_q2_increase#5, (store_sales#6 / store_sales#7) AS store_q1_q2_increase#8, (web_sales#9 / web_sales#3) AS web_q2_q3_increase#10, (store_sales#11 / store_sales#6) AS store_q2_q3_increase#12]
         +- SortMergeJoin [ca_county#13], [ca_county#14], Inner, (CASE WHEN (web_sales#3 > 0.00) THEN (web_sales#9 / web_sales#3) END > CASE WHEN (store_sales#6 > 0.00) THEN (store_sales#11 / store_sales#6) END)
            :- Project [ca_county#1, d_year#2, store_sales#7, store_sales#6, store_sales#11, ca_county#13, web_sales#4, web_sales#3]
            :  +- SortMergeJoin [ca_county#13], [ca_county#15], Inner, (CASE WHEN (web_sales#4 > 0.00) THEN (web_sales#3 / web_sales#4) END > CASE WHEN (store_sales#7 > 0.00) THEN (store_sales#6 / store_sales#7) END)
            :     :- SortMergeJoin [ca_county#1], [ca_county#13], Inner
            :     :  :- Project [ca_county#1, d_year#2, store_sales#7, store_sales#6, store_sales#11]
            :     :  :  +- SortMergeJoin [ca_county#16], [ca_county#17], Inner
            :     :  :     :- SortMergeJoin [ca_county#1], [ca_county#16], Inner
            :     :  :     :  :- Sort [ca_county#1 ASC NULLS FIRST], false, 0
            :     :  :     :  :  +- Exchange hashpartitioning(ca_county#1, 100), ENSURE_REQUIREMENTS, [plan_id=27]
            :     :  :     :  :     +- HashAggregate(keys=[ca_county#1, d_qoy#20, d_year#2], functions=[sum(UnscaledValue(ss_ext_sales_price#18))], output=[ca_county#1, d_year#2, store_sales#7])
            :     :  :     :  :        +- Exchange hashpartitioning(ca_county#1, d_qoy#20, d_year#2, 100), ENSURE_REQUIREMENTS, [plan_id=28]
            :     :  :     :  :           +- HashAggregate(keys=[ca_county#1, d_qoy#20, d_year#2], functions=[partial_sum(UnscaledValue(ss_ext_sales_price#18))], output=[ca_county#1, d_qoy#20, d_year#2, sum#73])
            :     :  :     :  :              +- Project [ss_ext_sales_price#18, d_year#2, d_qoy#20, ca_county#1]
            :     :  :     :  :                 +- SortMergeJoin [ss_addr_sk#23], [ca_address_sk#24], Inner
            :     :  :     :  :                    :- Sort [ss_addr_sk#23 ASC NULLS FIRST], false, 0
            :     :  :     :  :                    :  +- Exchange hashpartitioning(ss_addr_sk#23, 100), ENSURE_REQUIREMENTS, [plan_id=29]
            :     :  :     :  :                    :     +- Project [ss_addr_sk#23, ss_ext_sales_price#18, d_year#2, d_qoy#20]
            :     :  :     :  :                    :        +- SortMergeJoin [ss_sold_date_sk#25], [d_date_sk#26], Inner
            :     :  :     :  :                    :           :- Sort [ss_sold_date_sk#25 ASC NULLS FIRST], false, 0
            :     :  :     :  :                    :           :  +- Exchange hashpartitioning(ss_sold_date_sk#25, 100), ENSURE_REQUIREMENTS, [plan_id=30]
            :     :  :     :  :                    :           :     +- Filter (isnotnull(ss_sold_date_sk#25) AND isnotnull(ss_addr_sk#23))
            :     :  :     :  :                    :           :        +- FileScan parquet [ss_sold_date_sk#25,ss_addr_sk#23,ss_ext_sales_price#18] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#25), isnotnull(ss_addr_sk#23)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_addr_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_addr_sk:int,ss_ext_sales_price:decimal(7,2)>
            :     :  :     :  :                    :           +- Sort [d_date_sk#26 ASC NULLS FIRST], false, 0
            :     :  :     :  :                    :              +- Exchange hashpartitioning(d_date_sk#26, 100), ENSURE_REQUIREMENTS, [plan_id=31]
            :     :  :     :  :                    :                 +- Filter ((((isnotnull(d_qoy#20) AND isnotnull(d_year#2)) AND (d_qoy#20 = 1)) AND (d_year#2 = 2000)) AND isnotnull(d_date_sk#26))
            :     :  :     :  :                    :                    +- FileScan parquet [d_date_sk#26,d_year#2,d_qoy#20] Batched: true, DataFilters: [isnotnull(d_qoy#20), isnotnull(d_year#2), (d_qoy#20 = 1), (d_year#2 = 2000), isnot..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_qoy), IsNotNull(d_year), EqualTo(d_qoy,1), EqualTo(d_year,2000), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_qoy:int>
            :     :  :     :  :                    +- Sort [ca_address_sk#24 ASC NULLS FIRST], false, 0
            :     :  :     :  :                       +- Exchange hashpartitioning(ca_address_sk#24, 100), ENSURE_REQUIREMENTS, [plan_id=32]
            :     :  :     :  :                          +- Filter (isnotnull(ca_address_sk#24) AND isnotnull(ca_county#1))
            :     :  :     :  :                             +- FileScan parquet [ca_address_sk#24,ca_county#1] Batched: true, DataFilters: [isnotnull(ca_address_sk#24), isnotnull(ca_county#1)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk), IsNotNull(ca_county)], ReadSchema: struct<ca_address_sk:int,ca_county:string>
            :     :  :     :  +- Sort [ca_county#16 ASC NULLS FIRST], false, 0
            :     :  :     :     +- Exchange hashpartitioning(ca_county#16, 100), ENSURE_REQUIREMENTS, [plan_id=33]
            :     :  :     :        +- HashAggregate(keys=[ca_county#16, d_qoy#28, d_year#29], functions=[sum(UnscaledValue(ss_ext_sales_price#27))], output=[ca_county#16, store_sales#6])
            :     :  :     :           +- Exchange hashpartitioning(ca_county#16, d_qoy#28, d_year#29, 100), ENSURE_REQUIREMENTS, [plan_id=34]
            :     :  :     :              +- HashAggregate(keys=[ca_county#16, d_qoy#28, d_year#29], functions=[partial_sum(UnscaledValue(ss_ext_sales_price#27))], output=[ca_county#16, d_qoy#28, d_year#29, sum#74])
            :     :  :     :                 +- Project [ss_ext_sales_price#27, d_year#29, d_qoy#28, ca_county#16]
            :     :  :     :                    +- SortMergeJoin [ss_addr_sk#32], [ca_address_sk#33], Inner
            :     :  :     :                       :- Sort [ss_addr_sk#32 ASC NULLS FIRST], false, 0
            :     :  :     :                       :  +- Exchange hashpartitioning(ss_addr_sk#32, 100), ENSURE_REQUIREMENTS, [plan_id=35]
            :     :  :     :                       :     +- Project [ss_addr_sk#32, ss_ext_sales_price#27, d_year#29, d_qoy#28]
            :     :  :     :                       :        +- SortMergeJoin [ss_sold_date_sk#34], [d_date_sk#35], Inner
            :     :  :     :                       :           :- Sort [ss_sold_date_sk#34 ASC NULLS FIRST], false, 0
            :     :  :     :                       :           :  +- Exchange hashpartitioning(ss_sold_date_sk#34, 100), ENSURE_REQUIREMENTS, [plan_id=36]
            :     :  :     :                       :           :     +- Filter (isnotnull(ss_sold_date_sk#34) AND isnotnull(ss_addr_sk#32))
            :     :  :     :                       :           :        +- FileScan parquet [ss_sold_date_sk#34,ss_addr_sk#32,ss_ext_sales_price#27] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#34), isnotnull(ss_addr_sk#32)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_addr_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_addr_sk:int,ss_ext_sales_price:decimal(7,2)>
            :     :  :     :                       :           +- Sort [d_date_sk#35 ASC NULLS FIRST], false, 0
            :     :  :     :                       :              +- Exchange hashpartitioning(d_date_sk#35, 100), ENSURE_REQUIREMENTS, [plan_id=37]
            :     :  :     :                       :                 +- Filter ((((isnotnull(d_qoy#28) AND isnotnull(d_year#29)) AND (d_qoy#28 = 2)) AND (d_year#29 = 2000)) AND isnotnull(d_date_sk#35))
            :     :  :     :                       :                    +- FileScan parquet [d_date_sk#35,d_year#29,d_qoy#28] Batched: true, DataFilters: [isnotnull(d_qoy#28), isnotnull(d_year#29), (d_qoy#28 = 2), (d_year#29 = 2000), isnot..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_qoy), IsNotNull(d_year), EqualTo(d_qoy,2), EqualTo(d_year,2000), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_qoy:int>
            :     :  :     :                       +- Sort [ca_address_sk#33 ASC NULLS FIRST], false, 0
            :     :  :     :                          +- Exchange hashpartitioning(ca_address_sk#33, 100), ENSURE_REQUIREMENTS, [plan_id=38]
            :     :  :     :                             +- Filter (isnotnull(ca_address_sk#33) AND isnotnull(ca_county#16))
            :     :  :     :                                +- FileScan parquet [ca_address_sk#33,ca_county#16] Batched: true, DataFilters: [isnotnull(ca_address_sk#33), isnotnull(ca_county#16)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk), IsNotNull(ca_county)], ReadSchema: struct<ca_address_sk:int,ca_county:string>
            :     :  :     +- Sort [ca_county#17 ASC NULLS FIRST], false, 0
            :     :  :        +- Exchange hashpartitioning(ca_county#17, 100), ENSURE_REQUIREMENTS, [plan_id=39]
            :     :  :           +- HashAggregate(keys=[ca_county#17, d_qoy#37, d_year#38], functions=[sum(UnscaledValue(ss_ext_sales_price#36))], output=[ca_county#17, store_sales#11])
            :     :  :              +- Exchange hashpartitioning(ca_county#17, d_qoy#37, d_year#38, 100), ENSURE_REQUIREMENTS, [plan_id=40]
            :     :  :                 +- HashAggregate(keys=[ca_county#17, d_qoy#37, d_year#38], functions=[partial_sum(UnscaledValue(ss_ext_sales_price#36))], output=[ca_county#17, d_qoy#37, d_year#38, sum#75])
            :     :  :                    +- Project [ss_ext_sales_price#36, d_year#38, d_qoy#37, ca_county#17]
            :     :  :                       +- SortMergeJoin [ss_addr_sk#41], [ca_address_sk#42], Inner
            :     :  :                          :- Sort [ss_addr_sk#41 ASC NULLS FIRST], false, 0
            :     :  :                          :  +- Exchange hashpartitioning(ss_addr_sk#41, 100), ENSURE_REQUIREMENTS, [plan_id=41]
            :     :  :                          :     +- Project [ss_addr_sk#41, ss_ext_sales_price#36, d_year#38, d_qoy#37]
            :     :  :                          :        +- SortMergeJoin [ss_sold_date_sk#43], [d_date_sk#44], Inner
            :     :  :                          :           :- Sort [ss_sold_date_sk#43 ASC NULLS FIRST], false, 0
            :     :  :                          :           :  +- Exchange hashpartitioning(ss_sold_date_sk#43, 100), ENSURE_REQUIREMENTS, [plan_id=42]
            :     :  :                          :           :     +- Filter (isnotnull(ss_sold_date_sk#43) AND isnotnull(ss_addr_sk#41))
            :     :  :                          :           :        +- FileScan parquet [ss_sold_date_sk#43,ss_addr_sk#41,ss_ext_sales_price#36] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#43), isnotnull(ss_addr_sk#41)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_addr_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_addr_sk:int,ss_ext_sales_price:decimal(7,2)>
            :     :  :                          :           +- Sort [d_date_sk#44 ASC NULLS FIRST], false, 0
            :     :  :                          :              +- Exchange hashpartitioning(d_date_sk#44, 100), ENSURE_REQUIREMENTS, [plan_id=43]
            :     :  :                          :                 +- Filter ((((isnotnull(d_qoy#37) AND isnotnull(d_year#38)) AND (d_qoy#37 = 3)) AND (d_year#38 = 2000)) AND isnotnull(d_date_sk#44))
            :     :  :                          :                    +- FileScan parquet [d_date_sk#44,d_year#38,d_qoy#37] Batched: true, DataFilters: [isnotnull(d_qoy#37), isnotnull(d_year#38), (d_qoy#37 = 3), (d_year#38 = 2000), isnot..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_qoy), IsNotNull(d_year), EqualTo(d_qoy,3), EqualTo(d_year,2000), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_qoy:int>
            :     :  :                          +- Sort [ca_address_sk#42 ASC NULLS FIRST], false, 0
            :     :  :                             +- Exchange hashpartitioning(ca_address_sk#42, 100), ENSURE_REQUIREMENTS, [plan_id=44]
            :     :  :                                +- Filter (isnotnull(ca_address_sk#42) AND isnotnull(ca_county#17))
            :     :  :                                   +- FileScan parquet [ca_address_sk#42,ca_county#17] Batched: true, DataFilters: [isnotnull(ca_address_sk#42), isnotnull(ca_county#17)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk), IsNotNull(ca_county)], ReadSchema: struct<ca_address_sk:int,ca_county:string>
            :     :  +- Sort [ca_county#13 ASC NULLS FIRST], false, 0
            :     :     +- Exchange hashpartitioning(ca_county#13, 100), ENSURE_REQUIREMENTS, [plan_id=45]
            :     :        +- HashAggregate(keys=[ca_county#13, d_qoy#47, d_year#48], functions=[sum(UnscaledValue(ws_ext_sales_price#45))], output=[ca_county#13, web_sales#4])
            :     :           +- Exchange hashpartitioning(ca_county#13, d_qoy#47, d_year#48, 100), ENSURE_REQUIREMENTS, [plan_id=46]
            :     :              +- HashAggregate(keys=[ca_county#13, d_qoy#47, d_year#48], functions=[partial_sum(UnscaledValue(ws_ext_sales_price#45))], output=[ca_county#13, d_qoy#47, d_year#48, sum#76])
            :     :                 +- Project [ws_ext_sales_price#45, d_year#48, d_qoy#47, ca_county#13]
            :     :                    +- SortMergeJoin [ws_bill_addr_sk#51], [ca_address_sk#52], Inner
            :     :                       :- Sort [ws_bill_addr_sk#51 ASC NULLS FIRST], false, 0
            :     :                       :  +- Exchange hashpartitioning(ws_bill_addr_sk#51, 100), ENSURE_REQUIREMENTS, [plan_id=47]
            :     :                       :     +- Project [ws_bill_addr_sk#51, ws_ext_sales_price#45, d_year#48, d_qoy#47]
            :     :                       :        +- SortMergeJoin [ws_sold_date_sk#53], [d_date_sk#54], Inner
            :     :                       :           :- Sort [ws_sold_date_sk#53 ASC NULLS FIRST], false, 0
            :     :                       :           :  +- Exchange hashpartitioning(ws_sold_date_sk#53, 100), ENSURE_REQUIREMENTS, [plan_id=48]
            :     :                       :           :     +- Filter (isnotnull(ws_sold_date_sk#53) AND isnotnull(ws_bill_addr_sk#51))
            :     :                       :           :        +- FileScan parquet [ws_sold_date_sk#53,ws_bill_addr_sk#51,ws_ext_sales_price#45] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#53), isnotnull(ws_bill_addr_sk#51)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk), IsNotNull(ws_bill_addr_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_bill_addr_sk:int,ws_ext_sales_price:decimal(7,2)>
            :     :                       :           +- Sort [d_date_sk#54 ASC NULLS FIRST], false, 0
            :     :                       :              +- Exchange hashpartitioning(d_date_sk#54, 100), ENSURE_REQUIREMENTS, [plan_id=49]
            :     :                       :                 +- Filter ((((isnotnull(d_qoy#47) AND isnotnull(d_year#48)) AND (d_qoy#47 = 1)) AND (d_year#48 = 2000)) AND isnotnull(d_date_sk#54))
            :     :                       :                    +- FileScan parquet [d_date_sk#54,d_year#48,d_qoy#47] Batched: true, DataFilters: [isnotnull(d_qoy#47), isnotnull(d_year#48), (d_qoy#47 = 1), (d_year#48 = 2000), isnot..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_qoy), IsNotNull(d_year), EqualTo(d_qoy,1), EqualTo(d_year,2000), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_qoy:int>
            :     :                       +- Sort [ca_address_sk#52 ASC NULLS FIRST], false, 0
            :     :                          +- Exchange hashpartitioning(ca_address_sk#52, 100), ENSURE_REQUIREMENTS, [plan_id=50]
            :     :                             +- Filter (isnotnull(ca_address_sk#52) AND isnotnull(ca_county#13))
            :     :                                +- FileScan parquet [ca_address_sk#52,ca_county#13] Batched: true, DataFilters: [isnotnull(ca_address_sk#52), isnotnull(ca_county#13)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk), IsNotNull(ca_county)], ReadSchema: struct<ca_address_sk:int,ca_county:string>
            :     +- Sort [ca_county#15 ASC NULLS FIRST], false, 0
            :        +- Exchange hashpartitioning(ca_county#15, 100), ENSURE_REQUIREMENTS, [plan_id=51]
            :           +- HashAggregate(keys=[ca_county#15, d_qoy#56, d_year#57], functions=[sum(UnscaledValue(ws_ext_sales_price#55))], output=[ca_county#15, web_sales#3])
            :              +- Exchange hashpartitioning(ca_county#15, d_qoy#56, d_year#57, 100), ENSURE_REQUIREMENTS, [plan_id=52]
            :                 +- HashAggregate(keys=[ca_county#15, d_qoy#56, d_year#57], functions=[partial_sum(UnscaledValue(ws_ext_sales_price#55))], output=[ca_county#15, d_qoy#56, d_year#57, sum#77])
            :                    +- Project [ws_ext_sales_price#55, d_year#57, d_qoy#56, ca_county#15]
            :                       +- SortMergeJoin [ws_bill_addr_sk#60], [ca_address_sk#61], Inner
            :                          :- Sort [ws_bill_addr_sk#60 ASC NULLS FIRST], false, 0
            :                          :  +- Exchange hashpartitioning(ws_bill_addr_sk#60, 100), ENSURE_REQUIREMENTS, [plan_id=53]
            :                          :     +- Project [ws_bill_addr_sk#60, ws_ext_sales_price#55, d_year#57, d_qoy#56]
            :                          :        +- SortMergeJoin [ws_sold_date_sk#62], [d_date_sk#63], Inner
            :                          :           :- Sort [ws_sold_date_sk#62 ASC NULLS FIRST], false, 0
            :                          :           :  +- Exchange hashpartitioning(ws_sold_date_sk#62, 100), ENSURE_REQUIREMENTS, [plan_id=54]
            :                          :           :     +- Filter (isnotnull(ws_sold_date_sk#62) AND isnotnull(ws_bill_addr_sk#60))
            :                          :           :        +- FileScan parquet [ws_sold_date_sk#62,ws_bill_addr_sk#60,ws_ext_sales_price#55] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#62), isnotnull(ws_bill_addr_sk#60)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk), IsNotNull(ws_bill_addr_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_bill_addr_sk:int,ws_ext_sales_price:decimal(7,2)>
            :                          :           +- Sort [d_date_sk#63 ASC NULLS FIRST], false, 0
            :                          :              +- Exchange hashpartitioning(d_date_sk#63, 100), ENSURE_REQUIREMENTS, [plan_id=55]
            :                          :                 +- Filter ((((isnotnull(d_qoy#56) AND isnotnull(d_year#57)) AND (d_qoy#56 = 2)) AND (d_year#57 = 2000)) AND isnotnull(d_date_sk#63))
            :                          :                    +- FileScan parquet [d_date_sk#63,d_year#57,d_qoy#56] Batched: true, DataFilters: [isnotnull(d_qoy#56), isnotnull(d_year#57), (d_qoy#56 = 2), (d_year#57 = 2000), isnot..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_qoy), IsNotNull(d_year), EqualTo(d_qoy,2), EqualTo(d_year,2000), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_qoy:int>
            :                          +- Sort [ca_address_sk#61 ASC NULLS FIRST], false, 0
            :                             +- Exchange hashpartitioning(ca_address_sk#61, 100), ENSURE_REQUIREMENTS, [plan_id=56]
            :                                +- Filter (isnotnull(ca_address_sk#61) AND isnotnull(ca_county#15))
            :                                   +- FileScan parquet [ca_address_sk#61,ca_county#15] Batched: true, DataFilters: [isnotnull(ca_address_sk#61), isnotnull(ca_county#15)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk), IsNotNull(ca_county)], ReadSchema: struct<ca_address_sk:int,ca_county:string>
            +- Sort [ca_county#14 ASC NULLS FIRST], false, 0
               +- Exchange hashpartitioning(ca_county#14, 100), ENSURE_REQUIREMENTS, [plan_id=57]
                  +- HashAggregate(keys=[ca_county#14, d_qoy#65, d_year#66], functions=[sum(UnscaledValue(ws_ext_sales_price#64))], output=[ca_county#14, web_sales#9])
                     +- Exchange hashpartitioning(ca_county#14, d_qoy#65, d_year#66, 100), ENSURE_REQUIREMENTS, [plan_id=58]
                        +- HashAggregate(keys=[ca_county#14, d_qoy#65, d_year#66], functions=[partial_sum(UnscaledValue(ws_ext_sales_price#64))], output=[ca_county#14, d_qoy#65, d_year#66, sum#78])
                           +- Project [ws_ext_sales_price#64, d_year#66, d_qoy#65, ca_county#14]
                              +- SortMergeJoin [ws_bill_addr_sk#69], [ca_address_sk#70], Inner
                                 :- Sort [ws_bill_addr_sk#69 ASC NULLS FIRST], false, 0
                                 :  +- Exchange hashpartitioning(ws_bill_addr_sk#69, 100), ENSURE_REQUIREMENTS, [plan_id=59]
                                 :     +- Project [ws_bill_addr_sk#69, ws_ext_sales_price#64, d_year#66, d_qoy#65]
                                 :        +- SortMergeJoin [ws_sold_date_sk#71], [d_date_sk#72], Inner
                                 :           :- Sort [ws_sold_date_sk#71 ASC NULLS FIRST], false, 0
                                 :           :  +- Exchange hashpartitioning(ws_sold_date_sk#71, 100), ENSURE_REQUIREMENTS, [plan_id=60]
                                 :           :     +- Filter (isnotnull(ws_sold_date_sk#71) AND isnotnull(ws_bill_addr_sk#69))
                                 :           :        +- FileScan parquet [ws_sold_date_sk#71,ws_bill_addr_sk#69,ws_ext_sales_price#64] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#71), isnotnull(ws_bill_addr_sk#69)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk), IsNotNull(ws_bill_addr_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_bill_addr_sk:int,ws_ext_sales_price:decimal(7,2)>
                                 :           +- Sort [d_date_sk#72 ASC NULLS FIRST], false, 0
                                 :              +- Exchange hashpartitioning(d_date_sk#72, 100), ENSURE_REQUIREMENTS, [plan_id=61]
                                 :                 +- Filter ((((isnotnull(d_qoy#65) AND isnotnull(d_year#66)) AND (d_qoy#65 = 3)) AND (d_year#66 = 2000)) AND isnotnull(d_date_sk#72))
                                 :                    +- FileScan parquet [d_date_sk#72,d_year#66,d_qoy#65] Batched: true, DataFilters: [isnotnull(d_qoy#65), isnotnull(d_year#66), (d_qoy#65 = 3), (d_year#66 = 2000), isnot..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_qoy), IsNotNull(d_year), EqualTo(d_qoy,3), EqualTo(d_year,2000), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_qoy:int>
                                 +- Sort [ca_address_sk#70 ASC NULLS FIRST], false, 0
                                    +- Exchange hashpartitioning(ca_address_sk#70, 100), ENSURE_REQUIREMENTS, [plan_id=62]
                                       +- Filter (isnotnull(ca_address_sk#70) AND isnotnull(ca_county#14))
                                          +- FileScan parquet [ca_address_sk#70,ca_county#14] Batched: true, DataFilters: [isnotnull(ca_address_sk#70), isnotnull(ca_county#14)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk), IsNotNull(ca_county)], ReadSchema: struct<ca_address_sk:int,ca_county:string>
