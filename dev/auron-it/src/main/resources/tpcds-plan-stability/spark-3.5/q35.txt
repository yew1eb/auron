AdaptiveSparkPlan isFinalPlan=true
+- == Final Plan ==
   NativeProject [ca_state#1, cd_gender#2, cd_marital_status#3, cnt1#4, min(cd_dep_count)#5, max(cd_dep_count)#6, avg(cd_dep_count)#7, cd_dep_employed_count#8, cnt2#9, min(cd_dep_employed_count)#10, max(cd_dep_employed_count)#11, avg(cd_dep_employed_count)#12, cd_dep_college_count#13, cnt3#14, min(cd_dep_college_count)#15, max(cd_dep_college_count)#16, avg(cd_dep_college_count)#17]
   +- NativeTakeOrdered 100, [ca_state#1 ASC NULLS FIRST, cd_gender#2 ASC NULLS FIRST, cd_marital_status#3 ASC NULLS FIRST, cd_dep_count#18 ASC NULLS FIRST, cd_dep_employed_count#8 ASC NULLS FIRST, cd_dep_college_count#13 ASC NULLS FIRST]
      +- NativeProject [ca_state#1, cd_gender#2, cd_marital_status#3, count(1)#19 AS cnt1#4, min(cd_dep_count#18)#20 AS min(cd_dep_count)#5, max(cd_dep_count#18)#21 AS max(cd_dep_count)#6, avg(cd_dep_count#18)#22 AS avg(cd_dep_count)#7, cd_dep_employed_count#8, count(1)#19 AS cnt2#9, min(cd_dep_employed_count#8)#23 AS min(cd_dep_employed_count)#10, max(cd_dep_employed_count#8)#24 AS max(cd_dep_employed_count)#11, avg(cd_dep_employed_count#8)#25 AS avg(cd_dep_employed_count)#12, cd_dep_college_count#13, count(1)#19 AS cnt3#14, min(cd_dep_college_count#13)#26 AS min(cd_dep_college_count)#15, max(cd_dep_college_count#13)#27 AS max(cd_dep_college_count)#16, avg(cd_dep_college_count#13)#28 AS avg(cd_dep_college_count)#17, cd_dep_count#18]
         +- NativeHashAggregate HashAgg, ArrayBuffer(ca_state#1, cd_gender#2, cd_marital_status#3, cd_dep_count#18, cd_dep_employed_count#8, cd_dep_college_count#13), [ca_state#1, cd_gender#2, cd_marital_status#3, cd_dep_count#18, cd_dep_employed_count#8, cd_dep_college_count#13], [count(1), min(cd_dep_count#18), max(cd_dep_count#18), avg(cd_dep_count#18), min(cd_dep_employed_count#8), max(cd_dep_employed_count#8), avg(cd_dep_employed_count#8), min(cd_dep_college_count#13), max(cd_dep_college_count#13), avg(cd_dep_college_count#13)], [count(1)#19, min(cd_dep_count#18)#20, max(cd_dep_count#18)#21, avg(cd_dep_count#18)#22, min(cd_dep_employed_count#8)#23, max(cd_dep_employed_count#8)#24, avg(cd_dep_employed_count#8)#25, min(cd_dep_college_count#13)#26, max(cd_dep_college_count#13)#27, avg(cd_dep_college_count#13)#28], 6
            +- InputAdapter
               +- AQEShuffleRead coalesced
                  +- ShuffleQueryStage X
                     +- NativeShuffleExchange hashpartitioning(ca_state#1, cd_gender#2, cd_marital_status#3, cd_dep_count#18, cd_dep_employed_count#8, cd_dep_college_count#13, 100), ENSURE_REQUIREMENTS, [plan_id=1]
                        +- NativeHashAggregate HashAgg, [ca_state#1, cd_gender#2, cd_marital_status#3, cd_dep_count#18, cd_dep_employed_count#8, cd_dep_college_count#13], [partial_count(1), partial_min(cd_dep_count#18), partial_max(cd_dep_count#18), partial_avg(cd_dep_count#18), partial_min(cd_dep_employed_count#8), partial_max(cd_dep_employed_count#8), partial_avg(cd_dep_employed_count#8), partial_min(cd_dep_college_count#13), partial_max(cd_dep_college_count#13), partial_avg(cd_dep_college_count#13)], [count#29, min#30, max#31, sum#32, count#33, min#34, max#35, sum#36, count#37, min#38, max#39, sum#40, count#41], 0
                           +- NativeProject [ca_state#1, cd_gender#2, cd_marital_status#3, cd_dep_count#18, cd_dep_employed_count#8, cd_dep_college_count#13]
                              +- NativeSortMergeJoin [c_current_cdemo_sk#42], [cd_demo_sk#43], Inner
                                 :- NativeSort [c_current_cdemo_sk#42 ASC NULLS FIRST], false
                                 :  +- InputAdapter
                                 :     +- AQEShuffleRead coalesced
                                 :        +- ShuffleQueryStage X
                                 :           +- NativeShuffleExchange hashpartitioning(c_current_cdemo_sk#42, 100), ENSURE_REQUIREMENTS, [plan_id=2]
                                 :              +- NativeProject [c_current_cdemo_sk#42, ca_state#1]
                                 :                 +- NativeSortMergeJoin [c_current_addr_sk#44], [ca_address_sk#45], Inner
                                 :                    :- NativeSort [c_current_addr_sk#44 ASC NULLS FIRST], false
                                 :                    :  +- InputAdapter
                                 :                    :     +- AQEShuffleRead coalesced
                                 :                    :        +- ShuffleQueryStage X
                                 :                    :           +- NativeShuffleExchange hashpartitioning(c_current_addr_sk#44, 100), ENSURE_REQUIREMENTS, [plan_id=3]
                                 :                    :              +- NativeProject [c_current_cdemo_sk#42, c_current_addr_sk#44]
                                 :                    :                 +- NativeFilter (exists#46 OR exists#47)
                                 :                    :                    +- NativeSortMergeJoin [c_customer_sk#48], [cs_ship_customer_sk#49], ExistenceJoin(exists#47)
                                 :                    :                       :- NativeSortMergeJoin [c_customer_sk#48], [ws_bill_customer_sk#50], ExistenceJoin(exists#46)
                                 :                    :                       :  :- NativeSortMergeJoin [c_customer_sk#48], [ss_customer_sk#51], LeftSemi
                                 :                    :                       :  :  :- NativeSort [c_customer_sk#48 ASC NULLS FIRST], false
                                 :                    :                       :  :  :  +- InputAdapter
                                 :                    :                       :  :  :     +- AQEShuffleRead coalesced
                                 :                    :                       :  :  :        +- ShuffleQueryStage X
                                 :                    :                       :  :  :           +- NativeShuffleExchange hashpartitioning(c_customer_sk#48, 100), ENSURE_REQUIREMENTS, [plan_id=4]
                                 :                    :                       :  :  :              +- NativeFilter (isnotnull(c_current_addr_sk#44) AND isnotnull(c_current_cdemo_sk#42))
                                 :                    :                       :  :  :                 +- InputAdapter [#48, #42, #44]
                                 :                    :                       :  :  :                    +- NativeParquetScan  (FileScan parquet [c_customer_sk#48,c_current_cdemo_sk#42,c_current_addr_sk#44] Batched: true, DataFilters: [isnotnull(c_current_addr_sk#44), isnotnull(c_current_cdemo_sk#42)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(c_current_addr_sk), IsNotNull(c_current_cdemo_sk)], ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_addr_sk:int>)
                                 :                    :                       :  :  +- NativeSort [ss_customer_sk#51 ASC NULLS FIRST], false
                                 :                    :                       :  :     +- InputAdapter
                                 :                    :                       :  :        +- AQEShuffleRead coalesced
                                 :                    :                       :  :           +- ShuffleQueryStage X
                                 :                    :                       :  :              +- NativeShuffleExchange hashpartitioning(ss_customer_sk#51, 100), ENSURE_REQUIREMENTS, [plan_id=5]
                                 :                    :                       :  :                 +- NativeProject [ss_customer_sk#51]
                                 :                    :                       :  :                    +- NativeSortMergeJoin [ss_sold_date_sk#52], [d_date_sk#53], Inner
                                 :                    :                       :  :                       :- NativeSort [ss_sold_date_sk#52 ASC NULLS FIRST], false
                                 :                    :                       :  :                       :  +- InputAdapter
                                 :                    :                       :  :                       :     +- AQEShuffleRead coalesced
                                 :                    :                       :  :                       :        +- ShuffleQueryStage X
                                 :                    :                       :  :                       :           +- NativeShuffleExchange hashpartitioning(ss_sold_date_sk#52, 100), ENSURE_REQUIREMENTS, [plan_id=6]
                                 :                    :                       :  :                       :              +- NativeFilter isnotnull(ss_sold_date_sk#52)
                                 :                    :                       :  :                       :                 +- InputAdapter [#52, #51]
                                 :                    :                       :  :                       :                    +- NativeParquetScan  (FileScan parquet [ss_sold_date_sk#52,ss_customer_sk#51] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#52)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int>)
                                 :                    :                       :  :                       +- NativeSort [d_date_sk#53 ASC NULLS FIRST], false
                                 :                    :                       :  :                          +- InputAdapter
                                 :                    :                       :  :                             +- AQEShuffleRead coalesced
                                 :                    :                       :  :                                +- ShuffleQueryStage X
                                 :                    :                       :  :                                   +- NativeShuffleExchange hashpartitioning(d_date_sk#53, 100), ENSURE_REQUIREMENTS, [plan_id=7]
                                 :                    :                       :  :                                      +- NativeProject [d_date_sk#53]
                                 :                    :                       :  :                                         +- NativeFilter ((((isnotnull(d_year#54) AND isnotnull(d_qoy#55)) AND (d_year#54 = 2002)) AND (d_qoy#55 < 4)) AND isnotnull(d_date_sk#53))
                                 :                    :                       :  :                                            +- InputAdapter [#53, #54, #55]
                                 :                    :                       :  :                                               +- NativeParquetScan  (FileScan parquet [d_date_sk#53,d_year#54,d_qoy#55] Batched: true, DataFilters: [isnotnull(d_year#54), isnotnull(d_qoy#55), (d_year#54 = 2002), (d_qoy#55 < 4), isnotnull(d_d..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_qoy), EqualTo(d_year,2002), LessThan(d_qoy,4), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_qoy:int>)
                                 :                    :                       :  +- NativeSort [ws_bill_customer_sk#50 ASC NULLS FIRST], false
                                 :                    :                       :     +- InputAdapter
                                 :                    :                       :        +- AQEShuffleRead coalesced
                                 :                    :                       :           +- ShuffleQueryStage X
                                 :                    :                       :              +- NativeShuffleExchange hashpartitioning(ws_bill_customer_sk#50, 100), ENSURE_REQUIREMENTS, [plan_id=8]
                                 :                    :                       :                 +- NativeProject [ws_bill_customer_sk#50]
                                 :                    :                       :                    +- NativeSortMergeJoin [ws_sold_date_sk#56], [d_date_sk#57], Inner
                                 :                    :                       :                       :- NativeSort [ws_sold_date_sk#56 ASC NULLS FIRST], false
                                 :                    :                       :                       :  +- InputAdapter
                                 :                    :                       :                       :     +- AQEShuffleRead coalesced
                                 :                    :                       :                       :        +- ShuffleQueryStage X
                                 :                    :                       :                       :           +- NativeShuffleExchange hashpartitioning(ws_sold_date_sk#56, 100), ENSURE_REQUIREMENTS, [plan_id=9]
                                 :                    :                       :                       :              +- NativeFilter isnotnull(ws_sold_date_sk#56)
                                 :                    :                       :                       :                 +- InputAdapter [#56, #50]
                                 :                    :                       :                       :                    +- NativeParquetScan  (FileScan parquet [ws_sold_date_sk#56,ws_bill_customer_sk#50] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#56)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_bill_customer_sk:int>)
                                 :                    :                       :                       +- NativeSort [d_date_sk#57 ASC NULLS FIRST], false
                                 :                    :                       :                          +- InputAdapter
                                 :                    :                       :                             +- InputAdapter [#57]
                                 :                    :                       :                                +- AQEShuffleRead coalesced
                                 :                    :                       :                                   +- ShuffleQueryStage X
                                 :                    :                       :                                      +- ReusedExchange [d_date_sk#57], NativeShuffleExchange hashpartitioning(d_date_sk#53, 100), ENSURE_REQUIREMENTS, [plan_id=7]
                                 :                    :                       +- NativeSort [cs_ship_customer_sk#49 ASC NULLS FIRST], false
                                 :                    :                          +- InputAdapter
                                 :                    :                             +- AQEShuffleRead coalesced
                                 :                    :                                +- ShuffleQueryStage X
                                 :                    :                                   +- NativeShuffleExchange hashpartitioning(cs_ship_customer_sk#49, 100), ENSURE_REQUIREMENTS, [plan_id=10]
                                 :                    :                                      +- NativeProject [cs_ship_customer_sk#49]
                                 :                    :                                         +- NativeSortMergeJoin [cs_sold_date_sk#58], [d_date_sk#59], Inner
                                 :                    :                                            :- NativeSort [cs_sold_date_sk#58 ASC NULLS FIRST], false
                                 :                    :                                            :  +- InputAdapter
                                 :                    :                                            :     +- AQEShuffleRead coalesced
                                 :                    :                                            :        +- ShuffleQueryStage X
                                 :                    :                                            :           +- NativeShuffleExchange hashpartitioning(cs_sold_date_sk#58, 100), ENSURE_REQUIREMENTS, [plan_id=11]
                                 :                    :                                            :              +- NativeFilter isnotnull(cs_sold_date_sk#58)
                                 :                    :                                            :                 +- InputAdapter [#58, #49]
                                 :                    :                                            :                    +- NativeParquetScan  (FileScan parquet [cs_sold_date_sk#58,cs_ship_customer_sk#49] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#58)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_ship_customer_sk:int>)
                                 :                    :                                            +- NativeSort [d_date_sk#59 ASC NULLS FIRST], false
                                 :                    :                                               +- InputAdapter
                                 :                    :                                                  +- InputAdapter [#59]
                                 :                    :                                                     +- AQEShuffleRead coalesced
                                 :                    :                                                        +- ShuffleQueryStage X
                                 :                    :                                                           +- ReusedExchange [d_date_sk#59], NativeShuffleExchange hashpartitioning(d_date_sk#53, 100), ENSURE_REQUIREMENTS, [plan_id=7]
                                 :                    +- NativeSort [ca_address_sk#45 ASC NULLS FIRST], false
                                 :                       +- InputAdapter
                                 :                          +- AQEShuffleRead coalesced
                                 :                             +- ShuffleQueryStage X
                                 :                                +- NativeShuffleExchange hashpartitioning(ca_address_sk#45, 100), ENSURE_REQUIREMENTS, [plan_id=12]
                                 :                                   +- NativeFilter isnotnull(ca_address_sk#45)
                                 :                                      +- InputAdapter [#45, #1]
                                 :                                         +- NativeParquetScan  (FileScan parquet [ca_address_sk#45,ca_state#1] Batched: true, DataFilters: [isnotnull(ca_address_sk#45)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_state:string>)
                                 +- NativeSort [cd_demo_sk#43 ASC NULLS FIRST], false
                                    +- InputAdapter
                                       +- AQEShuffleRead coalesced
                                          +- ShuffleQueryStage X
                                             +- NativeShuffleExchange hashpartitioning(cd_demo_sk#43, 100), ENSURE_REQUIREMENTS, [plan_id=13]
                                                +- NativeFilter isnotnull(cd_demo_sk#43)
                                                   +- InputAdapter [#43, #2, #3, #18, #8, #13]
                                                      +- NativeParquetScan  (FileScan parquet [cd_demo_sk#43,cd_gender#2,cd_marital_status#3,cd_dep_count#18,cd_dep_employed_count#8,cd_dep_college_count#13] Batched: true, DataFilters: [isnotnull(cd_demo_sk#43)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>, PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk)], ReadSchema: struct<cd_demo_sk:int,cd_gender:string,cd_marital_status:string,cd_dep_count:int,cd_dep_employed_...)
+- == Initial Plan ==
   TakeOrderedAndProject(limit=100, orderBy=[ca_state#1 ASC NULLS FIRST,cd_gender#2 ASC NULLS FIRST,cd_marital_status#3 ASC NULLS FIRST,cd_dep_count#18 ASC NULLS FIRST,cd_dep_employed_count#8 ASC NULLS FIRST,cd_dep_college_count#13 ASC NULLS FIRST], output=[ca_state#1,cd_gender#2,cd_marital_status#3,cnt1#4,min(cd_dep_count)#5,max(cd_dep_count)#6,avg(cd_dep_count)#7,cd_dep_employed_count#8,cnt2#9,min(cd_dep_employed_count)#10,max(cd_dep_employed_count)#11,avg(cd_dep_employed_count)#12,cd_dep_college_count#13,cnt3#14,min(cd_dep_college_count)#15,max(cd_dep_college_count)#16,avg(cd_dep_college_count)#17])
   +- HashAggregate(keys=[ca_state#1, cd_gender#2, cd_marital_status#3, cd_dep_count#18, cd_dep_employed_count#8, cd_dep_college_count#13], functions=[count(1), min(cd_dep_count#18), max(cd_dep_count#18), avg(cd_dep_count#18), min(cd_dep_employed_count#8), max(cd_dep_employed_count#8), avg(cd_dep_employed_count#8), min(cd_dep_college_count#13), max(cd_dep_college_count#13), avg(cd_dep_college_count#13)], output=[ca_state#1, cd_gender#2, cd_marital_status#3, cnt1#4, min(cd_dep_count)#5, max(cd_dep_count)#6, avg(cd_dep_count)#7, cd_dep_employed_count#8, cnt2#9, min(cd_dep_employed_count)#10, max(cd_dep_employed_count)#11, avg(cd_dep_employed_count)#12, cd_dep_college_count#13, cnt3#14, min(cd_dep_college_count)#15, max(cd_dep_college_count)#16, avg(cd_dep_college_count)#17, cd_dep_count#18])
      +- Exchange hashpartitioning(ca_state#1, cd_gender#2, cd_marital_status#3, cd_dep_count#18, cd_dep_employed_count#8, cd_dep_college_count#13, 100), ENSURE_REQUIREMENTS, [plan_id=14]
         +- HashAggregate(keys=[ca_state#1, cd_gender#2, cd_marital_status#3, cd_dep_count#18, cd_dep_employed_count#8, cd_dep_college_count#13], functions=[partial_count(1), partial_min(cd_dep_count#18), partial_max(cd_dep_count#18), partial_avg(cd_dep_count#18), partial_min(cd_dep_employed_count#8), partial_max(cd_dep_employed_count#8), partial_avg(cd_dep_employed_count#8), partial_min(cd_dep_college_count#13), partial_max(cd_dep_college_count#13), partial_avg(cd_dep_college_count#13)], output=[ca_state#1, cd_gender#2, cd_marital_status#3, cd_dep_count#18, cd_dep_employed_count#8, cd_dep_college_count#13, count#60, min#61, max#62, sum#63, count#64, min#65, max#66, sum#67, count#68, min#69, max#70, sum#71, count#72])
            +- Project [ca_state#1, cd_gender#2, cd_marital_status#3, cd_dep_count#18, cd_dep_employed_count#8, cd_dep_college_count#13]
               +- SortMergeJoin [c_current_cdemo_sk#42], [cd_demo_sk#43], Inner
                  :- Sort [c_current_cdemo_sk#42 ASC NULLS FIRST], false, 0
                  :  +- Exchange hashpartitioning(c_current_cdemo_sk#42, 100), ENSURE_REQUIREMENTS, [plan_id=15]
                  :     +- Project [c_current_cdemo_sk#42, ca_state#1]
                  :        +- SortMergeJoin [c_current_addr_sk#44], [ca_address_sk#45], Inner
                  :           :- Sort [c_current_addr_sk#44 ASC NULLS FIRST], false, 0
                  :           :  +- Exchange hashpartitioning(c_current_addr_sk#44, 100), ENSURE_REQUIREMENTS, [plan_id=16]
                  :           :     +- Project [c_current_cdemo_sk#42, c_current_addr_sk#44]
                  :           :        +- Filter (exists#46 OR exists#47)
                  :           :           +- SortMergeJoin [c_customer_sk#48], [cs_ship_customer_sk#49], ExistenceJoin(exists#47)
                  :           :              :- SortMergeJoin [c_customer_sk#48], [ws_bill_customer_sk#50], ExistenceJoin(exists#46)
                  :           :              :  :- SortMergeJoin [c_customer_sk#48], [ss_customer_sk#51], LeftSemi
                  :           :              :  :  :- Sort [c_customer_sk#48 ASC NULLS FIRST], false, 0
                  :           :              :  :  :  +- Exchange hashpartitioning(c_customer_sk#48, 100), ENSURE_REQUIREMENTS, [plan_id=17]
                  :           :              :  :  :     +- Filter (isnotnull(c_current_addr_sk#44) AND isnotnull(c_current_cdemo_sk#42))
                  :           :              :  :  :        +- FileScan parquet [c_customer_sk#48,c_current_cdemo_sk#42,c_current_addr_sk#44] Batched: true, DataFilters: [isnotnull(c_current_addr_sk#44), isnotnull(c_current_cdemo_sk#42)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(c_current_addr_sk), IsNotNull(c_current_cdemo_sk)], ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_addr_sk:int>
                  :           :              :  :  +- Sort [ss_customer_sk#51 ASC NULLS FIRST], false, 0
                  :           :              :  :     +- Exchange hashpartitioning(ss_customer_sk#51, 100), ENSURE_REQUIREMENTS, [plan_id=18]
                  :           :              :  :        +- Project [ss_customer_sk#51]
                  :           :              :  :           +- SortMergeJoin [ss_sold_date_sk#52], [d_date_sk#53], Inner
                  :           :              :  :              :- Sort [ss_sold_date_sk#52 ASC NULLS FIRST], false, 0
                  :           :              :  :              :  +- Exchange hashpartitioning(ss_sold_date_sk#52, 100), ENSURE_REQUIREMENTS, [plan_id=19]
                  :           :              :  :              :     +- Filter isnotnull(ss_sold_date_sk#52)
                  :           :              :  :              :        +- FileScan parquet [ss_sold_date_sk#52,ss_customer_sk#51] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#52)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int>
                  :           :              :  :              +- Sort [d_date_sk#53 ASC NULLS FIRST], false, 0
                  :           :              :  :                 +- Exchange hashpartitioning(d_date_sk#53, 100), ENSURE_REQUIREMENTS, [plan_id=20]
                  :           :              :  :                    +- Project [d_date_sk#53]
                  :           :              :  :                       +- Filter ((((isnotnull(d_year#54) AND isnotnull(d_qoy#55)) AND (d_year#54 = 2002)) AND (d_qoy#55 < 4)) AND isnotnull(d_date_sk#53))
                  :           :              :  :                          +- FileScan parquet [d_date_sk#53,d_year#54,d_qoy#55] Batched: true, DataFilters: [isnotnull(d_year#54), isnotnull(d_qoy#55), (d_year#54 = 2002), (d_qoy#55 < 4), isnotnull(d_d..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_qoy), EqualTo(d_year,2002), LessThan(d_qoy,4), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_qoy:int>
                  :           :              :  +- Sort [ws_bill_customer_sk#50 ASC NULLS FIRST], false, 0
                  :           :              :     +- Exchange hashpartitioning(ws_bill_customer_sk#50, 100), ENSURE_REQUIREMENTS, [plan_id=21]
                  :           :              :        +- Project [ws_bill_customer_sk#50]
                  :           :              :           +- SortMergeJoin [ws_sold_date_sk#56], [d_date_sk#57], Inner
                  :           :              :              :- Sort [ws_sold_date_sk#56 ASC NULLS FIRST], false, 0
                  :           :              :              :  +- Exchange hashpartitioning(ws_sold_date_sk#56, 100), ENSURE_REQUIREMENTS, [plan_id=22]
                  :           :              :              :     +- Filter isnotnull(ws_sold_date_sk#56)
                  :           :              :              :        +- FileScan parquet [ws_sold_date_sk#56,ws_bill_customer_sk#50] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#56)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_bill_customer_sk:int>
                  :           :              :              +- Sort [d_date_sk#57 ASC NULLS FIRST], false, 0
                  :           :              :                 +- Exchange hashpartitioning(d_date_sk#57, 100), ENSURE_REQUIREMENTS, [plan_id=23]
                  :           :              :                    +- Project [d_date_sk#57]
                  :           :              :                       +- Filter ((((isnotnull(d_year#73) AND isnotnull(d_qoy#74)) AND (d_year#73 = 2002)) AND (d_qoy#74 < 4)) AND isnotnull(d_date_sk#57))
                  :           :              :                          +- FileScan parquet [d_date_sk#57,d_year#73,d_qoy#74] Batched: true, DataFilters: [isnotnull(d_year#73), isnotnull(d_qoy#74), (d_year#73 = 2002), (d_qoy#74 < 4), isnot..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_qoy), EqualTo(d_year,2002), LessThan(d_qoy,4), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_qoy:int>
                  :           :              +- Sort [cs_ship_customer_sk#49 ASC NULLS FIRST], false, 0
                  :           :                 +- Exchange hashpartitioning(cs_ship_customer_sk#49, 100), ENSURE_REQUIREMENTS, [plan_id=24]
                  :           :                    +- Project [cs_ship_customer_sk#49]
                  :           :                       +- SortMergeJoin [cs_sold_date_sk#58], [d_date_sk#59], Inner
                  :           :                          :- Sort [cs_sold_date_sk#58 ASC NULLS FIRST], false, 0
                  :           :                          :  +- Exchange hashpartitioning(cs_sold_date_sk#58, 100), ENSURE_REQUIREMENTS, [plan_id=25]
                  :           :                          :     +- Filter isnotnull(cs_sold_date_sk#58)
                  :           :                          :        +- FileScan parquet [cs_sold_date_sk#58,cs_ship_customer_sk#49] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#58)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_ship_customer_sk:int>
                  :           :                          +- Sort [d_date_sk#59 ASC NULLS FIRST], false, 0
                  :           :                             +- Exchange hashpartitioning(d_date_sk#59, 100), ENSURE_REQUIREMENTS, [plan_id=26]
                  :           :                                +- Project [d_date_sk#59]
                  :           :                                   +- Filter ((((isnotnull(d_year#75) AND isnotnull(d_qoy#76)) AND (d_year#75 = 2002)) AND (d_qoy#76 < 4)) AND isnotnull(d_date_sk#59))
                  :           :                                      +- FileScan parquet [d_date_sk#59,d_year#75,d_qoy#76] Batched: true, DataFilters: [isnotnull(d_year#75), isnotnull(d_qoy#76), (d_year#75 = 2002), (d_qoy#76 < 4), isnot..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_qoy), EqualTo(d_year,2002), LessThan(d_qoy,4), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_qoy:int>
                  :           +- Sort [ca_address_sk#45 ASC NULLS FIRST], false, 0
                  :              +- Exchange hashpartitioning(ca_address_sk#45, 100), ENSURE_REQUIREMENTS, [plan_id=27]
                  :                 +- Filter isnotnull(ca_address_sk#45)
                  :                    +- FileScan parquet [ca_address_sk#45,ca_state#1] Batched: true, DataFilters: [isnotnull(ca_address_sk#45)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_state:string>
                  +- Sort [cd_demo_sk#43 ASC NULLS FIRST], false, 0
                     +- Exchange hashpartitioning(cd_demo_sk#43, 100), ENSURE_REQUIREMENTS, [plan_id=28]
                        +- Filter isnotnull(cd_demo_sk#43)
                           +- FileScan parquet [cd_demo_sk#43,cd_gender#2,cd_marital_status#3,cd_dep_count#18,cd_dep_employed_count#8,cd_dep_college_count#13] Batched: true, DataFilters: [isnotnull(cd_demo_sk#43)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>, PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk)], ReadSchema: struct<cd_demo_sk:int,cd_gender:string,cd_marital_status:string,cd_dep_count:int,cd_dep_employed_...
