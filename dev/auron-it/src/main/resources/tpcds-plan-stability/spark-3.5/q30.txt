== Physical Plan ==
AdaptiveSparkPlan (202)
+- == Final Plan ==
   NativeTakeOrdered (129)
   +- NativeProject (128)
      +- NativeSortMergeJoin Inner (127)
         :- NativeSort (117)
         :  +- InputAdapter (116)
         :     +- AQEShuffleRead (115)
         :        +- ShuffleQueryStage (114), Statistics(X)
         :           +- NativeShuffleExchange (113)
         :              +- NativeProject (112)
         :                 +- NativeSortMergeJoin Inner (111)
         :                    :- NativeSort (102)
         :                    :  +- InputAdapter (101)
         :                    :     +- AQEShuffleRead (100)
         :                    :        +- ShuffleQueryStage (99), Statistics(X)
         :                    :           +- NativeShuffleExchange (98)
         :                    :              +- ConvertToNative (97)
         :                    :                 +- * Project (96)
         :                    :                    +- * SortMergeJoin Inner (95)
         :                    :                       :- NativeSort (48)
         :                    :                       :  +- InputAdapter (47)
         :                    :                       :     +- AQEShuffleRead (46)
         :                    :                       :        +- ShuffleQueryStage (45), Statistics(X)
         :                    :                       :           +- NativeShuffleExchange (44)
         :                    :                       :              +- NativeFilter (43)
         :                    :                       :                 +- NativeProject (42)
         :                    :                       :                    +- NativeHashAggregate (41)
         :                    :                       :                       +- InputAdapter (40)
         :                    :                       :                          +- AQEShuffleRead (39)
         :                    :                       :                             +- ShuffleQueryStage (38), Statistics(X)
         :                    :                       :                                +- NativeShuffleExchange (37)
         :                    :                       :                                   +- NativeHashAggregate (36)
         :                    :                       :                                      +- NativeProject (35)
         :                    :                       :                                         +- NativeProject (34)
         :                    :                       :                                            +- NativeSortMergeJoin Inner (33)
         :                    :                       :                                               :- NativeSort (24)
         :                    :                       :                                               :  +- InputAdapter (23)
         :                    :                       :                                               :     +- AQEShuffleRead (22)
         :                    :                       :                                               :        +- ShuffleQueryStage (21), Statistics(X)
         :                    :                       :                                               :           +- NativeShuffleExchange (20)
         :                    :                       :                                               :              +- NativeProject (19)
         :                    :                       :                                               :                 +- NativeSortMergeJoin Inner (18)
         :                    :                       :                                               :                    :- NativeSort (8)
         :                    :                       :                                               :                    :  +- InputAdapter (7)
         :                    :                       :                                               :                    :     +- AQEShuffleRead (6)
         :                    :                       :                                               :                    :        +- ShuffleQueryStage (5), Statistics(X)
         :                    :                       :                                               :                    :           +- NativeShuffleExchange (4)
         :                    :                       :                                               :                    :              +- NativeFilter (3)
         :                    :                       :                                               :                    :                 +- InputAdapter (2)
         :                    :                       :                                               :                    :                    +- NativeParquetScan  (1)
         :                    :                       :                                               :                    +- NativeSort (17)
         :                    :                       :                                               :                       +- InputAdapter (16)
         :                    :                       :                                               :                          +- AQEShuffleRead (15)
         :                    :                       :                                               :                             +- ShuffleQueryStage (14), Statistics(X)
         :                    :                       :                                               :                                +- NativeShuffleExchange (13)
         :                    :                       :                                               :                                   +- NativeProject (12)
         :                    :                       :                                               :                                      +- NativeFilter (11)
         :                    :                       :                                               :                                         +- InputAdapter (10)
         :                    :                       :                                               :                                            +- NativeParquetScan  (9)
         :                    :                       :                                               +- NativeSort (32)
         :                    :                       :                                                  +- InputAdapter (31)
         :                    :                       :                                                     +- AQEShuffleRead (30)
         :                    :                       :                                                        +- ShuffleQueryStage (29), Statistics(X)
         :                    :                       :                                                           +- NativeShuffleExchange (28)
         :                    :                       :                                                              +- NativeFilter (27)
         :                    :                       :                                                                 +- InputAdapter (26)
         :                    :                       :                                                                    +- NativeParquetScan  (25)
         :                    :                       +- NativeSort (94)
         :                    :                          +- NativeFilter (93)
         :                    :                             +- NativeProject (92)
         :                    :                                +- NativeHashAggregate (91)
         :                    :                                   +- InputAdapter (90)
         :                    :                                      +- AQEShuffleRead (89)
         :                    :                                         +- ShuffleQueryStage (88), Statistics(X)
         :                    :                                            +- NativeShuffleExchange (87)
         :                    :                                               +- NativeHashAggregate (86)
         :                    :                                                  +- NativeProject (85)
         :                    :                                                     +- NativeHashAggregate (84)
         :                    :                                                        +- InputAdapter (83)
         :                    :                                                           +- AQEShuffleRead (82)
         :                    :                                                              +- ShuffleQueryStage (81), Statistics(X)
         :                    :                                                                 +- NativeShuffleExchange (80)
         :                    :                                                                    +- NativeHashAggregate (79)
         :                    :                                                                       +- NativeProject (78)
         :                    :                                                                          +- NativeProject (77)
         :                    :                                                                             +- NativeSortMergeJoin Inner (76)
         :                    :                                                                                :- NativeSort (69)
         :                    :                                                                                :  +- InputAdapter (68)
         :                    :                                                                                :     +- AQEShuffleRead (67)
         :                    :                                                                                :        +- ShuffleQueryStage (66), Statistics(X)
         :                    :                                                                                :           +- NativeShuffleExchange (65)
         :                    :                                                                                :              +- NativeProject (64)
         :                    :                                                                                :                 +- NativeSortMergeJoin Inner (63)
         :                    :                                                                                :                    :- NativeSort (56)
         :                    :                                                                                :                    :  +- InputAdapter (55)
         :                    :                                                                                :                    :     +- AQEShuffleRead (54)
         :                    :                                                                                :                    :        +- ShuffleQueryStage (53), Statistics(X)
         :                    :                                                                                :                    :           +- NativeShuffleExchange (52)
         :                    :                                                                                :                    :              +- NativeFilter (51)
         :                    :                                                                                :                    :                 +- InputAdapter (50)
         :                    :                                                                                :                    :                    +- NativeParquetScan  (49)
         :                    :                                                                                :                    +- NativeSort (62)
         :                    :                                                                                :                       +- InputAdapter (61)
         :                    :                                                                                :                          +- InputAdapter (60)
         :                    :                                                                                :                             +- AQEShuffleRead (59)
         :                    :                                                                                :                                +- ShuffleQueryStage (58), Statistics(X)
         :                    :                                                                                :                                   +- ReusedExchange (57)
         :                    :                                                                                +- NativeSort (75)
         :                    :                                                                                   +- InputAdapter (74)
         :                    :                                                                                      +- InputAdapter (73)
         :                    :                                                                                         +- AQEShuffleRead (72)
         :                    :                                                                                            +- ShuffleQueryStage (71), Statistics(X)
         :                    :                                                                                               +- ReusedExchange (70)
         :                    +- NativeSort (110)
         :                       +- InputAdapter (109)
         :                          +- AQEShuffleRead (108)
         :                             +- ShuffleQueryStage (107), Statistics(X)
         :                                +- NativeShuffleExchange (106)
         :                                   +- NativeFilter (105)
         :                                      +- InputAdapter (104)
         :                                         +- NativeParquetScan  (103)
         +- NativeSort (126)
            +- InputAdapter (125)
               +- AQEShuffleRead (124)
                  +- ShuffleQueryStage (123), Statistics(X)
                     +- NativeShuffleExchange (122)
                        +- NativeProject (121)
                           +- NativeFilter (120)
                              +- InputAdapter (119)
                                 +- NativeParquetScan  (118)
+- == Initial Plan ==
   TakeOrderedAndProject (201)
   +- Project (200)
      +- SortMergeJoin Inner (199)
         :- Sort (193)
         :  +- Exchange (192)
         :     +- Project (191)
         :        +- SortMergeJoin Inner (190)
         :           :- Sort (185)
         :           :  +- Exchange (184)
         :           :     +- Project (183)
         :           :        +- SortMergeJoin Inner (182)
         :           :           :- Sort (154)
         :           :           :  +- Exchange (153)
         :           :           :     +- Filter (152)
         :           :           :        +- HashAggregate (151)
         :           :           :           +- Exchange (150)
         :           :           :              +- HashAggregate (149)
         :           :           :                 +- Project (148)
         :           :           :                    +- SortMergeJoin Inner (147)
         :           :           :                       :- Sort (142)
         :           :           :                       :  +- Exchange (141)
         :           :           :                       :     +- Project (140)
         :           :           :                       :        +- SortMergeJoin Inner (139)
         :           :           :                       :           :- Sort (133)
         :           :           :                       :           :  +- Exchange (132)
         :           :           :                       :           :     +- Filter (131)
         :           :           :                       :           :        +- Scan parquet (130)
         :           :           :                       :           +- Sort (138)
         :           :           :                       :              +- Exchange (137)
         :           :           :                       :                 +- Project (136)
         :           :           :                       :                    +- Filter (135)
         :           :           :                       :                       +- Scan parquet (134)
         :           :           :                       +- Sort (146)
         :           :           :                          +- Exchange (145)
         :           :           :                             +- Filter (144)
         :           :           :                                +- Scan parquet (143)
         :           :           +- Sort (181)
         :           :              +- Filter (180)
         :           :                 +- HashAggregate (179)
         :           :                    +- Exchange (178)
         :           :                       +- HashAggregate (177)
         :           :                          +- HashAggregate (176)
         :           :                             +- Exchange (175)
         :           :                                +- HashAggregate (174)
         :           :                                   +- Project (173)
         :           :                                      +- SortMergeJoin Inner (172)
         :           :                                         :- Sort (167)
         :           :                                         :  +- Exchange (166)
         :           :                                         :     +- Project (165)
         :           :                                         :        +- SortMergeJoin Inner (164)
         :           :                                         :           :- Sort (158)
         :           :                                         :           :  +- Exchange (157)
         :           :                                         :           :     +- Filter (156)
         :           :                                         :           :        +- Scan parquet (155)
         :           :                                         :           +- Sort (163)
         :           :                                         :              +- Exchange (162)
         :           :                                         :                 +- Project (161)
         :           :                                         :                    +- Filter (160)
         :           :                                         :                       +- Scan parquet (159)
         :           :                                         +- Sort (171)
         :           :                                            +- Exchange (170)
         :           :                                               +- Filter (169)
         :           :                                                  +- Scan parquet (168)
         :           +- Sort (189)
         :              +- Exchange (188)
         :                 +- Filter (187)
         :                    +- Scan parquet (186)
         +- Sort (198)
            +- Exchange (197)
               +- Project (196)
                  +- Filter (195)
                     +- Scan parquet (194)


(130) Scan parquet
Output [4]: [wr_returned_date_sk#1, wr_returning_customer_sk#2, wr_returning_addr_sk#3, wr_return_amt#4]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(wr_returned_date_sk), IsNotNull(wr_returning_addr_sk), IsNotNull(wr_returning_customer_sk)]
ReadSchema: struct<wr_returned_date_sk:int,wr_returning_customer_sk:int,wr_returning_addr_sk:int,wr_return_amt:decimal(7,2)>

(2) InputAdapter
Input [4]: [wr_returned_date_sk#1, wr_returning_customer_sk#2, wr_returning_addr_sk#3, wr_return_amt#4]
Arguments: [#1, #2, #3, #4]

(3) NativeFilter
Input [4]: [#1#1, #2#2, #3#3, #4#4]
Condition : ((isnotnull(wr_returned_date_sk#1) AND isnotnull(wr_returning_addr_sk#3)) AND isnotnull(wr_returning_customer_sk#2))

(4) NativeShuffleExchange
Input [4]: [#1#1, #2#2, #3#3, #4#4]
Arguments: hashpartitioning(wr_returned_date_sk#1, 100), ENSURE_REQUIREMENTS, [plan_id=1]

(5) ShuffleQueryStage
Output [4]: [#1#1, #2#2, #3#3, #4#4]
Arguments: X

(6) AQEShuffleRead
Input [4]: [#1#1, #2#2, #3#3, #4#4]
Arguments: coalesced

(7) InputAdapter
Input [4]: [#1#1, #2#2, #3#3, #4#4]

(8) NativeSort
Input [4]: [#1#1, #2#2, #3#3, #4#4]
Arguments: [wr_returned_date_sk#1 ASC NULLS FIRST], false

(134) Scan parquet
Output [2]: [d_date_sk#5, d_year#6]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2002), IsNotNull(d_date_sk)]
ReadSchema: struct<d_date_sk:int,d_year:int>

(10) InputAdapter
Input [2]: [d_date_sk#5, d_year#6]
Arguments: [#5, #6]

(11) NativeFilter
Input [2]: [#5#5, #6#6]
Condition : ((isnotnull(d_year#6) AND (d_year#6 = 2002)) AND isnotnull(d_date_sk#5))

(12) NativeProject
Output [1]: [d_date_sk#5]
Input [2]: [#5#5, #6#6]

(13) NativeShuffleExchange
Input [1]: [d_date_sk#5]
Arguments: hashpartitioning(d_date_sk#5, 100), ENSURE_REQUIREMENTS, [plan_id=2]

(14) ShuffleQueryStage
Output [1]: [d_date_sk#5]
Arguments: X

(15) AQEShuffleRead
Input [1]: [d_date_sk#5]
Arguments: coalesced

(16) InputAdapter
Input [1]: [d_date_sk#5]

(17) NativeSort
Input [1]: [d_date_sk#5]
Arguments: [d_date_sk#5 ASC NULLS FIRST], false

(18) NativeSortMergeJoin
Left keys [1]: [wr_returned_date_sk#1]
Right keys [1]: [d_date_sk#5]
Join type: Inner
Join condition: None

(19) NativeProject
Output [3]: [wr_returning_customer_sk#2, wr_returning_addr_sk#3, wr_return_amt#4]
Input [5]: [#1#1, #2#2, #3#3, #4#4, d_date_sk#5]

(20) NativeShuffleExchange
Input [3]: [wr_returning_customer_sk#2, wr_returning_addr_sk#3, wr_return_amt#4]
Arguments: hashpartitioning(wr_returning_addr_sk#3, 100), ENSURE_REQUIREMENTS, [plan_id=3]

(21) ShuffleQueryStage
Output [3]: [wr_returning_customer_sk#2, wr_returning_addr_sk#3, wr_return_amt#4]
Arguments: X

(22) AQEShuffleRead
Input [3]: [wr_returning_customer_sk#2, wr_returning_addr_sk#3, wr_return_amt#4]
Arguments: coalesced

(23) InputAdapter
Input [3]: [wr_returning_customer_sk#2, wr_returning_addr_sk#3, wr_return_amt#4]

(24) NativeSort
Input [3]: [wr_returning_customer_sk#2, wr_returning_addr_sk#3, wr_return_amt#4]
Arguments: [wr_returning_addr_sk#3 ASC NULLS FIRST], false

(143) Scan parquet
Output [2]: [ca_address_sk#7, ca_state#8]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(ca_address_sk), IsNotNull(ca_state)]
ReadSchema: struct<ca_address_sk:int,ca_state:string>

(26) InputAdapter
Input [2]: [ca_address_sk#7, ca_state#8]
Arguments: [#7, #8]

(27) NativeFilter
Input [2]: [#7#7, #8#8]
Condition : (isnotnull(ca_address_sk#7) AND isnotnull(ca_state#8))

(28) NativeShuffleExchange
Input [2]: [#7#7, #8#8]
Arguments: hashpartitioning(ca_address_sk#7, 100), ENSURE_REQUIREMENTS, [plan_id=4]

(29) ShuffleQueryStage
Output [2]: [#7#7, #8#8]
Arguments: X

(30) AQEShuffleRead
Input [2]: [#7#7, #8#8]
Arguments: coalesced

(31) InputAdapter
Input [2]: [#7#7, #8#8]

(32) NativeSort
Input [2]: [#7#7, #8#8]
Arguments: [ca_address_sk#7 ASC NULLS FIRST], false

(33) NativeSortMergeJoin
Left keys [1]: [wr_returning_addr_sk#3]
Right keys [1]: [ca_address_sk#7]
Join type: Inner
Join condition: None

(34) NativeProject
Output [3]: [wr_returning_customer_sk#2, wr_return_amt#4, ca_state#8]
Input [5]: [wr_returning_customer_sk#2, wr_returning_addr_sk#3, wr_return_amt#4, #7#7, #8#8]

(35) NativeProject
Output [3]: [wr_returning_customer_sk#2 AS wr_returning_customer_sk#2, ca_state#8 AS ca_state#8, UnscaledValue(wr_return_amt#4) AS _c2#9]
Input [3]: [wr_returning_customer_sk#2, wr_return_amt#4, ca_state#8]

(36) NativeHashAggregate
Input [3]: [wr_returning_customer_sk#2, ca_state#8, _c2#9]
Keys [2]: [wr_returning_customer_sk#2, ca_state#8]
Functions [1]: [partial_sum(_c2#9)]
Aggregate Attributes [1]: [sum#10]
Results [3]: [wr_returning_customer_sk#2, ca_state#8, #11]

(37) NativeShuffleExchange
Input [3]: [wr_returning_customer_sk#2, ca_state#8, #11]
Arguments: hashpartitioning(wr_returning_customer_sk#2, ca_state#8, 100), ENSURE_REQUIREMENTS, [plan_id=5]

(38) ShuffleQueryStage
Output [3]: [wr_returning_customer_sk#2, ca_state#8, #11]
Arguments: X

(39) AQEShuffleRead
Input [3]: [wr_returning_customer_sk#2, ca_state#8, #11]
Arguments: coalesced

(40) InputAdapter
Input [3]: [wr_returning_customer_sk#2, ca_state#8, #11]

(41) NativeHashAggregate
Input [3]: [wr_returning_customer_sk#2, ca_state#8, #11]
Keys [2]: [wr_returning_customer_sk#2, ca_state#8]
Functions [1]: [sum(UnscaledValue(wr_return_amt#4))]
Aggregate Attributes [1]: [sum(UnscaledValue(wr_return_amt#4))#12]
Results [3]: [wr_returning_customer_sk#2, ca_state#8, sum(UnscaledValue(wr_return_amt#4))#12]

(42) NativeProject
Output [3]: [wr_returning_customer_sk#2 AS ctr_customer_sk#13, ca_state#8 AS ctr_state#14, MakeDecimal(sum(UnscaledValue(wr_return_amt#4))#12,17,2) AS ctr_total_return#15]
Input [3]: [wr_returning_customer_sk#2, ca_state#8, sum(UnscaledValue(wr_return_amt#4))#12]

(43) NativeFilter
Input [3]: [ctr_customer_sk#13, ctr_state#14, ctr_total_return#15]
Condition : isnotnull(ctr_total_return#15)

(44) NativeShuffleExchange
Input [3]: [ctr_customer_sk#13, ctr_state#14, ctr_total_return#15]
Arguments: hashpartitioning(ctr_state#14, 100), ENSURE_REQUIREMENTS, [plan_id=6]

(45) ShuffleQueryStage
Output [3]: [ctr_customer_sk#13, ctr_state#14, ctr_total_return#15]
Arguments: X

(46) AQEShuffleRead
Input [3]: [ctr_customer_sk#13, ctr_state#14, ctr_total_return#15]
Arguments: coalesced

(47) InputAdapter
Input [3]: [ctr_customer_sk#13, ctr_state#14, ctr_total_return#15]

(48) NativeSort
Input [3]: [ctr_customer_sk#13, ctr_state#14, ctr_total_return#15]
Arguments: [ctr_state#14 ASC NULLS FIRST], false

(155) Scan parquet
Output [4]: [wr_returned_date_sk#16, wr_returning_customer_sk#17, wr_returning_addr_sk#18, wr_return_amt#19]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(wr_returned_date_sk), IsNotNull(wr_returning_addr_sk)]
ReadSchema: struct<wr_returned_date_sk:int,wr_returning_customer_sk:int,wr_returning_addr_sk:int,wr_return_amt:decimal(7,2)>

(50) InputAdapter
Input [4]: [wr_returned_date_sk#16, wr_returning_customer_sk#17, wr_returning_addr_sk#18, wr_return_amt#19]
Arguments: [#16, #17, #18, #19]

(51) NativeFilter
Input [4]: [#16#16, #17#17, #18#18, #19#19]
Condition : (isnotnull(wr_returned_date_sk#16) AND isnotnull(wr_returning_addr_sk#18))

(52) NativeShuffleExchange
Input [4]: [#16#16, #17#17, #18#18, #19#19]
Arguments: hashpartitioning(wr_returned_date_sk#16, 100), ENSURE_REQUIREMENTS, [plan_id=7]

(53) ShuffleQueryStage
Output [4]: [#16#16, #17#17, #18#18, #19#19]
Arguments: X

(54) AQEShuffleRead
Input [4]: [#16#16, #17#17, #18#18, #19#19]
Arguments: coalesced

(55) InputAdapter
Input [4]: [#16#16, #17#17, #18#18, #19#19]

(56) NativeSort
Input [4]: [#16#16, #17#17, #18#18, #19#19]
Arguments: [wr_returned_date_sk#16 ASC NULLS FIRST], false

(57) ReusedExchange [Reuses operator id: 13]
Output [1]: [d_date_sk#20]

(58) ShuffleQueryStage
Output [1]: [d_date_sk#20]
Arguments: X

(59) AQEShuffleRead
Input [1]: [d_date_sk#20]
Arguments: coalesced

(60) InputAdapter
Input [1]: [d_date_sk#20]
Arguments: [#20]

(61) InputAdapter
Input [1]: [#20#20]

(62) NativeSort
Input [1]: [#20#20]
Arguments: [d_date_sk#20 ASC NULLS FIRST], false

(63) NativeSortMergeJoin
Left keys [1]: [wr_returned_date_sk#16]
Right keys [1]: [d_date_sk#20]
Join type: Inner
Join condition: None

(64) NativeProject
Output [3]: [wr_returning_customer_sk#17, wr_returning_addr_sk#18, wr_return_amt#19]
Input [5]: [#16#16, #17#17, #18#18, #19#19, #20#20]

(65) NativeShuffleExchange
Input [3]: [wr_returning_customer_sk#17, wr_returning_addr_sk#18, wr_return_amt#19]
Arguments: hashpartitioning(wr_returning_addr_sk#18, 100), ENSURE_REQUIREMENTS, [plan_id=8]

(66) ShuffleQueryStage
Output [3]: [wr_returning_customer_sk#17, wr_returning_addr_sk#18, wr_return_amt#19]
Arguments: X

(67) AQEShuffleRead
Input [3]: [wr_returning_customer_sk#17, wr_returning_addr_sk#18, wr_return_amt#19]
Arguments: coalesced

(68) InputAdapter
Input [3]: [wr_returning_customer_sk#17, wr_returning_addr_sk#18, wr_return_amt#19]

(69) NativeSort
Input [3]: [wr_returning_customer_sk#17, wr_returning_addr_sk#18, wr_return_amt#19]
Arguments: [wr_returning_addr_sk#18 ASC NULLS FIRST], false

(70) ReusedExchange [Reuses operator id: 28]
Output [2]: [ca_address_sk#21, ca_state#22]

(71) ShuffleQueryStage
Output [2]: [ca_address_sk#21, ca_state#22]
Arguments: X

(72) AQEShuffleRead
Input [2]: [ca_address_sk#21, ca_state#22]
Arguments: coalesced

(73) InputAdapter
Input [2]: [ca_address_sk#21, ca_state#22]
Arguments: [#21, #22]

(74) InputAdapter
Input [2]: [#21#21, #22#22]

(75) NativeSort
Input [2]: [#21#21, #22#22]
Arguments: [ca_address_sk#21 ASC NULLS FIRST], false

(76) NativeSortMergeJoin
Left keys [1]: [wr_returning_addr_sk#18]
Right keys [1]: [ca_address_sk#21]
Join type: Inner
Join condition: None

(77) NativeProject
Output [3]: [wr_returning_customer_sk#17, wr_return_amt#19, ca_state#22]
Input [5]: [wr_returning_customer_sk#17, wr_returning_addr_sk#18, wr_return_amt#19, #21#21, #22#22]

(78) NativeProject
Output [3]: [wr_returning_customer_sk#17 AS wr_returning_customer_sk#17, ca_state#22 AS ca_state#22, UnscaledValue(wr_return_amt#19) AS _c2#23]
Input [3]: [wr_returning_customer_sk#17, wr_return_amt#19, ca_state#22]

(79) NativeHashAggregate
Input [3]: [wr_returning_customer_sk#17, ca_state#22, _c2#23]
Keys [2]: [wr_returning_customer_sk#17, ca_state#22]
Functions [1]: [partial_sum(_c2#23)]
Aggregate Attributes [1]: [sum#24]
Results [3]: [wr_returning_customer_sk#17, ca_state#22, #11]

(80) NativeShuffleExchange
Input [3]: [wr_returning_customer_sk#17, ca_state#22, #11]
Arguments: hashpartitioning(wr_returning_customer_sk#17, ca_state#22, 100), ENSURE_REQUIREMENTS, [plan_id=9]

(81) ShuffleQueryStage
Output [3]: [wr_returning_customer_sk#17, ca_state#22, #11]
Arguments: X

(82) AQEShuffleRead
Input [3]: [wr_returning_customer_sk#17, ca_state#22, #11]
Arguments: coalesced

(83) InputAdapter
Input [3]: [wr_returning_customer_sk#17, ca_state#22, #11]

(84) NativeHashAggregate
Input [3]: [wr_returning_customer_sk#17, ca_state#22, #11]
Keys [2]: [wr_returning_customer_sk#17, ca_state#22]
Functions [1]: [sum(UnscaledValue(wr_return_amt#19))]
Aggregate Attributes [1]: [sum(UnscaledValue(wr_return_amt#19))#12]
Results [3]: [wr_returning_customer_sk#17, ca_state#22, sum(UnscaledValue(wr_return_amt#19))#12]

(85) NativeProject
Output [2]: [ca_state#22 AS ctr_state#25, MakeDecimal(sum(UnscaledValue(wr_return_amt#19))#12,17,2) AS ctr_total_return#26]
Input [3]: [wr_returning_customer_sk#17, ca_state#22, sum(UnscaledValue(wr_return_amt#19))#12]

(86) NativeHashAggregate
Input [2]: [ctr_state#25, ctr_total_return#26]
Keys [1]: [ctr_state#25]
Functions [1]: [partial_avg(ctr_total_return#26)]
Aggregate Attributes [2]: [sum#27, count#28]
Results [3]: [ctr_state#25, #29, #11]

(87) NativeShuffleExchange
Input [3]: [ctr_state#25, #29, #11]
Arguments: hashpartitioning(ctr_state#25, 100), ENSURE_REQUIREMENTS, [plan_id=10]

(88) ShuffleQueryStage
Output [3]: [ctr_state#25, #29, #11]
Arguments: X

(89) AQEShuffleRead
Input [3]: [ctr_state#25, #29, #11]
Arguments: coalesced

(90) InputAdapter
Input [3]: [ctr_state#25, #29, #11]

(91) NativeHashAggregate
Input [3]: [ctr_state#25, #29, #11]
Keys [1]: [ctr_state#25]
Functions [1]: [avg(ctr_total_return#26)]
Aggregate Attributes [1]: [avg(ctr_total_return#26)#30]
Results [2]: [ctr_state#25, avg(ctr_total_return#26)#30]

(92) NativeProject
Output [2]: [(avg(ctr_total_return#26)#30 * 1.2) AS (avg(ctr_total_return) * 1.2)#31, ctr_state#25]
Input [2]: [ctr_state#25, avg(ctr_total_return#26)#30]

(93) NativeFilter
Input [2]: [(avg(ctr_total_return) * 1.2)#31, ctr_state#25]
Condition : isnotnull((avg(ctr_total_return) * 1.2)#31)

(94) NativeSort
Input [2]: [(avg(ctr_total_return) * 1.2)#31, ctr_state#25]
Arguments: [ctr_state#25 ASC NULLS FIRST], false

(95) SortMergeJoin [codegen id : X]
Left keys [1]: [ctr_state#14]
Right keys [1]: [ctr_state#25]
Join type: Inner
Join condition: (cast(ctr_total_return#15 as decimal(24,7)) > (avg(ctr_total_return) * 1.2)#31)

(96) Project [codegen id : X]
Output [2]: [ctr_customer_sk#13, ctr_total_return#15]
Input [5]: [ctr_customer_sk#13, ctr_state#14, ctr_total_return#15, (avg(ctr_total_return) * 1.2)#31, ctr_state#25]

(97) ConvertToNative
Input [2]: [ctr_customer_sk#13, ctr_total_return#15]

(98) NativeShuffleExchange
Input [2]: [ctr_customer_sk#13, ctr_total_return#15]
Arguments: hashpartitioning(ctr_customer_sk#13, 100), ENSURE_REQUIREMENTS, [plan_id=11]

(99) ShuffleQueryStage
Output [2]: [ctr_customer_sk#13, ctr_total_return#15]
Arguments: X

(100) AQEShuffleRead
Input [2]: [ctr_customer_sk#13, ctr_total_return#15]
Arguments: coalesced

(101) InputAdapter
Input [2]: [ctr_customer_sk#13, ctr_total_return#15]

(102) NativeSort
Input [2]: [ctr_customer_sk#13, ctr_total_return#15]
Arguments: [ctr_customer_sk#13 ASC NULLS FIRST], false

(186) Scan parquet
Output [14]: [c_customer_sk#32, c_customer_id#33, c_current_addr_sk#34, c_salutation#35, c_first_name#36, c_last_name#37, c_preferred_cust_flag#38, c_birth_day#39, c_birth_month#40, c_birth_year#41, c_birth_country#42, c_login#43, c_email_address#44, c_last_review_date_sk#45]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_current_addr_sk)]
ReadSchema: struct<c_customer_sk:int,c_customer_id:string,c_current_addr_sk:int,c_salutation:string,c_first_name:string,c_last_name:string,c_preferred_cust_flag:string,c_birth_day:int,c_birth_month:int,c_birth_year:int,c_birth_country:string,c_login:string,c_email_address:string,c_last_review_date_sk:int>

(104) InputAdapter
Input [14]: [c_customer_sk#32, c_customer_id#33, c_current_addr_sk#34, c_salutation#35, c_first_name#36, c_last_name#37, c_preferred_cust_flag#38, c_birth_day#39, c_birth_month#40, c_birth_year#41, c_birth_country#42, c_login#43, c_email_address#44, c_last_review_date_sk#45]
Arguments: [#32, #33, #34, #35, #36, #37, #38, #39, #40, #41, #42, #43, #44, #45]

(105) NativeFilter
Input [14]: [#32#32, #33#33, #34#34, #35#35, #36#36, #37#37, #38#38, #39#39, #40#40, #41#41, #42#42, #43#43, #44#44, #45#45]
Condition : (isnotnull(c_customer_sk#32) AND isnotnull(c_current_addr_sk#34))

(106) NativeShuffleExchange
Input [14]: [#32#32, #33#33, #34#34, #35#35, #36#36, #37#37, #38#38, #39#39, #40#40, #41#41, #42#42, #43#43, #44#44, #45#45]
Arguments: hashpartitioning(c_customer_sk#32, 100), ENSURE_REQUIREMENTS, [plan_id=12]

(107) ShuffleQueryStage
Output [14]: [#32#32, #33#33, #34#34, #35#35, #36#36, #37#37, #38#38, #39#39, #40#40, #41#41, #42#42, #43#43, #44#44, #45#45]
Arguments: X

(108) AQEShuffleRead
Input [14]: [#32#32, #33#33, #34#34, #35#35, #36#36, #37#37, #38#38, #39#39, #40#40, #41#41, #42#42, #43#43, #44#44, #45#45]
Arguments: coalesced

(109) InputAdapter
Input [14]: [#32#32, #33#33, #34#34, #35#35, #36#36, #37#37, #38#38, #39#39, #40#40, #41#41, #42#42, #43#43, #44#44, #45#45]

(110) NativeSort
Input [14]: [#32#32, #33#33, #34#34, #35#35, #36#36, #37#37, #38#38, #39#39, #40#40, #41#41, #42#42, #43#43, #44#44, #45#45]
Arguments: [c_customer_sk#32 ASC NULLS FIRST], false

(111) NativeSortMergeJoin
Left keys [1]: [ctr_customer_sk#13]
Right keys [1]: [c_customer_sk#32]
Join type: Inner
Join condition: None

(112) NativeProject
Output [14]: [ctr_total_return#15, c_customer_id#33, c_current_addr_sk#34, c_salutation#35, c_first_name#36, c_last_name#37, c_preferred_cust_flag#38, c_birth_day#39, c_birth_month#40, c_birth_year#41, c_birth_country#42, c_login#43, c_email_address#44, c_last_review_date_sk#45]
Input [16]: [ctr_customer_sk#13, ctr_total_return#15, #32#32, #33#33, #34#34, #35#35, #36#36, #37#37, #38#38, #39#39, #40#40, #41#41, #42#42, #43#43, #44#44, #45#45]

(113) NativeShuffleExchange
Input [14]: [ctr_total_return#15, c_customer_id#33, c_current_addr_sk#34, c_salutation#35, c_first_name#36, c_last_name#37, c_preferred_cust_flag#38, c_birth_day#39, c_birth_month#40, c_birth_year#41, c_birth_country#42, c_login#43, c_email_address#44, c_last_review_date_sk#45]
Arguments: hashpartitioning(c_current_addr_sk#34, 100), ENSURE_REQUIREMENTS, [plan_id=13]

(114) ShuffleQueryStage
Output [14]: [ctr_total_return#15, c_customer_id#33, c_current_addr_sk#34, c_salutation#35, c_first_name#36, c_last_name#37, c_preferred_cust_flag#38, c_birth_day#39, c_birth_month#40, c_birth_year#41, c_birth_country#42, c_login#43, c_email_address#44, c_last_review_date_sk#45]
Arguments: X

(115) AQEShuffleRead
Input [14]: [ctr_total_return#15, c_customer_id#33, c_current_addr_sk#34, c_salutation#35, c_first_name#36, c_last_name#37, c_preferred_cust_flag#38, c_birth_day#39, c_birth_month#40, c_birth_year#41, c_birth_country#42, c_login#43, c_email_address#44, c_last_review_date_sk#45]
Arguments: coalesced

(116) InputAdapter
Input [14]: [ctr_total_return#15, c_customer_id#33, c_current_addr_sk#34, c_salutation#35, c_first_name#36, c_last_name#37, c_preferred_cust_flag#38, c_birth_day#39, c_birth_month#40, c_birth_year#41, c_birth_country#42, c_login#43, c_email_address#44, c_last_review_date_sk#45]

(117) NativeSort
Input [14]: [ctr_total_return#15, c_customer_id#33, c_current_addr_sk#34, c_salutation#35, c_first_name#36, c_last_name#37, c_preferred_cust_flag#38, c_birth_day#39, c_birth_month#40, c_birth_year#41, c_birth_country#42, c_login#43, c_email_address#44, c_last_review_date_sk#45]
Arguments: [c_current_addr_sk#34 ASC NULLS FIRST], false

(194) Scan parquet
Output [2]: [ca_address_sk#46, ca_state#47]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(ca_state), EqualTo(ca_state,GA), IsNotNull(ca_address_sk)]
ReadSchema: struct<ca_address_sk:int,ca_state:string>

(119) InputAdapter
Input [2]: [ca_address_sk#46, ca_state#47]
Arguments: [#46, #47]

(120) NativeFilter
Input [2]: [#46#46, #47#47]
Condition : ((isnotnull(ca_state#47) AND (ca_state#47 = GA)) AND isnotnull(ca_address_sk#46))

(121) NativeProject
Output [1]: [ca_address_sk#46]
Input [2]: [#46#46, #47#47]

(122) NativeShuffleExchange
Input [1]: [ca_address_sk#46]
Arguments: hashpartitioning(ca_address_sk#46, 100), ENSURE_REQUIREMENTS, [plan_id=14]

(123) ShuffleQueryStage
Output [1]: [ca_address_sk#46]
Arguments: X

(124) AQEShuffleRead
Input [1]: [ca_address_sk#46]
Arguments: coalesced

(125) InputAdapter
Input [1]: [ca_address_sk#46]

(126) NativeSort
Input [1]: [ca_address_sk#46]
Arguments: [ca_address_sk#46 ASC NULLS FIRST], false

(127) NativeSortMergeJoin
Left keys [1]: [c_current_addr_sk#34]
Right keys [1]: [ca_address_sk#46]
Join type: Inner
Join condition: None

(128) NativeProject
Output [13]: [c_customer_id#33, c_salutation#35, c_first_name#36, c_last_name#37, c_preferred_cust_flag#38, c_birth_day#39, c_birth_month#40, c_birth_year#41, c_birth_country#42, c_login#43, c_email_address#44, c_last_review_date_sk#45, ctr_total_return#15]
Input [15]: [ctr_total_return#15, c_customer_id#33, c_current_addr_sk#34, c_salutation#35, c_first_name#36, c_last_name#37, c_preferred_cust_flag#38, c_birth_day#39, c_birth_month#40, c_birth_year#41, c_birth_country#42, c_login#43, c_email_address#44, c_last_review_date_sk#45, ca_address_sk#46]

(129) NativeTakeOrdered
Input [13]: [c_customer_id#33, c_salutation#35, c_first_name#36, c_last_name#37, c_preferred_cust_flag#38, c_birth_day#39, c_birth_month#40, c_birth_year#41, c_birth_country#42, c_login#43, c_email_address#44, c_last_review_date_sk#45, ctr_total_return#15]
Arguments: X, X, [c_customer_id#33 ASC NULLS FIRST, c_salutation#35 ASC NULLS FIRST, c_first_name#36 ASC NULLS FIRST, c_last_name#37 ASC NULLS FIRST, c_preferred_cust_flag#38 ASC NULLS FIRST, c_birth_day#39 ASC NULLS FIRST, c_birth_month#40 ASC NULLS FIRST, c_birth_year#41 ASC NULLS FIRST, c_birth_country#42 ASC NULLS FIRST, c_login#43 ASC NULLS FIRST, c_email_address#44 ASC NULLS FIRST, c_last_review_date_sk#45 ASC NULLS FIRST, ctr_total_return#15 ASC NULLS FIRST]

(130) Scan parquet
Output [4]: [wr_returned_date_sk#1, wr_returning_customer_sk#2, wr_returning_addr_sk#3, wr_return_amt#4]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(wr_returned_date_sk), IsNotNull(wr_returning_addr_sk), IsNotNull(wr_returning_customer_sk)]
ReadSchema: struct<wr_returned_date_sk:int,wr_returning_customer_sk:int,wr_returning_addr_sk:int,wr_return_amt:decimal(7,2)>

(131) Filter
Input [4]: [wr_returned_date_sk#1, wr_returning_customer_sk#2, wr_returning_addr_sk#3, wr_return_amt#4]
Condition : ((isnotnull(wr_returned_date_sk#1) AND isnotnull(wr_returning_addr_sk#3)) AND isnotnull(wr_returning_customer_sk#2))

(132) Exchange
Input [4]: [wr_returned_date_sk#1, wr_returning_customer_sk#2, wr_returning_addr_sk#3, wr_return_amt#4]
Arguments: hashpartitioning(wr_returned_date_sk#1, 100), ENSURE_REQUIREMENTS, [plan_id=15]

(133) Sort
Input [4]: [wr_returned_date_sk#1, wr_returning_customer_sk#2, wr_returning_addr_sk#3, wr_return_amt#4]
Arguments: [wr_returned_date_sk#1 ASC NULLS FIRST], false, 0

(134) Scan parquet
Output [2]: [d_date_sk#5, d_year#6]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2002), IsNotNull(d_date_sk)]
ReadSchema: struct<d_date_sk:int,d_year:int>

(135) Filter
Input [2]: [d_date_sk#5, d_year#6]
Condition : ((isnotnull(d_year#6) AND (d_year#6 = 2002)) AND isnotnull(d_date_sk#5))

(136) Project
Output [1]: [d_date_sk#5]
Input [2]: [d_date_sk#5, d_year#6]

(137) Exchange
Input [1]: [d_date_sk#5]
Arguments: hashpartitioning(d_date_sk#5, 100), ENSURE_REQUIREMENTS, [plan_id=16]

(138) Sort
Input [1]: [d_date_sk#5]
Arguments: [d_date_sk#5 ASC NULLS FIRST], false, 0

(139) SortMergeJoin
Left keys [1]: [wr_returned_date_sk#1]
Right keys [1]: [d_date_sk#5]
Join type: Inner
Join condition: None

(140) Project
Output [3]: [wr_returning_customer_sk#2, wr_returning_addr_sk#3, wr_return_amt#4]
Input [5]: [wr_returned_date_sk#1, wr_returning_customer_sk#2, wr_returning_addr_sk#3, wr_return_amt#4, d_date_sk#5]

(141) Exchange
Input [3]: [wr_returning_customer_sk#2, wr_returning_addr_sk#3, wr_return_amt#4]
Arguments: hashpartitioning(wr_returning_addr_sk#3, 100), ENSURE_REQUIREMENTS, [plan_id=17]

(142) Sort
Input [3]: [wr_returning_customer_sk#2, wr_returning_addr_sk#3, wr_return_amt#4]
Arguments: [wr_returning_addr_sk#3 ASC NULLS FIRST], false, 0

(143) Scan parquet
Output [2]: [ca_address_sk#7, ca_state#8]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(ca_address_sk), IsNotNull(ca_state)]
ReadSchema: struct<ca_address_sk:int,ca_state:string>

(144) Filter
Input [2]: [ca_address_sk#7, ca_state#8]
Condition : (isnotnull(ca_address_sk#7) AND isnotnull(ca_state#8))

(145) Exchange
Input [2]: [ca_address_sk#7, ca_state#8]
Arguments: hashpartitioning(ca_address_sk#7, 100), ENSURE_REQUIREMENTS, [plan_id=18]

(146) Sort
Input [2]: [ca_address_sk#7, ca_state#8]
Arguments: [ca_address_sk#7 ASC NULLS FIRST], false, 0

(147) SortMergeJoin
Left keys [1]: [wr_returning_addr_sk#3]
Right keys [1]: [ca_address_sk#7]
Join type: Inner
Join condition: None

(148) Project
Output [3]: [wr_returning_customer_sk#2, wr_return_amt#4, ca_state#8]
Input [5]: [wr_returning_customer_sk#2, wr_returning_addr_sk#3, wr_return_amt#4, ca_address_sk#7, ca_state#8]

(149) HashAggregate
Input [3]: [wr_returning_customer_sk#2, wr_return_amt#4, ca_state#8]
Keys [2]: [wr_returning_customer_sk#2, ca_state#8]
Functions [1]: [partial_sum(UnscaledValue(wr_return_amt#4))]
Aggregate Attributes [1]: [sum#10]
Results [3]: [wr_returning_customer_sk#2, ca_state#8, sum#48]

(150) Exchange
Input [3]: [wr_returning_customer_sk#2, ca_state#8, sum#48]
Arguments: hashpartitioning(wr_returning_customer_sk#2, ca_state#8, 100), ENSURE_REQUIREMENTS, [plan_id=19]

(151) HashAggregate
Input [3]: [wr_returning_customer_sk#2, ca_state#8, sum#48]
Keys [2]: [wr_returning_customer_sk#2, ca_state#8]
Functions [1]: [sum(UnscaledValue(wr_return_amt#4))]
Aggregate Attributes [1]: [sum(UnscaledValue(wr_return_amt#4))#12]
Results [3]: [wr_returning_customer_sk#2 AS ctr_customer_sk#13, ca_state#8 AS ctr_state#14, MakeDecimal(sum(UnscaledValue(wr_return_amt#4))#12,17,2) AS ctr_total_return#15]

(152) Filter
Input [3]: [ctr_customer_sk#13, ctr_state#14, ctr_total_return#15]
Condition : isnotnull(ctr_total_return#15)

(153) Exchange
Input [3]: [ctr_customer_sk#13, ctr_state#14, ctr_total_return#15]
Arguments: hashpartitioning(ctr_state#14, 100), ENSURE_REQUIREMENTS, [plan_id=20]

(154) Sort
Input [3]: [ctr_customer_sk#13, ctr_state#14, ctr_total_return#15]
Arguments: [ctr_state#14 ASC NULLS FIRST], false, 0

(155) Scan parquet
Output [4]: [wr_returned_date_sk#16, wr_returning_customer_sk#17, wr_returning_addr_sk#18, wr_return_amt#19]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(wr_returned_date_sk), IsNotNull(wr_returning_addr_sk)]
ReadSchema: struct<wr_returned_date_sk:int,wr_returning_customer_sk:int,wr_returning_addr_sk:int,wr_return_amt:decimal(7,2)>

(156) Filter
Input [4]: [wr_returned_date_sk#16, wr_returning_customer_sk#17, wr_returning_addr_sk#18, wr_return_amt#19]
Condition : (isnotnull(wr_returned_date_sk#16) AND isnotnull(wr_returning_addr_sk#18))

(157) Exchange
Input [4]: [wr_returned_date_sk#16, wr_returning_customer_sk#17, wr_returning_addr_sk#18, wr_return_amt#19]
Arguments: hashpartitioning(wr_returned_date_sk#16, 100), ENSURE_REQUIREMENTS, [plan_id=21]

(158) Sort
Input [4]: [wr_returned_date_sk#16, wr_returning_customer_sk#17, wr_returning_addr_sk#18, wr_return_amt#19]
Arguments: [wr_returned_date_sk#16 ASC NULLS FIRST], false, 0

(159) Scan parquet
Output [2]: [d_date_sk#20, d_year#49]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2002), IsNotNull(d_date_sk)]
ReadSchema: struct<d_date_sk:int,d_year:int>

(160) Filter
Input [2]: [d_date_sk#20, d_year#49]
Condition : ((isnotnull(d_year#49) AND (d_year#49 = 2002)) AND isnotnull(d_date_sk#20))

(161) Project
Output [1]: [d_date_sk#20]
Input [2]: [d_date_sk#20, d_year#49]

(162) Exchange
Input [1]: [d_date_sk#20]
Arguments: hashpartitioning(d_date_sk#20, 100), ENSURE_REQUIREMENTS, [plan_id=22]

(163) Sort
Input [1]: [d_date_sk#20]
Arguments: [d_date_sk#20 ASC NULLS FIRST], false, 0

(164) SortMergeJoin
Left keys [1]: [wr_returned_date_sk#16]
Right keys [1]: [d_date_sk#20]
Join type: Inner
Join condition: None

(165) Project
Output [3]: [wr_returning_customer_sk#17, wr_returning_addr_sk#18, wr_return_amt#19]
Input [5]: [wr_returned_date_sk#16, wr_returning_customer_sk#17, wr_returning_addr_sk#18, wr_return_amt#19, d_date_sk#20]

(166) Exchange
Input [3]: [wr_returning_customer_sk#17, wr_returning_addr_sk#18, wr_return_amt#19]
Arguments: hashpartitioning(wr_returning_addr_sk#18, 100), ENSURE_REQUIREMENTS, [plan_id=23]

(167) Sort
Input [3]: [wr_returning_customer_sk#17, wr_returning_addr_sk#18, wr_return_amt#19]
Arguments: [wr_returning_addr_sk#18 ASC NULLS FIRST], false, 0

(168) Scan parquet
Output [2]: [ca_address_sk#21, ca_state#22]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(ca_address_sk), IsNotNull(ca_state)]
ReadSchema: struct<ca_address_sk:int,ca_state:string>

(169) Filter
Input [2]: [ca_address_sk#21, ca_state#22]
Condition : (isnotnull(ca_address_sk#21) AND isnotnull(ca_state#22))

(170) Exchange
Input [2]: [ca_address_sk#21, ca_state#22]
Arguments: hashpartitioning(ca_address_sk#21, 100), ENSURE_REQUIREMENTS, [plan_id=24]

(171) Sort
Input [2]: [ca_address_sk#21, ca_state#22]
Arguments: [ca_address_sk#21 ASC NULLS FIRST], false, 0

(172) SortMergeJoin
Left keys [1]: [wr_returning_addr_sk#18]
Right keys [1]: [ca_address_sk#21]
Join type: Inner
Join condition: None

(173) Project
Output [3]: [wr_returning_customer_sk#17, wr_return_amt#19, ca_state#22]
Input [5]: [wr_returning_customer_sk#17, wr_returning_addr_sk#18, wr_return_amt#19, ca_address_sk#21, ca_state#22]

(174) HashAggregate
Input [3]: [wr_returning_customer_sk#17, wr_return_amt#19, ca_state#22]
Keys [2]: [wr_returning_customer_sk#17, ca_state#22]
Functions [1]: [partial_sum(UnscaledValue(wr_return_amt#19))]
Aggregate Attributes [1]: [sum#24]
Results [3]: [wr_returning_customer_sk#17, ca_state#22, sum#50]

(175) Exchange
Input [3]: [wr_returning_customer_sk#17, ca_state#22, sum#50]
Arguments: hashpartitioning(wr_returning_customer_sk#17, ca_state#22, 100), ENSURE_REQUIREMENTS, [plan_id=25]

(176) HashAggregate
Input [3]: [wr_returning_customer_sk#17, ca_state#22, sum#50]
Keys [2]: [wr_returning_customer_sk#17, ca_state#22]
Functions [1]: [sum(UnscaledValue(wr_return_amt#19))]
Aggregate Attributes [1]: [sum(UnscaledValue(wr_return_amt#19))#12]
Results [2]: [ca_state#22 AS ctr_state#25, MakeDecimal(sum(UnscaledValue(wr_return_amt#19))#12,17,2) AS ctr_total_return#26]

(177) HashAggregate
Input [2]: [ctr_state#25, ctr_total_return#26]
Keys [1]: [ctr_state#25]
Functions [1]: [partial_avg(ctr_total_return#26)]
Aggregate Attributes [2]: [sum#27, count#28]
Results [3]: [ctr_state#25, sum#51, count#52]

(178) Exchange
Input [3]: [ctr_state#25, sum#51, count#52]
Arguments: hashpartitioning(ctr_state#25, 100), ENSURE_REQUIREMENTS, [plan_id=26]

(179) HashAggregate
Input [3]: [ctr_state#25, sum#51, count#52]
Keys [1]: [ctr_state#25]
Functions [1]: [avg(ctr_total_return#26)]
Aggregate Attributes [1]: [avg(ctr_total_return#26)#30]
Results [2]: [(avg(ctr_total_return#26)#30 * 1.2) AS (avg(ctr_total_return) * 1.2)#31, ctr_state#25]

(180) Filter
Input [2]: [(avg(ctr_total_return) * 1.2)#31, ctr_state#25]
Condition : isnotnull((avg(ctr_total_return) * 1.2)#31)

(181) Sort
Input [2]: [(avg(ctr_total_return) * 1.2)#31, ctr_state#25]
Arguments: [ctr_state#25 ASC NULLS FIRST], false, 0

(182) SortMergeJoin
Left keys [1]: [ctr_state#14]
Right keys [1]: [ctr_state#25]
Join type: Inner
Join condition: (cast(ctr_total_return#15 as decimal(24,7)) > (avg(ctr_total_return) * 1.2)#31)

(183) Project
Output [2]: [ctr_customer_sk#13, ctr_total_return#15]
Input [5]: [ctr_customer_sk#13, ctr_state#14, ctr_total_return#15, (avg(ctr_total_return) * 1.2)#31, ctr_state#25]

(184) Exchange
Input [2]: [ctr_customer_sk#13, ctr_total_return#15]
Arguments: hashpartitioning(ctr_customer_sk#13, 100), ENSURE_REQUIREMENTS, [plan_id=27]

(185) Sort
Input [2]: [ctr_customer_sk#13, ctr_total_return#15]
Arguments: [ctr_customer_sk#13 ASC NULLS FIRST], false, 0

(186) Scan parquet
Output [14]: [c_customer_sk#32, c_customer_id#33, c_current_addr_sk#34, c_salutation#35, c_first_name#36, c_last_name#37, c_preferred_cust_flag#38, c_birth_day#39, c_birth_month#40, c_birth_year#41, c_birth_country#42, c_login#43, c_email_address#44, c_last_review_date_sk#45]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_current_addr_sk)]
ReadSchema: struct<c_customer_sk:int,c_customer_id:string,c_current_addr_sk:int,c_salutation:string,c_first_name:string,c_last_name:string,c_preferred_cust_flag:string,c_birth_day:int,c_birth_month:int,c_birth_year:int,c_birth_country:string,c_login:string,c_email_address:string,c_last_review_date_sk:int>

(187) Filter
Input [14]: [c_customer_sk#32, c_customer_id#33, c_current_addr_sk#34, c_salutation#35, c_first_name#36, c_last_name#37, c_preferred_cust_flag#38, c_birth_day#39, c_birth_month#40, c_birth_year#41, c_birth_country#42, c_login#43, c_email_address#44, c_last_review_date_sk#45]
Condition : (isnotnull(c_customer_sk#32) AND isnotnull(c_current_addr_sk#34))

(188) Exchange
Input [14]: [c_customer_sk#32, c_customer_id#33, c_current_addr_sk#34, c_salutation#35, c_first_name#36, c_last_name#37, c_preferred_cust_flag#38, c_birth_day#39, c_birth_month#40, c_birth_year#41, c_birth_country#42, c_login#43, c_email_address#44, c_last_review_date_sk#45]
Arguments: hashpartitioning(c_customer_sk#32, 100), ENSURE_REQUIREMENTS, [plan_id=28]

(189) Sort
Input [14]: [c_customer_sk#32, c_customer_id#33, c_current_addr_sk#34, c_salutation#35, c_first_name#36, c_last_name#37, c_preferred_cust_flag#38, c_birth_day#39, c_birth_month#40, c_birth_year#41, c_birth_country#42, c_login#43, c_email_address#44, c_last_review_date_sk#45]
Arguments: [c_customer_sk#32 ASC NULLS FIRST], false, 0

(190) SortMergeJoin
Left keys [1]: [ctr_customer_sk#13]
Right keys [1]: [c_customer_sk#32]
Join type: Inner
Join condition: None

(191) Project
Output [14]: [ctr_total_return#15, c_customer_id#33, c_current_addr_sk#34, c_salutation#35, c_first_name#36, c_last_name#37, c_preferred_cust_flag#38, c_birth_day#39, c_birth_month#40, c_birth_year#41, c_birth_country#42, c_login#43, c_email_address#44, c_last_review_date_sk#45]
Input [16]: [ctr_customer_sk#13, ctr_total_return#15, c_customer_sk#32, c_customer_id#33, c_current_addr_sk#34, c_salutation#35, c_first_name#36, c_last_name#37, c_preferred_cust_flag#38, c_birth_day#39, c_birth_month#40, c_birth_year#41, c_birth_country#42, c_login#43, c_email_address#44, c_last_review_date_sk#45]

(192) Exchange
Input [14]: [ctr_total_return#15, c_customer_id#33, c_current_addr_sk#34, c_salutation#35, c_first_name#36, c_last_name#37, c_preferred_cust_flag#38, c_birth_day#39, c_birth_month#40, c_birth_year#41, c_birth_country#42, c_login#43, c_email_address#44, c_last_review_date_sk#45]
Arguments: hashpartitioning(c_current_addr_sk#34, 100), ENSURE_REQUIREMENTS, [plan_id=29]

(193) Sort
Input [14]: [ctr_total_return#15, c_customer_id#33, c_current_addr_sk#34, c_salutation#35, c_first_name#36, c_last_name#37, c_preferred_cust_flag#38, c_birth_day#39, c_birth_month#40, c_birth_year#41, c_birth_country#42, c_login#43, c_email_address#44, c_last_review_date_sk#45]
Arguments: [c_current_addr_sk#34 ASC NULLS FIRST], false, 0

(194) Scan parquet
Output [2]: [ca_address_sk#46, ca_state#47]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(ca_state), EqualTo(ca_state,GA), IsNotNull(ca_address_sk)]
ReadSchema: struct<ca_address_sk:int,ca_state:string>

(195) Filter
Input [2]: [ca_address_sk#46, ca_state#47]
Condition : ((isnotnull(ca_state#47) AND (ca_state#47 = GA)) AND isnotnull(ca_address_sk#46))

(196) Project
Output [1]: [ca_address_sk#46]
Input [2]: [ca_address_sk#46, ca_state#47]

(197) Exchange
Input [1]: [ca_address_sk#46]
Arguments: hashpartitioning(ca_address_sk#46, 100), ENSURE_REQUIREMENTS, [plan_id=30]

(198) Sort
Input [1]: [ca_address_sk#46]
Arguments: [ca_address_sk#46 ASC NULLS FIRST], false, 0

(199) SortMergeJoin
Left keys [1]: [c_current_addr_sk#34]
Right keys [1]: [ca_address_sk#46]
Join type: Inner
Join condition: None

(200) Project
Output [13]: [c_customer_id#33, c_salutation#35, c_first_name#36, c_last_name#37, c_preferred_cust_flag#38, c_birth_day#39, c_birth_month#40, c_birth_year#41, c_birth_country#42, c_login#43, c_email_address#44, c_last_review_date_sk#45, ctr_total_return#15]
Input [15]: [ctr_total_return#15, c_customer_id#33, c_current_addr_sk#34, c_salutation#35, c_first_name#36, c_last_name#37, c_preferred_cust_flag#38, c_birth_day#39, c_birth_month#40, c_birth_year#41, c_birth_country#42, c_login#43, c_email_address#44, c_last_review_date_sk#45, ca_address_sk#46]

(201) TakeOrderedAndProject
Input [13]: [c_customer_id#33, c_salutation#35, c_first_name#36, c_last_name#37, c_preferred_cust_flag#38, c_birth_day#39, c_birth_month#40, c_birth_year#41, c_birth_country#42, c_login#43, c_email_address#44, c_last_review_date_sk#45, ctr_total_return#15]
Arguments: X, [c_customer_id#33 ASC NULLS FIRST, c_salutation#35 ASC NULLS FIRST, c_first_name#36 ASC NULLS FIRST, c_last_name#37 ASC NULLS FIRST, c_preferred_cust_flag#38 ASC NULLS FIRST, c_birth_day#39 ASC NULLS FIRST, c_birth_month#40 ASC NULLS FIRST, c_birth_year#41 ASC NULLS FIRST, c_birth_country#42 ASC NULLS FIRST, c_login#43 ASC NULLS FIRST, c_email_address#44 ASC NULLS FIRST, c_last_review_date_sk#45 ASC NULLS FIRST, ctr_total_return#15 ASC NULLS FIRST], [c_customer_id#33, c_salutation#35, c_first_name#36, c_last_name#37, c_preferred_cust_flag#38, c_birth_day#39, c_birth_month#40, c_birth_year#41, c_birth_country#42, c_login#43, c_email_address#44, c_last_review_date_sk#45, ctr_total_return#15]

(202) AdaptiveSparkPlan
Output [13]: [c_customer_id#33, c_salutation#35, c_first_name#36, c_last_name#37, c_preferred_cust_flag#38, c_birth_day#39, c_birth_month#40, c_birth_year#41, c_birth_country#42, c_login#43, c_email_address#44, c_last_review_date_sk#45, ctr_total_return#15]
Arguments: isFinalPlan=true

