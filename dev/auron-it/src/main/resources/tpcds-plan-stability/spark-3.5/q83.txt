AdaptiveSparkPlan isFinalPlan=true
+- == Final Plan ==
   NativeTakeOrdered 100, [item_id#1 ASC NULLS FIRST, sr_item_qty#2 ASC NULLS FIRST]
   +- NativeProject [item_id#1, sr_item_qty#2, (((cast(sr_item_qty#2 as double) / cast(((sr_item_qty#2 + cr_item_qty#3) + wr_item_qty#4) as double)) / 3.0) * 100.0) AS sr_dev#5, cr_item_qty#3, (((cast(cr_item_qty#3 as double) / cast(((sr_item_qty#2 + cr_item_qty#3) + wr_item_qty#4) as double)) / 3.0) * 100.0) AS cr_dev#6, wr_item_qty#4, (((cast(wr_item_qty#4 as double) / cast(((sr_item_qty#2 + cr_item_qty#3) + wr_item_qty#4) as double)) / 3.0) * 100.0) AS wr_dev#7, (cast(((sr_item_qty#2 + cr_item_qty#3) + wr_item_qty#4) as decimal(20,0)) / 3.0) AS average#8]
      +- NativeSortMergeJoin [item_id#1], [item_id#9], Inner
         :- NativeProject [item_id#1, sr_item_qty#2, cr_item_qty#3]
         :  +- NativeSortMergeJoin [item_id#1], [item_id#10], Inner
         :     :- NativeSort [item_id#1 ASC NULLS FIRST], false
         :     :  +- NativeProject [i_item_id#11 AS item_id#1, sum(sr_return_quantity#12)#13 AS sr_item_qty#2]
         :     :     +- NativeHashAggregate HashAgg, ArrayBuffer(i_item_id#11), [i_item_id#11], [sum(sr_return_quantity#12)], [sum(sr_return_quantity#12)#13], 1
         :     :        +- InputAdapter
         :     :           +- AQEShuffleRead coalesced
         :     :              +- ShuffleQueryStage 36
         :     :                 +- NativeShuffleExchange hashpartitioning(i_item_id#11, 100), ENSURE_REQUIREMENTS, [plan_id=1]
         :     :                    +- NativeHashAggregate HashAgg, [i_item_id#11], [partial_sum(sr_return_quantity#12)], [sum#14], 0
         :     :                       +- NativeProject [sr_return_quantity#12, i_item_id#11]
         :     :                          +- NativeSortMergeJoin [sr_returned_date_sk#15], [d_date_sk#16], Inner
         :     :                             :- NativeSort [sr_returned_date_sk#15 ASC NULLS FIRST], false
         :     :                             :  +- InputAdapter
         :     :                             :     +- AQEShuffleRead coalesced
         :     :                             :        +- ShuffleQueryStage 23
         :     :                             :           +- NativeShuffleExchange hashpartitioning(sr_returned_date_sk#15, 100), ENSURE_REQUIREMENTS, [plan_id=2]
         :     :                             :              +- NativeProject [sr_returned_date_sk#15, sr_return_quantity#12, i_item_id#11]
         :     :                             :                 +- NativeSortMergeJoin [sr_item_sk#17], [i_item_sk#18], Inner
         :     :                             :                    :- NativeSort [sr_item_sk#17 ASC NULLS FIRST], false
         :     :                             :                    :  +- InputAdapter
         :     :                             :                    :     +- AQEShuffleRead coalesced
         :     :                             :                    :        +- ShuffleQueryStage 0
         :     :                             :                    :           +- NativeShuffleExchange hashpartitioning(sr_item_sk#17, 100), ENSURE_REQUIREMENTS, [plan_id=3]
         :     :                             :                    :              +- NativeFilter (isnotnull(sr_item_sk#17) AND isnotnull(sr_returned_date_sk#15))
         :     :                             :                    :                 +- InputAdapter [#15, #17, #12]
         :     :                             :                    :                    +- NativeParquetScan  (FileScan parquet [sr_returned_date_sk#15,sr_item_sk#17,sr_return_quantity#12] Batched: true, DataFilters: [isnotnull(sr_item_sk#17), isnotnull(sr_returned_date_sk#15)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(sr_item_sk), IsNotNull(sr_returned_date_sk)], ReadSchema: struct<sr_returned_date_sk:int,sr_item_sk:int,sr_return_quantity:int>)
         :     :                             :                    +- NativeSort [i_item_sk#18 ASC NULLS FIRST], false
         :     :                             :                       +- InputAdapter
         :     :                             :                          +- AQEShuffleRead coalesced
         :     :                             :                             +- ShuffleQueryStage 1
         :     :                             :                                +- NativeShuffleExchange hashpartitioning(i_item_sk#18, 100), ENSURE_REQUIREMENTS, [plan_id=4]
         :     :                             :                                   +- NativeFilter (isnotnull(i_item_sk#18) AND isnotnull(i_item_id#11))
         :     :                             :                                      +- InputAdapter [#18, #11]
         :     :                             :                                         +- NativeParquetScan  (FileScan parquet [i_item_sk#18,i_item_id#11] Batched: true, DataFilters: [isnotnull(i_item_sk#18), isnotnull(i_item_id#11)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_item_id)], ReadSchema: struct<i_item_sk:int,i_item_id:string>)
         :     :                             +- NativeSort [d_date_sk#16 ASC NULLS FIRST], false
         :     :                                +- InputAdapter
         :     :                                   +- AQEShuffleRead coalesced
         :     :                                      +- ShuffleQueryStage 31
         :     :                                         +- NativeShuffleExchange hashpartitioning(d_date_sk#16, 100), ENSURE_REQUIREMENTS, [plan_id=5]
         :     :                                            +- NativeProject [d_date_sk#16]
         :     :                                               +- NativeSortMergeJoin [d_date#19], [d_date#20], LeftSemi
         :     :                                                  :- NativeSort [d_date#19 ASC NULLS FIRST], false
         :     :                                                  :  +- InputAdapter
         :     :                                                  :     +- AQEShuffleRead coalesced
         :     :                                                  :        +- ShuffleQueryStage 2
         :     :                                                  :           +- NativeShuffleExchange hashpartitioning(d_date#19, 100), ENSURE_REQUIREMENTS, [plan_id=6]
         :     :                                                  :              +- NativeFilter isnotnull(d_date_sk#16)
         :     :                                                  :                 +- InputAdapter [#16, #19]
         :     :                                                  :                    +- NativeParquetScan  (FileScan parquet [d_date_sk#16,d_date#19] Batched: true, DataFilters: [isnotnull(d_date_sk#16)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_date:date>)
         :     :                                                  +- NativeSort [d_date#20 ASC NULLS FIRST], false
         :     :                                                     +- InputAdapter
         :     :                                                        +- AQEShuffleRead coalesced
         :     :                                                           +- ShuffleQueryStage 26
         :     :                                                              +- NativeShuffleExchange hashpartitioning(d_date#20, 100), ENSURE_REQUIREMENTS, [plan_id=7]
         :     :                                                                 +- NativeProject [d_date#20]
         :     :                                                                    +- NativeSortMergeJoin [d_week_seq#21], [d_week_seq#22], LeftSemi
         :     :                                                                       :- NativeSort [d_week_seq#21 ASC NULLS FIRST], false
         :     :                                                                       :  +- InputAdapter
         :     :                                                                       :     +- AQEShuffleRead coalesced
         :     :                                                                       :        +- ShuffleQueryStage 3
         :     :                                                                       :           +- NativeShuffleExchange hashpartitioning(d_week_seq#21, 100), ENSURE_REQUIREMENTS, [plan_id=8]
         :     :                                                                       :              +- InputAdapter [#20, #21]
         :     :                                                                       :                 +- NativeParquetScan  (FileScan parquet [d_date#20,d_week_seq#21] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<d_date:date,d_week_seq:int>)
         :     :                                                                       +- NativeSort [d_week_seq#22 ASC NULLS FIRST], false
         :     :                                                                          +- InputAdapter
         :     :                                                                             +- AQEShuffleRead coalesced
         :     :                                                                                +- ShuffleQueryStage 4
         :     :                                                                                   +- NativeShuffleExchange hashpartitioning(d_week_seq#22, 100), ENSURE_REQUIREMENTS, [plan_id=9]
         :     :                                                                                      +- NativeProject [d_week_seq#22]
         :     :                                                                                         +- NativeFilter cast(d_date#23 as string) IN (2000-06-30,2000-09-27,2000-11-17)
         :     :                                                                                            +- InputAdapter [#23, #22]
         :     :                                                                                               +- NativeParquetScan  (FileScan parquet [d_date#23,d_week_seq#22] Batched: true, DataFilters: [cast(d_date#23 as string) IN (2000-06-30,2000-09-27,2000-11-17)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<d_date:date,d_week_seq:int>)
         :     +- NativeSort [item_id#10 ASC NULLS FIRST], false
         :        +- NativeProject [i_item_id#24 AS item_id#10, sum(cr_return_quantity#25)#26 AS cr_item_qty#3]
         :           +- NativeHashAggregate HashAgg, ArrayBuffer(i_item_id#24), [i_item_id#24], [sum(cr_return_quantity#25)], [sum(cr_return_quantity#25)#26], 1
         :              +- InputAdapter
         :                 +- AQEShuffleRead coalesced
         :                    +- ShuffleQueryStage 37
         :                       +- NativeShuffleExchange hashpartitioning(i_item_id#24, 100), ENSURE_REQUIREMENTS, [plan_id=10]
         :                          +- NativeHashAggregate HashAgg, [i_item_id#24], [partial_sum(cr_return_quantity#25)], [sum#27], 0
         :                             +- NativeProject [cr_return_quantity#25, i_item_id#24]
         :                                +- NativeSortMergeJoin [cr_returned_date_sk#28], [d_date_sk#29], Inner
         :                                   :- NativeSort [cr_returned_date_sk#28 ASC NULLS FIRST], false
         :                                   :  +- InputAdapter
         :                                   :     +- AQEShuffleRead coalesced
         :                                   :        +- ShuffleQueryStage 24
         :                                   :           +- NativeShuffleExchange hashpartitioning(cr_returned_date_sk#28, 100), ENSURE_REQUIREMENTS, [plan_id=11]
         :                                   :              +- NativeProject [cr_returned_date_sk#28, cr_return_quantity#25, i_item_id#24]
         :                                   :                 +- NativeSortMergeJoin [cr_item_sk#30], [i_item_sk#31], Inner
         :                                   :                    :- NativeSort [cr_item_sk#30 ASC NULLS FIRST], false
         :                                   :                    :  +- InputAdapter
         :                                   :                    :     +- AQEShuffleRead coalesced
         :                                   :                    :        +- ShuffleQueryStage 5
         :                                   :                    :           +- NativeShuffleExchange hashpartitioning(cr_item_sk#30, 100), ENSURE_REQUIREMENTS, [plan_id=12]
         :                                   :                    :              +- NativeFilter (isnotnull(cr_item_sk#30) AND isnotnull(cr_returned_date_sk#28))
         :                                   :                    :                 +- InputAdapter [#28, #30, #25]
         :                                   :                    :                    +- NativeParquetScan  (FileScan parquet [cr_returned_date_sk#28,cr_item_sk#30,cr_return_quantity#25] Batched: true, DataFilters: [isnotnull(cr_item_sk#30), isnotnull(cr_returned_date_sk#28)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cr_item_sk), IsNotNull(cr_returned_date_sk)], ReadSchema: struct<cr_returned_date_sk:int,cr_item_sk:int,cr_return_quantity:int>)
         :                                   :                    +- NativeSort [i_item_sk#31 ASC NULLS FIRST], false
         :                                   :                       +- InputAdapter
         :                                   :                          +- InputAdapter [#31, #24]
         :                                   :                             +- AQEShuffleRead coalesced
         :                                   :                                +- ShuffleQueryStage 7
         :                                   :                                   +- ReusedExchange [i_item_sk#31, i_item_id#24], NativeShuffleExchange hashpartitioning(i_item_sk#18, 100), ENSURE_REQUIREMENTS, [plan_id=4]
         :                                   +- NativeSort [d_date_sk#29 ASC NULLS FIRST], false
         :                                      +- InputAdapter
         :                                         +- InputAdapter [#29]
         :                                            +- AQEShuffleRead coalesced
         :                                               +- ShuffleQueryStage 33
         :                                                  +- ReusedExchange [d_date_sk#29], NativeShuffleExchange hashpartitioning(d_date_sk#16, 100), ENSURE_REQUIREMENTS, [plan_id=5]
         +- NativeSort [item_id#9 ASC NULLS FIRST], false
            +- NativeProject [i_item_id#32 AS item_id#9, sum(wr_return_quantity#33)#34 AS wr_item_qty#4]
               +- NativeHashAggregate HashAgg, ArrayBuffer(i_item_id#32), [i_item_id#32], [sum(wr_return_quantity#33)], [sum(wr_return_quantity#33)#34], 1
                  +- InputAdapter
                     +- AQEShuffleRead coalesced
                        +- ShuffleQueryStage 38
                           +- NativeShuffleExchange hashpartitioning(i_item_id#32, 100), ENSURE_REQUIREMENTS, [plan_id=13]
                              +- NativeHashAggregate HashAgg, [i_item_id#32], [partial_sum(wr_return_quantity#33)], [sum#35], 0
                                 +- NativeProject [wr_return_quantity#33, i_item_id#32]
                                    +- NativeSortMergeJoin [wr_returned_date_sk#36], [d_date_sk#37], Inner
                                       :- NativeSort [wr_returned_date_sk#36 ASC NULLS FIRST], false
                                       :  +- InputAdapter
                                       :     +- AQEShuffleRead coalesced
                                       :        +- ShuffleQueryStage 25
                                       :           +- NativeShuffleExchange hashpartitioning(wr_returned_date_sk#36, 100), ENSURE_REQUIREMENTS, [plan_id=14]
                                       :              +- NativeProject [wr_returned_date_sk#36, wr_return_quantity#33, i_item_id#32]
                                       :                 +- NativeSortMergeJoin [wr_item_sk#38], [i_item_sk#39], Inner
                                       :                    :- NativeSort [wr_item_sk#38 ASC NULLS FIRST], false
                                       :                    :  +- InputAdapter
                                       :                    :     +- AQEShuffleRead coalesced
                                       :                    :        +- ShuffleQueryStage 14
                                       :                    :           +- NativeShuffleExchange hashpartitioning(wr_item_sk#38, 100), ENSURE_REQUIREMENTS, [plan_id=15]
                                       :                    :              +- NativeFilter (isnotnull(wr_item_sk#38) AND isnotnull(wr_returned_date_sk#36))
                                       :                    :                 +- InputAdapter [#36, #38, #33]
                                       :                    :                    +- NativeParquetScan  (FileScan parquet [wr_returned_date_sk#36,wr_item_sk#38,wr_return_quantity#33] Batched: true, DataFilters: [isnotnull(wr_item_sk#38), isnotnull(wr_returned_date_sk#36)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(wr_item_sk), IsNotNull(wr_returned_date_sk)], ReadSchema: struct<wr_returned_date_sk:int,wr_item_sk:int,wr_return_quantity:int>)
                                       :                    +- NativeSort [i_item_sk#39 ASC NULLS FIRST], false
                                       :                       +- InputAdapter
                                       :                          +- InputAdapter [#39, #32]
                                       :                             +- AQEShuffleRead coalesced
                                       :                                +- ShuffleQueryStage 16
                                       :                                   +- ReusedExchange [i_item_sk#39, i_item_id#32], NativeShuffleExchange hashpartitioning(i_item_sk#18, 100), ENSURE_REQUIREMENTS, [plan_id=4]
                                       +- NativeSort [d_date_sk#37 ASC NULLS FIRST], false
                                          +- InputAdapter
                                             +- InputAdapter [#37]
                                                +- AQEShuffleRead coalesced
                                                   +- ShuffleQueryStage 35
                                                      +- ReusedExchange [d_date_sk#37], NativeShuffleExchange hashpartitioning(d_date_sk#16, 100), ENSURE_REQUIREMENTS, [plan_id=5]
+- == Initial Plan ==
   TakeOrderedAndProject(limit=100, orderBy=[item_id#1 ASC NULLS FIRST,sr_item_qty#2 ASC NULLS FIRST], output=[item_id#1,sr_item_qty#2,sr_dev#5,cr_item_qty#3,cr_dev#6,wr_item_qty#4,wr_dev#7,average#8])
   +- Project [item_id#1, sr_item_qty#2, (((cast(sr_item_qty#2 as double) / cast(((sr_item_qty#2 + cr_item_qty#3) + wr_item_qty#4) as double)) / 3.0) * 100.0) AS sr_dev#5, cr_item_qty#3, (((cast(cr_item_qty#3 as double) / cast(((sr_item_qty#2 + cr_item_qty#3) + wr_item_qty#4) as double)) / 3.0) * 100.0) AS cr_dev#6, wr_item_qty#4, (((cast(wr_item_qty#4 as double) / cast(((sr_item_qty#2 + cr_item_qty#3) + wr_item_qty#4) as double)) / 3.0) * 100.0) AS wr_dev#7, (cast(((sr_item_qty#2 + cr_item_qty#3) + wr_item_qty#4) as decimal(20,0)) / 3.0) AS average#8]
      +- SortMergeJoin [item_id#1], [item_id#9], Inner
         :- Project [item_id#1, sr_item_qty#2, cr_item_qty#3]
         :  +- SortMergeJoin [item_id#1], [item_id#10], Inner
         :     :- Sort [item_id#1 ASC NULLS FIRST], false, 0
         :     :  +- HashAggregate(keys=[i_item_id#11], functions=[sum(sr_return_quantity#12)], output=[item_id#1, sr_item_qty#2])
         :     :     +- Exchange hashpartitioning(i_item_id#11, 100), ENSURE_REQUIREMENTS, [plan_id=16]
         :     :        +- HashAggregate(keys=[i_item_id#11], functions=[partial_sum(sr_return_quantity#12)], output=[i_item_id#11, sum#40])
         :     :           +- Project [sr_return_quantity#12, i_item_id#11]
         :     :              +- SortMergeJoin [sr_returned_date_sk#15], [d_date_sk#16], Inner
         :     :                 :- Sort [sr_returned_date_sk#15 ASC NULLS FIRST], false, 0
         :     :                 :  +- Exchange hashpartitioning(sr_returned_date_sk#15, 100), ENSURE_REQUIREMENTS, [plan_id=17]
         :     :                 :     +- Project [sr_returned_date_sk#15, sr_return_quantity#12, i_item_id#11]
         :     :                 :        +- SortMergeJoin [sr_item_sk#17], [i_item_sk#18], Inner
         :     :                 :           :- Sort [sr_item_sk#17 ASC NULLS FIRST], false, 0
         :     :                 :           :  +- Exchange hashpartitioning(sr_item_sk#17, 100), ENSURE_REQUIREMENTS, [plan_id=18]
         :     :                 :           :     +- Filter (isnotnull(sr_item_sk#17) AND isnotnull(sr_returned_date_sk#15))
         :     :                 :           :        +- FileScan parquet [sr_returned_date_sk#15,sr_item_sk#17,sr_return_quantity#12] Batched: true, DataFilters: [isnotnull(sr_item_sk#17), isnotnull(sr_returned_date_sk#15)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(sr_item_sk), IsNotNull(sr_returned_date_sk)], ReadSchema: struct<sr_returned_date_sk:int,sr_item_sk:int,sr_return_quantity:int>
         :     :                 :           +- Sort [i_item_sk#18 ASC NULLS FIRST], false, 0
         :     :                 :              +- Exchange hashpartitioning(i_item_sk#18, 100), ENSURE_REQUIREMENTS, [plan_id=19]
         :     :                 :                 +- Filter (isnotnull(i_item_sk#18) AND isnotnull(i_item_id#11))
         :     :                 :                    +- FileScan parquet [i_item_sk#18,i_item_id#11] Batched: true, DataFilters: [isnotnull(i_item_sk#18), isnotnull(i_item_id#11)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_item_id)], ReadSchema: struct<i_item_sk:int,i_item_id:string>
         :     :                 +- Sort [d_date_sk#16 ASC NULLS FIRST], false, 0
         :     :                    +- Exchange hashpartitioning(d_date_sk#16, 100), ENSURE_REQUIREMENTS, [plan_id=20]
         :     :                       +- Project [d_date_sk#16]
         :     :                          +- SortMergeJoin [d_date#19], [d_date#20], LeftSemi
         :     :                             :- Sort [d_date#19 ASC NULLS FIRST], false, 0
         :     :                             :  +- Exchange hashpartitioning(d_date#19, 100), ENSURE_REQUIREMENTS, [plan_id=21]
         :     :                             :     +- Filter isnotnull(d_date_sk#16)
         :     :                             :        +- FileScan parquet [d_date_sk#16,d_date#19] Batched: true, DataFilters: [isnotnull(d_date_sk#16)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_date:date>
         :     :                             +- Sort [d_date#20 ASC NULLS FIRST], false, 0
         :     :                                +- Exchange hashpartitioning(d_date#20, 100), ENSURE_REQUIREMENTS, [plan_id=22]
         :     :                                   +- Project [d_date#20]
         :     :                                      +- SortMergeJoin [d_week_seq#21], [d_week_seq#22], LeftSemi
         :     :                                         :- Sort [d_week_seq#21 ASC NULLS FIRST], false, 0
         :     :                                         :  +- Exchange hashpartitioning(d_week_seq#21, 100), ENSURE_REQUIREMENTS, [plan_id=23]
         :     :                                         :     +- FileScan parquet [d_date#20,d_week_seq#21] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<d_date:date,d_week_seq:int>
         :     :                                         +- Sort [d_week_seq#22 ASC NULLS FIRST], false, 0
         :     :                                            +- Exchange hashpartitioning(d_week_seq#22, 100), ENSURE_REQUIREMENTS, [plan_id=24]
         :     :                                               +- Project [d_week_seq#22]
         :     :                                                  +- Filter cast(d_date#23 as string) IN (2000-06-30,2000-09-27,2000-11-17)
         :     :                                                     +- FileScan parquet [d_date#23,d_week_seq#22] Batched: true, DataFilters: [cast(d_date#23 as string) IN (2000-06-30,2000-09-27,2000-11-17)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<d_date:date,d_week_seq:int>
         :     +- Sort [item_id#10 ASC NULLS FIRST], false, 0
         :        +- HashAggregate(keys=[i_item_id#24], functions=[sum(cr_return_quantity#25)], output=[item_id#10, cr_item_qty#3])
         :           +- Exchange hashpartitioning(i_item_id#24, 100), ENSURE_REQUIREMENTS, [plan_id=25]
         :              +- HashAggregate(keys=[i_item_id#24], functions=[partial_sum(cr_return_quantity#25)], output=[i_item_id#24, sum#41])
         :                 +- Project [cr_return_quantity#25, i_item_id#24]
         :                    +- SortMergeJoin [cr_returned_date_sk#28], [d_date_sk#29], Inner
         :                       :- Sort [cr_returned_date_sk#28 ASC NULLS FIRST], false, 0
         :                       :  +- Exchange hashpartitioning(cr_returned_date_sk#28, 100), ENSURE_REQUIREMENTS, [plan_id=26]
         :                       :     +- Project [cr_returned_date_sk#28, cr_return_quantity#25, i_item_id#24]
         :                       :        +- SortMergeJoin [cr_item_sk#30], [i_item_sk#31], Inner
         :                       :           :- Sort [cr_item_sk#30 ASC NULLS FIRST], false, 0
         :                       :           :  +- Exchange hashpartitioning(cr_item_sk#30, 100), ENSURE_REQUIREMENTS, [plan_id=27]
         :                       :           :     +- Filter (isnotnull(cr_item_sk#30) AND isnotnull(cr_returned_date_sk#28))
         :                       :           :        +- FileScan parquet [cr_returned_date_sk#28,cr_item_sk#30,cr_return_quantity#25] Batched: true, DataFilters: [isnotnull(cr_item_sk#30), isnotnull(cr_returned_date_sk#28)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cr_item_sk), IsNotNull(cr_returned_date_sk)], ReadSchema: struct<cr_returned_date_sk:int,cr_item_sk:int,cr_return_quantity:int>
         :                       :           +- Sort [i_item_sk#31 ASC NULLS FIRST], false, 0
         :                       :              +- Exchange hashpartitioning(i_item_sk#31, 100), ENSURE_REQUIREMENTS, [plan_id=28]
         :                       :                 +- Filter (isnotnull(i_item_sk#31) AND isnotnull(i_item_id#24))
         :                       :                    +- FileScan parquet [i_item_sk#31,i_item_id#24] Batched: true, DataFilters: [isnotnull(i_item_sk#31), isnotnull(i_item_id#24)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_item_id)], ReadSchema: struct<i_item_sk:int,i_item_id:string>
         :                       +- Sort [d_date_sk#29 ASC NULLS FIRST], false, 0
         :                          +- Exchange hashpartitioning(d_date_sk#29, 100), ENSURE_REQUIREMENTS, [plan_id=29]
         :                             +- Project [d_date_sk#29]
         :                                +- SortMergeJoin [d_date#42], [d_date#43], LeftSemi
         :                                   :- Sort [d_date#42 ASC NULLS FIRST], false, 0
         :                                   :  +- Exchange hashpartitioning(d_date#42, 100), ENSURE_REQUIREMENTS, [plan_id=30]
         :                                   :     +- Filter isnotnull(d_date_sk#29)
         :                                   :        +- FileScan parquet [d_date_sk#29,d_date#42] Batched: true, DataFilters: [isnotnull(d_date_sk#29)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_date:date>
         :                                   +- Sort [d_date#43 ASC NULLS FIRST], false, 0
         :                                      +- Exchange hashpartitioning(d_date#43, 100), ENSURE_REQUIREMENTS, [plan_id=31]
         :                                         +- Project [d_date#43]
         :                                            +- SortMergeJoin [d_week_seq#44], [d_week_seq#45], LeftSemi
         :                                               :- Sort [d_week_seq#44 ASC NULLS FIRST], false, 0
         :                                               :  +- Exchange hashpartitioning(d_week_seq#44, 100), ENSURE_REQUIREMENTS, [plan_id=32]
         :                                               :     +- FileScan parquet [d_date#43,d_week_seq#44] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<d_date:date,d_week_seq:int>
         :                                               +- Sort [d_week_seq#45 ASC NULLS FIRST], false, 0
         :                                                  +- Exchange hashpartitioning(d_week_seq#45, 100), ENSURE_REQUIREMENTS, [plan_id=33]
         :                                                     +- Project [d_week_seq#45]
         :                                                        +- Filter cast(d_date#46 as string) IN (2000-06-30,2000-09-27,2000-11-17)
         :                                                           +- FileScan parquet [d_date#46,d_week_seq#45] Batched: true, DataFilters: [cast(d_date#46 as string) IN (2000-06-30,2000-09-27,2000-11-17)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<d_date:date,d_week_seq:int>
         +- Sort [item_id#9 ASC NULLS FIRST], false, 0
            +- HashAggregate(keys=[i_item_id#32], functions=[sum(wr_return_quantity#33)], output=[item_id#9, wr_item_qty#4])
               +- Exchange hashpartitioning(i_item_id#32, 100), ENSURE_REQUIREMENTS, [plan_id=34]
                  +- HashAggregate(keys=[i_item_id#32], functions=[partial_sum(wr_return_quantity#33)], output=[i_item_id#32, sum#47])
                     +- Project [wr_return_quantity#33, i_item_id#32]
                        +- SortMergeJoin [wr_returned_date_sk#36], [d_date_sk#37], Inner
                           :- Sort [wr_returned_date_sk#36 ASC NULLS FIRST], false, 0
                           :  +- Exchange hashpartitioning(wr_returned_date_sk#36, 100), ENSURE_REQUIREMENTS, [plan_id=35]
                           :     +- Project [wr_returned_date_sk#36, wr_return_quantity#33, i_item_id#32]
                           :        +- SortMergeJoin [wr_item_sk#38], [i_item_sk#39], Inner
                           :           :- Sort [wr_item_sk#38 ASC NULLS FIRST], false, 0
                           :           :  +- Exchange hashpartitioning(wr_item_sk#38, 100), ENSURE_REQUIREMENTS, [plan_id=36]
                           :           :     +- Filter (isnotnull(wr_item_sk#38) AND isnotnull(wr_returned_date_sk#36))
                           :           :        +- FileScan parquet [wr_returned_date_sk#36,wr_item_sk#38,wr_return_quantity#33] Batched: true, DataFilters: [isnotnull(wr_item_sk#38), isnotnull(wr_returned_date_sk#36)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(wr_item_sk), IsNotNull(wr_returned_date_sk)], ReadSchema: struct<wr_returned_date_sk:int,wr_item_sk:int,wr_return_quantity:int>
                           :           +- Sort [i_item_sk#39 ASC NULLS FIRST], false, 0
                           :              +- Exchange hashpartitioning(i_item_sk#39, 100), ENSURE_REQUIREMENTS, [plan_id=37]
                           :                 +- Filter (isnotnull(i_item_sk#39) AND isnotnull(i_item_id#32))
                           :                    +- FileScan parquet [i_item_sk#39,i_item_id#32] Batched: true, DataFilters: [isnotnull(i_item_sk#39), isnotnull(i_item_id#32)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_item_id)], ReadSchema: struct<i_item_sk:int,i_item_id:string>
                           +- Sort [d_date_sk#37 ASC NULLS FIRST], false, 0
                              +- Exchange hashpartitioning(d_date_sk#37, 100), ENSURE_REQUIREMENTS, [plan_id=38]
                                 +- Project [d_date_sk#37]
                                    +- SortMergeJoin [d_date#48], [d_date#49], LeftSemi
                                       :- Sort [d_date#48 ASC NULLS FIRST], false, 0
                                       :  +- Exchange hashpartitioning(d_date#48, 100), ENSURE_REQUIREMENTS, [plan_id=39]
                                       :     +- Filter isnotnull(d_date_sk#37)
                                       :        +- FileScan parquet [d_date_sk#37,d_date#48] Batched: true, DataFilters: [isnotnull(d_date_sk#37)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_date:date>
                                       +- Sort [d_date#49 ASC NULLS FIRST], false, 0
                                          +- Exchange hashpartitioning(d_date#49, 100), ENSURE_REQUIREMENTS, [plan_id=40]
                                             +- Project [d_date#49]
                                                +- SortMergeJoin [d_week_seq#50], [d_week_seq#51], LeftSemi
                                                   :- Sort [d_week_seq#50 ASC NULLS FIRST], false, 0
                                                   :  +- Exchange hashpartitioning(d_week_seq#50, 100), ENSURE_REQUIREMENTS, [plan_id=41]
                                                   :     +- FileScan parquet [d_date#49,d_week_seq#50] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<d_date:date,d_week_seq:int>
                                                   +- Sort [d_week_seq#51 ASC NULLS FIRST], false, 0
                                                      +- Exchange hashpartitioning(d_week_seq#51, 100), ENSURE_REQUIREMENTS, [plan_id=42]
                                                         +- Project [d_week_seq#51]
                                                            +- Filter cast(d_date#52 as string) IN (2000-06-30,2000-09-27,2000-11-17)
                                                               +- FileScan parquet [d_date#52,d_week_seq#51] Batched: true, DataFilters: [cast(d_date#52 as string) IN (2000-06-30,2000-09-27,2000-11-17)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<d_date:date,d_week_seq:int>
