AdaptiveSparkPlan isFinalPlan=true
+- == Final Plan ==
   NativeTakeOrdered 100, [w_warehouse_name#1 ASC NULLS FIRST]
   +- NativeProject [w_warehouse_name#1, w_warehouse_sq_ft#2, w_city#3, w_county#4, w_state#5, w_country#6, ship_carriers#7, year#8, sum(jan_sales#9)#10 AS jan_sales#11, sum(feb_sales#12)#13 AS feb_sales#14, sum(mar_sales#15)#16 AS mar_sales#17, sum(apr_sales#18)#19 AS apr_sales#20, sum(may_sales#21)#22 AS may_sales#23, sum(jun_sales#24)#25 AS jun_sales#26, sum(jul_sales#27)#28 AS jul_sales#29, sum(aug_sales#30)#31 AS aug_sales#32, sum(sep_sales#33)#34 AS sep_sales#35, sum(oct_sales#36)#37 AS oct_sales#38, sum(nov_sales#39)#40 AS nov_sales#41, sum(dec_sales#42)#43 AS dec_sales#44, sum((jan_sales#9 / cast(w_warehouse_sq_ft#2 as decimal(10,0))))#45 AS jan_sales_per_sq_foot#46, sum((feb_sales#12 / cast(w_warehouse_sq_ft#2 as decimal(10,0))))#47 AS feb_sales_per_sq_foot#48, sum((mar_sales#15 / cast(w_warehouse_sq_ft#2 as decimal(10,0))))#49 AS mar_sales_per_sq_foot#50, sum((apr_sales#18 / cast(w_warehouse_sq_ft#2 as decimal(10,0))))#51 AS apr_sales_per_sq_foot#52, ... 20 more fields]
      +- NativeHashAggregate HashAgg, ArrayBuffer(w_warehouse_name#1, w_warehouse_sq_ft#2, w_city#3, w_county#4, w_state#5, w_country#6, ship_carriers#7, year#8), [w_warehouse_name#1, w_warehouse_sq_ft#2, w_city#3, w_county#4, w_state#5, w_country#6, ship_carriers#7, year#8], [sum(jan_sales#9), sum(feb_sales#12), sum(mar_sales#15), sum(apr_sales#18), sum(may_sales#21), sum(jun_sales#24), sum(jul_sales#27), sum(aug_sales#30), sum(sep_sales#33), sum(oct_sales#36), sum(nov_sales#39), sum(dec_sales#42), sum((jan_sales#9 / cast(w_warehouse_sq_ft#2 as decimal(10,0)))), sum((feb_sales#12 / cast(w_warehouse_sq_ft#2 as decimal(10,0)))), sum((mar_sales#15 / cast(w_warehouse_sq_ft#2 as decimal(10,0)))), sum((apr_sales#18 / cast(w_warehouse_sq_ft#2 as decimal(10,0)))), sum((may_sales#21 / cast(w_warehouse_sq_ft#2 as decimal(10,0)))), sum((jun_sales#24 / cast(w_warehouse_sq_ft#2 as decimal(10,0)))), sum((jul_sales#27 / cast(w_warehouse_sq_ft#2 as decimal(10,0)))), sum((aug_sales#30 / cast(w_warehouse_sq_ft#2 as decimal(10,0)))), sum((sep_sales#33 / cast(w_warehouse_sq_ft#2 as decimal(10,0)))), sum((oct_sales#36 / cast(w_warehouse_sq_ft#2 as decimal(10,0)))), sum((nov_sales#39 / cast(w_warehouse_sq_ft#2 as decimal(10,0)))), sum((dec_sales#42 / cast(w_warehouse_sq_ft#2 as decimal(10,0)))), ... 12 more fields], [sum(jan_sales#9)#10, sum(feb_sales#12)#13, sum(mar_sales#15)#16, sum(apr_sales#18)#19, sum(may_sales#21)#22, sum(jun_sales#24)#25, sum(jul_sales#27)#28, sum(aug_sales#30)#31, sum(sep_sales#33)#34, sum(oct_sales#36)#37, sum(nov_sales#39)#40, sum(dec_sales#42)#43, sum((jan_sales#9 / cast(w_warehouse_sq_ft#2 as decimal(10,0))))#45, sum((feb_sales#12 / cast(w_warehouse_sq_ft#2 as decimal(10,0))))#47, sum((mar_sales#15 / cast(w_warehouse_sq_ft#2 as decimal(10,0))))#49, sum((apr_sales#18 / cast(w_warehouse_sq_ft#2 as decimal(10,0))))#51, sum((may_sales#21 / cast(w_warehouse_sq_ft#2 as decimal(10,0))))#53, sum((jun_sales#24 / cast(w_warehouse_sq_ft#2 as decimal(10,0))))#54, sum((jul_sales#27 / cast(w_warehouse_sq_ft#2 as decimal(10,0))))#55, sum((aug_sales#30 / cast(w_warehouse_sq_ft#2 as decimal(10,0))))#56, sum((sep_sales#33 / cast(w_warehouse_sq_ft#2 as decimal(10,0))))#57, sum((oct_sales#36 / cast(w_warehouse_sq_ft#2 as decimal(10,0))))#58, sum((nov_sales#39 / cast(w_warehouse_sq_ft#2 as decimal(10,0))))#59, sum((dec_sales#42 / cast(w_warehouse_sq_ft#2 as decimal(10,0))))#60, ... 12 more fields], 8
         +- InputAdapter
            +- AQEShuffleRead coalesced
               +- ShuffleQueryStage X
                  +- NativeShuffleExchange hashpartitioning(w_warehouse_name#1, w_warehouse_sq_ft#2, w_city#3, w_county#4, w_state#5, w_country#6, ship_carriers#7, year#8, 100), ENSURE_REQUIREMENTS, [plan_id=1]
                     +- NativeHashAggregate HashAgg, [w_warehouse_name#1, w_warehouse_sq_ft#2, w_city#3, w_county#4, w_state#5, w_country#6, ship_carriers#7, year#8], [partial_sum(_c8#61), partial_sum(_c9#62), partial_sum(_c10#63), partial_sum(_c11#64), partial_sum(_c12#65), partial_sum(_c13#66), partial_sum(_c14#67), partial_sum(_c15#68), partial_sum(_c16#69), partial_sum(_c17#70), partial_sum(_c18#71), partial_sum(_c19#72), partial_sum(_c20#73), partial_sum(_c21#74), partial_sum(_c22#75), partial_sum(_c23#76), partial_sum(_c24#77), partial_sum(_c25#78), partial_sum(_c26#79), partial_sum(_c27#80), partial_sum(_c28#81), partial_sum(_c29#82), partial_sum(_c30#83), partial_sum(_c31#84), ... 12 more fields], [sum#85, isEmpty#86, sum#87, isEmpty#88, sum#89, isEmpty#90, sum#91, isEmpty#92, sum#93, isEmpty#94, sum#95, isEmpty#96, sum#97, isEmpty#98, sum#99, isEmpty#100, sum#101, isEmpty#102, sum#103, isEmpty#104, sum#105, isEmpty#106, sum#107, isEmpty#108, ... 48 more fields], 0
                        +- NativeProject [w_warehouse_name#1 AS w_warehouse_name#1, w_warehouse_sq_ft#2 AS w_warehouse_sq_ft#2, w_city#3 AS w_city#3, w_county#4 AS w_county#4, w_state#5 AS w_state#5, w_country#6 AS w_country#6, ship_carriers#7 AS ship_carriers#7, year#8 AS year#8, jan_sales#9 AS _c8#61, feb_sales#12 AS _c9#62, mar_sales#15 AS _c10#63, apr_sales#18 AS _c11#64, may_sales#21 AS _c12#65, jun_sales#24 AS _c13#66, jul_sales#27 AS _c14#67, aug_sales#30 AS _c15#68, sep_sales#33 AS _c16#69, oct_sales#36 AS _c17#70, nov_sales#39 AS _c18#71, dec_sales#42 AS _c19#72, (jan_sales#9 / cast(w_warehouse_sq_ft#2 as decimal(10,0))) AS _c20#73, (feb_sales#12 / cast(w_warehouse_sq_ft#2 as decimal(10,0))) AS _c21#74, (mar_sales#15 / cast(w_warehouse_sq_ft#2 as decimal(10,0))) AS _c22#75, (apr_sales#18 / cast(w_warehouse_sq_ft#2 as decimal(10,0))) AS _c23#76, ... 20 more fields]
                           +- InputAdapter [#1, #2, #3, #4, #5, #6, #7, #8, #9, #12, #15, #18, #21, #24, #27, #30, #33, #36, #39, #42, #109, #110, #111, #112, ... 8 more fields]
                              +- NativeUnion [w_warehouse_name#1, w_warehouse_sq_ft#2, w_city#3, w_county#4, w_state#5, w_country#6, ship_carriers#7, year#8, jan_sales#9, feb_sales#12, mar_sales#15, apr_sales#18, may_sales#21, jun_sales#24, jul_sales#27, aug_sales#30, sep_sales#33, oct_sales#36, nov_sales#39, dec_sales#42, jan_net#109, feb_net#110, mar_net#111, apr_net#112, ... 8 more fields]
                                 :- NativeProject [w_warehouse_name#1, w_warehouse_sq_ft#2, w_city#3, w_county#4, w_state#5, w_country#6, DHL,BARIAN AS ship_carriers#7, d_year#113 AS year#8, sum(CASE WHEN (d_moy#114 = 1) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END)#117 AS jan_sales#9, sum(CASE WHEN (d_moy#114 = 2) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END)#118 AS feb_sales#12, sum(CASE WHEN (d_moy#114 = 3) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END)#119 AS mar_sales#15, sum(CASE WHEN (d_moy#114 = 4) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END)#120 AS apr_sales#18, sum(CASE WHEN (d_moy#114 = 5) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END)#121 AS may_sales#21, sum(CASE WHEN (d_moy#114 = 6) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END)#122 AS jun_sales#24, sum(CASE WHEN (d_moy#114 = 7) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END)#123 AS jul_sales#27, sum(CASE WHEN (d_moy#114 = 8) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END)#124 AS aug_sales#30, sum(CASE WHEN (d_moy#114 = 9) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END)#125 AS sep_sales#33, sum(CASE WHEN (d_moy#114 = 10) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END)#126 AS oct_sales#36, sum(CASE WHEN (d_moy#114 = 11) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END)#127 AS nov_sales#39, sum(CASE WHEN (d_moy#114 = 12) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END)#128 AS dec_sales#42, sum(CASE WHEN (d_moy#114 = 1) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END)#130 AS jan_net#109, sum(CASE WHEN (d_moy#114 = 2) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END)#131 AS feb_net#110, sum(CASE WHEN (d_moy#114 = 3) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END)#132 AS mar_net#111, sum(CASE WHEN (d_moy#114 = 4) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END)#133 AS apr_net#112, ... 8 more fields]
                                 :  +- NativeHashAggregate HashAgg, ArrayBuffer(w_warehouse_name#1, w_warehouse_sq_ft#2, w_city#3, w_county#4, w_state#5, w_country#6, d_year#113), [w_warehouse_name#1, w_warehouse_sq_ft#2, w_city#3, w_county#4, w_state#5, w_country#6, d_year#113], [sum(CASE WHEN (d_moy#114 = 1) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#114 = 2) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#114 = 3) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#114 = 4) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#114 = 5) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#114 = 6) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#114 = 7) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#114 = 8) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#114 = 9) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#114 = 10) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#114 = 11) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#114 = 12) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#114 = 1) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#114 = 2) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#114 = 3) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#114 = 4) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#114 = 5) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#114 = 6) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#114 = 7) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#114 = 8) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#114 = 9) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#114 = 10) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#114 = 11) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#114 = 12) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END)], [sum(CASE WHEN (d_moy#114 = 1) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END)#117, sum(CASE WHEN (d_moy#114 = 2) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END)#118, sum(CASE WHEN (d_moy#114 = 3) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END)#119, sum(CASE WHEN (d_moy#114 = 4) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END)#120, sum(CASE WHEN (d_moy#114 = 5) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END)#121, sum(CASE WHEN (d_moy#114 = 6) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END)#122, sum(CASE WHEN (d_moy#114 = 7) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END)#123, sum(CASE WHEN (d_moy#114 = 8) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END)#124, sum(CASE WHEN (d_moy#114 = 9) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END)#125, sum(CASE WHEN (d_moy#114 = 10) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END)#126, sum(CASE WHEN (d_moy#114 = 11) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END)#127, sum(CASE WHEN (d_moy#114 = 12) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END)#128, sum(CASE WHEN (d_moy#114 = 1) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END)#130, sum(CASE WHEN (d_moy#114 = 2) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END)#131, sum(CASE WHEN (d_moy#114 = 3) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END)#132, sum(CASE WHEN (d_moy#114 = 4) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END)#133, sum(CASE WHEN (d_moy#114 = 5) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END)#134, sum(CASE WHEN (d_moy#114 = 6) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END)#135, sum(CASE WHEN (d_moy#114 = 7) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END)#136, sum(CASE WHEN (d_moy#114 = 8) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END)#137, sum(CASE WHEN (d_moy#114 = 9) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END)#138, sum(CASE WHEN (d_moy#114 = 10) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END)#139, sum(CASE WHEN (d_moy#114 = 11) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END)#140, sum(CASE WHEN (d_moy#114 = 12) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END)#141], 7
                                 :     +- InputAdapter
                                 :        +- AQEShuffleRead coalesced
                                 :           +- ShuffleQueryStage X
                                 :              +- NativeShuffleExchange hashpartitioning(w_warehouse_name#1, w_warehouse_sq_ft#2, w_city#3, w_county#4, w_state#5, w_country#6, d_year#113, 100), ENSURE_REQUIREMENTS, [plan_id=2]
                                 :                 +- NativeHashAggregate HashAgg, [w_warehouse_name#1, w_warehouse_sq_ft#2, w_city#3, w_county#4, w_state#5, w_country#6, d_year#113], [partial_sum(_c7#142), partial_sum(_c8#143), partial_sum(_c9#144), partial_sum(_c10#145), partial_sum(_c11#146), partial_sum(_c12#147), partial_sum(_c13#148), partial_sum(_c14#149), partial_sum(_c15#150), partial_sum(_c16#151), partial_sum(_c17#152), partial_sum(_c18#153), partial_sum(_c19#154), partial_sum(_c20#155), partial_sum(_c21#156), partial_sum(_c22#157), partial_sum(_c23#158), partial_sum(_c24#159), partial_sum(_c25#160), partial_sum(_c26#161), partial_sum(_c27#162), partial_sum(_c28#163), partial_sum(_c29#164), partial_sum(_c30#165)], [sum#166, isEmpty#167, sum#168, isEmpty#169, sum#170, isEmpty#171, sum#172, isEmpty#173, sum#174, isEmpty#175, sum#176, isEmpty#177, sum#178, isEmpty#179, sum#180, isEmpty#181, sum#182, isEmpty#183, sum#184, isEmpty#185, sum#186, isEmpty#187, sum#188, isEmpty#189, ... 24 more fields], 0
                                 :                    +- NativeProject [w_warehouse_name#1 AS w_warehouse_name#1, w_warehouse_sq_ft#2 AS w_warehouse_sq_ft#2, w_city#3 AS w_city#3, w_county#4 AS w_county#4, w_state#5 AS w_state#5, w_country#6 AS w_country#6, d_year#113 AS d_year#113, CASE WHEN (d_moy#114 = 1) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END AS _c7#142, CASE WHEN (d_moy#114 = 2) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END AS _c8#143, CASE WHEN (d_moy#114 = 3) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END AS _c9#144, CASE WHEN (d_moy#114 = 4) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END AS _c10#145, CASE WHEN (d_moy#114 = 5) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END AS _c11#146, CASE WHEN (d_moy#114 = 6) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END AS _c12#147, CASE WHEN (d_moy#114 = 7) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END AS _c13#148, CASE WHEN (d_moy#114 = 8) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END AS _c14#149, CASE WHEN (d_moy#114 = 9) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END AS _c15#150, CASE WHEN (d_moy#114 = 10) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END AS _c16#151, CASE WHEN (d_moy#114 = 11) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END AS _c17#152, CASE WHEN (d_moy#114 = 12) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END AS _c18#153, CASE WHEN (d_moy#114 = 1) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END AS _c19#154, CASE WHEN (d_moy#114 = 2) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END AS _c20#155, CASE WHEN (d_moy#114 = 3) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END AS _c21#156, CASE WHEN (d_moy#114 = 4) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END AS _c22#157, CASE WHEN (d_moy#114 = 5) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END AS _c23#158, ... 7 more fields]
                                 :                       +- NativeProject [ws_quantity#116, ws_ext_sales_price#115, ws_net_paid#129, w_warehouse_name#1, w_warehouse_sq_ft#2, w_city#3, w_county#4, w_state#5, w_country#6, d_year#113, d_moy#114]
                                 :                          +- NativeSortMergeJoin [ws_ship_mode_sk#190], [sm_ship_mode_sk#191], Inner
                                 :                             :- NativeSort [ws_ship_mode_sk#190 ASC NULLS FIRST], false
                                 :                             :  +- InputAdapter
                                 :                             :     +- AQEShuffleRead coalesced
                                 :                             :        +- ShuffleQueryStage X
                                 :                             :           +- NativeShuffleExchange hashpartitioning(ws_ship_mode_sk#190, 100), ENSURE_REQUIREMENTS, [plan_id=3]
                                 :                             :              +- NativeProject [ws_ship_mode_sk#190, ws_quantity#116, ws_ext_sales_price#115, ws_net_paid#129, w_warehouse_name#1, w_warehouse_sq_ft#2, w_city#3, w_county#4, w_state#5, w_country#6, d_year#113, d_moy#114]
                                 :                             :                 +- NativeSortMergeJoin [ws_sold_time_sk#192], [t_time_sk#193], Inner
                                 :                             :                    :- NativeSort [ws_sold_time_sk#192 ASC NULLS FIRST], false
                                 :                             :                    :  +- InputAdapter
                                 :                             :                    :     +- AQEShuffleRead coalesced
                                 :                             :                    :        +- ShuffleQueryStage X
                                 :                             :                    :           +- NativeShuffleExchange hashpartitioning(ws_sold_time_sk#192, 100), ENSURE_REQUIREMENTS, [plan_id=4]
                                 :                             :                    :              +- NativeProject [ws_sold_time_sk#192, ws_ship_mode_sk#190, ws_quantity#116, ws_ext_sales_price#115, ws_net_paid#129, w_warehouse_name#1, w_warehouse_sq_ft#2, w_city#3, w_county#4, w_state#5, w_country#6, d_year#113, d_moy#114]
                                 :                             :                    :                 +- NativeSortMergeJoin [ws_sold_date_sk#194], [d_date_sk#195], Inner
                                 :                             :                    :                    :- NativeSort [ws_sold_date_sk#194 ASC NULLS FIRST], false
                                 :                             :                    :                    :  +- InputAdapter
                                 :                             :                    :                    :     +- AQEShuffleRead coalesced
                                 :                             :                    :                    :        +- ShuffleQueryStage X
                                 :                             :                    :                    :           +- NativeShuffleExchange hashpartitioning(ws_sold_date_sk#194, 100), ENSURE_REQUIREMENTS, [plan_id=5]
                                 :                             :                    :                    :              +- NativeProject [ws_sold_date_sk#194, ws_sold_time_sk#192, ws_ship_mode_sk#190, ws_quantity#116, ws_ext_sales_price#115, ws_net_paid#129, w_warehouse_name#1, w_warehouse_sq_ft#2, w_city#3, w_county#4, w_state#5, w_country#6]
                                 :                             :                    :                    :                 +- NativeSortMergeJoin [ws_warehouse_sk#196], [w_warehouse_sk#197], Inner
                                 :                             :                    :                    :                    :- NativeSort [ws_warehouse_sk#196 ASC NULLS FIRST], false
                                 :                             :                    :                    :                    :  +- InputAdapter
                                 :                             :                    :                    :                    :     +- AQEShuffleRead coalesced
                                 :                             :                    :                    :                    :        +- ShuffleQueryStage X
                                 :                             :                    :                    :                    :           +- NativeShuffleExchange hashpartitioning(ws_warehouse_sk#196, 100), ENSURE_REQUIREMENTS, [plan_id=6]
                                 :                             :                    :                    :                    :              +- NativeFilter (((isnotnull(ws_warehouse_sk#196) AND isnotnull(ws_sold_date_sk#194)) AND isnotnull(ws_sold_time_sk#192)) AND isnotnull(ws_ship_mode_sk#190))
                                 :                             :                    :                    :                    :                 +- InputAdapter [#194, #192, #190, #196, #116, #115, #129]
                                 :                             :                    :                    :                    :                    +- NativeParquetScan  (FileScan parquet [ws_sold_date_sk#194,ws_sold_time_sk#192,ws_ship_mode_sk#190,ws_warehouse_sk#196,ws_quantity#116,ws_ext_sales_price#115,ws_net_paid#129] Batched: true, DataFilters: [isnotnull(ws_warehouse_sk#196), isnotnull(ws_sold_date_sk#194), isnotnull(ws_sold_time_sk#192..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ws_warehouse_sk), IsNotNull(ws_sold_date_sk), IsNotNull(ws_sold_time_sk), IsNotNull(ws..., ReadSchema: struct<ws_sold_date_sk:int,ws_sold_time_sk:int,ws_ship_mode_sk:int,ws_warehouse_sk:int,ws_quantit...)
                                 :                             :                    :                    :                    +- NativeSort [w_warehouse_sk#197 ASC NULLS FIRST], false
                                 :                             :                    :                    :                       +- InputAdapter
                                 :                             :                    :                    :                          +- AQEShuffleRead coalesced
                                 :                             :                    :                    :                             +- ShuffleQueryStage X
                                 :                             :                    :                    :                                +- NativeShuffleExchange hashpartitioning(w_warehouse_sk#197, 100), ENSURE_REQUIREMENTS, [plan_id=7]
                                 :                             :                    :                    :                                   +- NativeFilter isnotnull(w_warehouse_sk#197)
                                 :                             :                    :                    :                                      +- InputAdapter [#197, #1, #2, #3, #4, #5, #6]
                                 :                             :                    :                    :                                         +- NativeParquetScan  (FileScan parquet [w_warehouse_sk#197,w_warehouse_name#1,w_warehouse_sq_ft#2,w_city#3,w_county#4,w_state#5,w_country#6] Batched: true, DataFilters: [isnotnull(w_warehouse_sk#197)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(w_warehouse_sk)], ReadSchema: struct<w_warehouse_sk:int,w_warehouse_name:string,w_warehouse_sq_ft:int,w_city:string,w_county:st...)
                                 :                             :                    :                    +- NativeSort [d_date_sk#195 ASC NULLS FIRST], false
                                 :                             :                    :                       +- InputAdapter
                                 :                             :                    :                          +- AQEShuffleRead coalesced
                                 :                             :                    :                             +- ShuffleQueryStage X
                                 :                             :                    :                                +- NativeShuffleExchange hashpartitioning(d_date_sk#195, 100), ENSURE_REQUIREMENTS, [plan_id=8]
                                 :                             :                    :                                   +- NativeFilter ((isnotnull(d_year#113) AND (d_year#113 = 2001)) AND isnotnull(d_date_sk#195))
                                 :                             :                    :                                      +- InputAdapter [#195, #113, #114]
                                 :                             :                    :                                         +- NativeParquetScan  (FileScan parquet [d_date_sk#195,d_year#113,d_moy#114] Batched: true, DataFilters: [isnotnull(d_year#113), (d_year#113 = 2001), isnotnull(d_date_sk#195)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2001), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_moy:int>)
                                 :                             :                    +- NativeSort [t_time_sk#193 ASC NULLS FIRST], false
                                 :                             :                       +- InputAdapter
                                 :                             :                          +- AQEShuffleRead coalesced
                                 :                             :                             +- ShuffleQueryStage X
                                 :                             :                                +- NativeShuffleExchange hashpartitioning(t_time_sk#193, 100), ENSURE_REQUIREMENTS, [plan_id=9]
                                 :                             :                                   +- NativeProject [t_time_sk#193]
                                 :                             :                                      +- NativeFilter (((isnotnull(t_time#198) AND (t_time#198 >= 30838)) AND (t_time#198 <= 59638)) AND isnotnull(t_time_sk#193))
                                 :                             :                                         +- InputAdapter [#193, #198]
                                 :                             :                                            +- NativeParquetScan  (FileScan parquet [t_time_sk#193,t_time#198] Batched: true, DataFilters: [isnotnull(t_time#198), (t_time#198 >= 30838), (t_time#198 <= 59638), isnotnull(t_time_sk#193)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(t_time), GreaterThanOrEqual(t_time,30838), LessThanOrEqual(t_time,59638), IsNotNull(t_..., ReadSchema: struct<t_time_sk:int,t_time:int>)
                                 :                             +- NativeSort [sm_ship_mode_sk#191 ASC NULLS FIRST], false
                                 :                                +- InputAdapter
                                 :                                   +- AQEShuffleRead coalesced
                                 :                                      +- ShuffleQueryStage X
                                 :                                         +- NativeShuffleExchange hashpartitioning(sm_ship_mode_sk#191, 100), ENSURE_REQUIREMENTS, [plan_id=10]
                                 :                                            +- NativeProject [sm_ship_mode_sk#191]
                                 :                                               +- NativeFilter (sm_carrier#199 IN (DHL,BARIAN) AND isnotnull(sm_ship_mode_sk#191))
                                 :                                                  +- InputAdapter [#191, #199]
                                 :                                                     +- NativeParquetScan  (FileScan parquet [sm_ship_mode_sk#191,sm_carrier#199] Batched: true, DataFilters: [sm_carrier#199 IN (DHL,BARIAN), isnotnull(sm_ship_mode_sk#191)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [In(sm_carrier, [BARIAN,DHL]), IsNotNull(sm_ship_mode_sk)], ReadSchema: struct<sm_ship_mode_sk:int,sm_carrier:string>)
                                 +- NativeProject [w_warehouse_name#200, w_warehouse_sq_ft#201, w_city#202, w_county#203, w_state#204, w_country#205, DHL,BARIAN AS ship_carriers#206, d_year#207 AS year#208, sum(CASE WHEN (d_moy#209 = 1) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END)#212 AS jan_sales#213, sum(CASE WHEN (d_moy#209 = 2) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END)#214 AS feb_sales#215, sum(CASE WHEN (d_moy#209 = 3) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END)#216 AS mar_sales#217, sum(CASE WHEN (d_moy#209 = 4) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END)#218 AS apr_sales#219, sum(CASE WHEN (d_moy#209 = 5) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END)#220 AS may_sales#221, sum(CASE WHEN (d_moy#209 = 6) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END)#222 AS jun_sales#223, sum(CASE WHEN (d_moy#209 = 7) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END)#224 AS jul_sales#225, sum(CASE WHEN (d_moy#209 = 8) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END)#226 AS aug_sales#227, sum(CASE WHEN (d_moy#209 = 9) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END)#228 AS sep_sales#229, sum(CASE WHEN (d_moy#209 = 10) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END)#230 AS oct_sales#231, sum(CASE WHEN (d_moy#209 = 11) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END)#232 AS nov_sales#233, sum(CASE WHEN (d_moy#209 = 12) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END)#234 AS dec_sales#235, sum(CASE WHEN (d_moy#209 = 1) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END)#237 AS jan_net#238, sum(CASE WHEN (d_moy#209 = 2) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END)#239 AS feb_net#240, sum(CASE WHEN (d_moy#209 = 3) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END)#241 AS mar_net#242, sum(CASE WHEN (d_moy#209 = 4) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END)#243 AS apr_net#244, ... 8 more fields]
                                    +- NativeHashAggregate HashAgg, ArrayBuffer(w_warehouse_name#200, w_warehouse_sq_ft#201, w_city#202, w_county#203, w_state#204, w_country#205, d_year#207), [w_warehouse_name#200, w_warehouse_sq_ft#201, w_city#202, w_county#203, w_state#204, w_country#205, d_year#207], [sum(CASE WHEN (d_moy#209 = 1) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#209 = 2) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#209 = 3) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#209 = 4) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#209 = 5) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#209 = 6) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#209 = 7) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#209 = 8) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#209 = 9) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#209 = 10) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#209 = 11) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#209 = 12) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#209 = 1) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#209 = 2) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#209 = 3) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#209 = 4) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#209 = 5) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#209 = 6) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#209 = 7) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#209 = 8) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#209 = 9) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#209 = 10) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#209 = 11) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#209 = 12) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END)], [sum(CASE WHEN (d_moy#209 = 1) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END)#212, sum(CASE WHEN (d_moy#209 = 2) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END)#214, sum(CASE WHEN (d_moy#209 = 3) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END)#216, sum(CASE WHEN (d_moy#209 = 4) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END)#218, sum(CASE WHEN (d_moy#209 = 5) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END)#220, sum(CASE WHEN (d_moy#209 = 6) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END)#222, sum(CASE WHEN (d_moy#209 = 7) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END)#224, sum(CASE WHEN (d_moy#209 = 8) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END)#226, sum(CASE WHEN (d_moy#209 = 9) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END)#228, sum(CASE WHEN (d_moy#209 = 10) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END)#230, sum(CASE WHEN (d_moy#209 = 11) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END)#232, sum(CASE WHEN (d_moy#209 = 12) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END)#234, sum(CASE WHEN (d_moy#209 = 1) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END)#237, sum(CASE WHEN (d_moy#209 = 2) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END)#239, sum(CASE WHEN (d_moy#209 = 3) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END)#241, sum(CASE WHEN (d_moy#209 = 4) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END)#243, sum(CASE WHEN (d_moy#209 = 5) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END)#245, sum(CASE WHEN (d_moy#209 = 6) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END)#246, sum(CASE WHEN (d_moy#209 = 7) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END)#247, sum(CASE WHEN (d_moy#209 = 8) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END)#248, sum(CASE WHEN (d_moy#209 = 9) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END)#249, sum(CASE WHEN (d_moy#209 = 10) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END)#250, sum(CASE WHEN (d_moy#209 = 11) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END)#251, sum(CASE WHEN (d_moy#209 = 12) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END)#252], 7
                                       +- InputAdapter
                                          +- AQEShuffleRead coalesced
                                             +- ShuffleQueryStage X
                                                +- NativeShuffleExchange hashpartitioning(w_warehouse_name#200, w_warehouse_sq_ft#201, w_city#202, w_county#203, w_state#204, w_country#205, d_year#207, 100), ENSURE_REQUIREMENTS, [plan_id=11]
                                                   +- NativeHashAggregate HashAgg, [w_warehouse_name#200, w_warehouse_sq_ft#201, w_city#202, w_county#203, w_state#204, w_country#205, d_year#207], [partial_sum(_c7#253), partial_sum(_c8#254), partial_sum(_c9#255), partial_sum(_c10#256), partial_sum(_c11#257), partial_sum(_c12#258), partial_sum(_c13#259), partial_sum(_c14#260), partial_sum(_c15#261), partial_sum(_c16#262), partial_sum(_c17#263), partial_sum(_c18#264), partial_sum(_c19#265), partial_sum(_c20#266), partial_sum(_c21#267), partial_sum(_c22#268), partial_sum(_c23#269), partial_sum(_c24#270), partial_sum(_c25#271), partial_sum(_c26#272), partial_sum(_c27#273), partial_sum(_c28#274), partial_sum(_c29#275), partial_sum(_c30#276)], [sum#277, isEmpty#278, sum#279, isEmpty#280, sum#281, isEmpty#282, sum#283, isEmpty#284, sum#285, isEmpty#286, sum#287, isEmpty#288, sum#289, isEmpty#290, sum#291, isEmpty#292, sum#293, isEmpty#294, sum#295, isEmpty#296, sum#297, isEmpty#298, sum#299, isEmpty#300, ... 24 more fields], 0
                                                      +- NativeProject [w_warehouse_name#200 AS w_warehouse_name#200, w_warehouse_sq_ft#201 AS w_warehouse_sq_ft#201, w_city#202 AS w_city#202, w_county#203 AS w_county#203, w_state#204 AS w_state#204, w_country#205 AS w_country#205, d_year#207 AS d_year#207, CASE WHEN (d_moy#209 = 1) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END AS _c7#253, CASE WHEN (d_moy#209 = 2) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END AS _c8#254, CASE WHEN (d_moy#209 = 3) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END AS _c9#255, CASE WHEN (d_moy#209 = 4) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END AS _c10#256, CASE WHEN (d_moy#209 = 5) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END AS _c11#257, CASE WHEN (d_moy#209 = 6) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END AS _c12#258, CASE WHEN (d_moy#209 = 7) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END AS _c13#259, CASE WHEN (d_moy#209 = 8) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END AS _c14#260, CASE WHEN (d_moy#209 = 9) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END AS _c15#261, CASE WHEN (d_moy#209 = 10) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END AS _c16#262, CASE WHEN (d_moy#209 = 11) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END AS _c17#263, CASE WHEN (d_moy#209 = 12) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END AS _c18#264, CASE WHEN (d_moy#209 = 1) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END AS _c19#265, CASE WHEN (d_moy#209 = 2) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END AS _c20#266, CASE WHEN (d_moy#209 = 3) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END AS _c21#267, CASE WHEN (d_moy#209 = 4) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END AS _c22#268, CASE WHEN (d_moy#209 = 5) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END AS _c23#269, ... 7 more fields]
                                                         +- NativeProject [cs_quantity#211, cs_sales_price#210, cs_net_paid_inc_tax#236, w_warehouse_name#200, w_warehouse_sq_ft#201, w_city#202, w_county#203, w_state#204, w_country#205, d_year#207, d_moy#209]
                                                            +- NativeSortMergeJoin [cs_ship_mode_sk#301], [sm_ship_mode_sk#302], Inner
                                                               :- NativeSort [cs_ship_mode_sk#301 ASC NULLS FIRST], false
                                                               :  +- InputAdapter
                                                               :     +- AQEShuffleRead coalesced
                                                               :        +- ShuffleQueryStage X
                                                               :           +- NativeShuffleExchange hashpartitioning(cs_ship_mode_sk#301, 100), ENSURE_REQUIREMENTS, [plan_id=12]
                                                               :              +- NativeProject [cs_ship_mode_sk#301, cs_quantity#211, cs_sales_price#210, cs_net_paid_inc_tax#236, w_warehouse_name#200, w_warehouse_sq_ft#201, w_city#202, w_county#203, w_state#204, w_country#205, d_year#207, d_moy#209]
                                                               :                 +- NativeSortMergeJoin [cs_sold_time_sk#303], [t_time_sk#304], Inner
                                                               :                    :- NativeSort [cs_sold_time_sk#303 ASC NULLS FIRST], false
                                                               :                    :  +- InputAdapter
                                                               :                    :     +- AQEShuffleRead coalesced
                                                               :                    :        +- ShuffleQueryStage X
                                                               :                    :           +- NativeShuffleExchange hashpartitioning(cs_sold_time_sk#303, 100), ENSURE_REQUIREMENTS, [plan_id=13]
                                                               :                    :              +- NativeProject [cs_sold_time_sk#303, cs_ship_mode_sk#301, cs_quantity#211, cs_sales_price#210, cs_net_paid_inc_tax#236, w_warehouse_name#200, w_warehouse_sq_ft#201, w_city#202, w_county#203, w_state#204, w_country#205, d_year#207, d_moy#209]
                                                               :                    :                 +- NativeSortMergeJoin [cs_sold_date_sk#305], [d_date_sk#306], Inner
                                                               :                    :                    :- NativeSort [cs_sold_date_sk#305 ASC NULLS FIRST], false
                                                               :                    :                    :  +- InputAdapter
                                                               :                    :                    :     +- AQEShuffleRead coalesced
                                                               :                    :                    :        +- ShuffleQueryStage X
                                                               :                    :                    :           +- NativeShuffleExchange hashpartitioning(cs_sold_date_sk#305, 100), ENSURE_REQUIREMENTS, [plan_id=14]
                                                               :                    :                    :              +- NativeProject [cs_sold_date_sk#305, cs_sold_time_sk#303, cs_ship_mode_sk#301, cs_quantity#211, cs_sales_price#210, cs_net_paid_inc_tax#236, w_warehouse_name#200, w_warehouse_sq_ft#201, w_city#202, w_county#203, w_state#204, w_country#205]
                                                               :                    :                    :                 +- NativeSortMergeJoin [cs_warehouse_sk#307], [w_warehouse_sk#308], Inner
                                                               :                    :                    :                    :- NativeSort [cs_warehouse_sk#307 ASC NULLS FIRST], false
                                                               :                    :                    :                    :  +- InputAdapter
                                                               :                    :                    :                    :     +- AQEShuffleRead coalesced
                                                               :                    :                    :                    :        +- ShuffleQueryStage X
                                                               :                    :                    :                    :           +- NativeShuffleExchange hashpartitioning(cs_warehouse_sk#307, 100), ENSURE_REQUIREMENTS, [plan_id=15]
                                                               :                    :                    :                    :              +- NativeFilter (((isnotnull(cs_warehouse_sk#307) AND isnotnull(cs_sold_date_sk#305)) AND isnotnull(cs_sold_time_sk#303)) AND isnotnull(cs_ship_mode_sk#301))
                                                               :                    :                    :                    :                 +- InputAdapter [#305, #303, #301, #307, #211, #210, #236]
                                                               :                    :                    :                    :                    +- NativeParquetScan  (FileScan parquet [cs_sold_date_sk#305,cs_sold_time_sk#303,cs_ship_mode_sk#301,cs_warehouse_sk#307,cs_quantity#211,cs_sales_price#210,cs_net_paid_inc_tax#236] Batched: true, DataFilters: [isnotnull(cs_warehouse_sk#307), isnotnull(cs_sold_date_sk#305), isnotnull(cs_sold_time_sk#303..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cs_warehouse_sk), IsNotNull(cs_sold_date_sk), IsNotNull(cs_sold_time_sk), IsNotNull(cs..., ReadSchema: struct<cs_sold_date_sk:int,cs_sold_time_sk:int,cs_ship_mode_sk:int,cs_warehouse_sk:int,cs_quantit...)
                                                               :                    :                    :                    +- NativeSort [w_warehouse_sk#308 ASC NULLS FIRST], false
                                                               :                    :                    :                       +- InputAdapter
                                                               :                    :                    :                          +- InputAdapter [#308, #200, #201, #202, #203, #204, #205]
                                                               :                    :                    :                             +- AQEShuffleRead coalesced
                                                               :                    :                    :                                +- ShuffleQueryStage X
                                                               :                    :                    :                                   +- ReusedExchange [w_warehouse_sk#308, w_warehouse_name#200, w_warehouse_sq_ft#201, w_city#202, w_county#203, w_state#204, w_country#205], NativeShuffleExchange hashpartitioning(w_warehouse_sk#197, 100), ENSURE_REQUIREMENTS, [plan_id=7]
                                                               :                    :                    +- NativeSort [d_date_sk#306 ASC NULLS FIRST], false
                                                               :                    :                       +- InputAdapter
                                                               :                    :                          +- InputAdapter [#306, #207, #209]
                                                               :                    :                             +- AQEShuffleRead coalesced
                                                               :                    :                                +- ShuffleQueryStage X
                                                               :                    :                                   +- ReusedExchange [d_date_sk#306, d_year#207, d_moy#209], NativeShuffleExchange hashpartitioning(d_date_sk#195, 100), ENSURE_REQUIREMENTS, [plan_id=8]
                                                               :                    +- NativeSort [t_time_sk#304 ASC NULLS FIRST], false
                                                               :                       +- InputAdapter
                                                               :                          +- InputAdapter [#304]
                                                               :                             +- AQEShuffleRead coalesced
                                                               :                                +- ShuffleQueryStage X
                                                               :                                   +- ReusedExchange [t_time_sk#304], NativeShuffleExchange hashpartitioning(t_time_sk#193, 100), ENSURE_REQUIREMENTS, [plan_id=9]
                                                               +- NativeSort [sm_ship_mode_sk#302 ASC NULLS FIRST], false
                                                                  +- InputAdapter
                                                                     +- InputAdapter [#302]
                                                                        +- AQEShuffleRead coalesced
                                                                           +- ShuffleQueryStage X
                                                                              +- ReusedExchange [sm_ship_mode_sk#302], NativeShuffleExchange hashpartitioning(sm_ship_mode_sk#191, 100), ENSURE_REQUIREMENTS, [plan_id=10]
+- == Initial Plan ==
   TakeOrderedAndProject(limit=100, orderBy=[w_warehouse_name#1 ASC NULLS FIRST], output=[w_warehouse_name#1,w_warehouse_sq_ft#2,w_city#3,w_county#4,w_state#5,w_country#6,ship_carriers#7,year#8,jan_sales#11,feb_sales#14,mar_sales#17,apr_sales#20,may_sales#23,jun_sales#26,jul_sales#29,aug_sales#32,sep_sales#35,oct_sales#38,nov_sales#41,dec_sales#44,jan_sales_per_sq_foot#46,feb_sales_per_sq_foot#48,mar_sales_per_sq_foot#50,apr_sales_per_sq_foot#52,... 20 more fields])
   +- HashAggregate(keys=[w_warehouse_name#1, w_warehouse_sq_ft#2, w_city#3, w_county#4, w_state#5, w_country#6, ship_carriers#7, year#8], functions=[sum(jan_sales#9), sum(feb_sales#12), sum(mar_sales#15), sum(apr_sales#18), sum(may_sales#21), sum(jun_sales#24), sum(jul_sales#27), sum(aug_sales#30), sum(sep_sales#33), sum(oct_sales#36), sum(nov_sales#39), sum(dec_sales#42), sum((jan_sales#9 / cast(w_warehouse_sq_ft#2 as decimal(10,0)))), sum((feb_sales#12 / cast(w_warehouse_sq_ft#2 as decimal(10,0)))), sum((mar_sales#15 / cast(w_warehouse_sq_ft#2 as decimal(10,0)))), sum((apr_sales#18 / cast(w_warehouse_sq_ft#2 as decimal(10,0)))), sum((may_sales#21 / cast(w_warehouse_sq_ft#2 as decimal(10,0)))), sum((jun_sales#24 / cast(w_warehouse_sq_ft#2 as decimal(10,0)))), sum((jul_sales#27 / cast(w_warehouse_sq_ft#2 as decimal(10,0)))), sum((aug_sales#30 / cast(w_warehouse_sq_ft#2 as decimal(10,0)))), sum((sep_sales#33 / cast(w_warehouse_sq_ft#2 as decimal(10,0)))), sum((oct_sales#36 / cast(w_warehouse_sq_ft#2 as decimal(10,0)))), sum((nov_sales#39 / cast(w_warehouse_sq_ft#2 as decimal(10,0)))), sum((dec_sales#42 / cast(w_warehouse_sq_ft#2 as decimal(10,0)))), ... 12 more fields], output=[w_warehouse_name#1, w_warehouse_sq_ft#2, w_city#3, w_county#4, w_state#5, w_country#6, ship_carriers#7, year#8, jan_sales#11, feb_sales#14, mar_sales#17, apr_sales#20, may_sales#23, jun_sales#26, jul_sales#29, aug_sales#32, sep_sales#35, oct_sales#38, nov_sales#41, dec_sales#44, jan_sales_per_sq_foot#46, feb_sales_per_sq_foot#48, mar_sales_per_sq_foot#50, apr_sales_per_sq_foot#52, ... 20 more fields])
      +- Exchange hashpartitioning(w_warehouse_name#1, w_warehouse_sq_ft#2, w_city#3, w_county#4, w_state#5, w_country#6, ship_carriers#7, year#8, 100), ENSURE_REQUIREMENTS, [plan_id=16]
         +- HashAggregate(keys=[w_warehouse_name#1, w_warehouse_sq_ft#2, w_city#3, w_county#4, w_state#5, w_country#6, ship_carriers#7, year#8], functions=[partial_sum(jan_sales#9), partial_sum(feb_sales#12), partial_sum(mar_sales#15), partial_sum(apr_sales#18), partial_sum(may_sales#21), partial_sum(jun_sales#24), partial_sum(jul_sales#27), partial_sum(aug_sales#30), partial_sum(sep_sales#33), partial_sum(oct_sales#36), partial_sum(nov_sales#39), partial_sum(dec_sales#42), partial_sum((jan_sales#9 / cast(w_warehouse_sq_ft#2 as decimal(10,0)))), partial_sum((feb_sales#12 / cast(w_warehouse_sq_ft#2 as decimal(10,0)))), partial_sum((mar_sales#15 / cast(w_warehouse_sq_ft#2 as decimal(10,0)))), partial_sum((apr_sales#18 / cast(w_warehouse_sq_ft#2 as decimal(10,0)))), partial_sum((may_sales#21 / cast(w_warehouse_sq_ft#2 as decimal(10,0)))), partial_sum((jun_sales#24 / cast(w_warehouse_sq_ft#2 as decimal(10,0)))), partial_sum((jul_sales#27 / cast(w_warehouse_sq_ft#2 as decimal(10,0)))), partial_sum((aug_sales#30 / cast(w_warehouse_sq_ft#2 as decimal(10,0)))), partial_sum((sep_sales#33 / cast(w_warehouse_sq_ft#2 as decimal(10,0)))), partial_sum((oct_sales#36 / cast(w_warehouse_sq_ft#2 as decimal(10,0)))), partial_sum((nov_sales#39 / cast(w_warehouse_sq_ft#2 as decimal(10,0)))), partial_sum((dec_sales#42 / cast(w_warehouse_sq_ft#2 as decimal(10,0)))), ... 12 more fields], output=[w_warehouse_name#1, w_warehouse_sq_ft#2, w_city#3, w_county#4, w_state#5, w_country#6, ship_carriers#7, year#8, sum#309, isEmpty#310, sum#311, isEmpty#312, sum#313, isEmpty#314, sum#315, isEmpty#316, sum#317, isEmpty#318, sum#319, isEmpty#320, sum#321, isEmpty#322, sum#323, isEmpty#324, ... 56 more fields])
            +- Union
               :- HashAggregate(keys=[w_warehouse_name#1, w_warehouse_sq_ft#2, w_city#3, w_county#4, w_state#5, w_country#6, d_year#113], functions=[sum(CASE WHEN (d_moy#114 = 1) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#114 = 2) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#114 = 3) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#114 = 4) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#114 = 5) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#114 = 6) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#114 = 7) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#114 = 8) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#114 = 9) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#114 = 10) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#114 = 11) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#114 = 12) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#114 = 1) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#114 = 2) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#114 = 3) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#114 = 4) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#114 = 5) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#114 = 6) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#114 = 7) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#114 = 8) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#114 = 9) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#114 = 10) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#114 = 11) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#114 = 12) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END)], output=[w_warehouse_name#1, w_warehouse_sq_ft#2, w_city#3, w_county#4, w_state#5, w_country#6, ship_carriers#7, year#8, jan_sales#9, feb_sales#12, mar_sales#15, apr_sales#18, may_sales#21, jun_sales#24, jul_sales#27, aug_sales#30, sep_sales#33, oct_sales#36, nov_sales#39, dec_sales#42, jan_net#109, feb_net#110, mar_net#111, apr_net#112, ... 8 more fields])
               :  +- Exchange hashpartitioning(w_warehouse_name#1, w_warehouse_sq_ft#2, w_city#3, w_county#4, w_state#5, w_country#6, d_year#113, 100), ENSURE_REQUIREMENTS, [plan_id=17]
               :     +- HashAggregate(keys=[w_warehouse_name#1, w_warehouse_sq_ft#2, w_city#3, w_county#4, w_state#5, w_country#6, d_year#113], functions=[partial_sum(CASE WHEN (d_moy#114 = 1) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#114 = 2) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#114 = 3) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#114 = 4) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#114 = 5) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#114 = 6) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#114 = 7) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#114 = 8) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#114 = 9) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#114 = 10) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#114 = 11) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#114 = 12) THEN (ws_ext_sales_price#115 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#114 = 1) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#114 = 2) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#114 = 3) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#114 = 4) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#114 = 5) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#114 = 6) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#114 = 7) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#114 = 8) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#114 = 9) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#114 = 10) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#114 = 11) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#114 = 12) THEN (ws_net_paid#129 * cast(ws_quantity#116 as decimal(10,0))) ELSE 0.00 END)], output=[w_warehouse_name#1, w_warehouse_sq_ft#2, w_city#3, w_county#4, w_state#5, w_country#6, d_year#113, sum#325, isEmpty#326, sum#327, isEmpty#328, sum#329, isEmpty#330, sum#331, isEmpty#332, sum#333, isEmpty#334, sum#335, isEmpty#336, sum#337, isEmpty#338, sum#339, isEmpty#340, sum#341, ... 31 more fields])
               :        +- Project [ws_quantity#116, ws_ext_sales_price#115, ws_net_paid#129, w_warehouse_name#1, w_warehouse_sq_ft#2, w_city#3, w_county#4, w_state#5, w_country#6, d_year#113, d_moy#114]
               :           +- SortMergeJoin [ws_ship_mode_sk#190], [sm_ship_mode_sk#191], Inner
               :              :- Sort [ws_ship_mode_sk#190 ASC NULLS FIRST], false, 0
               :              :  +- Exchange hashpartitioning(ws_ship_mode_sk#190, 100), ENSURE_REQUIREMENTS, [plan_id=18]
               :              :     +- Project [ws_ship_mode_sk#190, ws_quantity#116, ws_ext_sales_price#115, ws_net_paid#129, w_warehouse_name#1, w_warehouse_sq_ft#2, w_city#3, w_county#4, w_state#5, w_country#6, d_year#113, d_moy#114]
               :              :        +- SortMergeJoin [ws_sold_time_sk#192], [t_time_sk#193], Inner
               :              :           :- Sort [ws_sold_time_sk#192 ASC NULLS FIRST], false, 0
               :              :           :  +- Exchange hashpartitioning(ws_sold_time_sk#192, 100), ENSURE_REQUIREMENTS, [plan_id=19]
               :              :           :     +- Project [ws_sold_time_sk#192, ws_ship_mode_sk#190, ws_quantity#116, ws_ext_sales_price#115, ws_net_paid#129, w_warehouse_name#1, w_warehouse_sq_ft#2, w_city#3, w_county#4, w_state#5, w_country#6, d_year#113, d_moy#114]
               :              :           :        +- SortMergeJoin [ws_sold_date_sk#194], [d_date_sk#195], Inner
               :              :           :           :- Sort [ws_sold_date_sk#194 ASC NULLS FIRST], false, 0
               :              :           :           :  +- Exchange hashpartitioning(ws_sold_date_sk#194, 100), ENSURE_REQUIREMENTS, [plan_id=20]
               :              :           :           :     +- Project [ws_sold_date_sk#194, ws_sold_time_sk#192, ws_ship_mode_sk#190, ws_quantity#116, ws_ext_sales_price#115, ws_net_paid#129, w_warehouse_name#1, w_warehouse_sq_ft#2, w_city#3, w_county#4, w_state#5, w_country#6]
               :              :           :           :        +- SortMergeJoin [ws_warehouse_sk#196], [w_warehouse_sk#197], Inner
               :              :           :           :           :- Sort [ws_warehouse_sk#196 ASC NULLS FIRST], false, 0
               :              :           :           :           :  +- Exchange hashpartitioning(ws_warehouse_sk#196, 100), ENSURE_REQUIREMENTS, [plan_id=21]
               :              :           :           :           :     +- Filter (((isnotnull(ws_warehouse_sk#196) AND isnotnull(ws_sold_date_sk#194)) AND isnotnull(ws_sold_time_sk#192)) AND isnotnull(ws_ship_mode_sk#190))
               :              :           :           :           :        +- FileScan parquet [ws_sold_date_sk#194,ws_sold_time_sk#192,ws_ship_mode_sk#190,ws_warehouse_sk#196,ws_quantity#116,ws_ext_sales_price#115,ws_net_paid#129] Batched: true, DataFilters: [isnotnull(ws_warehouse_sk#196), isnotnull(ws_sold_date_sk#194), isnotnull(ws_sold_time_sk#192..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ws_warehouse_sk), IsNotNull(ws_sold_date_sk), IsNotNull(ws_sold_time_sk), IsNotNull(ws..., ReadSchema: struct<ws_sold_date_sk:int,ws_sold_time_sk:int,ws_ship_mode_sk:int,ws_warehouse_sk:int,ws_quantit...
               :              :           :           :           +- Sort [w_warehouse_sk#197 ASC NULLS FIRST], false, 0
               :              :           :           :              +- Exchange hashpartitioning(w_warehouse_sk#197, 100), ENSURE_REQUIREMENTS, [plan_id=22]
               :              :           :           :                 +- Filter isnotnull(w_warehouse_sk#197)
               :              :           :           :                    +- FileScan parquet [w_warehouse_sk#197,w_warehouse_name#1,w_warehouse_sq_ft#2,w_city#3,w_county#4,w_state#5,w_country#6] Batched: true, DataFilters: [isnotnull(w_warehouse_sk#197)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(w_warehouse_sk)], ReadSchema: struct<w_warehouse_sk:int,w_warehouse_name:string,w_warehouse_sq_ft:int,w_city:string,w_county:st...
               :              :           :           +- Sort [d_date_sk#195 ASC NULLS FIRST], false, 0
               :              :           :              +- Exchange hashpartitioning(d_date_sk#195, 100), ENSURE_REQUIREMENTS, [plan_id=23]
               :              :           :                 +- Filter ((isnotnull(d_year#113) AND (d_year#113 = 2001)) AND isnotnull(d_date_sk#195))
               :              :           :                    +- FileScan parquet [d_date_sk#195,d_year#113,d_moy#114] Batched: true, DataFilters: [isnotnull(d_year#113), (d_year#113 = 2001), isnotnull(d_date_sk#195)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2001), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_moy:int>
               :              :           +- Sort [t_time_sk#193 ASC NULLS FIRST], false, 0
               :              :              +- Exchange hashpartitioning(t_time_sk#193, 100), ENSURE_REQUIREMENTS, [plan_id=24]
               :              :                 +- Project [t_time_sk#193]
               :              :                    +- Filter (((isnotnull(t_time#198) AND (t_time#198 >= 30838)) AND (t_time#198 <= 59638)) AND isnotnull(t_time_sk#193))
               :              :                       +- FileScan parquet [t_time_sk#193,t_time#198] Batched: true, DataFilters: [isnotnull(t_time#198), (t_time#198 >= 30838), (t_time#198 <= 59638), isnotnull(t_time_sk#193)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(t_time), GreaterThanOrEqual(t_time,30838), LessThanOrEqual(t_time,59638), IsNotNull(t_..., ReadSchema: struct<t_time_sk:int,t_time:int>
               :              +- Sort [sm_ship_mode_sk#191 ASC NULLS FIRST], false, 0
               :                 +- Exchange hashpartitioning(sm_ship_mode_sk#191, 100), ENSURE_REQUIREMENTS, [plan_id=25]
               :                    +- Project [sm_ship_mode_sk#191]
               :                       +- Filter (sm_carrier#199 IN (DHL,BARIAN) AND isnotnull(sm_ship_mode_sk#191))
               :                          +- FileScan parquet [sm_ship_mode_sk#191,sm_carrier#199] Batched: true, DataFilters: [sm_carrier#199 IN (DHL,BARIAN), isnotnull(sm_ship_mode_sk#191)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [In(sm_carrier, [BARIAN,DHL]), IsNotNull(sm_ship_mode_sk)], ReadSchema: struct<sm_ship_mode_sk:int,sm_carrier:string>
               +- HashAggregate(keys=[w_warehouse_name#200, w_warehouse_sq_ft#201, w_city#202, w_county#203, w_state#204, w_country#205, d_year#207], functions=[sum(CASE WHEN (d_moy#209 = 1) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#209 = 2) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#209 = 3) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#209 = 4) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#209 = 5) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#209 = 6) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#209 = 7) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#209 = 8) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#209 = 9) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#209 = 10) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#209 = 11) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#209 = 12) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#209 = 1) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#209 = 2) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#209 = 3) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#209 = 4) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#209 = 5) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#209 = 6) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#209 = 7) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#209 = 8) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#209 = 9) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#209 = 10) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#209 = 11) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), sum(CASE WHEN (d_moy#209 = 12) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END)], output=[w_warehouse_name#200, w_warehouse_sq_ft#201, w_city#202, w_county#203, w_state#204, w_country#205, ship_carriers#206, year#208, jan_sales#213, feb_sales#215, mar_sales#217, apr_sales#219, may_sales#221, jun_sales#223, jul_sales#225, aug_sales#227, sep_sales#229, oct_sales#231, nov_sales#233, dec_sales#235, jan_net#238, feb_net#240, mar_net#242, apr_net#244, ... 8 more fields])
                  +- Exchange hashpartitioning(w_warehouse_name#200, w_warehouse_sq_ft#201, w_city#202, w_county#203, w_state#204, w_country#205, d_year#207, 100), ENSURE_REQUIREMENTS, [plan_id=26]
                     +- HashAggregate(keys=[w_warehouse_name#200, w_warehouse_sq_ft#201, w_city#202, w_county#203, w_state#204, w_country#205, d_year#207], functions=[partial_sum(CASE WHEN (d_moy#209 = 1) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#209 = 2) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#209 = 3) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#209 = 4) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#209 = 5) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#209 = 6) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#209 = 7) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#209 = 8) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#209 = 9) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#209 = 10) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#209 = 11) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#209 = 12) THEN (cs_sales_price#210 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#209 = 1) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#209 = 2) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#209 = 3) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#209 = 4) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#209 = 5) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#209 = 6) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#209 = 7) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#209 = 8) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#209 = 9) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#209 = 10) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#209 = 11) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#209 = 12) THEN (cs_net_paid_inc_tax#236 * cast(cs_quantity#211 as decimal(10,0))) ELSE 0.00 END)], output=[w_warehouse_name#200, w_warehouse_sq_ft#201, w_city#202, w_county#203, w_state#204, w_country#205, d_year#207, sum#342, isEmpty#343, sum#344, isEmpty#345, sum#346, isEmpty#347, sum#348, isEmpty#349, sum#350, isEmpty#351, sum#352, isEmpty#353, sum#354, isEmpty#355, sum#356, isEmpty#357, sum#358, ... 31 more fields])
                        +- Project [cs_quantity#211, cs_sales_price#210, cs_net_paid_inc_tax#236, w_warehouse_name#200, w_warehouse_sq_ft#201, w_city#202, w_county#203, w_state#204, w_country#205, d_year#207, d_moy#209]
                           +- SortMergeJoin [cs_ship_mode_sk#301], [sm_ship_mode_sk#302], Inner
                              :- Sort [cs_ship_mode_sk#301 ASC NULLS FIRST], false, 0
                              :  +- Exchange hashpartitioning(cs_ship_mode_sk#301, 100), ENSURE_REQUIREMENTS, [plan_id=27]
                              :     +- Project [cs_ship_mode_sk#301, cs_quantity#211, cs_sales_price#210, cs_net_paid_inc_tax#236, w_warehouse_name#200, w_warehouse_sq_ft#201, w_city#202, w_county#203, w_state#204, w_country#205, d_year#207, d_moy#209]
                              :        +- SortMergeJoin [cs_sold_time_sk#303], [t_time_sk#304], Inner
                              :           :- Sort [cs_sold_time_sk#303 ASC NULLS FIRST], false, 0
                              :           :  +- Exchange hashpartitioning(cs_sold_time_sk#303, 100), ENSURE_REQUIREMENTS, [plan_id=28]
                              :           :     +- Project [cs_sold_time_sk#303, cs_ship_mode_sk#301, cs_quantity#211, cs_sales_price#210, cs_net_paid_inc_tax#236, w_warehouse_name#200, w_warehouse_sq_ft#201, w_city#202, w_county#203, w_state#204, w_country#205, d_year#207, d_moy#209]
                              :           :        +- SortMergeJoin [cs_sold_date_sk#305], [d_date_sk#306], Inner
                              :           :           :- Sort [cs_sold_date_sk#305 ASC NULLS FIRST], false, 0
                              :           :           :  +- Exchange hashpartitioning(cs_sold_date_sk#305, 100), ENSURE_REQUIREMENTS, [plan_id=29]
                              :           :           :     +- Project [cs_sold_date_sk#305, cs_sold_time_sk#303, cs_ship_mode_sk#301, cs_quantity#211, cs_sales_price#210, cs_net_paid_inc_tax#236, w_warehouse_name#200, w_warehouse_sq_ft#201, w_city#202, w_county#203, w_state#204, w_country#205]
                              :           :           :        +- SortMergeJoin [cs_warehouse_sk#307], [w_warehouse_sk#308], Inner
                              :           :           :           :- Sort [cs_warehouse_sk#307 ASC NULLS FIRST], false, 0
                              :           :           :           :  +- Exchange hashpartitioning(cs_warehouse_sk#307, 100), ENSURE_REQUIREMENTS, [plan_id=30]
                              :           :           :           :     +- Filter (((isnotnull(cs_warehouse_sk#307) AND isnotnull(cs_sold_date_sk#305)) AND isnotnull(cs_sold_time_sk#303)) AND isnotnull(cs_ship_mode_sk#301))
                              :           :           :           :        +- FileScan parquet [cs_sold_date_sk#305,cs_sold_time_sk#303,cs_ship_mode_sk#301,cs_warehouse_sk#307,cs_quantity#211,cs_sales_price#210,cs_net_paid_inc_tax#236] Batched: true, DataFilters: [isnotnull(cs_warehouse_sk#307), isnotnull(cs_sold_date_sk#305), isnotnull(cs_sold_time_sk#303..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cs_warehouse_sk), IsNotNull(cs_sold_date_sk), IsNotNull(cs_sold_time_sk), IsNotNull(cs..., ReadSchema: struct<cs_sold_date_sk:int,cs_sold_time_sk:int,cs_ship_mode_sk:int,cs_warehouse_sk:int,cs_quantit...
                              :           :           :           +- Sort [w_warehouse_sk#308 ASC NULLS FIRST], false, 0
                              :           :           :              +- Exchange hashpartitioning(w_warehouse_sk#308, 100), ENSURE_REQUIREMENTS, [plan_id=31]
                              :           :           :                 +- Filter isnotnull(w_warehouse_sk#308)
                              :           :           :                    +- FileScan parquet [w_warehouse_sk#308,w_warehouse_name#200,w_warehouse_sq_ft#201,w_city#202,w_county#203,w_state#204,w_country#205] Batched: true, DataFilters: [isnotnull(w_warehouse_sk#308)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(w_warehouse_sk)], ReadSchema: struct<w_warehouse_sk:int,w_warehouse_name:string,w_warehouse_sq_ft:int,w_city:string,w_county:st...
                              :           :           +- Sort [d_date_sk#306 ASC NULLS FIRST], false, 0
                              :           :              +- Exchange hashpartitioning(d_date_sk#306, 100), ENSURE_REQUIREMENTS, [plan_id=32]
                              :           :                 +- Filter ((isnotnull(d_year#207) AND (d_year#207 = 2001)) AND isnotnull(d_date_sk#306))
                              :           :                    +- FileScan parquet [d_date_sk#306,d_year#207,d_moy#209] Batched: true, DataFilters: [isnotnull(d_year#207), (d_year#207 = 2001), isnotnull(d_date_sk#306)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2001), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_moy:int>
                              :           +- Sort [t_time_sk#304 ASC NULLS FIRST], false, 0
                              :              +- Exchange hashpartitioning(t_time_sk#304, 100), ENSURE_REQUIREMENTS, [plan_id=33]
                              :                 +- Project [t_time_sk#304]
                              :                    +- Filter (((isnotnull(t_time#359) AND (t_time#359 >= 30838)) AND (t_time#359 <= 59638)) AND isnotnull(t_time_sk#304))
                              :                       +- FileScan parquet [t_time_sk#304,t_time#359] Batched: true, DataFilters: [isnotnull(t_time#359), (t_time#359 >= 30838), (t_time#359 <= 59638), isnotnull(t_time_sk#360..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(t_time), GreaterThanOrEqual(t_time,30838), LessThanOrEqual(t_time,59638), IsNotNull(t_..., ReadSchema: struct<t_time_sk:int,t_time:int>
                              +- Sort [sm_ship_mode_sk#302 ASC NULLS FIRST], false, 0
                                 +- Exchange hashpartitioning(sm_ship_mode_sk#302, 100), ENSURE_REQUIREMENTS, [plan_id=34]
                                    +- Project [sm_ship_mode_sk#302]
                                       +- Filter (sm_carrier#361 IN (DHL,BARIAN) AND isnotnull(sm_ship_mode_sk#302))
                                          +- FileScan parquet [sm_ship_mode_sk#302,sm_carrier#361] Batched: true, DataFilters: [sm_carrier#361 IN (DHL,BARIAN), isnotnull(sm_ship_mode_sk#302)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [In(sm_carrier, [BARIAN,DHL]), IsNotNull(sm_ship_mode_sk)], ReadSchema: struct<sm_ship_mode_sk:int,sm_carrier:string>
