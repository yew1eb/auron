AdaptiveSparkPlan isFinalPlan=true
+- == Final Plan ==
   NativeProject [i_item_desc#1, i_category#2, i_class#3, i_current_price#4, itemrevenue#5, revenueratio#6]
   +- NativeSort [i_category#2 ASC NULLS FIRST, i_class#3 ASC NULLS FIRST, i_item_id#7 ASC NULLS FIRST, i_item_desc#1 ASC NULLS FIRST, revenueratio#6 ASC NULLS FIRST], true
      +- ConvertToNative
         +- AQEShuffleRead coalesced
            +- ShuffleQueryStage X
               +- Exchange rangepartitioning(i_category#2 ASC NULLS FIRST, i_class#3 ASC NULLS FIRST, i_item_id#7 ASC NULLS FIRST, i_item_desc#1 ASC NULLS FIRST, revenueratio#6 ASC NULLS FIRST, 100), ENSURE_REQUIREMENTS, [plan_id=1]
                  +- *(1) Project [i_item_desc#1, i_category#2, i_class#3, i_current_price#4, itemrevenue#5, ((_w0#8 * 100) / _we0#9) AS revenueratio#6, i_item_id#7]
                     +- Window [sum(_w0#8) windowspecdefinition(i_class#3, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS _we0#9], [i_class#3]
                        +- NativeSort [i_class#3 ASC NULLS FIRST], false
                           +- InputAdapter
                              +- AQEShuffleRead coalesced
                                 +- ShuffleQueryStage X
                                    +- NativeShuffleExchange hashpartitioning(i_class#3, 100), ENSURE_REQUIREMENTS, [plan_id=2]
                                       +- NativeProject [i_item_desc#1, i_category#2, i_class#3, i_current_price#4, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#10))#11,17,2) AS itemrevenue#5, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#10))#11,17,2) AS _w0#8, i_item_id#7]
                                          +- NativeHashAggregate HashAgg, ArrayBuffer(i_item_id#7, i_item_desc#1, i_category#2, i_class#3, i_current_price#4), [i_item_id#7, i_item_desc#1, i_category#2, i_class#3, i_current_price#4], [sum(UnscaledValue(ss_ext_sales_price#10))], [sum(UnscaledValue(ss_ext_sales_price#10))#11], 5
                                             +- InputAdapter
                                                +- AQEShuffleRead coalesced
                                                   +- ShuffleQueryStage X
                                                      +- NativeShuffleExchange hashpartitioning(i_item_id#7, i_item_desc#1, i_category#2, i_class#3, i_current_price#4, 100), ENSURE_REQUIREMENTS, [plan_id=3]
                                                         +- NativeHashAggregate HashAgg, [i_item_id#7, i_item_desc#1, i_category#2, i_class#3, i_current_price#4], [partial_sum(_c5#12)], [sum#13], 0
                                                            +- NativeProject [i_item_id#7 AS i_item_id#7, i_item_desc#1 AS i_item_desc#1, i_category#2 AS i_category#2, i_class#3 AS i_class#3, i_current_price#4 AS i_current_price#4, UnscaledValue(ss_ext_sales_price#10) AS _c5#12]
                                                               +- NativeProject [ss_ext_sales_price#10, i_item_id#7, i_item_desc#1, i_current_price#4, i_class#3, i_category#2]
                                                                  +- NativeSortMergeJoin [ss_sold_date_sk#14], [d_date_sk#15], Inner
                                                                     :- NativeSort [ss_sold_date_sk#14 ASC NULLS FIRST], false
                                                                     :  +- InputAdapter
                                                                     :     +- AQEShuffleRead coalesced
                                                                     :        +- ShuffleQueryStage X
                                                                     :           +- NativeShuffleExchange hashpartitioning(ss_sold_date_sk#14, 100), ENSURE_REQUIREMENTS, [plan_id=4]
                                                                     :              +- NativeProject [ss_sold_date_sk#14, ss_ext_sales_price#10, i_item_id#7, i_item_desc#1, i_current_price#4, i_class#3, i_category#2]
                                                                     :                 +- NativeSortMergeJoin [ss_item_sk#16], [i_item_sk#17], Inner
                                                                     :                    :- NativeSort [ss_item_sk#16 ASC NULLS FIRST], false
                                                                     :                    :  +- InputAdapter
                                                                     :                    :     +- AQEShuffleRead coalesced
                                                                     :                    :        +- ShuffleQueryStage X
                                                                     :                    :           +- NativeShuffleExchange hashpartitioning(ss_item_sk#16, 100), ENSURE_REQUIREMENTS, [plan_id=5]
                                                                     :                    :              +- NativeFilter (isnotnull(ss_item_sk#16) AND isnotnull(ss_sold_date_sk#14))
                                                                     :                    :                 +- InputAdapter [#14, #16, #10]
                                                                     :                    :                    +- NativeParquetScan  (FileScan parquet [ss_sold_date_sk#14,ss_item_sk#16,ss_ext_sales_price#10] Batched: true, DataFilters: [isnotnull(ss_item_sk#16), isnotnull(ss_sold_date_sk#14)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_ext_sales_price:decimal(7,2)>)
                                                                     :                    +- NativeSort [i_item_sk#17 ASC NULLS FIRST], false
                                                                     :                       +- InputAdapter
                                                                     :                          +- AQEShuffleRead coalesced
                                                                     :                             +- ShuffleQueryStage X
                                                                     :                                +- NativeShuffleExchange hashpartitioning(i_item_sk#17, 100), ENSURE_REQUIREMENTS, [plan_id=6]
                                                                     :                                   +- NativeFilter (i_category#2 IN (Sports,Books,Home) AND isnotnull(i_item_sk#17))
                                                                     :                                      +- InputAdapter [#17, #7, #1, #4, #3, #2]
                                                                     :                                         +- NativeParquetScan  (FileScan parquet [i_item_sk#17,i_item_id#7,i_item_desc#1,i_current_price#4,i_class#3,i_category#2] Batched: true, DataFilters: [i_category#2 IN (Sports,Books,Home), isnotnull(i_item_sk#17)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [In(i_category, [Books,Home,Sports]), IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_item_id:string,i_item_desc:string,i_current_price:decimal(7,2),i_class:str...)
                                                                     +- NativeSort [d_date_sk#15 ASC NULLS FIRST], false
                                                                        +- InputAdapter
                                                                           +- AQEShuffleRead coalesced
                                                                              +- ShuffleQueryStage X
                                                                                 +- NativeShuffleExchange hashpartitioning(d_date_sk#15, 100), ENSURE_REQUIREMENTS, [plan_id=7]
                                                                                    +- NativeProject [d_date_sk#15]
                                                                                       +- NativeFilter (((isnotnull(d_date#18) AND (d_date#18 >= 1999-02-22)) AND (d_date#18 <= 1999-03-24)) AND isnotnull(d_date_sk#15))
                                                                                          +- InputAdapter [#15, #18]
                                                                                             +- NativeParquetScan  (FileScan parquet [d_date_sk#15,d_date#18] Batched: true, DataFilters: [isnotnull(d_date#18), (d_date#18 >= 1999-02-22), (d_date#18 <= 1999-03-24), isnotnull(d..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_date), GreaterThanOrEqual(d_date,1999-02-22), LessThanOrEqual(d_date,1999-03-24), Is..., ReadSchema: struct<d_date_sk:int,d_date:date>)
+- == Initial Plan ==
   Project [i_item_desc#1, i_category#2, i_class#3, i_current_price#4, itemrevenue#5, revenueratio#6]
   +- Sort [i_category#2 ASC NULLS FIRST, i_class#3 ASC NULLS FIRST, i_item_id#7 ASC NULLS FIRST, i_item_desc#1 ASC NULLS FIRST, revenueratio#6 ASC NULLS FIRST], true, 0
      +- Exchange rangepartitioning(i_category#2 ASC NULLS FIRST, i_class#3 ASC NULLS FIRST, i_item_id#7 ASC NULLS FIRST, i_item_desc#1 ASC NULLS FIRST, revenueratio#6 ASC NULLS FIRST, 100), ENSURE_REQUIREMENTS, [plan_id=8]
         +- Project [i_item_desc#1, i_category#2, i_class#3, i_current_price#4, itemrevenue#5, ((_w0#8 * 100) / _we0#9) AS revenueratio#6, i_item_id#7]
            +- Window [sum(_w0#8) windowspecdefinition(i_class#3, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS _we0#9], [i_class#3]
               +- Sort [i_class#3 ASC NULLS FIRST], false, 0
                  +- Exchange hashpartitioning(i_class#3, 100), ENSURE_REQUIREMENTS, [plan_id=9]
                     +- HashAggregate(keys=[i_item_id#7, i_item_desc#1, i_category#2, i_class#3, i_current_price#4], functions=[sum(UnscaledValue(ss_ext_sales_price#10))], output=[i_item_desc#1, i_category#2, i_class#3, i_current_price#4, itemrevenue#5, _w0#8, i_item_id#7])
                        +- Exchange hashpartitioning(i_item_id#7, i_item_desc#1, i_category#2, i_class#3, i_current_price#4, 100), ENSURE_REQUIREMENTS, [plan_id=10]
                           +- HashAggregate(keys=[i_item_id#7, i_item_desc#1, i_category#2, i_class#3, i_current_price#4], functions=[partial_sum(UnscaledValue(ss_ext_sales_price#10))], output=[i_item_id#7, i_item_desc#1, i_category#2, i_class#3, i_current_price#4, sum#19])
                              +- Project [ss_ext_sales_price#10, i_item_id#7, i_item_desc#1, i_current_price#4, i_class#3, i_category#2]
                                 +- SortMergeJoin [ss_sold_date_sk#14], [d_date_sk#15], Inner
                                    :- Sort [ss_sold_date_sk#14 ASC NULLS FIRST], false, 0
                                    :  +- Exchange hashpartitioning(ss_sold_date_sk#14, 100), ENSURE_REQUIREMENTS, [plan_id=11]
                                    :     +- Project [ss_sold_date_sk#14, ss_ext_sales_price#10, i_item_id#7, i_item_desc#1, i_current_price#4, i_class#3, i_category#2]
                                    :        +- SortMergeJoin [ss_item_sk#16], [i_item_sk#17], Inner
                                    :           :- Sort [ss_item_sk#16 ASC NULLS FIRST], false, 0
                                    :           :  +- Exchange hashpartitioning(ss_item_sk#16, 100), ENSURE_REQUIREMENTS, [plan_id=12]
                                    :           :     +- Filter (isnotnull(ss_item_sk#16) AND isnotnull(ss_sold_date_sk#14))
                                    :           :        +- FileScan parquet [ss_sold_date_sk#14,ss_item_sk#16,ss_ext_sales_price#10] Batched: true, DataFilters: [isnotnull(ss_item_sk#16), isnotnull(ss_sold_date_sk#14)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_ext_sales_price:decimal(7,2)>
                                    :           +- Sort [i_item_sk#17 ASC NULLS FIRST], false, 0
                                    :              +- Exchange hashpartitioning(i_item_sk#17, 100), ENSURE_REQUIREMENTS, [plan_id=13]
                                    :                 +- Filter (i_category#2 IN (Sports,Books,Home) AND isnotnull(i_item_sk#17))
                                    :                    +- FileScan parquet [i_item_sk#17,i_item_id#7,i_item_desc#1,i_current_price#4,i_class#3,i_category#2] Batched: true, DataFilters: [i_category#2 IN (Sports,Books,Home), isnotnull(i_item_sk#17)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [In(i_category, [Books,Home,Sports]), IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_item_id:string,i_item_desc:string,i_current_price:decimal(7,2),i_class:str...
                                    +- Sort [d_date_sk#15 ASC NULLS FIRST], false, 0
                                       +- Exchange hashpartitioning(d_date_sk#15, 100), ENSURE_REQUIREMENTS, [plan_id=14]
                                          +- Project [d_date_sk#15]
                                             +- Filter (((isnotnull(d_date#18) AND (d_date#18 >= 1999-02-22)) AND (d_date#18 <= 1999-03-24)) AND isnotnull(d_date_sk#15))
                                                +- FileScan parquet [d_date_sk#15,d_date#18] Batched: true, DataFilters: [isnotnull(d_date#18), (d_date#18 >= 1999-02-22), (d_date#18 <= 1999-03-24), isnotnull(d..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_date), GreaterThanOrEqual(d_date,1999-02-22), LessThanOrEqual(d_date,1999-03-24), Is..., ReadSchema: struct<d_date_sk:int,d_date:date>
