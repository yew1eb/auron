AdaptiveSparkPlan isFinalPlan=true
+- == Final Plan ==
   NativeTakeOrdered 100, [channel#1 ASC NULLS FIRST, id#2 ASC NULLS FIRST]
   +- NativeProject [channel#1, id#2, sum(sales#3)#4 AS sales#5, sum(returns#6)#7 AS returns#8, sum(profit#9)#10 AS profit#11]
      +- NativeHashAggregate HashAgg, Vector(channel#1, id#2, spark_grouping_id#12), [channel#1, id#2, spark_grouping_id#12], [sum(sales#3), sum(returns#6), sum(profit#9)], [sum(sales#3)#4, sum(returns#6)#7, sum(profit#9)#10], 3
         +- InputAdapter
            +- AQEShuffleRead coalesced
               +- ShuffleQueryStage X
                  +- NativeShuffleExchange hashpartitioning(channel#1, id#2, spark_grouping_id#12, 100), ENSURE_REQUIREMENTS, [plan_id=1]
                     +- NativeHashAggregate HashAgg, [channel#1, id#2, spark_grouping_id#12], [partial_sum(sales#3), partial_sum(returns#6), partial_sum(profit#9)], [sum#13, isEmpty#14, sum#15, isEmpty#16, sum#17, isEmpty#18], 0
                        +- !NativeExpand [[sales#3, returns#6, profit#9, channel#19, id#20, 0], [sales#3, returns#6, profit#9, channel#19, null, 1], [sales#3, returns#6, profit#9, null, null, 3]], [sales#3, returns#6, profit#9, channel#1, id#2, spark_grouping_id#12]
                           +- InputAdapter [#3, #6, #9, #19, #20]
                              +- NativeUnion [sales#3, returns#6, profit#9, channel#19, id#20]
                                 :- NativeProject [MakeDecimal(sum(UnscaledValue(sales_price#21))#22,17,2) AS sales#3, MakeDecimal(sum(UnscaledValue(return_amt#23))#24,17,2) AS returns#6, (MakeDecimal(sum(UnscaledValue(profit#25))#26,17,2) - MakeDecimal(sum(UnscaledValue(net_loss#27))#28,17,2)) AS profit#9, store channel AS channel#19, concat(store, s_store_id#29) AS id#20]
                                 :  +- NativeHashAggregate HashAgg, ArrayBuffer(s_store_id#29), [s_store_id#29], [sum(UnscaledValue(sales_price#21)), sum(UnscaledValue(return_amt#23)), sum(UnscaledValue(profit#25)), sum(UnscaledValue(net_loss#27))], [sum(UnscaledValue(sales_price#21))#22, sum(UnscaledValue(return_amt#23))#24, sum(UnscaledValue(profit#25))#26, sum(UnscaledValue(net_loss#27))#28], 1
                                 :     +- InputAdapter
                                 :        +- AQEShuffleRead coalesced
                                 :           +- ShuffleQueryStage X
                                 :              +- NativeShuffleExchange hashpartitioning(s_store_id#29, 100), ENSURE_REQUIREMENTS, [plan_id=2]
                                 :                 +- NativeHashAggregate HashAgg, [s_store_id#29], [partial_sum(_c1#30), partial_sum(_c2#31), partial_sum(_c3#32), partial_sum(_c4#33)], [sum#34, sum#35, sum#36, sum#37], 0
                                 :                    +- NativeProject [s_store_id#29 AS s_store_id#29, UnscaledValue(sales_price#21) AS _c1#30, UnscaledValue(return_amt#23) AS _c2#31, UnscaledValue(profit#25) AS _c3#32, UnscaledValue(net_loss#27) AS _c4#33]
                                 :                       +- NativeProject [sales_price#21, profit#25, return_amt#23, net_loss#27, s_store_id#29]
                                 :                          +- NativeSortMergeJoin [store_sk#38], [s_store_sk#39], Inner
                                 :                             :- NativeSort [store_sk#38 ASC NULLS FIRST], false
                                 :                             :  +- InputAdapter
                                 :                             :     +- AQEShuffleRead coalesced
                                 :                             :        +- ShuffleQueryStage X
                                 :                             :           +- NativeShuffleExchange hashpartitioning(store_sk#38, 100), ENSURE_REQUIREMENTS, [plan_id=3]
                                 :                             :              +- NativeProject [store_sk#38, sales_price#21, profit#25, return_amt#23, net_loss#27]
                                 :                             :                 +- NativeSortMergeJoin [date_sk#40], [d_date_sk#41], Inner
                                 :                             :                    :- NativeSort [date_sk#40 ASC NULLS FIRST], false
                                 :                             :                    :  +- InputAdapter
                                 :                             :                    :     +- AQEShuffleRead coalesced
                                 :                             :                    :        +- ShuffleQueryStage X
                                 :                             :                    :           +- NativeShuffleExchange hashpartitioning(date_sk#40, 100), ENSURE_REQUIREMENTS, [plan_id=4]
                                 :                             :                    :              +- InputAdapter [#38, #40, #21, #25, #23, #27]
                                 :                             :                    :                 +- NativeUnion [store_sk#38, date_sk#40, sales_price#21, profit#25, return_amt#23, net_loss#27]
                                 :                             :                    :                    :- NativeProject [ss_store_sk#42 AS store_sk#38, ss_sold_date_sk#43 AS date_sk#40, ss_ext_sales_price#44 AS sales_price#21, ss_net_profit#45 AS profit#25, 0.00 AS return_amt#23, 0.00 AS net_loss#27]
                                 :                             :                    :                    :  +- NativeFilter (isnotnull(ss_sold_date_sk#43) AND isnotnull(ss_store_sk#42))
                                 :                             :                    :                    :     +- InputAdapter [#43, #42, #44, #45]
                                 :                             :                    :                    :        +- NativeParquetScan  (FileScan parquet [ss_sold_date_sk#43,ss_store_sk#42,ss_ext_sales_price#44,ss_net_profit#45] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#43), isnotnull(ss_store_sk#42)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_store_sk:int,ss_ext_sales_price:decimal(7,2),ss_net_profit:decimal(...)
                                 :                             :                    :                    +- NativeProject [sr_store_sk#46 AS store_sk#47, sr_returned_date_sk#48 AS date_sk#49, 0.00 AS sales_price#50, 0.00 AS profit#51, sr_return_amt#52 AS return_amt#53, sr_net_loss#54 AS net_loss#55]
                                 :                             :                    :                       +- NativeFilter (isnotnull(sr_returned_date_sk#48) AND isnotnull(sr_store_sk#46))
                                 :                             :                    :                          +- InputAdapter [#48, #46, #52, #54]
                                 :                             :                    :                             +- NativeParquetScan  (FileScan parquet [sr_returned_date_sk#48,sr_store_sk#46,sr_return_amt#52,sr_net_loss#54] Batched: true, DataFilters: [isnotnull(sr_returned_date_sk#48), isnotnull(sr_store_sk#46)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(sr_returned_date_sk), IsNotNull(sr_store_sk)], ReadSchema: struct<sr_returned_date_sk:int,sr_store_sk:int,sr_return_amt:decimal(7,2),sr_net_loss:decimal(7,2)>)
                                 :                             :                    +- NativeSort [d_date_sk#41 ASC NULLS FIRST], false
                                 :                             :                       +- InputAdapter
                                 :                             :                          +- AQEShuffleRead coalesced
                                 :                             :                             +- ShuffleQueryStage X
                                 :                             :                                +- NativeShuffleExchange hashpartitioning(d_date_sk#41, 100), ENSURE_REQUIREMENTS, [plan_id=5]
                                 :                             :                                   +- NativeProject [d_date_sk#41]
                                 :                             :                                      +- NativeFilter (((isnotnull(d_date#56) AND (d_date#56 >= 2000-08-23)) AND (d_date#56 <= 2000-09-06)) AND isnotnull(d_date_sk#41))
                                 :                             :                                         +- InputAdapter [#41, #56]
                                 :                             :                                            +- NativeParquetScan  (FileScan parquet [d_date_sk#41,d_date#56] Batched: true, DataFilters: [isnotnull(d_date#56), (d_date#56 >= 2000-08-23), (d_date#56 <= 2000-09-06), isnotnull(d..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_date), GreaterThanOrEqual(d_date,2000-08-23), LessThanOrEqual(d_date,2000-09-06), Is..., ReadSchema: struct<d_date_sk:int,d_date:date>)
                                 :                             +- NativeSort [s_store_sk#39 ASC NULLS FIRST], false
                                 :                                +- InputAdapter
                                 :                                   +- AQEShuffleRead coalesced
                                 :                                      +- ShuffleQueryStage X
                                 :                                         +- NativeShuffleExchange hashpartitioning(s_store_sk#39, 100), ENSURE_REQUIREMENTS, [plan_id=6]
                                 :                                            +- NativeFilter isnotnull(s_store_sk#39)
                                 :                                               +- InputAdapter [#39, #29]
                                 :                                                  +- NativeParquetScan  (FileScan parquet [s_store_sk#39,s_store_id#29] Batched: true, DataFilters: [isnotnull(s_store_sk#39)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk)], ReadSchema: struct<s_store_sk:int,s_store_id:string>)
                                 :- NativeProject [MakeDecimal(sum(UnscaledValue(sales_price#57))#58,17,2) AS sales#59, MakeDecimal(sum(UnscaledValue(return_amt#60))#61,17,2) AS returns#62, (MakeDecimal(sum(UnscaledValue(profit#63))#64,17,2) - MakeDecimal(sum(UnscaledValue(net_loss#65))#66,17,2)) AS profit#67, catalog channel AS channel#68, concat(catalog_page, cp_catalog_page_id#69) AS id#70]
                                 :  +- NativeHashAggregate HashAgg, ArrayBuffer(cp_catalog_page_id#69), [cp_catalog_page_id#69], [sum(UnscaledValue(sales_price#57)), sum(UnscaledValue(return_amt#60)), sum(UnscaledValue(profit#63)), sum(UnscaledValue(net_loss#65))], [sum(UnscaledValue(sales_price#57))#58, sum(UnscaledValue(return_amt#60))#61, sum(UnscaledValue(profit#63))#64, sum(UnscaledValue(net_loss#65))#66], 1
                                 :     +- InputAdapter
                                 :        +- AQEShuffleRead coalesced
                                 :           +- ShuffleQueryStage X
                                 :              +- NativeShuffleExchange hashpartitioning(cp_catalog_page_id#69, 100), ENSURE_REQUIREMENTS, [plan_id=7]
                                 :                 +- NativeHashAggregate HashAgg, [cp_catalog_page_id#69], [partial_sum(_c1#71), partial_sum(_c2#72), partial_sum(_c3#73), partial_sum(_c4#74)], [sum#75, sum#76, sum#77, sum#78], 0
                                 :                    +- NativeProject [cp_catalog_page_id#69 AS cp_catalog_page_id#69, UnscaledValue(sales_price#57) AS _c1#71, UnscaledValue(return_amt#60) AS _c2#72, UnscaledValue(profit#63) AS _c3#73, UnscaledValue(net_loss#65) AS _c4#74]
                                 :                       +- NativeProject [sales_price#57, profit#63, return_amt#60, net_loss#65, cp_catalog_page_id#69]
                                 :                          +- NativeSortMergeJoin [page_sk#79], [cp_catalog_page_sk#80], Inner
                                 :                             :- NativeSort [page_sk#79 ASC NULLS FIRST], false
                                 :                             :  +- InputAdapter
                                 :                             :     +- AQEShuffleRead coalesced
                                 :                             :        +- ShuffleQueryStage X
                                 :                             :           +- NativeShuffleExchange hashpartitioning(page_sk#79, 100), ENSURE_REQUIREMENTS, [plan_id=8]
                                 :                             :              +- NativeProject [page_sk#79, sales_price#57, profit#63, return_amt#60, net_loss#65]
                                 :                             :                 +- NativeSortMergeJoin [date_sk#81], [d_date_sk#82], Inner
                                 :                             :                    :- NativeSort [date_sk#81 ASC NULLS FIRST], false
                                 :                             :                    :  +- InputAdapter
                                 :                             :                    :     +- AQEShuffleRead coalesced
                                 :                             :                    :        +- ShuffleQueryStage X
                                 :                             :                    :           +- NativeShuffleExchange hashpartitioning(date_sk#81, 100), ENSURE_REQUIREMENTS, [plan_id=9]
                                 :                             :                    :              +- InputAdapter [#79, #81, #57, #63, #60, #65]
                                 :                             :                    :                 +- NativeUnion [page_sk#79, date_sk#81, sales_price#57, profit#63, return_amt#60, net_loss#65]
                                 :                             :                    :                    :- NativeProject [cs_catalog_page_sk#83 AS page_sk#79, cs_sold_date_sk#84 AS date_sk#81, cs_ext_sales_price#85 AS sales_price#57, cs_net_profit#86 AS profit#63, 0.00 AS return_amt#60, 0.00 AS net_loss#65]
                                 :                             :                    :                    :  +- NativeFilter (isnotnull(cs_sold_date_sk#84) AND isnotnull(cs_catalog_page_sk#83))
                                 :                             :                    :                    :     +- InputAdapter [#84, #83, #85, #86]
                                 :                             :                    :                    :        +- NativeParquetScan  (FileScan parquet [cs_sold_date_sk#84,cs_catalog_page_sk#83,cs_ext_sales_price#85,cs_net_profit#86] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#84), isnotnull(cs_catalog_page_sk#83)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk), IsNotNull(cs_catalog_page_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_catalog_page_sk:int,cs_ext_sales_price:decimal(7,2),cs_net_profit:d...)
                                 :                             :                    :                    +- NativeProject [cr_catalog_page_sk#87 AS page_sk#88, cr_returned_date_sk#89 AS date_sk#90, 0.00 AS sales_price#91, 0.00 AS profit#92, cr_return_amount#93 AS return_amt#94, cr_net_loss#95 AS net_loss#96]
                                 :                             :                    :                       +- NativeFilter (isnotnull(cr_returned_date_sk#89) AND isnotnull(cr_catalog_page_sk#87))
                                 :                             :                    :                          +- InputAdapter [#89, #87, #93, #95]
                                 :                             :                    :                             +- NativeParquetScan  (FileScan parquet [cr_returned_date_sk#89,cr_catalog_page_sk#87,cr_return_amount#93,cr_net_loss#95] Batched: true, DataFilters: [isnotnull(cr_returned_date_sk#89), isnotnull(cr_catalog_page_sk#87)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cr_returned_date_sk), IsNotNull(cr_catalog_page_sk)], ReadSchema: struct<cr_returned_date_sk:int,cr_catalog_page_sk:int,cr_return_amount:decimal(7,2),cr_net_loss:d...)
                                 :                             :                    +- NativeSort [d_date_sk#82 ASC NULLS FIRST], false
                                 :                             :                       +- InputAdapter
                                 :                             :                          +- InputAdapter [#82]
                                 :                             :                             +- AQEShuffleRead coalesced
                                 :                             :                                +- ShuffleQueryStage X
                                 :                             :                                   +- ReusedExchange [d_date_sk#82], NativeShuffleExchange hashpartitioning(d_date_sk#41, 100), ENSURE_REQUIREMENTS, [plan_id=5]
                                 :                             +- NativeSort [cp_catalog_page_sk#80 ASC NULLS FIRST], false
                                 :                                +- InputAdapter
                                 :                                   +- AQEShuffleRead coalesced
                                 :                                      +- ShuffleQueryStage X
                                 :                                         +- NativeShuffleExchange hashpartitioning(cp_catalog_page_sk#80, 100), ENSURE_REQUIREMENTS, [plan_id=10]
                                 :                                            +- NativeFilter isnotnull(cp_catalog_page_sk#80)
                                 :                                               +- InputAdapter [#80, #69]
                                 :                                                  +- NativeParquetScan  (FileScan parquet [cp_catalog_page_sk#80,cp_catalog_page_id#69] Batched: true, DataFilters: [isnotnull(cp_catalog_page_sk#80)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cp_catalog_page_sk)], ReadSchema: struct<cp_catalog_page_sk:int,cp_catalog_page_id:string>)
                                 +- NativeProject [MakeDecimal(sum(UnscaledValue(sales_price#97))#98,17,2) AS sales#99, MakeDecimal(sum(UnscaledValue(return_amt#100))#101,17,2) AS returns#102, (MakeDecimal(sum(UnscaledValue(profit#103))#104,17,2) - MakeDecimal(sum(UnscaledValue(net_loss#105))#106,17,2)) AS profit#107, web channel AS channel#108, concat(web_site, web_site_id#109) AS id#110]
                                    +- NativeHashAggregate HashAgg, ArrayBuffer(web_site_id#109), [web_site_id#109], [sum(UnscaledValue(sales_price#97)), sum(UnscaledValue(return_amt#100)), sum(UnscaledValue(profit#103)), sum(UnscaledValue(net_loss#105))], [sum(UnscaledValue(sales_price#97))#98, sum(UnscaledValue(return_amt#100))#101, sum(UnscaledValue(profit#103))#104, sum(UnscaledValue(net_loss#105))#106], 1
                                       +- InputAdapter
                                          +- AQEShuffleRead coalesced
                                             +- ShuffleQueryStage X
                                                +- NativeShuffleExchange hashpartitioning(web_site_id#109, 100), ENSURE_REQUIREMENTS, [plan_id=11]
                                                   +- NativeHashAggregate HashAgg, [web_site_id#109], [partial_sum(_c1#111), partial_sum(_c2#112), partial_sum(_c3#113), partial_sum(_c4#114)], [sum#115, sum#116, sum#117, sum#118], 0
                                                      +- NativeProject [web_site_id#109 AS web_site_id#109, UnscaledValue(sales_price#97) AS _c1#111, UnscaledValue(return_amt#100) AS _c2#112, UnscaledValue(profit#103) AS _c3#113, UnscaledValue(net_loss#105) AS _c4#114]
                                                         +- NativeProject [sales_price#97, profit#103, return_amt#100, net_loss#105, web_site_id#109]
                                                            +- NativeSortMergeJoin [wsr_web_site_sk#119], [web_site_sk#120], Inner
                                                               :- NativeSort [wsr_web_site_sk#119 ASC NULLS FIRST], false
                                                               :  +- InputAdapter
                                                               :     +- AQEShuffleRead coalesced
                                                               :        +- ShuffleQueryStage X
                                                               :           +- NativeShuffleExchange hashpartitioning(wsr_web_site_sk#119, 100), ENSURE_REQUIREMENTS, [plan_id=12]
                                                               :              +- NativeProject [wsr_web_site_sk#119, sales_price#97, profit#103, return_amt#100, net_loss#105]
                                                               :                 +- NativeSortMergeJoin [date_sk#121], [d_date_sk#122], Inner
                                                               :                    :- NativeSort [date_sk#121 ASC NULLS FIRST], false
                                                               :                    :  +- InputAdapter
                                                               :                    :     +- AQEShuffleRead coalesced
                                                               :                    :        +- ShuffleQueryStage X
                                                               :                    :           +- NativeShuffleExchange hashpartitioning(date_sk#121, 100), ENSURE_REQUIREMENTS, [plan_id=13]
                                                               :                    :              +- InputAdapter [#119, #121, #97, #103, #100, #105]
                                                               :                    :                 +- NativeUnion [wsr_web_site_sk#119, date_sk#121, sales_price#97, profit#103, return_amt#100, net_loss#105]
                                                               :                    :                    :- NativeProject [ws_web_site_sk#123 AS wsr_web_site_sk#119, ws_sold_date_sk#124 AS date_sk#121, ws_ext_sales_price#125 AS sales_price#97, ws_net_profit#126 AS profit#103, 0.00 AS return_amt#100, 0.00 AS net_loss#105]
                                                               :                    :                    :  +- NativeFilter (isnotnull(ws_sold_date_sk#124) AND isnotnull(ws_web_site_sk#123))
                                                               :                    :                    :     +- InputAdapter [#124, #123, #125, #126]
                                                               :                    :                    :        +- NativeParquetScan  (FileScan parquet [ws_sold_date_sk#124,ws_web_site_sk#123,ws_ext_sales_price#125,ws_net_profit#126] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#124), isnotnull(ws_web_site_sk#123)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk), IsNotNull(ws_web_site_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_web_site_sk:int,ws_ext_sales_price:decimal(7,2),ws_net_profit:decim...)
                                                               :                    :                    +- NativeProject [ws_web_site_sk#127 AS wsr_web_site_sk#128, wr_returned_date_sk#129 AS date_sk#130, 0.00 AS sales_price#131, 0.00 AS profit#132, wr_return_amt#133 AS return_amt#134, wr_net_loss#135 AS net_loss#136]
                                                               :                    :                       +- NativeSortMergeJoin [wr_item_sk#137, wr_order_number#138], [ws_item_sk#139, ws_order_number#140], Inner
                                                               :                    :                          :- NativeSort [wr_item_sk#137 ASC NULLS FIRST, wr_order_number#138 ASC NULLS FIRST], false
                                                               :                    :                          :  +- InputAdapter
                                                               :                    :                          :     +- AQEShuffleRead coalesced
                                                               :                    :                          :        +- ShuffleQueryStage X
                                                               :                    :                          :           +- NativeShuffleExchange hashpartitioning(wr_item_sk#137, wr_order_number#138, 100), ENSURE_REQUIREMENTS, [plan_id=14]
                                                               :                    :                          :              +- NativeFilter isnotnull(wr_returned_date_sk#129)
                                                               :                    :                          :                 +- InputAdapter [#129, #137, #138, #133, #135]
                                                               :                    :                          :                    +- NativeParquetScan  (FileScan parquet [wr_returned_date_sk#129,wr_item_sk#137,wr_order_number#138,wr_return_amt#133,wr_net_loss#135] Batched: true, DataFilters: [isnotnull(wr_returned_date_sk#129)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(wr_returned_date_sk)], ReadSchema: struct<wr_returned_date_sk:int,wr_item_sk:int,wr_order_number:int,wr_return_amt:decimal(7,2),wr_n...)
                                                               :                    :                          +- NativeSort [ws_item_sk#139 ASC NULLS FIRST, ws_order_number#140 ASC NULLS FIRST], false
                                                               :                    :                             +- InputAdapter
                                                               :                    :                                +- AQEShuffleRead coalesced
                                                               :                    :                                   +- ShuffleQueryStage X
                                                               :                    :                                      +- NativeShuffleExchange hashpartitioning(ws_item_sk#139, ws_order_number#140, 100), ENSURE_REQUIREMENTS, [plan_id=15]
                                                               :                    :                                         +- NativeFilter ((isnotnull(ws_item_sk#139) AND isnotnull(ws_order_number#140)) AND isnotnull(ws_web_site_sk#127))
                                                               :                    :                                            +- InputAdapter [#139, #127, #140]
                                                               :                    :                                               +- NativeParquetScan  (FileScan parquet [ws_item_sk#139,ws_web_site_sk#127,ws_order_number#140] Batched: true, DataFilters: [isnotnull(ws_item_sk#139), isnotnull(ws_order_number#140), isnotnull(ws_web_site_sk#127)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_order_number), IsNotNull(ws_web_site_sk)], ReadSchema: struct<ws_item_sk:int,ws_web_site_sk:int,ws_order_number:int>)
                                                               :                    +- NativeSort [d_date_sk#122 ASC NULLS FIRST], false
                                                               :                       +- InputAdapter
                                                               :                          +- InputAdapter [#122]
                                                               :                             +- AQEShuffleRead coalesced
                                                               :                                +- ShuffleQueryStage X
                                                               :                                   +- ReusedExchange [d_date_sk#122], NativeShuffleExchange hashpartitioning(d_date_sk#41, 100), ENSURE_REQUIREMENTS, [plan_id=5]
                                                               +- NativeSort [web_site_sk#120 ASC NULLS FIRST], false
                                                                  +- InputAdapter
                                                                     +- AQEShuffleRead coalesced
                                                                        +- ShuffleQueryStage X
                                                                           +- NativeShuffleExchange hashpartitioning(web_site_sk#120, 100), ENSURE_REQUIREMENTS, [plan_id=16]
                                                                              +- NativeFilter isnotnull(web_site_sk#120)
                                                                                 +- InputAdapter [#120, #109]
                                                                                    +- NativeParquetScan  (FileScan parquet [web_site_sk#120,web_site_id#109] Batched: true, DataFilters: [isnotnull(web_site_sk#120)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(web_site_sk)], ReadSchema: struct<web_site_sk:int,web_site_id:string>)
+- == Initial Plan ==
   TakeOrderedAndProject(limit=100, orderBy=[channel#1 ASC NULLS FIRST,id#2 ASC NULLS FIRST], output=[channel#1,id#2,sales#5,returns#8,profit#11])
   +- HashAggregate(keys=[channel#1, id#2, spark_grouping_id#12], functions=[sum(sales#3), sum(returns#6), sum(profit#9)], output=[channel#1, id#2, sales#5, returns#8, profit#11])
      +- Exchange hashpartitioning(channel#1, id#2, spark_grouping_id#12, 100), ENSURE_REQUIREMENTS, [plan_id=17]
         +- HashAggregate(keys=[channel#1, id#2, spark_grouping_id#12], functions=[partial_sum(sales#3), partial_sum(returns#6), partial_sum(profit#9)], output=[channel#1, id#2, spark_grouping_id#12, sum#141, isEmpty#142, sum#143, isEmpty#144, sum#145, isEmpty#146])
            +- Expand [[sales#3, returns#6, profit#9, channel#19, id#20, 0], [sales#3, returns#6, profit#9, channel#19, null, 1], [sales#3, returns#6, profit#9, null, null, 3]], [sales#3, returns#6, profit#9, channel#1, id#2, spark_grouping_id#12]
               +- Union
                  :- HashAggregate(keys=[s_store_id#29], functions=[sum(UnscaledValue(sales_price#21)), sum(UnscaledValue(return_amt#23)), sum(UnscaledValue(profit#25)), sum(UnscaledValue(net_loss#27))], output=[sales#3, returns#6, profit#9, channel#19, id#20])
                  :  +- Exchange hashpartitioning(s_store_id#29, 100), ENSURE_REQUIREMENTS, [plan_id=18]
                  :     +- HashAggregate(keys=[s_store_id#29], functions=[partial_sum(UnscaledValue(sales_price#21)), partial_sum(UnscaledValue(return_amt#23)), partial_sum(UnscaledValue(profit#25)), partial_sum(UnscaledValue(net_loss#27))], output=[s_store_id#29, sum#147, sum#148, sum#149, sum#150])
                  :        +- Project [sales_price#21, profit#25, return_amt#23, net_loss#27, s_store_id#29]
                  :           +- SortMergeJoin [store_sk#38], [s_store_sk#39], Inner
                  :              :- Sort [store_sk#38 ASC NULLS FIRST], false, 0
                  :              :  +- Exchange hashpartitioning(store_sk#38, 100), ENSURE_REQUIREMENTS, [plan_id=19]
                  :              :     +- Project [store_sk#38, sales_price#21, profit#25, return_amt#23, net_loss#27]
                  :              :        +- SortMergeJoin [date_sk#40], [d_date_sk#41], Inner
                  :              :           :- Sort [date_sk#40 ASC NULLS FIRST], false, 0
                  :              :           :  +- Exchange hashpartitioning(date_sk#40, 100), ENSURE_REQUIREMENTS, [plan_id=20]
                  :              :           :     +- Union
                  :              :           :        :- Project [ss_store_sk#42 AS store_sk#38, ss_sold_date_sk#43 AS date_sk#40, ss_ext_sales_price#44 AS sales_price#21, ss_net_profit#45 AS profit#25, 0.00 AS return_amt#23, 0.00 AS net_loss#27]
                  :              :           :        :  +- Filter (isnotnull(ss_sold_date_sk#43) AND isnotnull(ss_store_sk#42))
                  :              :           :        :     +- FileScan parquet [ss_sold_date_sk#43,ss_store_sk#42,ss_ext_sales_price#44,ss_net_profit#45] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#43), isnotnull(ss_store_sk#42)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_store_sk:int,ss_ext_sales_price:decimal(7,2),ss_net_profit:decimal(...
                  :              :           :        +- Project [sr_store_sk#46 AS store_sk#47, sr_returned_date_sk#48 AS date_sk#49, 0.00 AS sales_price#50, 0.00 AS profit#51, sr_return_amt#52 AS return_amt#53, sr_net_loss#54 AS net_loss#55]
                  :              :           :           +- Filter (isnotnull(sr_returned_date_sk#48) AND isnotnull(sr_store_sk#46))
                  :              :           :              +- FileScan parquet [sr_returned_date_sk#48,sr_store_sk#46,sr_return_amt#52,sr_net_loss#54] Batched: true, DataFilters: [isnotnull(sr_returned_date_sk#48), isnotnull(sr_store_sk#46)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(sr_returned_date_sk), IsNotNull(sr_store_sk)], ReadSchema: struct<sr_returned_date_sk:int,sr_store_sk:int,sr_return_amt:decimal(7,2),sr_net_loss:decimal(7,2)>
                  :              :           +- Sort [d_date_sk#41 ASC NULLS FIRST], false, 0
                  :              :              +- Exchange hashpartitioning(d_date_sk#41, 100), ENSURE_REQUIREMENTS, [plan_id=21]
                  :              :                 +- Project [d_date_sk#41]
                  :              :                    +- Filter (((isnotnull(d_date#56) AND (d_date#56 >= 2000-08-23)) AND (d_date#56 <= 2000-09-06)) AND isnotnull(d_date_sk#41))
                  :              :                       +- FileScan parquet [d_date_sk#41,d_date#56] Batched: true, DataFilters: [isnotnull(d_date#56), (d_date#56 >= 2000-08-23), (d_date#56 <= 2000-09-06), isnotnull(d..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_date), GreaterThanOrEqual(d_date,2000-08-23), LessThanOrEqual(d_date,2000-09-06), Is..., ReadSchema: struct<d_date_sk:int,d_date:date>
                  :              +- Sort [s_store_sk#39 ASC NULLS FIRST], false, 0
                  :                 +- Exchange hashpartitioning(s_store_sk#39, 100), ENSURE_REQUIREMENTS, [plan_id=22]
                  :                    +- Filter isnotnull(s_store_sk#39)
                  :                       +- FileScan parquet [s_store_sk#39,s_store_id#29] Batched: true, DataFilters: [isnotnull(s_store_sk#39)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk)], ReadSchema: struct<s_store_sk:int,s_store_id:string>
                  :- HashAggregate(keys=[cp_catalog_page_id#69], functions=[sum(UnscaledValue(sales_price#57)), sum(UnscaledValue(return_amt#60)), sum(UnscaledValue(profit#63)), sum(UnscaledValue(net_loss#65))], output=[sales#59, returns#62, profit#67, channel#68, id#70])
                  :  +- Exchange hashpartitioning(cp_catalog_page_id#69, 100), ENSURE_REQUIREMENTS, [plan_id=23]
                  :     +- HashAggregate(keys=[cp_catalog_page_id#69], functions=[partial_sum(UnscaledValue(sales_price#57)), partial_sum(UnscaledValue(return_amt#60)), partial_sum(UnscaledValue(profit#63)), partial_sum(UnscaledValue(net_loss#65))], output=[cp_catalog_page_id#69, sum#151, sum#152, sum#153, sum#154])
                  :        +- Project [sales_price#57, profit#63, return_amt#60, net_loss#65, cp_catalog_page_id#69]
                  :           +- SortMergeJoin [page_sk#79], [cp_catalog_page_sk#80], Inner
                  :              :- Sort [page_sk#79 ASC NULLS FIRST], false, 0
                  :              :  +- Exchange hashpartitioning(page_sk#79, 100), ENSURE_REQUIREMENTS, [plan_id=24]
                  :              :     +- Project [page_sk#79, sales_price#57, profit#63, return_amt#60, net_loss#65]
                  :              :        +- SortMergeJoin [date_sk#81], [d_date_sk#82], Inner
                  :              :           :- Sort [date_sk#81 ASC NULLS FIRST], false, 0
                  :              :           :  +- Exchange hashpartitioning(date_sk#81, 100), ENSURE_REQUIREMENTS, [plan_id=25]
                  :              :           :     +- Union
                  :              :           :        :- Project [cs_catalog_page_sk#83 AS page_sk#79, cs_sold_date_sk#84 AS date_sk#81, cs_ext_sales_price#85 AS sales_price#57, cs_net_profit#86 AS profit#63, 0.00 AS return_amt#60, 0.00 AS net_loss#65]
                  :              :           :        :  +- Filter (isnotnull(cs_sold_date_sk#84) AND isnotnull(cs_catalog_page_sk#83))
                  :              :           :        :     +- FileScan parquet [cs_sold_date_sk#84,cs_catalog_page_sk#83,cs_ext_sales_price#85,cs_net_profit#86] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#84), isnotnull(cs_catalog_page_sk#83)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk), IsNotNull(cs_catalog_page_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_catalog_page_sk:int,cs_ext_sales_price:decimal(7,2),cs_net_profit:d...
                  :              :           :        +- Project [cr_catalog_page_sk#87 AS page_sk#88, cr_returned_date_sk#89 AS date_sk#90, 0.00 AS sales_price#91, 0.00 AS profit#92, cr_return_amount#93 AS return_amt#94, cr_net_loss#95 AS net_loss#96]
                  :              :           :           +- Filter (isnotnull(cr_returned_date_sk#89) AND isnotnull(cr_catalog_page_sk#87))
                  :              :           :              +- FileScan parquet [cr_returned_date_sk#89,cr_catalog_page_sk#87,cr_return_amount#93,cr_net_loss#95] Batched: true, DataFilters: [isnotnull(cr_returned_date_sk#89), isnotnull(cr_catalog_page_sk#87)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cr_returned_date_sk), IsNotNull(cr_catalog_page_sk)], ReadSchema: struct<cr_returned_date_sk:int,cr_catalog_page_sk:int,cr_return_amount:decimal(7,2),cr_net_loss:d...
                  :              :           +- Sort [d_date_sk#82 ASC NULLS FIRST], false, 0
                  :              :              +- Exchange hashpartitioning(d_date_sk#82, 100), ENSURE_REQUIREMENTS, [plan_id=26]
                  :              :                 +- Project [d_date_sk#82]
                  :              :                    +- Filter (((isnotnull(d_date#155) AND (d_date#155 >= 2000-08-23)) AND (d_date#155 <= 2000-09-06)) AND isnotnull(d_date_sk#82))
                  :              :                       +- FileScan parquet [d_date_sk#82,d_date#155] Batched: true, DataFilters: [isnotnull(d_date#155), (d_date#155 >= 2000-08-23), (d_date#155 <= 2000-09-06), isnotnull(d..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_date), GreaterThanOrEqual(d_date,2000-08-23), LessThanOrEqual(d_date,2000-09-06), Is..., ReadSchema: struct<d_date_sk:int,d_date:date>
                  :              +- Sort [cp_catalog_page_sk#80 ASC NULLS FIRST], false, 0
                  :                 +- Exchange hashpartitioning(cp_catalog_page_sk#80, 100), ENSURE_REQUIREMENTS, [plan_id=27]
                  :                    +- Filter isnotnull(cp_catalog_page_sk#80)
                  :                       +- FileScan parquet [cp_catalog_page_sk#80,cp_catalog_page_id#69] Batched: true, DataFilters: [isnotnull(cp_catalog_page_sk#80)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cp_catalog_page_sk)], ReadSchema: struct<cp_catalog_page_sk:int,cp_catalog_page_id:string>
                  +- HashAggregate(keys=[web_site_id#109], functions=[sum(UnscaledValue(sales_price#97)), sum(UnscaledValue(return_amt#100)), sum(UnscaledValue(profit#103)), sum(UnscaledValue(net_loss#105))], output=[sales#99, returns#102, profit#107, channel#108, id#110])
                     +- Exchange hashpartitioning(web_site_id#109, 100), ENSURE_REQUIREMENTS, [plan_id=28]
                        +- HashAggregate(keys=[web_site_id#109], functions=[partial_sum(UnscaledValue(sales_price#97)), partial_sum(UnscaledValue(return_amt#100)), partial_sum(UnscaledValue(profit#103)), partial_sum(UnscaledValue(net_loss#105))], output=[web_site_id#109, sum#156, sum#157, sum#158, sum#159])
                           +- Project [sales_price#97, profit#103, return_amt#100, net_loss#105, web_site_id#109]
                              +- SortMergeJoin [wsr_web_site_sk#119], [web_site_sk#120], Inner
                                 :- Sort [wsr_web_site_sk#119 ASC NULLS FIRST], false, 0
                                 :  +- Exchange hashpartitioning(wsr_web_site_sk#119, 100), ENSURE_REQUIREMENTS, [plan_id=29]
                                 :     +- Project [wsr_web_site_sk#119, sales_price#97, profit#103, return_amt#100, net_loss#105]
                                 :        +- SortMergeJoin [date_sk#121], [d_date_sk#122], Inner
                                 :           :- Sort [date_sk#121 ASC NULLS FIRST], false, 0
                                 :           :  +- Exchange hashpartitioning(date_sk#121, 100), ENSURE_REQUIREMENTS, [plan_id=30]
                                 :           :     +- Union
                                 :           :        :- Project [ws_web_site_sk#123 AS wsr_web_site_sk#119, ws_sold_date_sk#124 AS date_sk#121, ws_ext_sales_price#125 AS sales_price#97, ws_net_profit#126 AS profit#103, 0.00 AS return_amt#100, 0.00 AS net_loss#105]
                                 :           :        :  +- Filter (isnotnull(ws_sold_date_sk#124) AND isnotnull(ws_web_site_sk#123))
                                 :           :        :     +- FileScan parquet [ws_sold_date_sk#124,ws_web_site_sk#123,ws_ext_sales_price#125,ws_net_profit#126] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#124), isnotnull(ws_web_site_sk#123)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk), IsNotNull(ws_web_site_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_web_site_sk:int,ws_ext_sales_price:decimal(7,2),ws_net_profit:decim...
                                 :           :        +- Project [ws_web_site_sk#127 AS wsr_web_site_sk#128, wr_returned_date_sk#129 AS date_sk#130, 0.00 AS sales_price#131, 0.00 AS profit#132, wr_return_amt#133 AS return_amt#134, wr_net_loss#135 AS net_loss#136]
                                 :           :           +- SortMergeJoin [wr_item_sk#137, wr_order_number#138], [ws_item_sk#139, ws_order_number#140], Inner
                                 :           :              :- Sort [wr_item_sk#137 ASC NULLS FIRST, wr_order_number#138 ASC NULLS FIRST], false, 0
                                 :           :              :  +- Exchange hashpartitioning(wr_item_sk#137, wr_order_number#138, 100), ENSURE_REQUIREMENTS, [plan_id=31]
                                 :           :              :     +- Filter isnotnull(wr_returned_date_sk#129)
                                 :           :              :        +- FileScan parquet [wr_returned_date_sk#129,wr_item_sk#137,wr_order_number#138,wr_return_amt#133,wr_net_loss#135] Batched: true, DataFilters: [isnotnull(wr_returned_date_sk#129)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(wr_returned_date_sk)], ReadSchema: struct<wr_returned_date_sk:int,wr_item_sk:int,wr_order_number:int,wr_return_amt:decimal(7,2),wr_n...
                                 :           :              +- Sort [ws_item_sk#139 ASC NULLS FIRST, ws_order_number#140 ASC NULLS FIRST], false, 0
                                 :           :                 +- Exchange hashpartitioning(ws_item_sk#139, ws_order_number#140, 100), ENSURE_REQUIREMENTS, [plan_id=32]
                                 :           :                    +- Filter ((isnotnull(ws_item_sk#139) AND isnotnull(ws_order_number#140)) AND isnotnull(ws_web_site_sk#127))
                                 :           :                       +- FileScan parquet [ws_item_sk#139,ws_web_site_sk#127,ws_order_number#140] Batched: true, DataFilters: [isnotnull(ws_item_sk#139), isnotnull(ws_order_number#140), isnotnull(ws_web_site_sk#127)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_order_number), IsNotNull(ws_web_site_sk)], ReadSchema: struct<ws_item_sk:int,ws_web_site_sk:int,ws_order_number:int>
                                 :           +- Sort [d_date_sk#122 ASC NULLS FIRST], false, 0
                                 :              +- Exchange hashpartitioning(d_date_sk#122, 100), ENSURE_REQUIREMENTS, [plan_id=33]
                                 :                 +- Project [d_date_sk#122]
                                 :                    +- Filter (((isnotnull(d_date#160) AND (d_date#160 >= 2000-08-23)) AND (d_date#160 <= 2000-09-06)) AND isnotnull(d_date_sk#122))
                                 :                       +- FileScan parquet [d_date_sk#122,d_date#160] Batched: true, DataFilters: [isnotnull(d_date#160), (d_date#160 >= 2000-08-23), (d_date#160 <= 2000-09-06), isnotnull(d..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_date), GreaterThanOrEqual(d_date,2000-08-23), LessThanOrEqual(d_date,2000-09-06), Is..., ReadSchema: struct<d_date_sk:int,d_date:date>
                                 +- Sort [web_site_sk#120 ASC NULLS FIRST], false, 0
                                    +- Exchange hashpartitioning(web_site_sk#120, 100), ENSURE_REQUIREMENTS, [plan_id=34]
                                       +- Filter isnotnull(web_site_sk#120)
                                          +- FileScan parquet [web_site_sk#120,web_site_id#109] Batched: true, DataFilters: [isnotnull(web_site_sk#120)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(web_site_sk)], ReadSchema: struct<web_site_sk:int,web_site_id:string>
