AdaptiveSparkPlan isFinalPlan=true
+- == Final Plan ==
   NativeTakeOrdered 100, [i_product_name#1 ASC NULLS FIRST]
   +- NativeProject [i_product_name#1]
      +- NativeHashAggregate HashAgg, List(i_product_name#1), [i_product_name#1], 1
         +- InputAdapter
            +- AQEShuffleRead coalesced
               +- ShuffleQueryStage X
                  +- NativeShuffleExchange hashpartitioning(i_product_name#1, 100), ENSURE_REQUIREMENTS, [plan_id=1]
                     +- NativeHashAggregate HashAgg, [i_product_name#1], 0
                        +- NativeProject [i_product_name#1]
                           +- NativeSortMergeJoin [i_manufact#2], [i_manufact#3], Inner
                              :- NativeSort [i_manufact#2 ASC NULLS FIRST], false
                              :  +- InputAdapter
                              :     +- AQEShuffleRead coalesced
                              :        +- ShuffleQueryStage X
                              :           +- NativeShuffleExchange hashpartitioning(i_manufact#2, 100), ENSURE_REQUIREMENTS, [plan_id=2]
                              :              +- NativeProject [i_manufact#2, i_product_name#1]
                              :                 +- NativeFilter (((isnotnull(i_manufact_id#4) AND (i_manufact_id#4 >= 738)) AND (i_manufact_id#4 <= 778)) AND isnotnull(i_manufact#2))
                              :                    +- InputAdapter [#4, #2, #1]
                              :                       +- NativeParquetScan  (FileScan parquet [i_manufact_id#4,i_manufact#2,i_product_name#1] Batched: true, DataFilters: [isnotnull(i_manufact_id#4), (i_manufact_id#4 >= 738), (i_manufact_id#4 <= 778), isno..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_manufact_id), GreaterThanOrEqual(i_manufact_id,738), LessThanOrEqual(i_manufact_id,7..., ReadSchema: struct<i_manufact_id:int,i_manufact:string,i_product_name:string>)
                              +- NativeSort [i_manufact#3 ASC NULLS FIRST], false
                                 +- NativeProject [i_manufact#3]
                                    +- NativeFilter (item_cnt#5 > 0)
                                       +- NativeProject [count(1)#6 AS item_cnt#5, i_manufact#3]
                                          +- NativeHashAggregate HashAgg, List(i_manufact#3), [i_manufact#3], [count(1)], [count(1)#6], 1
                                             +- InputAdapter
                                                +- AQEShuffleRead coalesced
                                                   +- ShuffleQueryStage X
                                                      +- NativeShuffleExchange hashpartitioning(i_manufact#3, 100), ENSURE_REQUIREMENTS, [plan_id=3]
                                                         +- NativeHashAggregate HashAgg, [i_manufact#3], [partial_count(1)], [count#7], 0
                                                            +- NativeProject [i_manufact#3]
                                                               +- NativeFilter (((((i_category#8 = Women) AND (((((i_color#9 = powder) OR (i_color#9 = khaki)) AND ((i_units#10 = Ounce) OR (i_units#10 = Oz))) AND ((i_size#11 = medium) OR (i_size#11 = extra large))) OR ((((i_color#9 = brown) OR (i_color#9 = honeydew)) AND ((i_units#10 = Bunch) OR (i_units#10 = Ton))) AND ((i_size#11 = N/A) OR (i_size#11 = small))))) OR ((i_category#8 = Men) AND (((((i_color#9 = floral) OR (i_color#9 = deep)) AND ((i_units#10 = N/A) OR (i_units#10 = Dozen))) AND ((i_size#11 = petite) OR (i_size#11 = large))) OR ((((i_color#9 = light) OR (i_color#9 = cornflower)) AND ((i_units#10 = Box) OR (i_units#10 = Pound))) AND ((i_size#11 = medium) OR (i_size#11 = extra large)))))) OR (((i_category#8 = Women) AND (((((i_color#9 = midnight) OR (i_color#9 = snow)) AND ((i_units#10 = Pallet) OR (i_units#10 = Gross))) AND ((i_size#11 = medium) OR (i_size#11 = extra large))) OR ((((i_color#9 = cyan) OR (i_color#9 = papaya)) AND ((i_units#10 = Cup) OR (i_units#10 = Dram))) AND ((i_size#11 = N/A) OR (i_size#11 = small))))) OR ((i_category#8 = Men) AND (((((i_color#9 = orange) OR (i_color#9 = frosted)) AND ((i_units#10 = Each) OR (i_units#10 = Tbl))) AND ((i_size#11 = petite) OR (i_size#11 = large))) OR ((((i_color#9 = forest) OR (i_color#9 = ghost)) AND ((i_units#10 = Lb) OR (i_units#10 = Bundle))) AND ((i_size#11 = medium) OR (i_size#11 = extra large))))))) AND isnotnull(i_manufact#3))
                                                                  +- InputAdapter [#8, #3, #11, #9, #10]
                                                                     +- NativeParquetScan  (FileScan parquet [i_category#8,i_manufact#3,i_size#11,i_color#9,i_units#10] Batched: true, DataFilters: [((((i_category#8 = Women) AND (((((i_color#9 = powder) OR (i_color#9 = khaki)) AND (..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [Or(Or(And(EqualTo(i_category,Women),Or(And(And(Or(EqualTo(i_color,powder),EqualTo(i_color,khaki)..., ReadSchema: struct<i_category:string,i_manufact:string,i_size:string,i_color:string,i_units:string>)
+- == Initial Plan ==
   TakeOrderedAndProject(limit=100, orderBy=[i_product_name#1 ASC NULLS FIRST], output=[i_product_name#1])
   +- HashAggregate(keys=[i_product_name#1], functions=[], output=[i_product_name#1])
      +- Exchange hashpartitioning(i_product_name#1, 100), ENSURE_REQUIREMENTS, [plan_id=4]
         +- HashAggregate(keys=[i_product_name#1], functions=[], output=[i_product_name#1])
            +- Project [i_product_name#1]
               +- SortMergeJoin [i_manufact#2], [i_manufact#3], Inner
                  :- Sort [i_manufact#2 ASC NULLS FIRST], false, 0
                  :  +- Exchange hashpartitioning(i_manufact#2, 100), ENSURE_REQUIREMENTS, [plan_id=5]
                  :     +- Project [i_manufact#2, i_product_name#1]
                  :        +- Filter (((isnotnull(i_manufact_id#4) AND (i_manufact_id#4 >= 738)) AND (i_manufact_id#4 <= 778)) AND isnotnull(i_manufact#2))
                  :           +- FileScan parquet [i_manufact_id#4,i_manufact#2,i_product_name#1] Batched: true, DataFilters: [isnotnull(i_manufact_id#4), (i_manufact_id#4 >= 738), (i_manufact_id#4 <= 778), isno..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_manufact_id), GreaterThanOrEqual(i_manufact_id,738), LessThanOrEqual(i_manufact_id,7..., ReadSchema: struct<i_manufact_id:int,i_manufact:string,i_product_name:string>
                  +- Sort [i_manufact#3 ASC NULLS FIRST], false, 0
                     +- Project [i_manufact#3]
                        +- Filter (item_cnt#5 > 0)
                           +- HashAggregate(keys=[i_manufact#3], functions=[count(1)], output=[item_cnt#5, i_manufact#3])
                              +- Exchange hashpartitioning(i_manufact#3, 100), ENSURE_REQUIREMENTS, [plan_id=6]
                                 +- HashAggregate(keys=[i_manufact#3], functions=[partial_count(1)], output=[i_manufact#3, count#12])
                                    +- Project [i_manufact#3]
                                       +- Filter (((((i_category#8 = Women) AND (((((i_color#9 = powder) OR (i_color#9 = khaki)) AND ((i_units#10 = Ounce) OR (i_units#10 = Oz))) AND ((i_size#11 = medium) OR (i_size#11 = extra large))) OR ((((i_color#9 = brown) OR (i_color#9 = honeydew)) AND ((i_units#10 = Bunch) OR (i_units#10 = Ton))) AND ((i_size#11 = N/A) OR (i_size#11 = small))))) OR ((i_category#8 = Men) AND (((((i_color#9 = floral) OR (i_color#9 = deep)) AND ((i_units#10 = N/A) OR (i_units#10 = Dozen))) AND ((i_size#11 = petite) OR (i_size#11 = large))) OR ((((i_color#9 = light) OR (i_color#9 = cornflower)) AND ((i_units#10 = Box) OR (i_units#10 = Pound))) AND ((i_size#11 = medium) OR (i_size#11 = extra large)))))) OR (((i_category#8 = Women) AND (((((i_color#9 = midnight) OR (i_color#9 = snow)) AND ((i_units#10 = Pallet) OR (i_units#10 = Gross))) AND ((i_size#11 = medium) OR (i_size#11 = extra large))) OR ((((i_color#9 = cyan) OR (i_color#9 = papaya)) AND ((i_units#10 = Cup) OR (i_units#10 = Dram))) AND ((i_size#11 = N/A) OR (i_size#11 = small))))) OR ((i_category#8 = Men) AND (((((i_color#9 = orange) OR (i_color#9 = frosted)) AND ((i_units#10 = Each) OR (i_units#10 = Tbl))) AND ((i_size#11 = petite) OR (i_size#11 = large))) OR ((((i_color#9 = forest) OR (i_color#9 = ghost)) AND ((i_units#10 = Lb) OR (i_units#10 = Bundle))) AND ((i_size#11 = medium) OR (i_size#11 = extra large))))))) AND isnotnull(i_manufact#3))
                                          +- FileScan parquet [i_category#8,i_manufact#3,i_size#11,i_color#9,i_units#10] Batched: true, DataFilters: [((((i_category#8 = Women) AND (((((i_color#9 = powder) OR (i_color#9 = khaki)) AND (..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [Or(Or(And(EqualTo(i_category,Women),Or(And(And(Or(EqualTo(i_color,powder),EqualTo(i_color,khaki)..., ReadSchema: struct<i_category:string,i_manufact:string,i_size:string,i_color:string,i_units:string>
