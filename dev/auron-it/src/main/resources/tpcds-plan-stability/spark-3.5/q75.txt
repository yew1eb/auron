AdaptiveSparkPlan isFinalPlan=true
+- == Final Plan ==
   TakeOrderedAndProject(limit=100, orderBy=[sales_cnt_diff#1 ASC NULLS FIRST,sales_amt_diff#2 ASC NULLS FIRST], output=[prev_year#3,year#4,i_brand_id#5,i_class_id#6,i_category_id#7,i_manufact_id#8,prev_yr_cnt#9,curr_yr_cnt#10,sales_cnt_diff#1,sales_amt_diff#2])
   +- *(1) Project [d_year#11 AS prev_year#3, d_year#12 AS year#4, i_brand_id#5, i_class_id#6, i_category_id#7, i_manufact_id#8, sales_cnt#13 AS prev_yr_cnt#9, sales_cnt#14 AS curr_yr_cnt#10, (sales_cnt#14 - sales_cnt#13) AS sales_cnt_diff#1, (sales_amt#15 - sales_amt#16) AS sales_amt_diff#2]
      +- *(1) SortMergeJoin [i_brand_id#5, i_class_id#6, i_category_id#7, i_manufact_id#8], [i_brand_id#17, i_class_id#18, i_category_id#19, i_manufact_id#20], Inner, ((cast(sales_cnt#14 as decimal(17,2)) / cast(sales_cnt#13 as decimal(17,2))) < 0.90000000000000000000)
         :- NativeSort [i_brand_id#5 ASC NULLS FIRST, i_class_id#6 ASC NULLS FIRST, i_category_id#7 ASC NULLS FIRST, i_manufact_id#8 ASC NULLS FIRST], false
         :  +- InputAdapter
         :     +- AQEShuffleRead coalesced
         :        +- ShuffleQueryStage X
         :           +- NativeShuffleExchange hashpartitioning(i_brand_id#5, i_class_id#6, i_category_id#7, i_manufact_id#8, 100), ENSURE_REQUIREMENTS, [plan_id=1]
         :              +- NativeFilter isnotnull(sales_cnt#14)
         :                 +- NativeProject [d_year#12, i_brand_id#5, i_class_id#6, i_category_id#7, i_manufact_id#8, sum(sales_cnt#21)#22 AS sales_cnt#14, MakeDecimal(sum(UnscaledValue(sales_amt#23))#24,18,2) AS sales_amt#15]
         :                    +- NativeHashAggregate HashAgg, ArrayBuffer(d_year#12, i_brand_id#5, i_class_id#6, i_category_id#7, i_manufact_id#8), [d_year#12, i_brand_id#5, i_class_id#6, i_category_id#7, i_manufact_id#8], [sum(sales_cnt#21), sum(UnscaledValue(sales_amt#23))], [sum(sales_cnt#21)#22, sum(UnscaledValue(sales_amt#23))#24], 5
         :                       +- InputAdapter
         :                          +- AQEShuffleRead coalesced
         :                             +- ShuffleQueryStage X
         :                                +- NativeShuffleExchange hashpartitioning(d_year#12, i_brand_id#5, i_class_id#6, i_category_id#7, i_manufact_id#8, 100), ENSURE_REQUIREMENTS, [plan_id=2]
         :                                   +- NativeHashAggregate HashAgg, [d_year#12, i_brand_id#5, i_class_id#6, i_category_id#7, i_manufact_id#8], [partial_sum(_c5#25), partial_sum(_c6#26)], [sum#27, sum#28], 0
         :                                      +- NativeProject [d_year#12 AS d_year#12, i_brand_id#5 AS i_brand_id#5, i_class_id#6 AS i_class_id#6, i_category_id#7 AS i_category_id#7, i_manufact_id#8 AS i_manufact_id#8, sales_cnt#21 AS _c5#25, UnscaledValue(sales_amt#23) AS _c6#26]
         :                                         +- NativeProject [d_year#12, i_brand_id#5, i_class_id#6, i_category_id#7, i_manufact_id#8, sales_cnt#21, sales_amt#23]
         :                                            +- NativeHashAggregate HashAgg, ArrayBuffer(d_year#12, i_brand_id#5, i_class_id#6, i_category_id#7, i_manufact_id#8, sales_cnt#21, sales_amt#23), [d_year#12, i_brand_id#5, i_class_id#6, i_category_id#7, i_manufact_id#8, sales_cnt#21, sales_amt#23], 7
         :                                               +- InputAdapter
         :                                                  +- AQEShuffleRead coalesced
         :                                                     +- ShuffleQueryStage X
         :                                                        +- NativeShuffleExchange hashpartitioning(d_year#12, i_brand_id#5, i_class_id#6, i_category_id#7, i_manufact_id#8, sales_cnt#21, sales_amt#23, 100), ENSURE_REQUIREMENTS, [plan_id=3]
         :                                                           +- NativeHashAggregate HashAgg, [d_year#12, i_brand_id#5, i_class_id#6, i_category_id#7, i_manufact_id#8, sales_cnt#21, sales_amt#23], 0
         :                                                              +- InputAdapter [#12, #5, #6, #7, #8, #21, #23]
         :                                                                 +- NativeUnion [d_year#12, i_brand_id#5, i_class_id#6, i_category_id#7, i_manufact_id#8, sales_cnt#21, sales_amt#23]
         :                                                                    :- NativeProject [d_year#12, i_brand_id#5, i_class_id#6, i_category_id#7, i_manufact_id#8, (cs_quantity#29 - coalesce(cr_return_quantity#30, 0)) AS sales_cnt#21, (cs_ext_sales_price#31 - coalesce(cr_return_amount#32, 0.00)) AS sales_amt#23]
         :                                                                    :  +- NativeSortMergeJoin [cs_order_number#33, cs_item_sk#34], [cr_order_number#35, cr_item_sk#36], LeftOuter
         :                                                                    :     :- NativeSort [cs_order_number#33 ASC NULLS FIRST, cs_item_sk#34 ASC NULLS FIRST], false
         :                                                                    :     :  +- InputAdapter
         :                                                                    :     :     +- AQEShuffleRead coalesced
         :                                                                    :     :        +- ShuffleQueryStage X
         :                                                                    :     :           +- NativeShuffleExchange hashpartitioning(cs_order_number#33, cs_item_sk#34, 100), ENSURE_REQUIREMENTS, [plan_id=4]
         :                                                                    :     :              +- NativeProject [cs_item_sk#34, cs_order_number#33, cs_quantity#29, cs_ext_sales_price#31, i_brand_id#5, i_class_id#6, i_category_id#7, i_manufact_id#8, d_year#12]
         :                                                                    :     :                 +- NativeSortMergeJoin [cs_sold_date_sk#37], [d_date_sk#38], Inner
         :                                                                    :     :                    :- NativeSort [cs_sold_date_sk#37 ASC NULLS FIRST], false
         :                                                                    :     :                    :  +- InputAdapter
         :                                                                    :     :                    :     +- AQEShuffleRead coalesced
         :                                                                    :     :                    :        +- ShuffleQueryStage X
         :                                                                    :     :                    :           +- NativeShuffleExchange hashpartitioning(cs_sold_date_sk#37, 100), ENSURE_REQUIREMENTS, [plan_id=5]
         :                                                                    :     :                    :              +- NativeProject [cs_sold_date_sk#37, cs_item_sk#34, cs_order_number#33, cs_quantity#29, cs_ext_sales_price#31, i_brand_id#5, i_class_id#6, i_category_id#7, i_manufact_id#8]
         :                                                                    :     :                    :                 +- NativeSortMergeJoin [cs_item_sk#34], [i_item_sk#39], Inner
         :                                                                    :     :                    :                    :- NativeSort [cs_item_sk#34 ASC NULLS FIRST], false
         :                                                                    :     :                    :                    :  +- InputAdapter
         :                                                                    :     :                    :                    :     +- AQEShuffleRead coalesced
         :                                                                    :     :                    :                    :        +- ShuffleQueryStage X
         :                                                                    :     :                    :                    :           +- NativeShuffleExchange hashpartitioning(cs_item_sk#34, 100), ENSURE_REQUIREMENTS, [plan_id=6]
         :                                                                    :     :                    :                    :              +- NativeFilter (isnotnull(cs_item_sk#34) AND isnotnull(cs_sold_date_sk#37))
         :                                                                    :     :                    :                    :                 +- InputAdapter [#37, #34, #33, #29, #31]
         :                                                                    :     :                    :                    :                    +- NativeParquetScan  (FileScan parquet [cs_sold_date_sk#37,cs_item_sk#34,cs_order_number#33,cs_quantity#29,cs_ext_sales_price#31] Batched: true, DataFilters: [isnotnull(cs_item_sk#34), isnotnull(cs_sold_date_sk#37)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int,cs_order_number:int,cs_quantity:int,cs_ext_sales_price:...)
         :                                                                    :     :                    :                    +- NativeSort [i_item_sk#39 ASC NULLS FIRST], false
         :                                                                    :     :                    :                       +- InputAdapter
         :                                                                    :     :                    :                          +- AQEShuffleRead coalesced
         :                                                                    :     :                    :                             +- ShuffleQueryStage X
         :                                                                    :     :                    :                                +- NativeShuffleExchange hashpartitioning(i_item_sk#39, 100), ENSURE_REQUIREMENTS, [plan_id=7]
         :                                                                    :     :                    :                                   +- NativeProject [i_item_sk#39, i_brand_id#5, i_class_id#6, i_category_id#7, i_manufact_id#8]
         :                                                                    :     :                    :                                      +- NativeFilter ((((((isnotnull(i_category#40) AND (i_category#40 = Books)) AND isnotnull(i_item_sk#39)) AND isnotnull(i_brand_id#5)) AND isnotnull(i_class_id#6)) AND isnotnull(i_category_id#7)) AND isnotnull(i_manufact_id#8))
         :                                                                    :     :                    :                                         +- InputAdapter [#39, #5, #6, #7, #40, #8]
         :                                                                    :     :                    :                                            +- NativeParquetScan  (FileScan parquet [i_item_sk#39,i_brand_id#5,i_class_id#6,i_category_id#7,i_category#40,i_manufact_id#8] Batched: true, DataFilters: [isnotnull(i_category#40), (i_category#40 = Books), isnotnull(i_item_sk#39), isnotnull(i..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_category), EqualTo(i_category,Books), IsNotNull(i_item_sk), IsNotNull(i_brand_id), I..., ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int,i_category:string,i_manufact...)
         :                                                                    :     :                    +- NativeSort [d_date_sk#38 ASC NULLS FIRST], false
         :                                                                    :     :                       +- InputAdapter
         :                                                                    :     :                          +- AQEShuffleRead coalesced
         :                                                                    :     :                             +- ShuffleQueryStage X
         :                                                                    :     :                                +- NativeShuffleExchange hashpartitioning(d_date_sk#38, 100), ENSURE_REQUIREMENTS, [plan_id=8]
         :                                                                    :     :                                   +- NativeFilter ((isnotnull(d_year#12) AND (d_year#12 = 2002)) AND isnotnull(d_date_sk#38))
         :                                                                    :     :                                      +- InputAdapter [#38, #12]
         :                                                                    :     :                                         +- NativeParquetScan  (FileScan parquet [d_date_sk#38,d_year#12] Batched: true, DataFilters: [isnotnull(d_year#12), (d_year#12 = 2002), isnotnull(d_date_sk#38)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2002), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>)
         :                                                                    :     +- NativeSort [cr_order_number#35 ASC NULLS FIRST, cr_item_sk#36 ASC NULLS FIRST], false
         :                                                                    :        +- InputAdapter
         :                                                                    :           +- AQEShuffleRead coalesced
         :                                                                    :              +- ShuffleQueryStage X
         :                                                                    :                 +- NativeShuffleExchange hashpartitioning(cr_order_number#35, cr_item_sk#36, 100), ENSURE_REQUIREMENTS, [plan_id=9]
         :                                                                    :                    +- NativeFilter (isnotnull(cr_order_number#35) AND isnotnull(cr_item_sk#36))
         :                                                                    :                       +- InputAdapter [#36, #35, #30, #32]
         :                                                                    :                          +- NativeParquetScan  (FileScan parquet [cr_item_sk#36,cr_order_number#35,cr_return_quantity#30,cr_return_amount#32] Batched: true, DataFilters: [isnotnull(cr_order_number#35), isnotnull(cr_item_sk#36)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cr_order_number), IsNotNull(cr_item_sk)], ReadSchema: struct<cr_item_sk:int,cr_order_number:int,cr_return_quantity:int,cr_return_amount:decimal(7,2)>)
         :                                                                    :- NativeProject [d_year#41, i_brand_id#42, i_class_id#43, i_category_id#44, i_manufact_id#45, (ss_quantity#46 - coalesce(sr_return_quantity#47, 0)) AS sales_cnt#48, (ss_ext_sales_price#49 - coalesce(sr_return_amt#50, 0.00)) AS sales_amt#51]
         :                                                                    :  +- NativeSortMergeJoin [ss_ticket_number#52, ss_item_sk#53], [sr_ticket_number#54, sr_item_sk#55], LeftOuter
         :                                                                    :     :- NativeSort [ss_ticket_number#52 ASC NULLS FIRST, ss_item_sk#53 ASC NULLS FIRST], false
         :                                                                    :     :  +- InputAdapter
         :                                                                    :     :     +- AQEShuffleRead coalesced
         :                                                                    :     :        +- ShuffleQueryStage X
         :                                                                    :     :           +- NativeShuffleExchange hashpartitioning(ss_ticket_number#52, ss_item_sk#53, 100), ENSURE_REQUIREMENTS, [plan_id=10]
         :                                                                    :     :              +- NativeProject [ss_item_sk#53, ss_ticket_number#52, ss_quantity#46, ss_ext_sales_price#49, i_brand_id#42, i_class_id#43, i_category_id#44, i_manufact_id#45, d_year#41]
         :                                                                    :     :                 +- NativeSortMergeJoin [ss_sold_date_sk#56], [d_date_sk#57], Inner
         :                                                                    :     :                    :- NativeSort [ss_sold_date_sk#56 ASC NULLS FIRST], false
         :                                                                    :     :                    :  +- InputAdapter
         :                                                                    :     :                    :     +- AQEShuffleRead coalesced
         :                                                                    :     :                    :        +- ShuffleQueryStage X
         :                                                                    :     :                    :           +- NativeShuffleExchange hashpartitioning(ss_sold_date_sk#56, 100), ENSURE_REQUIREMENTS, [plan_id=11]
         :                                                                    :     :                    :              +- NativeProject [ss_sold_date_sk#56, ss_item_sk#53, ss_ticket_number#52, ss_quantity#46, ss_ext_sales_price#49, i_brand_id#42, i_class_id#43, i_category_id#44, i_manufact_id#45]
         :                                                                    :     :                    :                 +- NativeSortMergeJoin [ss_item_sk#53], [i_item_sk#58], Inner
         :                                                                    :     :                    :                    :- NativeSort [ss_item_sk#53 ASC NULLS FIRST], false
         :                                                                    :     :                    :                    :  +- InputAdapter
         :                                                                    :     :                    :                    :     +- AQEShuffleRead coalesced
         :                                                                    :     :                    :                    :        +- ShuffleQueryStage X
         :                                                                    :     :                    :                    :           +- NativeShuffleExchange hashpartitioning(ss_item_sk#53, 100), ENSURE_REQUIREMENTS, [plan_id=12]
         :                                                                    :     :                    :                    :              +- NativeFilter (isnotnull(ss_item_sk#53) AND isnotnull(ss_sold_date_sk#56))
         :                                                                    :     :                    :                    :                 +- InputAdapter [#56, #53, #52, #46, #49]
         :                                                                    :     :                    :                    :                    +- NativeParquetScan  (FileScan parquet [ss_sold_date_sk#56,ss_item_sk#53,ss_ticket_number#52,ss_quantity#46,ss_ext_sales_price#49] Batched: true, DataFilters: [isnotnull(ss_item_sk#53), isnotnull(ss_sold_date_sk#56)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_ticket_number:int,ss_quantity:int,ss_ext_sales_price...)
         :                                                                    :     :                    :                    +- NativeSort [i_item_sk#58 ASC NULLS FIRST], false
         :                                                                    :     :                    :                       +- InputAdapter
         :                                                                    :     :                    :                          +- InputAdapter [#58, #42, #43, #44, #45]
         :                                                                    :     :                    :                             +- AQEShuffleRead coalesced
         :                                                                    :     :                    :                                +- ShuffleQueryStage X
         :                                                                    :     :                    :                                   +- ReusedExchange [i_item_sk#58, i_brand_id#42, i_class_id#43, i_category_id#44, i_manufact_id#45], NativeShuffleExchange hashpartitioning(i_item_sk#39, 100), ENSURE_REQUIREMENTS, [plan_id=7]
         :                                                                    :     :                    +- NativeSort [d_date_sk#57 ASC NULLS FIRST], false
         :                                                                    :     :                       +- InputAdapter
         :                                                                    :     :                          +- InputAdapter [#57, #41]
         :                                                                    :     :                             +- AQEShuffleRead coalesced
         :                                                                    :     :                                +- ShuffleQueryStage X
         :                                                                    :     :                                   +- ReusedExchange [d_date_sk#57, d_year#41], NativeShuffleExchange hashpartitioning(d_date_sk#38, 100), ENSURE_REQUIREMENTS, [plan_id=8]
         :                                                                    :     +- NativeSort [sr_ticket_number#54 ASC NULLS FIRST, sr_item_sk#55 ASC NULLS FIRST], false
         :                                                                    :        +- InputAdapter
         :                                                                    :           +- AQEShuffleRead coalesced
         :                                                                    :              +- ShuffleQueryStage X
         :                                                                    :                 +- NativeShuffleExchange hashpartitioning(sr_ticket_number#54, sr_item_sk#55, 100), ENSURE_REQUIREMENTS, [plan_id=13]
         :                                                                    :                    +- NativeFilter (isnotnull(sr_ticket_number#54) AND isnotnull(sr_item_sk#55))
         :                                                                    :                       +- InputAdapter [#55, #54, #47, #50]
         :                                                                    :                          +- NativeParquetScan  (FileScan parquet [sr_item_sk#55,sr_ticket_number#54,sr_return_quantity#47,sr_return_amt#50] Batched: true, DataFilters: [isnotnull(sr_ticket_number#54), isnotnull(sr_item_sk#55)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(sr_ticket_number), IsNotNull(sr_item_sk)], ReadSchema: struct<sr_item_sk:int,sr_ticket_number:int,sr_return_quantity:int,sr_return_amt:decimal(7,2)>)
         :                                                                    +- NativeProject [d_year#59, i_brand_id#60, i_class_id#61, i_category_id#62, i_manufact_id#63, (ws_quantity#64 - coalesce(wr_return_quantity#65, 0)) AS sales_cnt#66, (ws_ext_sales_price#67 - coalesce(wr_return_amt#68, 0.00)) AS sales_amt#69]
         :                                                                       +- NativeSortMergeJoin [ws_order_number#70, ws_item_sk#71], [wr_order_number#72, wr_item_sk#73], LeftOuter
         :                                                                          :- NativeSort [ws_order_number#70 ASC NULLS FIRST, ws_item_sk#71 ASC NULLS FIRST], false
         :                                                                          :  +- InputAdapter
         :                                                                          :     +- AQEShuffleRead coalesced
         :                                                                          :        +- ShuffleQueryStage X
         :                                                                          :           +- NativeShuffleExchange hashpartitioning(ws_order_number#70, ws_item_sk#71, 100), ENSURE_REQUIREMENTS, [plan_id=14]
         :                                                                          :              +- NativeProject [ws_item_sk#71, ws_order_number#70, ws_quantity#64, ws_ext_sales_price#67, i_brand_id#60, i_class_id#61, i_category_id#62, i_manufact_id#63, d_year#59]
         :                                                                          :                 +- NativeSortMergeJoin [ws_sold_date_sk#74], [d_date_sk#75], Inner
         :                                                                          :                    :- NativeSort [ws_sold_date_sk#74 ASC NULLS FIRST], false
         :                                                                          :                    :  +- InputAdapter
         :                                                                          :                    :     +- AQEShuffleRead coalesced
         :                                                                          :                    :        +- ShuffleQueryStage X
         :                                                                          :                    :           +- NativeShuffleExchange hashpartitioning(ws_sold_date_sk#74, 100), ENSURE_REQUIREMENTS, [plan_id=15]
         :                                                                          :                    :              +- NativeProject [ws_sold_date_sk#74, ws_item_sk#71, ws_order_number#70, ws_quantity#64, ws_ext_sales_price#67, i_brand_id#60, i_class_id#61, i_category_id#62, i_manufact_id#63]
         :                                                                          :                    :                 +- NativeSortMergeJoin [ws_item_sk#71], [i_item_sk#76], Inner
         :                                                                          :                    :                    :- NativeSort [ws_item_sk#71 ASC NULLS FIRST], false
         :                                                                          :                    :                    :  +- InputAdapter
         :                                                                          :                    :                    :     +- AQEShuffleRead coalesced
         :                                                                          :                    :                    :        +- ShuffleQueryStage X
         :                                                                          :                    :                    :           +- NativeShuffleExchange hashpartitioning(ws_item_sk#71, 100), ENSURE_REQUIREMENTS, [plan_id=16]
         :                                                                          :                    :                    :              +- NativeFilter (isnotnull(ws_item_sk#71) AND isnotnull(ws_sold_date_sk#74))
         :                                                                          :                    :                    :                 +- InputAdapter [#74, #71, #70, #64, #67]
         :                                                                          :                    :                    :                    +- NativeParquetScan  (FileScan parquet [ws_sold_date_sk#74,ws_item_sk#71,ws_order_number#70,ws_quantity#64,ws_ext_sales_price#67] Batched: true, DataFilters: [isnotnull(ws_item_sk#71), isnotnull(ws_sold_date_sk#74)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int,ws_order_number:int,ws_quantity:int,ws_ext_sales_price:...)
         :                                                                          :                    :                    +- NativeSort [i_item_sk#76 ASC NULLS FIRST], false
         :                                                                          :                    :                       +- InputAdapter
         :                                                                          :                    :                          +- InputAdapter [#76, #60, #61, #62, #63]
         :                                                                          :                    :                             +- AQEShuffleRead coalesced
         :                                                                          :                    :                                +- ShuffleQueryStage X
         :                                                                          :                    :                                   +- ReusedExchange [i_item_sk#76, i_brand_id#60, i_class_id#61, i_category_id#62, i_manufact_id#63], NativeShuffleExchange hashpartitioning(i_item_sk#39, 100), ENSURE_REQUIREMENTS, [plan_id=7]
         :                                                                          :                    +- NativeSort [d_date_sk#75 ASC NULLS FIRST], false
         :                                                                          :                       +- InputAdapter
         :                                                                          :                          +- InputAdapter [#75, #59]
         :                                                                          :                             +- AQEShuffleRead coalesced
         :                                                                          :                                +- ShuffleQueryStage X
         :                                                                          :                                   +- ReusedExchange [d_date_sk#75, d_year#59], NativeShuffleExchange hashpartitioning(d_date_sk#38, 100), ENSURE_REQUIREMENTS, [plan_id=8]
         :                                                                          +- NativeSort [wr_order_number#72 ASC NULLS FIRST, wr_item_sk#73 ASC NULLS FIRST], false
         :                                                                             +- InputAdapter
         :                                                                                +- AQEShuffleRead coalesced
         :                                                                                   +- ShuffleQueryStage X
         :                                                                                      +- NativeShuffleExchange hashpartitioning(wr_order_number#72, wr_item_sk#73, 100), ENSURE_REQUIREMENTS, [plan_id=17]
         :                                                                                         +- NativeFilter (isnotnull(wr_order_number#72) AND isnotnull(wr_item_sk#73))
         :                                                                                            +- InputAdapter [#73, #72, #65, #68]
         :                                                                                               +- NativeParquetScan  (FileScan parquet [wr_item_sk#73,wr_order_number#72,wr_return_quantity#65,wr_return_amt#68] Batched: true, DataFilters: [isnotnull(wr_order_number#72), isnotnull(wr_item_sk#73)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(wr_order_number), IsNotNull(wr_item_sk)], ReadSchema: struct<wr_item_sk:int,wr_order_number:int,wr_return_quantity:int,wr_return_amt:decimal(7,2)>)
         +- NativeSort [i_brand_id#17 ASC NULLS FIRST, i_class_id#18 ASC NULLS FIRST, i_category_id#19 ASC NULLS FIRST, i_manufact_id#20 ASC NULLS FIRST], false
            +- InputAdapter
               +- AQEShuffleRead coalesced
                  +- ShuffleQueryStage X
                     +- NativeShuffleExchange hashpartitioning(i_brand_id#17, i_class_id#18, i_category_id#19, i_manufact_id#20, 100), ENSURE_REQUIREMENTS, [plan_id=18]
                        +- NativeFilter isnotnull(sales_cnt#13)
                           +- NativeProject [d_year#11, i_brand_id#17, i_class_id#18, i_category_id#19, i_manufact_id#20, sum(sales_cnt#21)#22 AS sales_cnt#13, MakeDecimal(sum(UnscaledValue(sales_amt#23))#24,18,2) AS sales_amt#16]
                              +- NativeHashAggregate HashAgg, ArrayBuffer(d_year#11, i_brand_id#17, i_class_id#18, i_category_id#19, i_manufact_id#20), [d_year#11, i_brand_id#17, i_class_id#18, i_category_id#19, i_manufact_id#20], [sum(sales_cnt#21), sum(UnscaledValue(sales_amt#23))], [sum(sales_cnt#21)#22, sum(UnscaledValue(sales_amt#23))#24], 5
                                 +- InputAdapter
                                    +- AQEShuffleRead coalesced
                                       +- ShuffleQueryStage X
                                          +- NativeShuffleExchange hashpartitioning(d_year#11, i_brand_id#17, i_class_id#18, i_category_id#19, i_manufact_id#20, 100), ENSURE_REQUIREMENTS, [plan_id=19]
                                             +- NativeHashAggregate HashAgg, [d_year#11, i_brand_id#17, i_class_id#18, i_category_id#19, i_manufact_id#20], [partial_sum(_c5#77), partial_sum(_c6#78)], [sum#27, sum#79], 0
                                                +- NativeProject [d_year#11 AS d_year#11, i_brand_id#17 AS i_brand_id#17, i_class_id#18 AS i_class_id#18, i_category_id#19 AS i_category_id#19, i_manufact_id#20 AS i_manufact_id#20, sales_cnt#21 AS _c5#77, UnscaledValue(sales_amt#23) AS _c6#78]
                                                   +- NativeProject [d_year#11, i_brand_id#17, i_class_id#18, i_category_id#19, i_manufact_id#20, sales_cnt#21, sales_amt#23]
                                                      +- NativeHashAggregate HashAgg, ArrayBuffer(d_year#11, i_brand_id#17, i_class_id#18, i_category_id#19, i_manufact_id#20, sales_cnt#21, sales_amt#23), [d_year#11, i_brand_id#17, i_class_id#18, i_category_id#19, i_manufact_id#20, sales_cnt#21, sales_amt#23], 7
                                                         +- InputAdapter
                                                            +- AQEShuffleRead coalesced
                                                               +- ShuffleQueryStage X
                                                                  +- NativeShuffleExchange hashpartitioning(d_year#11, i_brand_id#17, i_class_id#18, i_category_id#19, i_manufact_id#20, sales_cnt#21, sales_amt#23, 100), ENSURE_REQUIREMENTS, [plan_id=20]
                                                                     +- NativeHashAggregate HashAgg, [d_year#11, i_brand_id#17, i_class_id#18, i_category_id#19, i_manufact_id#20, sales_cnt#21, sales_amt#23], 0
                                                                        +- InputAdapter [#11, #17, #18, #19, #20, #21, #23]
                                                                           +- NativeUnion [d_year#11, i_brand_id#17, i_class_id#18, i_category_id#19, i_manufact_id#20, sales_cnt#21, sales_amt#23]
                                                                              :- NativeProject [d_year#11, i_brand_id#17, i_class_id#18, i_category_id#19, i_manufact_id#20, (cs_quantity#80 - coalesce(cr_return_quantity#81, 0)) AS sales_cnt#21, (cs_ext_sales_price#82 - coalesce(cr_return_amount#83, 0.00)) AS sales_amt#23]
                                                                              :  +- NativeSortMergeJoin [cs_order_number#84, cs_item_sk#85], [cr_order_number#86, cr_item_sk#87], LeftOuter
                                                                              :     :- NativeSort [cs_order_number#84 ASC NULLS FIRST, cs_item_sk#85 ASC NULLS FIRST], false
                                                                              :     :  +- InputAdapter
                                                                              :     :     +- AQEShuffleRead coalesced
                                                                              :     :        +- ShuffleQueryStage X
                                                                              :     :           +- NativeShuffleExchange hashpartitioning(cs_order_number#84, cs_item_sk#85, 100), ENSURE_REQUIREMENTS, [plan_id=21]
                                                                              :     :              +- NativeProject [cs_item_sk#85, cs_order_number#84, cs_quantity#80, cs_ext_sales_price#82, i_brand_id#17, i_class_id#18, i_category_id#19, i_manufact_id#20, d_year#11]
                                                                              :     :                 +- NativeSortMergeJoin [cs_sold_date_sk#88], [d_date_sk#89], Inner
                                                                              :     :                    :- NativeSort [cs_sold_date_sk#88 ASC NULLS FIRST], false
                                                                              :     :                    :  +- InputAdapter
                                                                              :     :                    :     +- InputAdapter [#88, #85, #84, #80, #82, #17, #18, #19, #20]
                                                                              :     :                    :        +- AQEShuffleRead coalesced
                                                                              :     :                    :           +- ShuffleQueryStage X
                                                                              :     :                    :              +- ReusedExchange [cs_sold_date_sk#88, cs_item_sk#85, cs_order_number#84, cs_quantity#80, cs_ext_sales_price#82, i_brand_id#17, i_class_id#18, i_category_id#19, i_manufact_id#20], NativeShuffleExchange hashpartitioning(cs_sold_date_sk#37, 100), ENSURE_REQUIREMENTS, [plan_id=5]
                                                                              :     :                    +- NativeSort [d_date_sk#89 ASC NULLS FIRST], false
                                                                              :     :                       +- InputAdapter
                                                                              :     :                          +- AQEShuffleRead coalesced
                                                                              :     :                             +- ShuffleQueryStage X
                                                                              :     :                                +- NativeShuffleExchange hashpartitioning(d_date_sk#89, 100), ENSURE_REQUIREMENTS, [plan_id=22]
                                                                              :     :                                   +- NativeFilter ((isnotnull(d_year#11) AND (d_year#11 = 2001)) AND isnotnull(d_date_sk#89))
                                                                              :     :                                      +- InputAdapter [#89, #11]
                                                                              :     :                                         +- NativeParquetScan  (FileScan parquet [d_date_sk#89,d_year#11] Batched: true, DataFilters: [isnotnull(d_year#11), (d_year#11 = 2001), isnotnull(d_date_sk#89)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2001), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>)
                                                                              :     +- NativeSort [cr_order_number#86 ASC NULLS FIRST, cr_item_sk#87 ASC NULLS FIRST], false
                                                                              :        +- InputAdapter
                                                                              :           +- InputAdapter [#87, #86, #81, #83]
                                                                              :              +- AQEShuffleRead coalesced
                                                                              :                 +- ShuffleQueryStage X
                                                                              :                    +- ReusedExchange [cr_item_sk#87, cr_order_number#86, cr_return_quantity#81, cr_return_amount#83], NativeShuffleExchange hashpartitioning(cr_order_number#35, cr_item_sk#36, 100), ENSURE_REQUIREMENTS, [plan_id=9]
                                                                              :- NativeProject [d_year#90, i_brand_id#91, i_class_id#92, i_category_id#93, i_manufact_id#94, (ss_quantity#95 - coalesce(sr_return_quantity#96, 0)) AS sales_cnt#48, (ss_ext_sales_price#97 - coalesce(sr_return_amt#98, 0.00)) AS sales_amt#51]
                                                                              :  +- NativeSortMergeJoin [ss_ticket_number#99, ss_item_sk#100], [sr_ticket_number#101, sr_item_sk#102], LeftOuter
                                                                              :     :- NativeSort [ss_ticket_number#99 ASC NULLS FIRST, ss_item_sk#100 ASC NULLS FIRST], false
                                                                              :     :  +- InputAdapter
                                                                              :     :     +- AQEShuffleRead coalesced
                                                                              :     :        +- ShuffleQueryStage X
                                                                              :     :           +- NativeShuffleExchange hashpartitioning(ss_ticket_number#99, ss_item_sk#100, 100), ENSURE_REQUIREMENTS, [plan_id=23]
                                                                              :     :              +- NativeProject [ss_item_sk#100, ss_ticket_number#99, ss_quantity#95, ss_ext_sales_price#97, i_brand_id#91, i_class_id#92, i_category_id#93, i_manufact_id#94, d_year#90]
                                                                              :     :                 +- NativeSortMergeJoin [ss_sold_date_sk#103], [d_date_sk#104], Inner
                                                                              :     :                    :- NativeSort [ss_sold_date_sk#103 ASC NULLS FIRST], false
                                                                              :     :                    :  +- InputAdapter
                                                                              :     :                    :     +- InputAdapter [#103, #100, #99, #95, #97, #91, #92, #93, #94]
                                                                              :     :                    :        +- AQEShuffleRead coalesced
                                                                              :     :                    :           +- ShuffleQueryStage X
                                                                              :     :                    :              +- ReusedExchange [ss_sold_date_sk#103, ss_item_sk#100, ss_ticket_number#99, ss_quantity#95, ss_ext_sales_price#97, i_brand_id#91, i_class_id#92, i_category_id#93, i_manufact_id#94], NativeShuffleExchange hashpartitioning(ss_sold_date_sk#56, 100), ENSURE_REQUIREMENTS, [plan_id=11]
                                                                              :     :                    +- NativeSort [d_date_sk#104 ASC NULLS FIRST], false
                                                                              :     :                       +- InputAdapter
                                                                              :     :                          +- InputAdapter [#104, #90]
                                                                              :     :                             +- AQEShuffleRead coalesced
                                                                              :     :                                +- ShuffleQueryStage X
                                                                              :     :                                   +- ReusedExchange [d_date_sk#104, d_year#90], NativeShuffleExchange hashpartitioning(d_date_sk#89, 100), ENSURE_REQUIREMENTS, [plan_id=22]
                                                                              :     +- NativeSort [sr_ticket_number#101 ASC NULLS FIRST, sr_item_sk#102 ASC NULLS FIRST], false
                                                                              :        +- InputAdapter
                                                                              :           +- InputAdapter [#102, #101, #96, #98]
                                                                              :              +- AQEShuffleRead coalesced
                                                                              :                 +- ShuffleQueryStage X
                                                                              :                    +- ReusedExchange [sr_item_sk#102, sr_ticket_number#101, sr_return_quantity#96, sr_return_amt#98], NativeShuffleExchange hashpartitioning(sr_ticket_number#54, sr_item_sk#55, 100), ENSURE_REQUIREMENTS, [plan_id=13]
                                                                              +- NativeProject [d_year#105, i_brand_id#106, i_class_id#107, i_category_id#108, i_manufact_id#109, (ws_quantity#110 - coalesce(wr_return_quantity#111, 0)) AS sales_cnt#66, (ws_ext_sales_price#112 - coalesce(wr_return_amt#113, 0.00)) AS sales_amt#69]
                                                                                 +- NativeSortMergeJoin [ws_order_number#114, ws_item_sk#115], [wr_order_number#116, wr_item_sk#117], LeftOuter
                                                                                    :- NativeSort [ws_order_number#114 ASC NULLS FIRST, ws_item_sk#115 ASC NULLS FIRST], false
                                                                                    :  +- InputAdapter
                                                                                    :     +- AQEShuffleRead coalesced
                                                                                    :        +- ShuffleQueryStage X
                                                                                    :           +- NativeShuffleExchange hashpartitioning(ws_order_number#114, ws_item_sk#115, 100), ENSURE_REQUIREMENTS, [plan_id=24]
                                                                                    :              +- NativeProject [ws_item_sk#115, ws_order_number#114, ws_quantity#110, ws_ext_sales_price#112, i_brand_id#106, i_class_id#107, i_category_id#108, i_manufact_id#109, d_year#105]
                                                                                    :                 +- NativeSortMergeJoin [ws_sold_date_sk#118], [d_date_sk#119], Inner
                                                                                    :                    :- NativeSort [ws_sold_date_sk#118 ASC NULLS FIRST], false
                                                                                    :                    :  +- InputAdapter
                                                                                    :                    :     +- InputAdapter [#118, #115, #114, #110, #112, #106, #107, #108, #109]
                                                                                    :                    :        +- AQEShuffleRead coalesced
                                                                                    :                    :           +- ShuffleQueryStage X
                                                                                    :                    :              +- ReusedExchange [ws_sold_date_sk#118, ws_item_sk#115, ws_order_number#114, ws_quantity#110, ws_ext_sales_price#112, i_brand_id#106, i_class_id#107, i_category_id#108, i_manufact_id#109], NativeShuffleExchange hashpartitioning(ws_sold_date_sk#74, 100), ENSURE_REQUIREMENTS, [plan_id=15]
                                                                                    :                    +- NativeSort [d_date_sk#119 ASC NULLS FIRST], false
                                                                                    :                       +- InputAdapter
                                                                                    :                          +- InputAdapter [#119, #105]
                                                                                    :                             +- AQEShuffleRead coalesced
                                                                                    :                                +- ShuffleQueryStage X
                                                                                    :                                   +- ReusedExchange [d_date_sk#119, d_year#105], NativeShuffleExchange hashpartitioning(d_date_sk#89, 100), ENSURE_REQUIREMENTS, [plan_id=22]
                                                                                    +- NativeSort [wr_order_number#116 ASC NULLS FIRST, wr_item_sk#117 ASC NULLS FIRST], false
                                                                                       +- InputAdapter
                                                                                          +- InputAdapter [#117, #116, #111, #113]
                                                                                             +- AQEShuffleRead coalesced
                                                                                                +- ShuffleQueryStage X
                                                                                                   +- ReusedExchange [wr_item_sk#117, wr_order_number#116, wr_return_quantity#111, wr_return_amt#113], NativeShuffleExchange hashpartitioning(wr_order_number#72, wr_item_sk#73, 100), ENSURE_REQUIREMENTS, [plan_id=17]
+- == Initial Plan ==
   TakeOrderedAndProject(limit=100, orderBy=[sales_cnt_diff#1 ASC NULLS FIRST,sales_amt_diff#2 ASC NULLS FIRST], output=[prev_year#3,year#4,i_brand_id#5,i_class_id#6,i_category_id#7,i_manufact_id#8,prev_yr_cnt#9,curr_yr_cnt#10,sales_cnt_diff#1,sales_amt_diff#2])
   +- Project [d_year#11 AS prev_year#3, d_year#12 AS year#4, i_brand_id#5, i_class_id#6, i_category_id#7, i_manufact_id#8, sales_cnt#13 AS prev_yr_cnt#9, sales_cnt#14 AS curr_yr_cnt#10, (sales_cnt#14 - sales_cnt#13) AS sales_cnt_diff#1, (sales_amt#15 - sales_amt#16) AS sales_amt_diff#2]
      +- SortMergeJoin [i_brand_id#5, i_class_id#6, i_category_id#7, i_manufact_id#8], [i_brand_id#17, i_class_id#18, i_category_id#19, i_manufact_id#20], Inner, ((cast(sales_cnt#14 as decimal(17,2)) / cast(sales_cnt#13 as decimal(17,2))) < 0.90000000000000000000)
         :- Sort [i_brand_id#5 ASC NULLS FIRST, i_class_id#6 ASC NULLS FIRST, i_category_id#7 ASC NULLS FIRST, i_manufact_id#8 ASC NULLS FIRST], false, 0
         :  +- Exchange hashpartitioning(i_brand_id#5, i_class_id#6, i_category_id#7, i_manufact_id#8, 100), ENSURE_REQUIREMENTS, [plan_id=25]
         :     +- Filter isnotnull(sales_cnt#14)
         :        +- HashAggregate(keys=[d_year#12, i_brand_id#5, i_class_id#6, i_category_id#7, i_manufact_id#8], functions=[sum(sales_cnt#21), sum(UnscaledValue(sales_amt#23))], output=[d_year#12, i_brand_id#5, i_class_id#6, i_category_id#7, i_manufact_id#8, sales_cnt#14, sales_amt#15])
         :           +- Exchange hashpartitioning(d_year#12, i_brand_id#5, i_class_id#6, i_category_id#7, i_manufact_id#8, 100), ENSURE_REQUIREMENTS, [plan_id=26]
         :              +- HashAggregate(keys=[d_year#12, i_brand_id#5, i_class_id#6, i_category_id#7, i_manufact_id#8], functions=[partial_sum(sales_cnt#21), partial_sum(UnscaledValue(sales_amt#23))], output=[d_year#12, i_brand_id#5, i_class_id#6, i_category_id#7, i_manufact_id#8, sum#120, sum#121])
         :                 +- HashAggregate(keys=[d_year#12, i_brand_id#5, i_class_id#6, i_category_id#7, i_manufact_id#8, sales_cnt#21, sales_amt#23], functions=[], output=[d_year#12, i_brand_id#5, i_class_id#6, i_category_id#7, i_manufact_id#8, sales_cnt#21, sales_amt#23])
         :                    +- Exchange hashpartitioning(d_year#12, i_brand_id#5, i_class_id#6, i_category_id#7, i_manufact_id#8, sales_cnt#21, sales_amt#23, 100), ENSURE_REQUIREMENTS, [plan_id=27]
         :                       +- HashAggregate(keys=[d_year#12, i_brand_id#5, i_class_id#6, i_category_id#7, i_manufact_id#8, sales_cnt#21, sales_amt#23], functions=[], output=[d_year#12, i_brand_id#5, i_class_id#6, i_category_id#7, i_manufact_id#8, sales_cnt#21, sales_amt#23])
         :                          +- Union
         :                             :- Project [d_year#12, i_brand_id#5, i_class_id#6, i_category_id#7, i_manufact_id#8, (cs_quantity#29 - coalesce(cr_return_quantity#30, 0)) AS sales_cnt#21, (cs_ext_sales_price#31 - coalesce(cr_return_amount#32, 0.00)) AS sales_amt#23]
         :                             :  +- SortMergeJoin [cs_order_number#33, cs_item_sk#34], [cr_order_number#35, cr_item_sk#36], LeftOuter
         :                             :     :- Sort [cs_order_number#33 ASC NULLS FIRST, cs_item_sk#34 ASC NULLS FIRST], false, 0
         :                             :     :  +- Exchange hashpartitioning(cs_order_number#33, cs_item_sk#34, 100), ENSURE_REQUIREMENTS, [plan_id=28]
         :                             :     :     +- Project [cs_item_sk#34, cs_order_number#33, cs_quantity#29, cs_ext_sales_price#31, i_brand_id#5, i_class_id#6, i_category_id#7, i_manufact_id#8, d_year#12]
         :                             :     :        +- SortMergeJoin [cs_sold_date_sk#37], [d_date_sk#38], Inner
         :                             :     :           :- Sort [cs_sold_date_sk#37 ASC NULLS FIRST], false, 0
         :                             :     :           :  +- Exchange hashpartitioning(cs_sold_date_sk#37, 100), ENSURE_REQUIREMENTS, [plan_id=29]
         :                             :     :           :     +- Project [cs_sold_date_sk#37, cs_item_sk#34, cs_order_number#33, cs_quantity#29, cs_ext_sales_price#31, i_brand_id#5, i_class_id#6, i_category_id#7, i_manufact_id#8]
         :                             :     :           :        +- SortMergeJoin [cs_item_sk#34], [i_item_sk#39], Inner
         :                             :     :           :           :- Sort [cs_item_sk#34 ASC NULLS FIRST], false, 0
         :                             :     :           :           :  +- Exchange hashpartitioning(cs_item_sk#34, 100), ENSURE_REQUIREMENTS, [plan_id=30]
         :                             :     :           :           :     +- Filter (isnotnull(cs_item_sk#34) AND isnotnull(cs_sold_date_sk#37))
         :                             :     :           :           :        +- FileScan parquet [cs_sold_date_sk#37,cs_item_sk#34,cs_order_number#33,cs_quantity#29,cs_ext_sales_price#31] Batched: true, DataFilters: [isnotnull(cs_item_sk#34), isnotnull(cs_sold_date_sk#37)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int,cs_order_number:int,cs_quantity:int,cs_ext_sales_price:...
         :                             :     :           :           +- Sort [i_item_sk#39 ASC NULLS FIRST], false, 0
         :                             :     :           :              +- Exchange hashpartitioning(i_item_sk#39, 100), ENSURE_REQUIREMENTS, [plan_id=31]
         :                             :     :           :                 +- Project [i_item_sk#39, i_brand_id#5, i_class_id#6, i_category_id#7, i_manufact_id#8]
         :                             :     :           :                    +- Filter ((((((isnotnull(i_category#40) AND (i_category#40 = Books)) AND isnotnull(i_item_sk#39)) AND isnotnull(i_brand_id#5)) AND isnotnull(i_class_id#6)) AND isnotnull(i_category_id#7)) AND isnotnull(i_manufact_id#8))
         :                             :     :           :                       +- FileScan parquet [i_item_sk#39,i_brand_id#5,i_class_id#6,i_category_id#7,i_category#40,i_manufact_id#8] Batched: true, DataFilters: [isnotnull(i_category#40), (i_category#40 = Books), isnotnull(i_item_sk#39), isnotnull(i..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_category), EqualTo(i_category,Books), IsNotNull(i_item_sk), IsNotNull(i_brand_id), I..., ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int,i_category:string,i_manufact...
         :                             :     :           +- Sort [d_date_sk#38 ASC NULLS FIRST], false, 0
         :                             :     :              +- Exchange hashpartitioning(d_date_sk#38, 100), ENSURE_REQUIREMENTS, [plan_id=32]
         :                             :     :                 +- Filter ((isnotnull(d_year#12) AND (d_year#12 = 2002)) AND isnotnull(d_date_sk#38))
         :                             :     :                    +- FileScan parquet [d_date_sk#38,d_year#12] Batched: true, DataFilters: [isnotnull(d_year#12), (d_year#12 = 2002), isnotnull(d_date_sk#38)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2002), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
         :                             :     +- Sort [cr_order_number#35 ASC NULLS FIRST, cr_item_sk#36 ASC NULLS FIRST], false, 0
         :                             :        +- Exchange hashpartitioning(cr_order_number#35, cr_item_sk#36, 100), ENSURE_REQUIREMENTS, [plan_id=33]
         :                             :           +- Filter (isnotnull(cr_order_number#35) AND isnotnull(cr_item_sk#36))
         :                             :              +- FileScan parquet [cr_item_sk#36,cr_order_number#35,cr_return_quantity#30,cr_return_amount#32] Batched: true, DataFilters: [isnotnull(cr_order_number#35), isnotnull(cr_item_sk#36)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cr_order_number), IsNotNull(cr_item_sk)], ReadSchema: struct<cr_item_sk:int,cr_order_number:int,cr_return_quantity:int,cr_return_amount:decimal(7,2)>
         :                             :- Project [d_year#41, i_brand_id#42, i_class_id#43, i_category_id#44, i_manufact_id#45, (ss_quantity#46 - coalesce(sr_return_quantity#47, 0)) AS sales_cnt#48, (ss_ext_sales_price#49 - coalesce(sr_return_amt#50, 0.00)) AS sales_amt#51]
         :                             :  +- SortMergeJoin [ss_ticket_number#52, ss_item_sk#53], [sr_ticket_number#54, sr_item_sk#55], LeftOuter
         :                             :     :- Sort [ss_ticket_number#52 ASC NULLS FIRST, ss_item_sk#53 ASC NULLS FIRST], false, 0
         :                             :     :  +- Exchange hashpartitioning(ss_ticket_number#52, ss_item_sk#53, 100), ENSURE_REQUIREMENTS, [plan_id=34]
         :                             :     :     +- Project [ss_item_sk#53, ss_ticket_number#52, ss_quantity#46, ss_ext_sales_price#49, i_brand_id#42, i_class_id#43, i_category_id#44, i_manufact_id#45, d_year#41]
         :                             :     :        +- SortMergeJoin [ss_sold_date_sk#56], [d_date_sk#57], Inner
         :                             :     :           :- Sort [ss_sold_date_sk#56 ASC NULLS FIRST], false, 0
         :                             :     :           :  +- Exchange hashpartitioning(ss_sold_date_sk#56, 100), ENSURE_REQUIREMENTS, [plan_id=35]
         :                             :     :           :     +- Project [ss_sold_date_sk#56, ss_item_sk#53, ss_ticket_number#52, ss_quantity#46, ss_ext_sales_price#49, i_brand_id#42, i_class_id#43, i_category_id#44, i_manufact_id#45]
         :                             :     :           :        +- SortMergeJoin [ss_item_sk#53], [i_item_sk#58], Inner
         :                             :     :           :           :- Sort [ss_item_sk#53 ASC NULLS FIRST], false, 0
         :                             :     :           :           :  +- Exchange hashpartitioning(ss_item_sk#53, 100), ENSURE_REQUIREMENTS, [plan_id=36]
         :                             :     :           :           :     +- Filter (isnotnull(ss_item_sk#53) AND isnotnull(ss_sold_date_sk#56))
         :                             :     :           :           :        +- FileScan parquet [ss_sold_date_sk#56,ss_item_sk#53,ss_ticket_number#52,ss_quantity#46,ss_ext_sales_price#49] Batched: true, DataFilters: [isnotnull(ss_item_sk#53), isnotnull(ss_sold_date_sk#56)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_ticket_number:int,ss_quantity:int,ss_ext_sales_price...
         :                             :     :           :           +- Sort [i_item_sk#58 ASC NULLS FIRST], false, 0
         :                             :     :           :              +- Exchange hashpartitioning(i_item_sk#58, 100), ENSURE_REQUIREMENTS, [plan_id=37]
         :                             :     :           :                 +- Project [i_item_sk#58, i_brand_id#42, i_class_id#43, i_category_id#44, i_manufact_id#45]
         :                             :     :           :                    +- Filter ((((((isnotnull(i_category#122) AND (i_category#122 = Books)) AND isnotnull(i_item_sk#58)) AND isnotnull(i_brand_id#42)) AND isnotnull(i_class_id#43)) AND isnotnull(i_category_id#44)) AND isnotnull(i_manufact_id#45))
         :                             :     :           :                       +- FileScan parquet [i_item_sk#58,i_brand_id#42,i_class_id#43,i_category_id#44,i_category#122,i_manufact_id#45] Batched: true, DataFilters: [isnotnull(i_category#122), (i_category#122 = Books), isnotnull(i_item_sk#58), isnotnull(i..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_category), EqualTo(i_category,Books), IsNotNull(i_item_sk), IsNotNull(i_brand_id), I..., ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int,i_category:string,i_manufact...
         :                             :     :           +- Sort [d_date_sk#57 ASC NULLS FIRST], false, 0
         :                             :     :              +- Exchange hashpartitioning(d_date_sk#57, 100), ENSURE_REQUIREMENTS, [plan_id=38]
         :                             :     :                 +- Filter ((isnotnull(d_year#41) AND (d_year#41 = 2002)) AND isnotnull(d_date_sk#57))
         :                             :     :                    +- FileScan parquet [d_date_sk#57,d_year#41] Batched: true, DataFilters: [isnotnull(d_year#41), (d_year#41 = 2002), isnotnull(d_date_sk#57)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2002), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
         :                             :     +- Sort [sr_ticket_number#54 ASC NULLS FIRST, sr_item_sk#55 ASC NULLS FIRST], false, 0
         :                             :        +- Exchange hashpartitioning(sr_ticket_number#54, sr_item_sk#55, 100), ENSURE_REQUIREMENTS, [plan_id=39]
         :                             :           +- Filter (isnotnull(sr_ticket_number#54) AND isnotnull(sr_item_sk#55))
         :                             :              +- FileScan parquet [sr_item_sk#55,sr_ticket_number#54,sr_return_quantity#47,sr_return_amt#50] Batched: true, DataFilters: [isnotnull(sr_ticket_number#54), isnotnull(sr_item_sk#55)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(sr_ticket_number), IsNotNull(sr_item_sk)], ReadSchema: struct<sr_item_sk:int,sr_ticket_number:int,sr_return_quantity:int,sr_return_amt:decimal(7,2)>
         :                             +- Project [d_year#59, i_brand_id#60, i_class_id#61, i_category_id#62, i_manufact_id#63, (ws_quantity#64 - coalesce(wr_return_quantity#65, 0)) AS sales_cnt#66, (ws_ext_sales_price#67 - coalesce(wr_return_amt#68, 0.00)) AS sales_amt#69]
         :                                +- SortMergeJoin [ws_order_number#70, ws_item_sk#71], [wr_order_number#72, wr_item_sk#73], LeftOuter
         :                                   :- Sort [ws_order_number#70 ASC NULLS FIRST, ws_item_sk#71 ASC NULLS FIRST], false, 0
         :                                   :  +- Exchange hashpartitioning(ws_order_number#70, ws_item_sk#71, 100), ENSURE_REQUIREMENTS, [plan_id=40]
         :                                   :     +- Project [ws_item_sk#71, ws_order_number#70, ws_quantity#64, ws_ext_sales_price#67, i_brand_id#60, i_class_id#61, i_category_id#62, i_manufact_id#63, d_year#59]
         :                                   :        +- SortMergeJoin [ws_sold_date_sk#74], [d_date_sk#75], Inner
         :                                   :           :- Sort [ws_sold_date_sk#74 ASC NULLS FIRST], false, 0
         :                                   :           :  +- Exchange hashpartitioning(ws_sold_date_sk#74, 100), ENSURE_REQUIREMENTS, [plan_id=41]
         :                                   :           :     +- Project [ws_sold_date_sk#74, ws_item_sk#71, ws_order_number#70, ws_quantity#64, ws_ext_sales_price#67, i_brand_id#60, i_class_id#61, i_category_id#62, i_manufact_id#63]
         :                                   :           :        +- SortMergeJoin [ws_item_sk#71], [i_item_sk#76], Inner
         :                                   :           :           :- Sort [ws_item_sk#71 ASC NULLS FIRST], false, 0
         :                                   :           :           :  +- Exchange hashpartitioning(ws_item_sk#71, 100), ENSURE_REQUIREMENTS, [plan_id=42]
         :                                   :           :           :     +- Filter (isnotnull(ws_item_sk#71) AND isnotnull(ws_sold_date_sk#74))
         :                                   :           :           :        +- FileScan parquet [ws_sold_date_sk#74,ws_item_sk#71,ws_order_number#70,ws_quantity#64,ws_ext_sales_price#67] Batched: true, DataFilters: [isnotnull(ws_item_sk#71), isnotnull(ws_sold_date_sk#74)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int,ws_order_number:int,ws_quantity:int,ws_ext_sales_price:...
         :                                   :           :           +- Sort [i_item_sk#76 ASC NULLS FIRST], false, 0
         :                                   :           :              +- Exchange hashpartitioning(i_item_sk#76, 100), ENSURE_REQUIREMENTS, [plan_id=43]
         :                                   :           :                 +- Project [i_item_sk#76, i_brand_id#60, i_class_id#61, i_category_id#62, i_manufact_id#63]
         :                                   :           :                    +- Filter ((((((isnotnull(i_category#123) AND (i_category#123 = Books)) AND isnotnull(i_item_sk#76)) AND isnotnull(i_brand_id#60)) AND isnotnull(i_class_id#61)) AND isnotnull(i_category_id#62)) AND isnotnull(i_manufact_id#63))
         :                                   :           :                       +- FileScan parquet [i_item_sk#76,i_brand_id#60,i_class_id#61,i_category_id#62,i_category#123,i_manufact_id#63] Batched: true, DataFilters: [isnotnull(i_category#123), (i_category#123 = Books), isnotnull(i_item_sk#76), isnotnull(i..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_category), EqualTo(i_category,Books), IsNotNull(i_item_sk), IsNotNull(i_brand_id), I..., ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int,i_category:string,i_manufact...
         :                                   :           +- Sort [d_date_sk#75 ASC NULLS FIRST], false, 0
         :                                   :              +- Exchange hashpartitioning(d_date_sk#75, 100), ENSURE_REQUIREMENTS, [plan_id=44]
         :                                   :                 +- Filter ((isnotnull(d_year#59) AND (d_year#59 = 2002)) AND isnotnull(d_date_sk#75))
         :                                   :                    +- FileScan parquet [d_date_sk#75,d_year#59] Batched: true, DataFilters: [isnotnull(d_year#59), (d_year#59 = 2002), isnotnull(d_date_sk#75)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2002), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
         :                                   +- Sort [wr_order_number#72 ASC NULLS FIRST, wr_item_sk#73 ASC NULLS FIRST], false, 0
         :                                      +- Exchange hashpartitioning(wr_order_number#72, wr_item_sk#73, 100), ENSURE_REQUIREMENTS, [plan_id=45]
         :                                         +- Filter (isnotnull(wr_order_number#72) AND isnotnull(wr_item_sk#73))
         :                                            +- FileScan parquet [wr_item_sk#73,wr_order_number#72,wr_return_quantity#65,wr_return_amt#68] Batched: true, DataFilters: [isnotnull(wr_order_number#72), isnotnull(wr_item_sk#73)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(wr_order_number), IsNotNull(wr_item_sk)], ReadSchema: struct<wr_item_sk:int,wr_order_number:int,wr_return_quantity:int,wr_return_amt:decimal(7,2)>
         +- Sort [i_brand_id#17 ASC NULLS FIRST, i_class_id#18 ASC NULLS FIRST, i_category_id#19 ASC NULLS FIRST, i_manufact_id#20 ASC NULLS FIRST], false, 0
            +- Exchange hashpartitioning(i_brand_id#17, i_class_id#18, i_category_id#19, i_manufact_id#20, 100), ENSURE_REQUIREMENTS, [plan_id=46]
               +- Filter isnotnull(sales_cnt#13)
                  +- HashAggregate(keys=[d_year#11, i_brand_id#17, i_class_id#18, i_category_id#19, i_manufact_id#20], functions=[sum(sales_cnt#21), sum(UnscaledValue(sales_amt#23))], output=[d_year#11, i_brand_id#17, i_class_id#18, i_category_id#19, i_manufact_id#20, sales_cnt#13, sales_amt#16])
                     +- Exchange hashpartitioning(d_year#11, i_brand_id#17, i_class_id#18, i_category_id#19, i_manufact_id#20, 100), ENSURE_REQUIREMENTS, [plan_id=47]
                        +- HashAggregate(keys=[d_year#11, i_brand_id#17, i_class_id#18, i_category_id#19, i_manufact_id#20], functions=[partial_sum(sales_cnt#21), partial_sum(UnscaledValue(sales_amt#23))], output=[d_year#11, i_brand_id#17, i_class_id#18, i_category_id#19, i_manufact_id#20, sum#120, sum#124])
                           +- HashAggregate(keys=[d_year#11, i_brand_id#17, i_class_id#18, i_category_id#19, i_manufact_id#20, sales_cnt#21, sales_amt#23], functions=[], output=[d_year#11, i_brand_id#17, i_class_id#18, i_category_id#19, i_manufact_id#20, sales_cnt#21, sales_amt#23])
                              +- Exchange hashpartitioning(d_year#11, i_brand_id#17, i_class_id#18, i_category_id#19, i_manufact_id#20, sales_cnt#21, sales_amt#23, 100), ENSURE_REQUIREMENTS, [plan_id=48]
                                 +- HashAggregate(keys=[d_year#11, i_brand_id#17, i_class_id#18, i_category_id#19, i_manufact_id#20, sales_cnt#21, sales_amt#23], functions=[], output=[d_year#11, i_brand_id#17, i_class_id#18, i_category_id#19, i_manufact_id#20, sales_cnt#21, sales_amt#23])
                                    +- Union
                                       :- Project [d_year#11, i_brand_id#17, i_class_id#18, i_category_id#19, i_manufact_id#20, (cs_quantity#80 - coalesce(cr_return_quantity#81, 0)) AS sales_cnt#21, (cs_ext_sales_price#82 - coalesce(cr_return_amount#83, 0.00)) AS sales_amt#23]
                                       :  +- SortMergeJoin [cs_order_number#84, cs_item_sk#85], [cr_order_number#86, cr_item_sk#87], LeftOuter
                                       :     :- Sort [cs_order_number#84 ASC NULLS FIRST, cs_item_sk#85 ASC NULLS FIRST], false, 0
                                       :     :  +- Exchange hashpartitioning(cs_order_number#84, cs_item_sk#85, 100), ENSURE_REQUIREMENTS, [plan_id=49]
                                       :     :     +- Project [cs_item_sk#85, cs_order_number#84, cs_quantity#80, cs_ext_sales_price#82, i_brand_id#17, i_class_id#18, i_category_id#19, i_manufact_id#20, d_year#11]
                                       :     :        +- SortMergeJoin [cs_sold_date_sk#88], [d_date_sk#89], Inner
                                       :     :           :- Sort [cs_sold_date_sk#88 ASC NULLS FIRST], false, 0
                                       :     :           :  +- Exchange hashpartitioning(cs_sold_date_sk#88, 100), ENSURE_REQUIREMENTS, [plan_id=50]
                                       :     :           :     +- Project [cs_sold_date_sk#88, cs_item_sk#85, cs_order_number#84, cs_quantity#80, cs_ext_sales_price#82, i_brand_id#17, i_class_id#18, i_category_id#19, i_manufact_id#20]
                                       :     :           :        +- SortMergeJoin [cs_item_sk#85], [i_item_sk#125], Inner
                                       :     :           :           :- Sort [cs_item_sk#85 ASC NULLS FIRST], false, 0
                                       :     :           :           :  +- Exchange hashpartitioning(cs_item_sk#85, 100), ENSURE_REQUIREMENTS, [plan_id=51]
                                       :     :           :           :     +- Filter (isnotnull(cs_item_sk#85) AND isnotnull(cs_sold_date_sk#88))
                                       :     :           :           :        +- FileScan parquet [cs_sold_date_sk#88,cs_item_sk#85,cs_order_number#84,cs_quantity#80,cs_ext_sales_price#82] Batched: true, DataFilters: [isnotnull(cs_item_sk#85), isnotnull(cs_sold_date_sk#88)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int,cs_order_number:int,cs_quantity:int,cs_ext_sales_price:...
                                       :     :           :           +- Sort [i_item_sk#125 ASC NULLS FIRST], false, 0
                                       :     :           :              +- Exchange hashpartitioning(i_item_sk#125, 100), ENSURE_REQUIREMENTS, [plan_id=52]
                                       :     :           :                 +- Project [i_item_sk#125, i_brand_id#17, i_class_id#18, i_category_id#19, i_manufact_id#20]
                                       :     :           :                    +- Filter ((((((isnotnull(i_category#126) AND (i_category#126 = Books)) AND isnotnull(i_item_sk#125)) AND isnotnull(i_brand_id#17)) AND isnotnull(i_class_id#18)) AND isnotnull(i_category_id#19)) AND isnotnull(i_manufact_id#20))
                                       :     :           :                       +- FileScan parquet [i_item_sk#125,i_brand_id#17,i_class_id#18,i_category_id#19,i_category#126,i_manufact_id#20] Batched: true, DataFilters: [isnotnull(i_category#126), (i_category#126 = Books), isnotnull(i_item_sk#125), isnotnull(i..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_category), EqualTo(i_category,Books), IsNotNull(i_item_sk), IsNotNull(i_brand_id), I..., ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int,i_category:string,i_manufact...
                                       :     :           +- Sort [d_date_sk#89 ASC NULLS FIRST], false, 0
                                       :     :              +- Exchange hashpartitioning(d_date_sk#89, 100), ENSURE_REQUIREMENTS, [plan_id=53]
                                       :     :                 +- Filter ((isnotnull(d_year#11) AND (d_year#11 = 2001)) AND isnotnull(d_date_sk#89))
                                       :     :                    +- FileScan parquet [d_date_sk#89,d_year#11] Batched: true, DataFilters: [isnotnull(d_year#11), (d_year#11 = 2001), isnotnull(d_date_sk#89)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2001), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                                       :     +- Sort [cr_order_number#86 ASC NULLS FIRST, cr_item_sk#87 ASC NULLS FIRST], false, 0
                                       :        +- Exchange hashpartitioning(cr_order_number#86, cr_item_sk#87, 100), ENSURE_REQUIREMENTS, [plan_id=54]
                                       :           +- Filter (isnotnull(cr_order_number#86) AND isnotnull(cr_item_sk#87))
                                       :              +- FileScan parquet [cr_item_sk#87,cr_order_number#86,cr_return_quantity#81,cr_return_amount#83] Batched: true, DataFilters: [isnotnull(cr_order_number#86), isnotnull(cr_item_sk#87)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cr_order_number), IsNotNull(cr_item_sk)], ReadSchema: struct<cr_item_sk:int,cr_order_number:int,cr_return_quantity:int,cr_return_amount:decimal(7,2)>
                                       :- Project [d_year#90, i_brand_id#91, i_class_id#92, i_category_id#93, i_manufact_id#94, (ss_quantity#95 - coalesce(sr_return_quantity#96, 0)) AS sales_cnt#48, (ss_ext_sales_price#97 - coalesce(sr_return_amt#98, 0.00)) AS sales_amt#51]
                                       :  +- SortMergeJoin [ss_ticket_number#99, ss_item_sk#100], [sr_ticket_number#101, sr_item_sk#102], LeftOuter
                                       :     :- Sort [ss_ticket_number#99 ASC NULLS FIRST, ss_item_sk#100 ASC NULLS FIRST], false, 0
                                       :     :  +- Exchange hashpartitioning(ss_ticket_number#99, ss_item_sk#100, 100), ENSURE_REQUIREMENTS, [plan_id=55]
                                       :     :     +- Project [ss_item_sk#100, ss_ticket_number#99, ss_quantity#95, ss_ext_sales_price#97, i_brand_id#91, i_class_id#92, i_category_id#93, i_manufact_id#94, d_year#90]
                                       :     :        +- SortMergeJoin [ss_sold_date_sk#103], [d_date_sk#104], Inner
                                       :     :           :- Sort [ss_sold_date_sk#103 ASC NULLS FIRST], false, 0
                                       :     :           :  +- Exchange hashpartitioning(ss_sold_date_sk#103, 100), ENSURE_REQUIREMENTS, [plan_id=56]
                                       :     :           :     +- Project [ss_sold_date_sk#103, ss_item_sk#100, ss_ticket_number#99, ss_quantity#95, ss_ext_sales_price#97, i_brand_id#91, i_class_id#92, i_category_id#93, i_manufact_id#94]
                                       :     :           :        +- SortMergeJoin [ss_item_sk#100], [i_item_sk#127], Inner
                                       :     :           :           :- Sort [ss_item_sk#100 ASC NULLS FIRST], false, 0
                                       :     :           :           :  +- Exchange hashpartitioning(ss_item_sk#100, 100), ENSURE_REQUIREMENTS, [plan_id=57]
                                       :     :           :           :     +- Filter (isnotnull(ss_item_sk#100) AND isnotnull(ss_sold_date_sk#103))
                                       :     :           :           :        +- FileScan parquet [ss_sold_date_sk#103,ss_item_sk#100,ss_ticket_number#99,ss_quantity#95,ss_ext_sales_price#97] Batched: true, DataFilters: [isnotnull(ss_item_sk#100), isnotnull(ss_sold_date_sk#103)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_ticket_number:int,ss_quantity:int,ss_ext_sales_price...
                                       :     :           :           +- Sort [i_item_sk#127 ASC NULLS FIRST], false, 0
                                       :     :           :              +- Exchange hashpartitioning(i_item_sk#127, 100), ENSURE_REQUIREMENTS, [plan_id=58]
                                       :     :           :                 +- Project [i_item_sk#127, i_brand_id#91, i_class_id#92, i_category_id#93, i_manufact_id#94]
                                       :     :           :                    +- Filter ((((((isnotnull(i_category#128) AND (i_category#128 = Books)) AND isnotnull(i_item_sk#127)) AND isnotnull(i_brand_id#91)) AND isnotnull(i_class_id#92)) AND isnotnull(i_category_id#93)) AND isnotnull(i_manufact_id#94))
                                       :     :           :                       +- FileScan parquet [i_item_sk#127,i_brand_id#91,i_class_id#92,i_category_id#93,i_category#128,i_manufact_id#94] Batched: true, DataFilters: [isnotnull(i_category#128), (i_category#128 = Books), isnotnull(i_item_sk#127), isnotnull(i..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_category), EqualTo(i_category,Books), IsNotNull(i_item_sk), IsNotNull(i_brand_id), I..., ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int,i_category:string,i_manufact...
                                       :     :           +- Sort [d_date_sk#104 ASC NULLS FIRST], false, 0
                                       :     :              +- Exchange hashpartitioning(d_date_sk#104, 100), ENSURE_REQUIREMENTS, [plan_id=59]
                                       :     :                 +- Filter ((isnotnull(d_year#90) AND (d_year#90 = 2001)) AND isnotnull(d_date_sk#104))
                                       :     :                    +- FileScan parquet [d_date_sk#104,d_year#90] Batched: true, DataFilters: [isnotnull(d_year#90), (d_year#90 = 2001), isnotnull(d_date_sk#104)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2001), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                                       :     +- Sort [sr_ticket_number#101 ASC NULLS FIRST, sr_item_sk#102 ASC NULLS FIRST], false, 0
                                       :        +- Exchange hashpartitioning(sr_ticket_number#101, sr_item_sk#102, 100), ENSURE_REQUIREMENTS, [plan_id=60]
                                       :           +- Filter (isnotnull(sr_ticket_number#101) AND isnotnull(sr_item_sk#102))
                                       :              +- FileScan parquet [sr_item_sk#102,sr_ticket_number#101,sr_return_quantity#96,sr_return_amt#98] Batched: true, DataFilters: [isnotnull(sr_ticket_number#101), isnotnull(sr_item_sk#102)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(sr_ticket_number), IsNotNull(sr_item_sk)], ReadSchema: struct<sr_item_sk:int,sr_ticket_number:int,sr_return_quantity:int,sr_return_amt:decimal(7,2)>
                                       +- Project [d_year#105, i_brand_id#106, i_class_id#107, i_category_id#108, i_manufact_id#109, (ws_quantity#110 - coalesce(wr_return_quantity#111, 0)) AS sales_cnt#66, (ws_ext_sales_price#112 - coalesce(wr_return_amt#113, 0.00)) AS sales_amt#69]
                                          +- SortMergeJoin [ws_order_number#114, ws_item_sk#115], [wr_order_number#116, wr_item_sk#117], LeftOuter
                                             :- Sort [ws_order_number#114 ASC NULLS FIRST, ws_item_sk#115 ASC NULLS FIRST], false, 0
                                             :  +- Exchange hashpartitioning(ws_order_number#114, ws_item_sk#115, 100), ENSURE_REQUIREMENTS, [plan_id=61]
                                             :     +- Project [ws_item_sk#115, ws_order_number#114, ws_quantity#110, ws_ext_sales_price#112, i_brand_id#106, i_class_id#107, i_category_id#108, i_manufact_id#109, d_year#105]
                                             :        +- SortMergeJoin [ws_sold_date_sk#118], [d_date_sk#119], Inner
                                             :           :- Sort [ws_sold_date_sk#118 ASC NULLS FIRST], false, 0
                                             :           :  +- Exchange hashpartitioning(ws_sold_date_sk#118, 100), ENSURE_REQUIREMENTS, [plan_id=62]
                                             :           :     +- Project [ws_sold_date_sk#118, ws_item_sk#115, ws_order_number#114, ws_quantity#110, ws_ext_sales_price#112, i_brand_id#106, i_class_id#107, i_category_id#108, i_manufact_id#109]
                                             :           :        +- SortMergeJoin [ws_item_sk#115], [i_item_sk#129], Inner
                                             :           :           :- Sort [ws_item_sk#115 ASC NULLS FIRST], false, 0
                                             :           :           :  +- Exchange hashpartitioning(ws_item_sk#115, 100), ENSURE_REQUIREMENTS, [plan_id=63]
                                             :           :           :     +- Filter (isnotnull(ws_item_sk#115) AND isnotnull(ws_sold_date_sk#118))
                                             :           :           :        +- FileScan parquet [ws_sold_date_sk#118,ws_item_sk#115,ws_order_number#114,ws_quantity#110,ws_ext_sales_price#112] Batched: true, DataFilters: [isnotnull(ws_item_sk#115), isnotnull(ws_sold_date_sk#118)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int,ws_order_number:int,ws_quantity:int,ws_ext_sales_price:...
                                             :           :           +- Sort [i_item_sk#129 ASC NULLS FIRST], false, 0
                                             :           :              +- Exchange hashpartitioning(i_item_sk#129, 100), ENSURE_REQUIREMENTS, [plan_id=64]
                                             :           :                 +- Project [i_item_sk#129, i_brand_id#106, i_class_id#107, i_category_id#108, i_manufact_id#109]
                                             :           :                    +- Filter ((((((isnotnull(i_category#130) AND (i_category#130 = Books)) AND isnotnull(i_item_sk#129)) AND isnotnull(i_brand_id#106)) AND isnotnull(i_class_id#107)) AND isnotnull(i_category_id#108)) AND isnotnull(i_manufact_id#109))
                                             :           :                       +- FileScan parquet [i_item_sk#129,i_brand_id#106,i_class_id#107,i_category_id#108,i_category#130,i_manufact_id#109] Batched: true, DataFilters: [isnotnull(i_category#130), (i_category#130 = Books), isnotnull(i_item_sk#129), isnotnull(i..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_category), EqualTo(i_category,Books), IsNotNull(i_item_sk), IsNotNull(i_brand_id), I..., ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int,i_category:string,i_manufact...
                                             :           +- Sort [d_date_sk#119 ASC NULLS FIRST], false, 0
                                             :              +- Exchange hashpartitioning(d_date_sk#119, 100), ENSURE_REQUIREMENTS, [plan_id=65]
                                             :                 +- Filter ((isnotnull(d_year#105) AND (d_year#105 = 2001)) AND isnotnull(d_date_sk#119))
                                             :                    +- FileScan parquet [d_date_sk#119,d_year#105] Batched: true, DataFilters: [isnotnull(d_year#105), (d_year#105 = 2001), isnotnull(d_date_sk#119)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2001), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                                             +- Sort [wr_order_number#116 ASC NULLS FIRST, wr_item_sk#117 ASC NULLS FIRST], false, 0
                                                +- Exchange hashpartitioning(wr_order_number#116, wr_item_sk#117, 100), ENSURE_REQUIREMENTS, [plan_id=66]
                                                   +- Filter (isnotnull(wr_order_number#116) AND isnotnull(wr_item_sk#117))
                                                      +- FileScan parquet [wr_item_sk#117,wr_order_number#116,wr_return_quantity#111,wr_return_amt#113] Batched: true, DataFilters: [isnotnull(wr_order_number#116), isnotnull(wr_item_sk#117)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(wr_order_number), IsNotNull(wr_item_sk)], ReadSchema: struct<wr_item_sk:int,wr_order_number:int,wr_return_quantity:int,wr_return_amt:decimal(7,2)>
