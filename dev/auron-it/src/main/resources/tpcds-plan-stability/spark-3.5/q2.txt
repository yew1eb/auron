AdaptiveSparkPlan isFinalPlan=true
+- == Final Plan ==
   NativeSort [d_week_seq1#1 ASC NULLS FIRST], true
   +- InputAdapter
      +- AQEShuffleRead coalesced
         +- ShuffleQueryStage X
            +- NativeShuffleExchange rangepartitioning(d_week_seq1#1 ASC NULLS FIRST, 100), ENSURE_REQUIREMENTS, [plan_id=1]
               +- ConvertToNative
                  +- *(1) Project [d_week_seq1#1, round((sun_sales1#2 / sun_sales2#3), 2) AS round((sun_sales1 / sun_sales2), 2)#4, round((mon_sales1#5 / mon_sales2#6), 2) AS round((mon_sales1 / mon_sales2), 2)#7, round((tue_sales1#8 / tue_sales2#9), 2) AS round((tue_sales1 / tue_sales2), 2)#10, round((wed_sales1#11 / wed_sales2#12), 2) AS round((wed_sales1 / wed_sales2), 2)#13, round((thu_sales1#14 / thu_sales2#15), 2) AS round((thu_sales1 / thu_sales2), 2)#16, round((fri_sales1#17 / fri_sales2#18), 2) AS round((fri_sales1 / fri_sales2), 2)#19, round((sat_sales1#20 / sat_sales2#21), 2) AS round((sat_sales1 / sat_sales2), 2)#22]
                     +- NativeSortMergeJoin [d_week_seq1#1], [(d_week_seq2#23 - 53)], Inner
                        :- NativeProject [d_week_seq#24 AS d_week_seq1#1, sun_sales#25 AS sun_sales1#2, mon_sales#26 AS mon_sales1#5, tue_sales#27 AS tue_sales1#8, wed_sales#28 AS wed_sales1#11, thu_sales#29 AS thu_sales1#14, fri_sales#30 AS fri_sales1#17, sat_sales#31 AS sat_sales1#20]
                        :  +- NativeSortMergeJoin [d_week_seq#24], [d_week_seq#32], Inner
                        :     :- NativeSort [d_week_seq#24 ASC NULLS FIRST], false
                        :     :  +- NativeProject [d_week_seq#24, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#33 = Sunday) THEN sales_price#34 END))#35,17,2) AS sun_sales#25, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#33 = Monday) THEN sales_price#34 END))#36,17,2) AS mon_sales#26, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#33 = Tuesday) THEN sales_price#34 END))#37,17,2) AS tue_sales#27, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#33 = Wednesday) THEN sales_price#34 END))#38,17,2) AS wed_sales#28, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#33 = Thursday) THEN sales_price#34 END))#39,17,2) AS thu_sales#29, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#33 = Friday) THEN sales_price#34 END))#40,17,2) AS fri_sales#30, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#33 = Saturday) THEN sales_price#34 END))#41,17,2) AS sat_sales#31]
                        :     :     +- NativeHashAggregate HashAgg, ArrayBuffer(d_week_seq#24), [d_week_seq#24], [sum(UnscaledValue(CASE WHEN (d_day_name#33 = Sunday) THEN sales_price#34 END)), sum(UnscaledValue(CASE WHEN (d_day_name#33 = Monday) THEN sales_price#34 END)), sum(UnscaledValue(CASE WHEN (d_day_name#33 = Tuesday) THEN sales_price#34 END)), sum(UnscaledValue(CASE WHEN (d_day_name#33 = Wednesday) THEN sales_price#34 END)), sum(UnscaledValue(CASE WHEN (d_day_name#33 = Thursday) THEN sales_price#34 END)), sum(UnscaledValue(CASE WHEN (d_day_name#33 = Friday) THEN sales_price#34 END)), sum(UnscaledValue(CASE WHEN (d_day_name#33 = Saturday) THEN sales_price#34 END))], [sum(UnscaledValue(CASE WHEN (d_day_name#33 = Sunday) THEN sales_price#34 END))#35, sum(UnscaledValue(CASE WHEN (d_day_name#33 = Monday) THEN sales_price#34 END))#36, sum(UnscaledValue(CASE WHEN (d_day_name#33 = Tuesday) THEN sales_price#34 END))#37, sum(UnscaledValue(CASE WHEN (d_day_name#33 = Wednesday) THEN sales_price#34 END))#38, sum(UnscaledValue(CASE WHEN (d_day_name#33 = Thursday) THEN sales_price#34 END))#39, sum(UnscaledValue(CASE WHEN (d_day_name#33 = Friday) THEN sales_price#34 END))#40, sum(UnscaledValue(CASE WHEN (d_day_name#33 = Saturday) THEN sales_price#34 END))#41], 1
                        :     :        +- InputAdapter
                        :     :           +- AQEShuffleRead coalesced
                        :     :              +- ShuffleQueryStage X
                        :     :                 +- NativeShuffleExchange hashpartitioning(d_week_seq#24, 100), ENSURE_REQUIREMENTS, [plan_id=2]
                        :     :                    +- NativeHashAggregate HashAgg, [d_week_seq#24], [partial_sum(_c1#42), partial_sum(_c2#43), partial_sum(_c3#44), partial_sum(_c4#45), partial_sum(_c5#46), partial_sum(_c6#47), partial_sum(_c7#48)], [sum#49, sum#50, sum#51, sum#52, sum#53, sum#54, sum#55], 0
                        :     :                       +- NativeProject [d_week_seq#24 AS d_week_seq#24, UnscaledValue(CASE WHEN (d_day_name#33 = Sunday) THEN sales_price#34 END) AS _c1#42, UnscaledValue(CASE WHEN (d_day_name#33 = Monday) THEN sales_price#34 END) AS _c2#43, UnscaledValue(CASE WHEN (d_day_name#33 = Tuesday) THEN sales_price#34 END) AS _c3#44, UnscaledValue(CASE WHEN (d_day_name#33 = Wednesday) THEN sales_price#34 END) AS _c4#45, UnscaledValue(CASE WHEN (d_day_name#33 = Thursday) THEN sales_price#34 END) AS _c5#46, UnscaledValue(CASE WHEN (d_day_name#33 = Friday) THEN sales_price#34 END) AS _c6#47, UnscaledValue(CASE WHEN (d_day_name#33 = Saturday) THEN sales_price#34 END) AS _c7#48]
                        :     :                          +- NativeProject [sales_price#34, d_week_seq#24, d_day_name#33]
                        :     :                             +- NativeSortMergeJoin [sold_date_sk#56], [d_date_sk#57], Inner
                        :     :                                :- NativeSort [sold_date_sk#56 ASC NULLS FIRST], false
                        :     :                                :  +- InputAdapter
                        :     :                                :     +- AQEShuffleRead coalesced
                        :     :                                :        +- ShuffleQueryStage X
                        :     :                                :           +- NativeShuffleExchange hashpartitioning(sold_date_sk#56, 100), ENSURE_REQUIREMENTS, [plan_id=3]
                        :     :                                :              +- InputAdapter [#56, #34]
                        :     :                                :                 +- NativeUnion [sold_date_sk#56, sales_price#34]
                        :     :                                :                    :- NativeProject [ws_sold_date_sk#58 AS sold_date_sk#56, ws_ext_sales_price#59 AS sales_price#34]
                        :     :                                :                    :  +- NativeFilter isnotnull(ws_sold_date_sk#58)
                        :     :                                :                    :     +- InputAdapter [#58, #59]
                        :     :                                :                    :        +- NativeParquetScan  (FileScan parquet [ws_sold_date_sk#58,ws_ext_sales_price#59] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#58)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_ext_sales_price:decimal(7,2)>)
                        :     :                                :                    +- NativeProject [cs_sold_date_sk#60 AS sold_date_sk#61, cs_ext_sales_price#62 AS sales_price#63]
                        :     :                                :                       +- NativeFilter isnotnull(cs_sold_date_sk#60)
                        :     :                                :                          +- InputAdapter [#60, #62]
                        :     :                                :                             +- NativeParquetScan  (FileScan parquet [cs_sold_date_sk#60,cs_ext_sales_price#62] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#60)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_ext_sales_price:decimal(7,2)>)
                        :     :                                +- NativeSort [d_date_sk#57 ASC NULLS FIRST], false
                        :     :                                   +- InputAdapter
                        :     :                                      +- AQEShuffleRead coalesced
                        :     :                                         +- ShuffleQueryStage X
                        :     :                                            +- NativeShuffleExchange hashpartitioning(d_date_sk#57, 100), ENSURE_REQUIREMENTS, [plan_id=4]
                        :     :                                               +- NativeFilter (isnotnull(d_date_sk#57) AND isnotnull(d_week_seq#24))
                        :     :                                                  +- InputAdapter [#57, #24, #33]
                        :     :                                                     +- NativeParquetScan  (FileScan parquet [d_date_sk#57,d_week_seq#24,d_day_name#33] Batched: true, DataFilters: [isnotnull(d_date_sk#57), isnotnull(d_week_seq#24)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk), IsNotNull(d_week_seq)], ReadSchema: struct<d_date_sk:int,d_week_seq:int,d_day_name:string>)
                        :     +- NativeSort [d_week_seq#32 ASC NULLS FIRST], false
                        :        +- InputAdapter
                        :           +- AQEShuffleRead coalesced
                        :              +- ShuffleQueryStage X
                        :                 +- NativeShuffleExchange hashpartitioning(d_week_seq#32, 100), ENSURE_REQUIREMENTS, [plan_id=5]
                        :                    +- NativeProject [d_week_seq#32]
                        :                       +- NativeFilter ((isnotnull(d_year#64) AND (d_year#64 = 2001)) AND isnotnull(d_week_seq#32))
                        :                          +- InputAdapter [#32, #64]
                        :                             +- NativeParquetScan  (FileScan parquet [d_week_seq#32,d_year#64] Batched: true, DataFilters: [isnotnull(d_year#64), (d_year#64 = 2001), isnotnull(d_week_seq#32)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2001), IsNotNull(d_week_seq)], ReadSchema: struct<d_week_seq:int,d_year:int>)
                        +- NativeSort [(d_week_seq2#23 - 53) ASC NULLS FIRST], false
                           +- InputAdapter
                              +- AQEShuffleRead coalesced
                                 +- ShuffleQueryStage X
                                    +- NativeShuffleExchange hashpartitioning((d_week_seq2#23 - 53), 100), ENSURE_REQUIREMENTS, [plan_id=6]
                                       +- NativeProject [d_week_seq#65 AS d_week_seq2#23, sun_sales#66 AS sun_sales2#3, mon_sales#67 AS mon_sales2#6, tue_sales#68 AS tue_sales2#9, wed_sales#69 AS wed_sales2#12, thu_sales#70 AS thu_sales2#15, fri_sales#71 AS fri_sales2#18, sat_sales#72 AS sat_sales2#21]
                                          +- NativeSortMergeJoin [d_week_seq#65], [d_week_seq#73], Inner
                                             :- NativeSort [d_week_seq#65 ASC NULLS FIRST], false
                                             :  +- NativeProject [d_week_seq#65, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#74 = Sunday) THEN sales_price#34 END))#35,17,2) AS sun_sales#66, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#74 = Monday) THEN sales_price#34 END))#36,17,2) AS mon_sales#67, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#74 = Tuesday) THEN sales_price#34 END))#37,17,2) AS tue_sales#68, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#74 = Wednesday) THEN sales_price#34 END))#38,17,2) AS wed_sales#69, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#74 = Thursday) THEN sales_price#34 END))#39,17,2) AS thu_sales#70, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#74 = Friday) THEN sales_price#34 END))#40,17,2) AS fri_sales#71, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#74 = Saturday) THEN sales_price#34 END))#41,17,2) AS sat_sales#72]
                                             :     +- NativeHashAggregate HashAgg, ArrayBuffer(d_week_seq#65), [d_week_seq#65], [sum(UnscaledValue(CASE WHEN (d_day_name#74 = Sunday) THEN sales_price#34 END)), sum(UnscaledValue(CASE WHEN (d_day_name#74 = Monday) THEN sales_price#34 END)), sum(UnscaledValue(CASE WHEN (d_day_name#74 = Tuesday) THEN sales_price#34 END)), sum(UnscaledValue(CASE WHEN (d_day_name#74 = Wednesday) THEN sales_price#34 END)), sum(UnscaledValue(CASE WHEN (d_day_name#74 = Thursday) THEN sales_price#34 END)), sum(UnscaledValue(CASE WHEN (d_day_name#74 = Friday) THEN sales_price#34 END)), sum(UnscaledValue(CASE WHEN (d_day_name#74 = Saturday) THEN sales_price#34 END))], [sum(UnscaledValue(CASE WHEN (d_day_name#74 = Sunday) THEN sales_price#34 END))#35, sum(UnscaledValue(CASE WHEN (d_day_name#74 = Monday) THEN sales_price#34 END))#36, sum(UnscaledValue(CASE WHEN (d_day_name#74 = Tuesday) THEN sales_price#34 END))#37, sum(UnscaledValue(CASE WHEN (d_day_name#74 = Wednesday) THEN sales_price#34 END))#38, sum(UnscaledValue(CASE WHEN (d_day_name#74 = Thursday) THEN sales_price#34 END))#39, sum(UnscaledValue(CASE WHEN (d_day_name#74 = Friday) THEN sales_price#34 END))#40, sum(UnscaledValue(CASE WHEN (d_day_name#74 = Saturday) THEN sales_price#34 END))#41], 1
                                             :        +- InputAdapter
                                             :           +- InputAdapter [#65, #75, #76, #77, #78, #79, #80, #81]
                                             :              +- AQEShuffleRead coalesced
                                             :                 +- ShuffleQueryStage X
                                             :                    +- ReusedExchange [d_week_seq#65, sum#82, sum#83, sum#84, sum#85, sum#86, sum#87, sum#88], NativeShuffleExchange hashpartitioning(d_week_seq#24, 100), ENSURE_REQUIREMENTS, [plan_id=2]
                                             +- NativeSort [d_week_seq#73 ASC NULLS FIRST], false
                                                +- InputAdapter
                                                   +- AQEShuffleRead coalesced
                                                      +- ShuffleQueryStage X
                                                         +- NativeShuffleExchange hashpartitioning(d_week_seq#73, 100), ENSURE_REQUIREMENTS, [plan_id=7]
                                                            +- NativeProject [d_week_seq#73]
                                                               +- NativeFilter ((isnotnull(d_year#89) AND (d_year#89 = 2002)) AND isnotnull(d_week_seq#73))
                                                                  +- InputAdapter [#73, #89]
                                                                     +- NativeParquetScan  (FileScan parquet [d_week_seq#73,d_year#89] Batched: true, DataFilters: [isnotnull(d_year#89), (d_year#89 = 2002), isnotnull(d_week_seq#73)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2002), IsNotNull(d_week_seq)], ReadSchema: struct<d_week_seq:int,d_year:int>)
+- == Initial Plan ==
   Sort [d_week_seq1#1 ASC NULLS FIRST], true, 0
   +- Exchange rangepartitioning(d_week_seq1#1 ASC NULLS FIRST, 100), ENSURE_REQUIREMENTS, [plan_id=8]
      +- Project [d_week_seq1#1, round((sun_sales1#2 / sun_sales2#3), 2) AS round((sun_sales1 / sun_sales2), 2)#4, round((mon_sales1#5 / mon_sales2#6), 2) AS round((mon_sales1 / mon_sales2), 2)#7, round((tue_sales1#8 / tue_sales2#9), 2) AS round((tue_sales1 / tue_sales2), 2)#10, round((wed_sales1#11 / wed_sales2#12), 2) AS round((wed_sales1 / wed_sales2), 2)#13, round((thu_sales1#14 / thu_sales2#15), 2) AS round((thu_sales1 / thu_sales2), 2)#16, round((fri_sales1#17 / fri_sales2#18), 2) AS round((fri_sales1 / fri_sales2), 2)#19, round((sat_sales1#20 / sat_sales2#21), 2) AS round((sat_sales1 / sat_sales2), 2)#22]
         +- SortMergeJoin [d_week_seq1#1], [(d_week_seq2#23 - 53)], Inner
            :- Project [d_week_seq#24 AS d_week_seq1#1, sun_sales#25 AS sun_sales1#2, mon_sales#26 AS mon_sales1#5, tue_sales#27 AS tue_sales1#8, wed_sales#28 AS wed_sales1#11, thu_sales#29 AS thu_sales1#14, fri_sales#30 AS fri_sales1#17, sat_sales#31 AS sat_sales1#20]
            :  +- SortMergeJoin [d_week_seq#24], [d_week_seq#32], Inner
            :     :- Sort [d_week_seq#24 ASC NULLS FIRST], false, 0
            :     :  +- HashAggregate(keys=[d_week_seq#24], functions=[sum(UnscaledValue(CASE WHEN (d_day_name#33 = Sunday) THEN sales_price#34 END)), sum(UnscaledValue(CASE WHEN (d_day_name#33 = Monday) THEN sales_price#34 END)), sum(UnscaledValue(CASE WHEN (d_day_name#33 = Tuesday) THEN sales_price#34 END)), sum(UnscaledValue(CASE WHEN (d_day_name#33 = Wednesday) THEN sales_price#34 END)), sum(UnscaledValue(CASE WHEN (d_day_name#33 = Thursday) THEN sales_price#34 END)), sum(UnscaledValue(CASE WHEN (d_day_name#33 = Friday) THEN sales_price#34 END)), sum(UnscaledValue(CASE WHEN (d_day_name#33 = Saturday) THEN sales_price#34 END))], output=[d_week_seq#24, sun_sales#25, mon_sales#26, tue_sales#27, wed_sales#28, thu_sales#29, fri_sales#30, sat_sales#31])
            :     :     +- Exchange hashpartitioning(d_week_seq#24, 100), ENSURE_REQUIREMENTS, [plan_id=9]
            :     :        +- HashAggregate(keys=[d_week_seq#24], functions=[partial_sum(UnscaledValue(CASE WHEN (d_day_name#33 = Sunday) THEN sales_price#34 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#33 = Monday) THEN sales_price#34 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#33 = Tuesday) THEN sales_price#34 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#33 = Wednesday) THEN sales_price#34 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#33 = Thursday) THEN sales_price#34 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#33 = Friday) THEN sales_price#34 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#33 = Saturday) THEN sales_price#34 END))], output=[d_week_seq#24, sum#90, sum#91, sum#92, sum#93, sum#94, sum#95, sum#96])
            :     :           +- Project [sales_price#34, d_week_seq#24, d_day_name#33]
            :     :              +- SortMergeJoin [sold_date_sk#56], [d_date_sk#57], Inner
            :     :                 :- Sort [sold_date_sk#56 ASC NULLS FIRST], false, 0
            :     :                 :  +- Exchange hashpartitioning(sold_date_sk#56, 100), ENSURE_REQUIREMENTS, [plan_id=10]
            :     :                 :     +- Union
            :     :                 :        :- Project [ws_sold_date_sk#58 AS sold_date_sk#56, ws_ext_sales_price#59 AS sales_price#34]
            :     :                 :        :  +- Filter isnotnull(ws_sold_date_sk#58)
            :     :                 :        :     +- FileScan parquet [ws_sold_date_sk#58,ws_ext_sales_price#59] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#58)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_ext_sales_price:decimal(7,2)>
            :     :                 :        +- Project [cs_sold_date_sk#60 AS sold_date_sk#61, cs_ext_sales_price#62 AS sales_price#63]
            :     :                 :           +- Filter isnotnull(cs_sold_date_sk#60)
            :     :                 :              +- FileScan parquet [cs_sold_date_sk#60,cs_ext_sales_price#62] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#60)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_ext_sales_price:decimal(7,2)>
            :     :                 +- Sort [d_date_sk#57 ASC NULLS FIRST], false, 0
            :     :                    +- Exchange hashpartitioning(d_date_sk#57, 100), ENSURE_REQUIREMENTS, [plan_id=11]
            :     :                       +- Filter (isnotnull(d_date_sk#57) AND isnotnull(d_week_seq#24))
            :     :                          +- FileScan parquet [d_date_sk#57,d_week_seq#24,d_day_name#33] Batched: true, DataFilters: [isnotnull(d_date_sk#57), isnotnull(d_week_seq#24)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk), IsNotNull(d_week_seq)], ReadSchema: struct<d_date_sk:int,d_week_seq:int,d_day_name:string>
            :     +- Sort [d_week_seq#32 ASC NULLS FIRST], false, 0
            :        +- Exchange hashpartitioning(d_week_seq#32, 100), ENSURE_REQUIREMENTS, [plan_id=12]
            :           +- Project [d_week_seq#32]
            :              +- Filter ((isnotnull(d_year#64) AND (d_year#64 = 2001)) AND isnotnull(d_week_seq#32))
            :                 +- FileScan parquet [d_week_seq#32,d_year#64] Batched: true, DataFilters: [isnotnull(d_year#64), (d_year#64 = 2001), isnotnull(d_week_seq#32)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2001), IsNotNull(d_week_seq)], ReadSchema: struct<d_week_seq:int,d_year:int>
            +- Sort [(d_week_seq2#23 - 53) ASC NULLS FIRST], false, 0
               +- Exchange hashpartitioning((d_week_seq2#23 - 53), 100), ENSURE_REQUIREMENTS, [plan_id=13]
                  +- Project [d_week_seq#65 AS d_week_seq2#23, sun_sales#66 AS sun_sales2#3, mon_sales#67 AS mon_sales2#6, tue_sales#68 AS tue_sales2#9, wed_sales#69 AS wed_sales2#12, thu_sales#70 AS thu_sales2#15, fri_sales#71 AS fri_sales2#18, sat_sales#72 AS sat_sales2#21]
                     +- SortMergeJoin [d_week_seq#65], [d_week_seq#73], Inner
                        :- Sort [d_week_seq#65 ASC NULLS FIRST], false, 0
                        :  +- HashAggregate(keys=[d_week_seq#65], functions=[sum(UnscaledValue(CASE WHEN (d_day_name#74 = Sunday) THEN sales_price#34 END)), sum(UnscaledValue(CASE WHEN (d_day_name#74 = Monday) THEN sales_price#34 END)), sum(UnscaledValue(CASE WHEN (d_day_name#74 = Tuesday) THEN sales_price#34 END)), sum(UnscaledValue(CASE WHEN (d_day_name#74 = Wednesday) THEN sales_price#34 END)), sum(UnscaledValue(CASE WHEN (d_day_name#74 = Thursday) THEN sales_price#34 END)), sum(UnscaledValue(CASE WHEN (d_day_name#74 = Friday) THEN sales_price#34 END)), sum(UnscaledValue(CASE WHEN (d_day_name#74 = Saturday) THEN sales_price#34 END))], output=[d_week_seq#65, sun_sales#66, mon_sales#67, tue_sales#68, wed_sales#69, thu_sales#70, fri_sales#71, sat_sales#72])
                        :     +- Exchange hashpartitioning(d_week_seq#65, 100), ENSURE_REQUIREMENTS, [plan_id=14]
                        :        +- HashAggregate(keys=[d_week_seq#65], functions=[partial_sum(UnscaledValue(CASE WHEN (d_day_name#74 = Sunday) THEN sales_price#34 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#74 = Monday) THEN sales_price#34 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#74 = Tuesday) THEN sales_price#34 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#74 = Wednesday) THEN sales_price#34 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#74 = Thursday) THEN sales_price#34 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#74 = Friday) THEN sales_price#34 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#74 = Saturday) THEN sales_price#34 END))], output=[d_week_seq#65, sum#82, sum#83, sum#84, sum#85, sum#86, sum#87, sum#88])
                        :           +- Project [sales_price#34, d_week_seq#65, d_day_name#74]
                        :              +- SortMergeJoin [sold_date_sk#56], [d_date_sk#97], Inner
                        :                 :- Sort [sold_date_sk#56 ASC NULLS FIRST], false, 0
                        :                 :  +- Exchange hashpartitioning(sold_date_sk#56, 100), ENSURE_REQUIREMENTS, [plan_id=15]
                        :                 :     +- Union
                        :                 :        :- Project [ws_sold_date_sk#98 AS sold_date_sk#56, ws_ext_sales_price#99 AS sales_price#34]
                        :                 :        :  +- Filter isnotnull(ws_sold_date_sk#98)
                        :                 :        :     +- FileScan parquet [ws_sold_date_sk#98,ws_ext_sales_price#99] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#98)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_ext_sales_price:decimal(7,2)>
                        :                 :        +- Project [cs_sold_date_sk#100 AS sold_date_sk#61, cs_ext_sales_price#101 AS sales_price#63]
                        :                 :           +- Filter isnotnull(cs_sold_date_sk#100)
                        :                 :              +- FileScan parquet [cs_sold_date_sk#100,cs_ext_sales_price#101] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#100)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_ext_sales_price:decimal(7,2)>
                        :                 +- Sort [d_date_sk#97 ASC NULLS FIRST], false, 0
                        :                    +- Exchange hashpartitioning(d_date_sk#97, 100), ENSURE_REQUIREMENTS, [plan_id=16]
                        :                       +- Filter (isnotnull(d_date_sk#97) AND isnotnull(d_week_seq#65))
                        :                          +- FileScan parquet [d_date_sk#97,d_week_seq#65,d_day_name#74] Batched: true, DataFilters: [isnotnull(d_date_sk#97), isnotnull(d_week_seq#65)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk), IsNotNull(d_week_seq)], ReadSchema: struct<d_date_sk:int,d_week_seq:int,d_day_name:string>
                        +- Sort [d_week_seq#73 ASC NULLS FIRST], false, 0
                           +- Exchange hashpartitioning(d_week_seq#73, 100), ENSURE_REQUIREMENTS, [plan_id=17]
                              +- Project [d_week_seq#73]
                                 +- Filter ((isnotnull(d_year#89) AND (d_year#89 = 2002)) AND isnotnull(d_week_seq#73))
                                    +- FileScan parquet [d_week_seq#73,d_year#89] Batched: true, DataFilters: [isnotnull(d_year#89), (d_year#89 = 2002), isnotnull(d_week_seq#73)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2002), IsNotNull(d_week_seq)], ReadSchema: struct<d_week_seq:int,d_year:int>
