AdaptiveSparkPlan isFinalPlan=true
+- == Final Plan ==
   NativeTakeOrdered 100, [s_store_name1#1 ASC NULLS FIRST, s_store_id1#2 ASC NULLS FIRST, d_week_seq1#3 ASC NULLS FIRST]
   +- NativeProject [s_store_name1#1, s_store_id1#2, d_week_seq1#3, (sun_sales1#4 / sun_sales2#5) AS (sun_sales1 / sun_sales2)#6, (mon_sales1#7 / mon_sales2#8) AS (mon_sales1 / mon_sales2)#9, (tue_sales1#10 / tue_sales2#11) AS (tue_sales1 / tue_sales2)#12, (wed_sales1#13 / wed_sales2#14) AS (wed_sales1 / wed_sales2)#15, (thu_sales1#16 / thu_sales2#17) AS (thu_sales1 / thu_sales2)#18, (fri_sales1#19 / fri_sales2#20) AS (fri_sales1 / fri_sales2)#21, (sat_sales1#22 / sat_sales2#23) AS (sat_sales1 / sat_sales2)#24]
      +- NativeSortMergeJoin [s_store_id1#2, d_week_seq1#3], [s_store_id2#25, (d_week_seq2#26 - 52)], Inner
         :- NativeSort [s_store_id1#2 ASC NULLS FIRST, d_week_seq1#3 ASC NULLS FIRST], false
         :  +- InputAdapter
         :     +- AQEShuffleRead coalesced
         :        +- ShuffleQueryStage X
         :           +- NativeShuffleExchange hashpartitioning(s_store_id1#2, d_week_seq1#3, 100), ENSURE_REQUIREMENTS, [plan_id=1]
         :              +- NativeProject [s_store_name#27 AS s_store_name1#1, d_week_seq#28 AS d_week_seq1#3, s_store_id#29 AS s_store_id1#2, sun_sales#30 AS sun_sales1#4, mon_sales#31 AS mon_sales1#7, tue_sales#32 AS tue_sales1#10, wed_sales#33 AS wed_sales1#13, thu_sales#34 AS thu_sales1#16, fri_sales#35 AS fri_sales1#19, sat_sales#36 AS sat_sales1#22]
         :                 +- NativeSortMergeJoin [d_week_seq#28], [d_week_seq#37], Inner
         :                    :- NativeSort [d_week_seq#28 ASC NULLS FIRST], false
         :                    :  +- InputAdapter
         :                    :     +- AQEShuffleRead coalesced
         :                    :        +- ShuffleQueryStage X
         :                    :           +- NativeShuffleExchange hashpartitioning(d_week_seq#28, 100), ENSURE_REQUIREMENTS, [plan_id=2]
         :                    :              +- NativeProject [d_week_seq#28, sun_sales#30, mon_sales#31, tue_sales#32, wed_sales#33, thu_sales#34, fri_sales#35, sat_sales#36, s_store_id#29, s_store_name#27]
         :                    :                 +- NativeSortMergeJoin [ss_store_sk#38], [s_store_sk#39], Inner
         :                    :                    :- NativeSort [ss_store_sk#38 ASC NULLS FIRST], false
         :                    :                    :  +- InputAdapter
         :                    :                    :     +- AQEShuffleRead coalesced
         :                    :                    :        +- ShuffleQueryStage X
         :                    :                    :           +- NativeShuffleExchange hashpartitioning(ss_store_sk#38, 100), ENSURE_REQUIREMENTS, [plan_id=3]
         :                    :                    :              +- NativeProject [d_week_seq#28, ss_store_sk#38, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#40 = Sunday) THEN ss_sales_price#41 END))#42,17,2) AS sun_sales#30, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#40 = Monday) THEN ss_sales_price#41 END))#43,17,2) AS mon_sales#31, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#40 = Tuesday) THEN ss_sales_price#41 END))#44,17,2) AS tue_sales#32, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#40 = Wednesday) THEN ss_sales_price#41 END))#45,17,2) AS wed_sales#33, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#40 = Thursday) THEN ss_sales_price#41 END))#46,17,2) AS thu_sales#34, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#40 = Friday) THEN ss_sales_price#41 END))#47,17,2) AS fri_sales#35, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#40 = Saturday) THEN ss_sales_price#41 END))#48,17,2) AS sat_sales#36]
         :                    :                    :                 +- NativeHashAggregate HashAgg, ArrayBuffer(d_week_seq#28, ss_store_sk#38), [d_week_seq#28, ss_store_sk#38], [sum(UnscaledValue(CASE WHEN (d_day_name#40 = Sunday) THEN ss_sales_price#41 END)), sum(UnscaledValue(CASE WHEN (d_day_name#40 = Monday) THEN ss_sales_price#41 END)), sum(UnscaledValue(CASE WHEN (d_day_name#40 = Tuesday) THEN ss_sales_price#41 END)), sum(UnscaledValue(CASE WHEN (d_day_name#40 = Wednesday) THEN ss_sales_price#41 END)), sum(UnscaledValue(CASE WHEN (d_day_name#40 = Thursday) THEN ss_sales_price#41 END)), sum(UnscaledValue(CASE WHEN (d_day_name#40 = Friday) THEN ss_sales_price#41 END)), sum(UnscaledValue(CASE WHEN (d_day_name#40 = Saturday) THEN ss_sales_price#41 END))], [sum(UnscaledValue(CASE WHEN (d_day_name#40 = Sunday) THEN ss_sales_price#41 END))#42, sum(UnscaledValue(CASE WHEN (d_day_name#40 = Monday) THEN ss_sales_price#41 END))#43, sum(UnscaledValue(CASE WHEN (d_day_name#40 = Tuesday) THEN ss_sales_price#41 END))#44, sum(UnscaledValue(CASE WHEN (d_day_name#40 = Wednesday) THEN ss_sales_price#41 END))#45, sum(UnscaledValue(CASE WHEN (d_day_name#40 = Thursday) THEN ss_sales_price#41 END))#46, sum(UnscaledValue(CASE WHEN (d_day_name#40 = Friday) THEN ss_sales_price#41 END))#47, sum(UnscaledValue(CASE WHEN (d_day_name#40 = Saturday) THEN ss_sales_price#41 END))#48], 2
         :                    :                    :                    +- InputAdapter
         :                    :                    :                       +- AQEShuffleRead coalesced
         :                    :                    :                          +- ShuffleQueryStage X
         :                    :                    :                             +- NativeShuffleExchange hashpartitioning(d_week_seq#28, ss_store_sk#38, 100), ENSURE_REQUIREMENTS, [plan_id=4]
         :                    :                    :                                +- NativeHashAggregate HashAgg, [d_week_seq#28, ss_store_sk#38], [partial_sum(_c2#49), partial_sum(_c3#50), partial_sum(_c4#51), partial_sum(_c5#52), partial_sum(_c6#53), partial_sum(_c7#54), partial_sum(_c8#55)], [sum#56, sum#57, sum#58, sum#59, sum#60, sum#61, sum#62], 0
         :                    :                    :                                   +- NativeProject [d_week_seq#28 AS d_week_seq#28, ss_store_sk#38 AS ss_store_sk#38, UnscaledValue(CASE WHEN (d_day_name#40 = Sunday) THEN ss_sales_price#41 END) AS _c2#49, UnscaledValue(CASE WHEN (d_day_name#40 = Monday) THEN ss_sales_price#41 END) AS _c3#50, UnscaledValue(CASE WHEN (d_day_name#40 = Tuesday) THEN ss_sales_price#41 END) AS _c4#51, UnscaledValue(CASE WHEN (d_day_name#40 = Wednesday) THEN ss_sales_price#41 END) AS _c5#52, UnscaledValue(CASE WHEN (d_day_name#40 = Thursday) THEN ss_sales_price#41 END) AS _c6#53, UnscaledValue(CASE WHEN (d_day_name#40 = Friday) THEN ss_sales_price#41 END) AS _c7#54, UnscaledValue(CASE WHEN (d_day_name#40 = Saturday) THEN ss_sales_price#41 END) AS _c8#55]
         :                    :                    :                                      +- NativeProject [ss_store_sk#38, ss_sales_price#41, d_week_seq#28, d_day_name#40]
         :                    :                    :                                         +- NativeSortMergeJoin [ss_sold_date_sk#63], [d_date_sk#64], Inner
         :                    :                    :                                            :- NativeSort [ss_sold_date_sk#63 ASC NULLS FIRST], false
         :                    :                    :                                            :  +- InputAdapter
         :                    :                    :                                            :     +- AQEShuffleRead coalesced
         :                    :                    :                                            :        +- ShuffleQueryStage X
         :                    :                    :                                            :           +- NativeShuffleExchange hashpartitioning(ss_sold_date_sk#63, 100), ENSURE_REQUIREMENTS, [plan_id=5]
         :                    :                    :                                            :              +- NativeFilter (isnotnull(ss_sold_date_sk#63) AND isnotnull(ss_store_sk#38))
         :                    :                    :                                            :                 +- InputAdapter [#63, #38, #41]
         :                    :                    :                                            :                    +- NativeParquetScan  (FileScan parquet [ss_sold_date_sk#63,ss_store_sk#38,ss_sales_price#41] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#63), isnotnull(ss_store_sk#38)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_store_sk:int,ss_sales_price:decimal(7,2)>)
         :                    :                    :                                            +- NativeSort [d_date_sk#64 ASC NULLS FIRST], false
         :                    :                    :                                               +- InputAdapter
         :                    :                    :                                                  +- AQEShuffleRead coalesced
         :                    :                    :                                                     +- ShuffleQueryStage X
         :                    :                    :                                                        +- NativeShuffleExchange hashpartitioning(d_date_sk#64, 100), ENSURE_REQUIREMENTS, [plan_id=6]
         :                    :                    :                                                           +- NativeFilter (isnotnull(d_date_sk#64) AND isnotnull(d_week_seq#28))
         :                    :                    :                                                              +- InputAdapter [#64, #28, #40]
         :                    :                    :                                                                 +- NativeParquetScan  (FileScan parquet [d_date_sk#64,d_week_seq#28,d_day_name#40] Batched: true, DataFilters: [isnotnull(d_date_sk#64), isnotnull(d_week_seq#28)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk), IsNotNull(d_week_seq)], ReadSchema: struct<d_date_sk:int,d_week_seq:int,d_day_name:string>)
         :                    :                    +- NativeSort [s_store_sk#39 ASC NULLS FIRST], false
         :                    :                       +- InputAdapter
         :                    :                          +- AQEShuffleRead coalesced
         :                    :                             +- ShuffleQueryStage X
         :                    :                                +- NativeShuffleExchange hashpartitioning(s_store_sk#39, 100), ENSURE_REQUIREMENTS, [plan_id=7]
         :                    :                                   +- NativeFilter (isnotnull(s_store_sk#39) AND isnotnull(s_store_id#29))
         :                    :                                      +- InputAdapter [#39, #29, #27]
         :                    :                                         +- NativeParquetScan  (FileScan parquet [s_store_sk#39,s_store_id#29,s_store_name#27] Batched: true, DataFilters: [isnotnull(s_store_sk#39), isnotnull(s_store_id#29)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk), IsNotNull(s_store_id)], ReadSchema: struct<s_store_sk:int,s_store_id:string,s_store_name:string>)
         :                    +- NativeSort [d_week_seq#37 ASC NULLS FIRST], false
         :                       +- InputAdapter
         :                          +- AQEShuffleRead coalesced
         :                             +- ShuffleQueryStage X
         :                                +- NativeShuffleExchange hashpartitioning(d_week_seq#37, 100), ENSURE_REQUIREMENTS, [plan_id=8]
         :                                   +- NativeProject [d_week_seq#37]
         :                                      +- NativeFilter (((isnotnull(d_month_seq#65) AND (d_month_seq#65 >= 1212)) AND (d_month_seq#65 <= 1223)) AND isnotnull(d_week_seq#37))
         :                                         +- InputAdapter [#65, #37]
         :                                            +- NativeParquetScan  (FileScan parquet [d_month_seq#65,d_week_seq#37] Batched: true, DataFilters: [isnotnull(d_month_seq#65), (d_month_seq#65 >= 1212), (d_month_seq#65 <= 1223), isnotnul..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_month_seq), GreaterThanOrEqual(d_month_seq,1212), LessThanOrEqual(d_month_seq,1223),..., ReadSchema: struct<d_month_seq:int,d_week_seq:int>)
         +- NativeSort [s_store_id2#25 ASC NULLS FIRST, (d_week_seq2#26 - 52) ASC NULLS FIRST], false
            +- InputAdapter
               +- AQEShuffleRead coalesced
                  +- ShuffleQueryStage X
                     +- NativeShuffleExchange hashpartitioning(s_store_id2#25, (d_week_seq2#26 - 52), 100), ENSURE_REQUIREMENTS, [plan_id=9]
                        +- NativeProject [d_week_seq#66 AS d_week_seq2#26, s_store_id#67 AS s_store_id2#25, sun_sales#68 AS sun_sales2#5, mon_sales#69 AS mon_sales2#8, tue_sales#70 AS tue_sales2#11, wed_sales#71 AS wed_sales2#14, thu_sales#72 AS thu_sales2#17, fri_sales#73 AS fri_sales2#20, sat_sales#74 AS sat_sales2#23]
                           +- NativeSortMergeJoin [d_week_seq#66], [d_week_seq#75], Inner
                              :- NativeSort [d_week_seq#66 ASC NULLS FIRST], false
                              :  +- InputAdapter
                              :     +- AQEShuffleRead coalesced
                              :        +- ShuffleQueryStage X
                              :           +- NativeShuffleExchange hashpartitioning(d_week_seq#66, 100), ENSURE_REQUIREMENTS, [plan_id=10]
                              :              +- NativeProject [d_week_seq#66, sun_sales#68, mon_sales#69, tue_sales#70, wed_sales#71, thu_sales#72, fri_sales#73, sat_sales#74, s_store_id#67]
                              :                 +- NativeSortMergeJoin [ss_store_sk#76], [s_store_sk#77], Inner
                              :                    :- NativeSort [ss_store_sk#76 ASC NULLS FIRST], false
                              :                    :  +- InputAdapter
                              :                    :     +- InputAdapter [#66, #76, #68, #69, #70, #71, #72, #73, #74]
                              :                    :        +- AQEShuffleRead coalesced
                              :                    :           +- ShuffleQueryStage X
                              :                    :              +- ReusedExchange [d_week_seq#66, ss_store_sk#76, sun_sales#68, mon_sales#69, tue_sales#70, wed_sales#71, thu_sales#72, fri_sales#73, sat_sales#74], NativeShuffleExchange hashpartitioning(ss_store_sk#38, 100), ENSURE_REQUIREMENTS, [plan_id=3]
                              :                    +- NativeSort [s_store_sk#77 ASC NULLS FIRST], false
                              :                       +- InputAdapter
                              :                          +- AQEShuffleRead coalesced
                              :                             +- ShuffleQueryStage X
                              :                                +- NativeShuffleExchange hashpartitioning(s_store_sk#77, 100), ENSURE_REQUIREMENTS, [plan_id=11]
                              :                                   +- NativeFilter (isnotnull(s_store_sk#77) AND isnotnull(s_store_id#67))
                              :                                      +- InputAdapter [#77, #67]
                              :                                         +- NativeParquetScan  (FileScan parquet [s_store_sk#77,s_store_id#67] Batched: true, DataFilters: [isnotnull(s_store_sk#77), isnotnull(s_store_id#67)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk), IsNotNull(s_store_id)], ReadSchema: struct<s_store_sk:int,s_store_id:string>)
                              +- NativeSort [d_week_seq#75 ASC NULLS FIRST], false
                                 +- InputAdapter
                                    +- AQEShuffleRead coalesced
                                       +- ShuffleQueryStage X
                                          +- NativeShuffleExchange hashpartitioning(d_week_seq#75, 100), ENSURE_REQUIREMENTS, [plan_id=12]
                                             +- NativeProject [d_week_seq#75]
                                                +- NativeFilter (((isnotnull(d_month_seq#78) AND (d_month_seq#78 >= 1224)) AND (d_month_seq#78 <= 1235)) AND isnotnull(d_week_seq#75))
                                                   +- InputAdapter [#78, #75]
                                                      +- NativeParquetScan  (FileScan parquet [d_month_seq#78,d_week_seq#75] Batched: true, DataFilters: [isnotnull(d_month_seq#78), (d_month_seq#78 >= 1224), (d_month_seq#78 <= 1235), isnotnul..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_month_seq), GreaterThanOrEqual(d_month_seq,1224), LessThanOrEqual(d_month_seq,1235),..., ReadSchema: struct<d_month_seq:int,d_week_seq:int>)
+- == Initial Plan ==
   TakeOrderedAndProject(limit=100, orderBy=[s_store_name1#1 ASC NULLS FIRST,s_store_id1#2 ASC NULLS FIRST,d_week_seq1#3 ASC NULLS FIRST], output=[s_store_name1#1,s_store_id1#2,d_week_seq1#3,(sun_sales1 / sun_sales2)#6,(mon_sales1 / mon_sales2)#9,(tue_sales1 / tue_sales2)#12,(wed_sales1 / wed_sales2)#15,(thu_sales1 / thu_sales2)#18,(fri_sales1 / fri_sales2)#21,(sat_sales1 / sat_sales2)#24])
   +- Project [s_store_name1#1, s_store_id1#2, d_week_seq1#3, (sun_sales1#4 / sun_sales2#5) AS (sun_sales1 / sun_sales2)#6, (mon_sales1#7 / mon_sales2#8) AS (mon_sales1 / mon_sales2)#9, (tue_sales1#10 / tue_sales2#11) AS (tue_sales1 / tue_sales2)#12, (wed_sales1#13 / wed_sales2#14) AS (wed_sales1 / wed_sales2)#15, (thu_sales1#16 / thu_sales2#17) AS (thu_sales1 / thu_sales2)#18, (fri_sales1#19 / fri_sales2#20) AS (fri_sales1 / fri_sales2)#21, (sat_sales1#22 / sat_sales2#23) AS (sat_sales1 / sat_sales2)#24]
      +- SortMergeJoin [s_store_id1#2, d_week_seq1#3], [s_store_id2#25, (d_week_seq2#26 - 52)], Inner
         :- Sort [s_store_id1#2 ASC NULLS FIRST, d_week_seq1#3 ASC NULLS FIRST], false, 0
         :  +- Exchange hashpartitioning(s_store_id1#2, d_week_seq1#3, 100), ENSURE_REQUIREMENTS, [plan_id=13]
         :     +- Project [s_store_name#27 AS s_store_name1#1, d_week_seq#28 AS d_week_seq1#3, s_store_id#29 AS s_store_id1#2, sun_sales#30 AS sun_sales1#4, mon_sales#31 AS mon_sales1#7, tue_sales#32 AS tue_sales1#10, wed_sales#33 AS wed_sales1#13, thu_sales#34 AS thu_sales1#16, fri_sales#35 AS fri_sales1#19, sat_sales#36 AS sat_sales1#22]
         :        +- SortMergeJoin [d_week_seq#28], [d_week_seq#37], Inner
         :           :- Sort [d_week_seq#28 ASC NULLS FIRST], false, 0
         :           :  +- Exchange hashpartitioning(d_week_seq#28, 100), ENSURE_REQUIREMENTS, [plan_id=14]
         :           :     +- Project [d_week_seq#28, sun_sales#30, mon_sales#31, tue_sales#32, wed_sales#33, thu_sales#34, fri_sales#35, sat_sales#36, s_store_id#29, s_store_name#27]
         :           :        +- SortMergeJoin [ss_store_sk#38], [s_store_sk#39], Inner
         :           :           :- Sort [ss_store_sk#38 ASC NULLS FIRST], false, 0
         :           :           :  +- Exchange hashpartitioning(ss_store_sk#38, 100), ENSURE_REQUIREMENTS, [plan_id=15]
         :           :           :     +- HashAggregate(keys=[d_week_seq#28, ss_store_sk#38], functions=[sum(UnscaledValue(CASE WHEN (d_day_name#40 = Sunday) THEN ss_sales_price#41 END)), sum(UnscaledValue(CASE WHEN (d_day_name#40 = Monday) THEN ss_sales_price#41 END)), sum(UnscaledValue(CASE WHEN (d_day_name#40 = Tuesday) THEN ss_sales_price#41 END)), sum(UnscaledValue(CASE WHEN (d_day_name#40 = Wednesday) THEN ss_sales_price#41 END)), sum(UnscaledValue(CASE WHEN (d_day_name#40 = Thursday) THEN ss_sales_price#41 END)), sum(UnscaledValue(CASE WHEN (d_day_name#40 = Friday) THEN ss_sales_price#41 END)), sum(UnscaledValue(CASE WHEN (d_day_name#40 = Saturday) THEN ss_sales_price#41 END))], output=[d_week_seq#28, ss_store_sk#38, sun_sales#30, mon_sales#31, tue_sales#32, wed_sales#33, thu_sales#34, fri_sales#35, sat_sales#36])
         :           :           :        +- Exchange hashpartitioning(d_week_seq#28, ss_store_sk#38, 100), ENSURE_REQUIREMENTS, [plan_id=16]
         :           :           :           +- HashAggregate(keys=[d_week_seq#28, ss_store_sk#38], functions=[partial_sum(UnscaledValue(CASE WHEN (d_day_name#40 = Sunday) THEN ss_sales_price#41 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#40 = Monday) THEN ss_sales_price#41 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#40 = Tuesday) THEN ss_sales_price#41 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#40 = Wednesday) THEN ss_sales_price#41 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#40 = Thursday) THEN ss_sales_price#41 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#40 = Friday) THEN ss_sales_price#41 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#40 = Saturday) THEN ss_sales_price#41 END))], output=[d_week_seq#28, ss_store_sk#38, sum#79, sum#80, sum#81, sum#82, sum#83, sum#84, sum#85])
         :           :           :              +- Project [ss_store_sk#38, ss_sales_price#41, d_week_seq#28, d_day_name#40]
         :           :           :                 +- SortMergeJoin [ss_sold_date_sk#63], [d_date_sk#64], Inner
         :           :           :                    :- Sort [ss_sold_date_sk#63 ASC NULLS FIRST], false, 0
         :           :           :                    :  +- Exchange hashpartitioning(ss_sold_date_sk#63, 100), ENSURE_REQUIREMENTS, [plan_id=17]
         :           :           :                    :     +- Filter (isnotnull(ss_sold_date_sk#63) AND isnotnull(ss_store_sk#38))
         :           :           :                    :        +- FileScan parquet [ss_sold_date_sk#63,ss_store_sk#38,ss_sales_price#41] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#63), isnotnull(ss_store_sk#38)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_store_sk:int,ss_sales_price:decimal(7,2)>
         :           :           :                    +- Sort [d_date_sk#64 ASC NULLS FIRST], false, 0
         :           :           :                       +- Exchange hashpartitioning(d_date_sk#64, 100), ENSURE_REQUIREMENTS, [plan_id=18]
         :           :           :                          +- Filter (isnotnull(d_date_sk#64) AND isnotnull(d_week_seq#28))
         :           :           :                             +- FileScan parquet [d_date_sk#64,d_week_seq#28,d_day_name#40] Batched: true, DataFilters: [isnotnull(d_date_sk#64), isnotnull(d_week_seq#28)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk), IsNotNull(d_week_seq)], ReadSchema: struct<d_date_sk:int,d_week_seq:int,d_day_name:string>
         :           :           +- Sort [s_store_sk#39 ASC NULLS FIRST], false, 0
         :           :              +- Exchange hashpartitioning(s_store_sk#39, 100), ENSURE_REQUIREMENTS, [plan_id=19]
         :           :                 +- Filter (isnotnull(s_store_sk#39) AND isnotnull(s_store_id#29))
         :           :                    +- FileScan parquet [s_store_sk#39,s_store_id#29,s_store_name#27] Batched: true, DataFilters: [isnotnull(s_store_sk#39), isnotnull(s_store_id#29)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk), IsNotNull(s_store_id)], ReadSchema: struct<s_store_sk:int,s_store_id:string,s_store_name:string>
         :           +- Sort [d_week_seq#37 ASC NULLS FIRST], false, 0
         :              +- Exchange hashpartitioning(d_week_seq#37, 100), ENSURE_REQUIREMENTS, [plan_id=20]
         :                 +- Project [d_week_seq#37]
         :                    +- Filter (((isnotnull(d_month_seq#65) AND (d_month_seq#65 >= 1212)) AND (d_month_seq#65 <= 1223)) AND isnotnull(d_week_seq#37))
         :                       +- FileScan parquet [d_month_seq#65,d_week_seq#37] Batched: true, DataFilters: [isnotnull(d_month_seq#65), (d_month_seq#65 >= 1212), (d_month_seq#65 <= 1223), isnotnul..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_month_seq), GreaterThanOrEqual(d_month_seq,1212), LessThanOrEqual(d_month_seq,1223),..., ReadSchema: struct<d_month_seq:int,d_week_seq:int>
         +- Sort [s_store_id2#25 ASC NULLS FIRST, (d_week_seq2#26 - 52) ASC NULLS FIRST], false, 0
            +- Exchange hashpartitioning(s_store_id2#25, (d_week_seq2#26 - 52), 100), ENSURE_REQUIREMENTS, [plan_id=21]
               +- Project [d_week_seq#66 AS d_week_seq2#26, s_store_id#67 AS s_store_id2#25, sun_sales#68 AS sun_sales2#5, mon_sales#69 AS mon_sales2#8, tue_sales#70 AS tue_sales2#11, wed_sales#71 AS wed_sales2#14, thu_sales#72 AS thu_sales2#17, fri_sales#73 AS fri_sales2#20, sat_sales#74 AS sat_sales2#23]
                  +- SortMergeJoin [d_week_seq#66], [d_week_seq#75], Inner
                     :- Sort [d_week_seq#66 ASC NULLS FIRST], false, 0
                     :  +- Exchange hashpartitioning(d_week_seq#66, 100), ENSURE_REQUIREMENTS, [plan_id=22]
                     :     +- Project [d_week_seq#66, sun_sales#68, mon_sales#69, tue_sales#70, wed_sales#71, thu_sales#72, fri_sales#73, sat_sales#74, s_store_id#67]
                     :        +- SortMergeJoin [ss_store_sk#76], [s_store_sk#77], Inner
                     :           :- Sort [ss_store_sk#76 ASC NULLS FIRST], false, 0
                     :           :  +- Exchange hashpartitioning(ss_store_sk#76, 100), ENSURE_REQUIREMENTS, [plan_id=23]
                     :           :     +- HashAggregate(keys=[d_week_seq#66, ss_store_sk#76], functions=[sum(UnscaledValue(CASE WHEN (d_day_name#86 = Sunday) THEN ss_sales_price#87 END)), sum(UnscaledValue(CASE WHEN (d_day_name#86 = Monday) THEN ss_sales_price#87 END)), sum(UnscaledValue(CASE WHEN (d_day_name#86 = Tuesday) THEN ss_sales_price#87 END)), sum(UnscaledValue(CASE WHEN (d_day_name#86 = Wednesday) THEN ss_sales_price#87 END)), sum(UnscaledValue(CASE WHEN (d_day_name#86 = Thursday) THEN ss_sales_price#87 END)), sum(UnscaledValue(CASE WHEN (d_day_name#86 = Friday) THEN ss_sales_price#87 END)), sum(UnscaledValue(CASE WHEN (d_day_name#86 = Saturday) THEN ss_sales_price#87 END))], output=[d_week_seq#66, ss_store_sk#76, sun_sales#68, mon_sales#69, tue_sales#70, wed_sales#71, thu_sales#72, fri_sales#73, sat_sales#74])
                     :           :        +- Exchange hashpartitioning(d_week_seq#66, ss_store_sk#76, 100), ENSURE_REQUIREMENTS, [plan_id=24]
                     :           :           +- HashAggregate(keys=[d_week_seq#66, ss_store_sk#76], functions=[partial_sum(UnscaledValue(CASE WHEN (d_day_name#86 = Sunday) THEN ss_sales_price#87 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#86 = Monday) THEN ss_sales_price#87 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#86 = Tuesday) THEN ss_sales_price#87 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#86 = Wednesday) THEN ss_sales_price#87 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#86 = Thursday) THEN ss_sales_price#87 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#86 = Friday) THEN ss_sales_price#87 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#86 = Saturday) THEN ss_sales_price#87 END))], output=[d_week_seq#66, ss_store_sk#76, sum#88, sum#89, sum#90, sum#91, sum#92, sum#93, sum#94])
                     :           :              +- Project [ss_store_sk#76, ss_sales_price#87, d_week_seq#66, d_day_name#86]
                     :           :                 +- SortMergeJoin [ss_sold_date_sk#95], [d_date_sk#96], Inner
                     :           :                    :- Sort [ss_sold_date_sk#95 ASC NULLS FIRST], false, 0
                     :           :                    :  +- Exchange hashpartitioning(ss_sold_date_sk#95, 100), ENSURE_REQUIREMENTS, [plan_id=25]
                     :           :                    :     +- Filter (isnotnull(ss_sold_date_sk#95) AND isnotnull(ss_store_sk#76))
                     :           :                    :        +- FileScan parquet [ss_sold_date_sk#95,ss_store_sk#76,ss_sales_price#87] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#95), isnotnull(ss_store_sk#76)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_store_sk:int,ss_sales_price:decimal(7,2)>
                     :           :                    +- Sort [d_date_sk#96 ASC NULLS FIRST], false, 0
                     :           :                       +- Exchange hashpartitioning(d_date_sk#96, 100), ENSURE_REQUIREMENTS, [plan_id=26]
                     :           :                          +- Filter (isnotnull(d_date_sk#96) AND isnotnull(d_week_seq#66))
                     :           :                             +- FileScan parquet [d_date_sk#96,d_week_seq#66,d_day_name#86] Batched: true, DataFilters: [isnotnull(d_date_sk#96), isnotnull(d_week_seq#66)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk), IsNotNull(d_week_seq)], ReadSchema: struct<d_date_sk:int,d_week_seq:int,d_day_name:string>
                     :           +- Sort [s_store_sk#77 ASC NULLS FIRST], false, 0
                     :              +- Exchange hashpartitioning(s_store_sk#77, 100), ENSURE_REQUIREMENTS, [plan_id=27]
                     :                 +- Filter (isnotnull(s_store_sk#77) AND isnotnull(s_store_id#67))
                     :                    +- FileScan parquet [s_store_sk#77,s_store_id#67] Batched: true, DataFilters: [isnotnull(s_store_sk#77), isnotnull(s_store_id#67)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk), IsNotNull(s_store_id)], ReadSchema: struct<s_store_sk:int,s_store_id:string>
                     +- Sort [d_week_seq#75 ASC NULLS FIRST], false, 0
                        +- Exchange hashpartitioning(d_week_seq#75, 100), ENSURE_REQUIREMENTS, [plan_id=28]
                           +- Project [d_week_seq#75]
                              +- Filter (((isnotnull(d_month_seq#78) AND (d_month_seq#78 >= 1224)) AND (d_month_seq#78 <= 1235)) AND isnotnull(d_week_seq#75))
                                 +- FileScan parquet [d_month_seq#78,d_week_seq#75] Batched: true, DataFilters: [isnotnull(d_month_seq#78), (d_month_seq#78 >= 1224), (d_month_seq#78 <= 1235), isnotnul..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_month_seq), GreaterThanOrEqual(d_month_seq,1224), LessThanOrEqual(d_month_seq,1235),..., ReadSchema: struct<d_month_seq:int,d_week_seq:int>
