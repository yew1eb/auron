AdaptiveSparkPlan isFinalPlan=true
+- == Final Plan ==
   CartesianProduct
   :- CartesianProduct
   :  :- CartesianProduct
   :  :  :- CartesianProduct
   :  :  :  :- CartesianProduct
   :  :  :  :  :- CartesianProduct
   :  :  :  :  :  :- CartesianProduct
   :  :  :  :  :  :  :- NativeProject [count(1)#1 AS h8_30_to_9#2]
   :  :  :  :  :  :  :  +- NativeHashAggregate HashAgg, List(), [count(1)], [count(1)#1], 0
   :  :  :  :  :  :  :     +- ShuffleQueryStage 77
   :  :  :  :  :  :  :        +- NativeShuffleExchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=1]
   :  :  :  :  :  :  :           +- NativeHashAggregate HashAgg, [partial_count(1)], [count#3], 0
   :  :  :  :  :  :  :              +- NativeProject
   :  :  :  :  :  :  :                 +- NativeSortMergeJoin [ss_store_sk#4], [s_store_sk#5], Inner
   :  :  :  :  :  :  :                    :- NativeSort [ss_store_sk#4 ASC NULLS FIRST], false
   :  :  :  :  :  :  :                    :  +- InputAdapter
   :  :  :  :  :  :  :                    :     +- AQEShuffleRead coalesced
   :  :  :  :  :  :  :                    :        +- ShuffleQueryStage 68
   :  :  :  :  :  :  :                    :           +- NativeShuffleExchange hashpartitioning(ss_store_sk#4, 100), ENSURE_REQUIREMENTS, [plan_id=2]
   :  :  :  :  :  :  :                    :              +- NativeProject [ss_store_sk#4]
   :  :  :  :  :  :  :                    :                 +- NativeSortMergeJoin [ss_sold_time_sk#6], [t_time_sk#7], Inner
   :  :  :  :  :  :  :                    :                    :- NativeSort [ss_sold_time_sk#6 ASC NULLS FIRST], false
   :  :  :  :  :  :  :                    :                    :  +- InputAdapter
   :  :  :  :  :  :  :                    :                    :     +- AQEShuffleRead coalesced
   :  :  :  :  :  :  :                    :                    :        +- ShuffleQueryStage 53
   :  :  :  :  :  :  :                    :                    :           +- NativeShuffleExchange hashpartitioning(ss_sold_time_sk#6, 100), ENSURE_REQUIREMENTS, [plan_id=3]
   :  :  :  :  :  :  :                    :                    :              +- NativeProject [ss_sold_time_sk#6, ss_store_sk#4]
   :  :  :  :  :  :  :                    :                    :                 +- NativeSortMergeJoin [ss_hdemo_sk#8], [hd_demo_sk#9], Inner
   :  :  :  :  :  :  :                    :                    :                    :- NativeSort [ss_hdemo_sk#8 ASC NULLS FIRST], false
   :  :  :  :  :  :  :                    :                    :                    :  +- InputAdapter
   :  :  :  :  :  :  :                    :                    :                    :     +- AQEShuffleRead coalesced
   :  :  :  :  :  :  :                    :                    :                    :        +- ShuffleQueryStage 0
   :  :  :  :  :  :  :                    :                    :                    :           +- NativeShuffleExchange hashpartitioning(ss_hdemo_sk#8, 100), ENSURE_REQUIREMENTS, [plan_id=4]
   :  :  :  :  :  :  :                    :                    :                    :              +- NativeFilter ((isnotnull(ss_hdemo_sk#8) AND isnotnull(ss_sold_time_sk#6)) AND isnotnull(ss_store_sk#4))
   :  :  :  :  :  :  :                    :                    :                    :                 +- InputAdapter [#6, #8, #4]
   :  :  :  :  :  :  :                    :                    :                    :                    +- NativeParquetScan  (FileScan parquet [ss_sold_time_sk#6,ss_hdemo_sk#8,ss_store_sk#4] Batched: true, DataFilters: [isnotnull(ss_hdemo_sk#8), isnotnull(ss_sold_time_sk#6), isnotnull(ss_store_sk#4)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_hdemo_sk), IsNotNull(ss_sold_time_sk), IsNotNull(ss_store_sk)], ReadSchema: struct<ss_sold_time_sk:int,ss_hdemo_sk:int,ss_store_sk:int>)
   :  :  :  :  :  :  :                    :                    :                    +- NativeSort [hd_demo_sk#9 ASC NULLS FIRST], false
   :  :  :  :  :  :  :                    :                    :                       +- InputAdapter
   :  :  :  :  :  :  :                    :                    :                          +- AQEShuffleRead coalesced
   :  :  :  :  :  :  :                    :                    :                             +- ShuffleQueryStage 1
   :  :  :  :  :  :  :                    :                    :                                +- NativeShuffleExchange hashpartitioning(hd_demo_sk#9, 100), ENSURE_REQUIREMENTS, [plan_id=5]
   :  :  :  :  :  :  :                    :                    :                                   +- NativeProject [hd_demo_sk#9]
   :  :  :  :  :  :  :                    :                    :                                      +- NativeFilter (((((hd_dep_count#10 = 4) AND (hd_vehicle_count#11 <= 6)) OR ((hd_dep_count#10 = 2) AND (hd_vehicle_count#11 <= 4))) OR ((hd_dep_count#10 = 0) AND (hd_vehicle_count#11 <= 2))) AND isnotnull(hd_demo_sk#9))
   :  :  :  :  :  :  :                    :                    :                                         +- InputAdapter [#9, #10, #11]
   :  :  :  :  :  :  :                    :                    :                                            +- NativeParquetScan  (FileScan parquet [hd_demo_sk#9,hd_dep_count#10,hd_vehicle_count#11] Batched: true, DataFilters: [((((hd_dep_count#10 = 4) AND (hd_vehicle_count#11 <= 6)) OR ((hd_dep_count#10 = 2) AND ..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>, PartitionFilters: [], PushedFilters: [Or(Or(And(EqualTo(hd_dep_count,4),LessThanOrEqual(hd_vehicle_count,6)),And(EqualTo(hd_dep_count,..., ReadSchema: struct<hd_demo_sk:int,hd_dep_count:int,hd_vehicle_count:int>)
   :  :  :  :  :  :  :                    :                    +- NativeSort [t_time_sk#7 ASC NULLS FIRST], false
   :  :  :  :  :  :  :                    :                       +- InputAdapter
   :  :  :  :  :  :  :                    :                          +- AQEShuffleRead coalesced
   :  :  :  :  :  :  :                    :                             +- ShuffleQueryStage 2
   :  :  :  :  :  :  :                    :                                +- NativeShuffleExchange hashpartitioning(t_time_sk#7, 100), ENSURE_REQUIREMENTS, [plan_id=6]
   :  :  :  :  :  :  :                    :                                   +- NativeProject [t_time_sk#7]
   :  :  :  :  :  :  :                    :                                      +- NativeFilter ((((isnotnull(t_hour#12) AND isnotnull(t_minute#13)) AND (t_hour#12 = 8)) AND (t_minute#13 >= 30)) AND isnotnull(t_time_sk#7))
   :  :  :  :  :  :  :                    :                                         +- InputAdapter [#7, #12, #13]
   :  :  :  :  :  :  :                    :                                            +- NativeParquetScan  (FileScan parquet [t_time_sk#7,t_hour#12,t_minute#13] Batched: true, DataFilters: [isnotnull(t_hour#12), isnotnull(t_minute#13), (t_hour#12 = 8), (t_minute#13 >= 30), ..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(t_hour), IsNotNull(t_minute), EqualTo(t_hour,8), GreaterThanOrEqual(t_minute,30), IsNo..., ReadSchema: struct<t_time_sk:int,t_hour:int,t_minute:int>)
   :  :  :  :  :  :  :                    +- NativeSort [s_store_sk#5 ASC NULLS FIRST], false
   :  :  :  :  :  :  :                       +- InputAdapter
   :  :  :  :  :  :  :                          +- AQEShuffleRead coalesced
   :  :  :  :  :  :  :                             +- ShuffleQueryStage 3
   :  :  :  :  :  :  :                                +- NativeShuffleExchange hashpartitioning(s_store_sk#5, 100), ENSURE_REQUIREMENTS, [plan_id=7]
   :  :  :  :  :  :  :                                   +- NativeProject [s_store_sk#5]
   :  :  :  :  :  :  :                                      +- NativeFilter ((isnotnull(s_store_name#14) AND (s_store_name#14 = ese)) AND isnotnull(s_store_sk#5))
   :  :  :  :  :  :  :                                         +- InputAdapter [#5, #14]
   :  :  :  :  :  :  :                                            +- NativeParquetScan  (FileScan parquet [s_store_sk#5,s_store_name#14] Batched: true, DataFilters: [isnotnull(s_store_name#14), (s_store_name#14 = ese), isnotnull(s_store_sk#5)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_name), EqualTo(s_store_name,ese), IsNotNull(s_store_sk)], ReadSchema: struct<s_store_sk:int,s_store_name:string>)
   :  :  :  :  :  :  +- NativeProject [count(1)#15 AS h9_to_9_30#16]
   :  :  :  :  :  :     +- NativeHashAggregate HashAgg, List(), [count(1)], [count(1)#15], 0
   :  :  :  :  :  :        +- ShuffleQueryStage 80
   :  :  :  :  :  :           +- NativeShuffleExchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=8]
   :  :  :  :  :  :              +- NativeHashAggregate HashAgg, [partial_count(1)], [count#17], 0
   :  :  :  :  :  :                 +- NativeProject
   :  :  :  :  :  :                    +- NativeSortMergeJoin [ss_store_sk#18], [s_store_sk#19], Inner
   :  :  :  :  :  :                       :- NativeSort [ss_store_sk#18 ASC NULLS FIRST], false
   :  :  :  :  :  :                       :  +- InputAdapter
   :  :  :  :  :  :                       :     +- AQEShuffleRead coalesced
   :  :  :  :  :  :                       :        +- ShuffleQueryStage 69
   :  :  :  :  :  :                       :           +- NativeShuffleExchange hashpartitioning(ss_store_sk#18, 100), ENSURE_REQUIREMENTS, [plan_id=9]
   :  :  :  :  :  :                       :              +- NativeProject [ss_store_sk#18]
   :  :  :  :  :  :                       :                 +- NativeSortMergeJoin [ss_sold_time_sk#20], [t_time_sk#21], Inner
   :  :  :  :  :  :                       :                    :- NativeSort [ss_sold_time_sk#20 ASC NULLS FIRST], false
   :  :  :  :  :  :                       :                    :  +- InputAdapter
   :  :  :  :  :  :                       :                    :     +- InputAdapter [#20, #18]
   :  :  :  :  :  :                       :                    :        +- AQEShuffleRead coalesced
   :  :  :  :  :  :                       :                    :           +- ShuffleQueryStage 55
   :  :  :  :  :  :                       :                    :              +- ReusedExchange [ss_sold_time_sk#20, ss_store_sk#18], NativeShuffleExchange hashpartitioning(ss_sold_time_sk#6, 100), ENSURE_REQUIREMENTS, [plan_id=3]
   :  :  :  :  :  :                       :                    +- NativeSort [t_time_sk#21 ASC NULLS FIRST], false
   :  :  :  :  :  :                       :                       +- InputAdapter
   :  :  :  :  :  :                       :                          +- AQEShuffleRead coalesced
   :  :  :  :  :  :                       :                             +- ShuffleQueryStage 8
   :  :  :  :  :  :                       :                                +- NativeShuffleExchange hashpartitioning(t_time_sk#21, 100), ENSURE_REQUIREMENTS, [plan_id=10]
   :  :  :  :  :  :                       :                                   +- NativeProject [t_time_sk#21]
   :  :  :  :  :  :                       :                                      +- NativeFilter ((((isnotnull(t_hour#22) AND isnotnull(t_minute#23)) AND (t_hour#22 = 9)) AND (t_minute#23 < 30)) AND isnotnull(t_time_sk#21))
   :  :  :  :  :  :                       :                                         +- InputAdapter [#21, #22, #23]
   :  :  :  :  :  :                       :                                            +- NativeParquetScan  (FileScan parquet [t_time_sk#21,t_hour#22,t_minute#23] Batched: true, DataFilters: [isnotnull(t_hour#22), isnotnull(t_minute#23), (t_hour#22 = 9), (t_minute#23 < 30), i..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(t_hour), IsNotNull(t_minute), EqualTo(t_hour,9), LessThan(t_minute,30), IsNotNull(t_ti..., ReadSchema: struct<t_time_sk:int,t_hour:int,t_minute:int>)
   :  :  :  :  :  :                       +- NativeSort [s_store_sk#19 ASC NULLS FIRST], false
   :  :  :  :  :  :                          +- InputAdapter
   :  :  :  :  :  :                             +- InputAdapter [#19]
   :  :  :  :  :  :                                +- AQEShuffleRead coalesced
   :  :  :  :  :  :                                   +- ShuffleQueryStage 10
   :  :  :  :  :  :                                      +- ReusedExchange [s_store_sk#19], NativeShuffleExchange hashpartitioning(s_store_sk#5, 100), ENSURE_REQUIREMENTS, [plan_id=7]
   :  :  :  :  :  +- NativeProject [count(1)#24 AS h9_30_to_10#25]
   :  :  :  :  :     +- NativeHashAggregate HashAgg, List(), [count(1)], [count(1)#24], 0
   :  :  :  :  :        +- ShuffleQueryStage 81
   :  :  :  :  :           +- NativeShuffleExchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=11]
   :  :  :  :  :              +- NativeHashAggregate HashAgg, [partial_count(1)], [count#26], 0
   :  :  :  :  :                 +- NativeProject
   :  :  :  :  :                    +- NativeSortMergeJoin [ss_store_sk#27], [s_store_sk#28], Inner
   :  :  :  :  :                       :- NativeSort [ss_store_sk#27 ASC NULLS FIRST], false
   :  :  :  :  :                       :  +- InputAdapter
   :  :  :  :  :                       :     +- AQEShuffleRead coalesced
   :  :  :  :  :                       :        +- ShuffleQueryStage 70
   :  :  :  :  :                       :           +- NativeShuffleExchange hashpartitioning(ss_store_sk#27, 100), ENSURE_REQUIREMENTS, [plan_id=12]
   :  :  :  :  :                       :              +- NativeProject [ss_store_sk#27]
   :  :  :  :  :                       :                 +- NativeSortMergeJoin [ss_sold_time_sk#29], [t_time_sk#30], Inner
   :  :  :  :  :                       :                    :- NativeSort [ss_sold_time_sk#29 ASC NULLS FIRST], false
   :  :  :  :  :                       :                    :  +- InputAdapter
   :  :  :  :  :                       :                    :     +- InputAdapter [#29, #27]
   :  :  :  :  :                       :                    :        +- AQEShuffleRead coalesced
   :  :  :  :  :                       :                    :           +- ShuffleQueryStage 57
   :  :  :  :  :                       :                    :              +- ReusedExchange [ss_sold_time_sk#29, ss_store_sk#27], NativeShuffleExchange hashpartitioning(ss_sold_time_sk#6, 100), ENSURE_REQUIREMENTS, [plan_id=3]
   :  :  :  :  :                       :                    +- NativeSort [t_time_sk#30 ASC NULLS FIRST], false
   :  :  :  :  :                       :                       +- InputAdapter
   :  :  :  :  :                       :                          +- AQEShuffleRead coalesced
   :  :  :  :  :                       :                             +- ShuffleQueryStage 15
   :  :  :  :  :                       :                                +- NativeShuffleExchange hashpartitioning(t_time_sk#30, 100), ENSURE_REQUIREMENTS, [plan_id=13]
   :  :  :  :  :                       :                                   +- NativeProject [t_time_sk#30]
   :  :  :  :  :                       :                                      +- NativeFilter ((((isnotnull(t_hour#31) AND isnotnull(t_minute#32)) AND (t_hour#31 = 9)) AND (t_minute#32 >= 30)) AND isnotnull(t_time_sk#30))
   :  :  :  :  :                       :                                         +- InputAdapter [#30, #31, #32]
   :  :  :  :  :                       :                                            +- NativeParquetScan  (FileScan parquet [t_time_sk#30,t_hour#31,t_minute#32] Batched: true, DataFilters: [isnotnull(t_hour#31), isnotnull(t_minute#32), (t_hour#31 = 9), (t_minute#32 >= 30), ..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(t_hour), IsNotNull(t_minute), EqualTo(t_hour,9), GreaterThanOrEqual(t_minute,30), IsNo..., ReadSchema: struct<t_time_sk:int,t_hour:int,t_minute:int>)
   :  :  :  :  :                       +- NativeSort [s_store_sk#28 ASC NULLS FIRST], false
   :  :  :  :  :                          +- InputAdapter
   :  :  :  :  :                             +- InputAdapter [#28]
   :  :  :  :  :                                +- AQEShuffleRead coalesced
   :  :  :  :  :                                   +- ShuffleQueryStage 17
   :  :  :  :  :                                      +- ReusedExchange [s_store_sk#28], NativeShuffleExchange hashpartitioning(s_store_sk#5, 100), ENSURE_REQUIREMENTS, [plan_id=7]
   :  :  :  :  +- NativeProject [count(1)#33 AS h10_to_10_30#34]
   :  :  :  :     +- NativeHashAggregate HashAgg, List(), [count(1)], [count(1)#33], 0
   :  :  :  :        +- ShuffleQueryStage 78
   :  :  :  :           +- NativeShuffleExchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=14]
   :  :  :  :              +- NativeHashAggregate HashAgg, [partial_count(1)], [count#35], 0
   :  :  :  :                 +- NativeProject
   :  :  :  :                    +- NativeSortMergeJoin [ss_store_sk#36], [s_store_sk#37], Inner
   :  :  :  :                       :- NativeSort [ss_store_sk#36 ASC NULLS FIRST], false
   :  :  :  :                       :  +- InputAdapter
   :  :  :  :                       :     +- AQEShuffleRead coalesced
   :  :  :  :                       :        +- ShuffleQueryStage 71
   :  :  :  :                       :           +- NativeShuffleExchange hashpartitioning(ss_store_sk#36, 100), ENSURE_REQUIREMENTS, [plan_id=15]
   :  :  :  :                       :              +- NativeProject [ss_store_sk#36]
   :  :  :  :                       :                 +- NativeSortMergeJoin [ss_sold_time_sk#38], [t_time_sk#39], Inner
   :  :  :  :                       :                    :- NativeSort [ss_sold_time_sk#38 ASC NULLS FIRST], false
   :  :  :  :                       :                    :  +- InputAdapter
   :  :  :  :                       :                    :     +- InputAdapter [#38, #36]
   :  :  :  :                       :                    :        +- AQEShuffleRead coalesced
   :  :  :  :                       :                    :           +- ShuffleQueryStage 59
   :  :  :  :                       :                    :              +- ReusedExchange [ss_sold_time_sk#38, ss_store_sk#36], NativeShuffleExchange hashpartitioning(ss_sold_time_sk#6, 100), ENSURE_REQUIREMENTS, [plan_id=3]
   :  :  :  :                       :                    +- NativeSort [t_time_sk#39 ASC NULLS FIRST], false
   :  :  :  :                       :                       +- InputAdapter
   :  :  :  :                       :                          +- AQEShuffleRead coalesced
   :  :  :  :                       :                             +- ShuffleQueryStage 22
   :  :  :  :                       :                                +- NativeShuffleExchange hashpartitioning(t_time_sk#39, 100), ENSURE_REQUIREMENTS, [plan_id=16]
   :  :  :  :                       :                                   +- NativeProject [t_time_sk#39]
   :  :  :  :                       :                                      +- NativeFilter ((((isnotnull(t_hour#40) AND isnotnull(t_minute#41)) AND (t_hour#40 = 10)) AND (t_minute#41 < 30)) AND isnotnull(t_time_sk#39))
   :  :  :  :                       :                                         +- InputAdapter [#39, #40, #41]
   :  :  :  :                       :                                            +- NativeParquetScan  (FileScan parquet [t_time_sk#39,t_hour#40,t_minute#41] Batched: true, DataFilters: [isnotnull(t_hour#40), isnotnull(t_minute#41), (t_hour#40 = 10), (t_minute#41 < 30), ..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(t_hour), IsNotNull(t_minute), EqualTo(t_hour,10), LessThan(t_minute,30), IsNotNull(t_t..., ReadSchema: struct<t_time_sk:int,t_hour:int,t_minute:int>)
   :  :  :  :                       +- NativeSort [s_store_sk#37 ASC NULLS FIRST], false
   :  :  :  :                          +- InputAdapter
   :  :  :  :                             +- InputAdapter [#37]
   :  :  :  :                                +- AQEShuffleRead coalesced
   :  :  :  :                                   +- ShuffleQueryStage 24
   :  :  :  :                                      +- ReusedExchange [s_store_sk#37], NativeShuffleExchange hashpartitioning(s_store_sk#5, 100), ENSURE_REQUIREMENTS, [plan_id=7]
   :  :  :  +- NativeProject [count(1)#42 AS h10_30_to_11#43]
   :  :  :     +- NativeHashAggregate HashAgg, List(), [count(1)], [count(1)#42], 0
   :  :  :        +- ShuffleQueryStage 76
   :  :  :           +- NativeShuffleExchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=17]
   :  :  :              +- NativeHashAggregate HashAgg, [partial_count(1)], [count#44], 0
   :  :  :                 +- NativeProject
   :  :  :                    +- NativeSortMergeJoin [ss_store_sk#45], [s_store_sk#46], Inner
   :  :  :                       :- NativeSort [ss_store_sk#45 ASC NULLS FIRST], false
   :  :  :                       :  +- InputAdapter
   :  :  :                       :     +- AQEShuffleRead coalesced
   :  :  :                       :        +- ShuffleQueryStage 72
   :  :  :                       :           +- NativeShuffleExchange hashpartitioning(ss_store_sk#45, 100), ENSURE_REQUIREMENTS, [plan_id=18]
   :  :  :                       :              +- NativeProject [ss_store_sk#45]
   :  :  :                       :                 +- NativeSortMergeJoin [ss_sold_time_sk#47], [t_time_sk#48], Inner
   :  :  :                       :                    :- NativeSort [ss_sold_time_sk#47 ASC NULLS FIRST], false
   :  :  :                       :                    :  +- InputAdapter
   :  :  :                       :                    :     +- InputAdapter [#47, #45]
   :  :  :                       :                    :        +- AQEShuffleRead coalesced
   :  :  :                       :                    :           +- ShuffleQueryStage 61
   :  :  :                       :                    :              +- ReusedExchange [ss_sold_time_sk#47, ss_store_sk#45], NativeShuffleExchange hashpartitioning(ss_sold_time_sk#6, 100), ENSURE_REQUIREMENTS, [plan_id=3]
   :  :  :                       :                    +- NativeSort [t_time_sk#48 ASC NULLS FIRST], false
   :  :  :                       :                       +- InputAdapter
   :  :  :                       :                          +- AQEShuffleRead coalesced
   :  :  :                       :                             +- ShuffleQueryStage 29
   :  :  :                       :                                +- NativeShuffleExchange hashpartitioning(t_time_sk#48, 100), ENSURE_REQUIREMENTS, [plan_id=19]
   :  :  :                       :                                   +- NativeProject [t_time_sk#48]
   :  :  :                       :                                      +- NativeFilter ((((isnotnull(t_hour#49) AND isnotnull(t_minute#50)) AND (t_hour#49 = 10)) AND (t_minute#50 >= 30)) AND isnotnull(t_time_sk#48))
   :  :  :                       :                                         +- InputAdapter [#48, #49, #50]
   :  :  :                       :                                            +- NativeParquetScan  (FileScan parquet [t_time_sk#48,t_hour#49,t_minute#50] Batched: true, DataFilters: [isnotnull(t_hour#49), isnotnull(t_minute#50), (t_hour#49 = 10), (t_minute#50 >= 30),..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(t_hour), IsNotNull(t_minute), EqualTo(t_hour,10), GreaterThanOrEqual(t_minute,30), IsN..., ReadSchema: struct<t_time_sk:int,t_hour:int,t_minute:int>)
   :  :  :                       +- NativeSort [s_store_sk#46 ASC NULLS FIRST], false
   :  :  :                          +- InputAdapter
   :  :  :                             +- InputAdapter [#46]
   :  :  :                                +- AQEShuffleRead coalesced
   :  :  :                                   +- ShuffleQueryStage 31
   :  :  :                                      +- ReusedExchange [s_store_sk#46], NativeShuffleExchange hashpartitioning(s_store_sk#5, 100), ENSURE_REQUIREMENTS, [plan_id=7]
   :  :  +- NativeProject [count(1)#51 AS h11_to_11_30#52]
   :  :     +- NativeHashAggregate HashAgg, List(), [count(1)], [count(1)#51], 0
   :  :        +- ShuffleQueryStage 82
   :  :           +- NativeShuffleExchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=20]
   :  :              +- NativeHashAggregate HashAgg, [partial_count(1)], [count#53], 0
   :  :                 +- NativeProject
   :  :                    +- NativeSortMergeJoin [ss_store_sk#54], [s_store_sk#55], Inner
   :  :                       :- NativeSort [ss_store_sk#54 ASC NULLS FIRST], false
   :  :                       :  +- InputAdapter
   :  :                       :     +- AQEShuffleRead coalesced
   :  :                       :        +- ShuffleQueryStage 73
   :  :                       :           +- NativeShuffleExchange hashpartitioning(ss_store_sk#54, 100), ENSURE_REQUIREMENTS, [plan_id=21]
   :  :                       :              +- NativeProject [ss_store_sk#54]
   :  :                       :                 +- NativeSortMergeJoin [ss_sold_time_sk#56], [t_time_sk#57], Inner
   :  :                       :                    :- NativeSort [ss_sold_time_sk#56 ASC NULLS FIRST], false
   :  :                       :                    :  +- InputAdapter
   :  :                       :                    :     +- InputAdapter [#56, #54]
   :  :                       :                    :        +- AQEShuffleRead coalesced
   :  :                       :                    :           +- ShuffleQueryStage 63
   :  :                       :                    :              +- ReusedExchange [ss_sold_time_sk#56, ss_store_sk#54], NativeShuffleExchange hashpartitioning(ss_sold_time_sk#6, 100), ENSURE_REQUIREMENTS, [plan_id=3]
   :  :                       :                    +- NativeSort [t_time_sk#57 ASC NULLS FIRST], false
   :  :                       :                       +- InputAdapter
   :  :                       :                          +- AQEShuffleRead coalesced
   :  :                       :                             +- ShuffleQueryStage 36
   :  :                       :                                +- NativeShuffleExchange hashpartitioning(t_time_sk#57, 100), ENSURE_REQUIREMENTS, [plan_id=22]
   :  :                       :                                   +- NativeProject [t_time_sk#57]
   :  :                       :                                      +- NativeFilter ((((isnotnull(t_hour#58) AND isnotnull(t_minute#59)) AND (t_hour#58 = 11)) AND (t_minute#59 < 30)) AND isnotnull(t_time_sk#57))
   :  :                       :                                         +- InputAdapter [#57, #58, #59]
   :  :                       :                                            +- NativeParquetScan  (FileScan parquet [t_time_sk#57,t_hour#58,t_minute#59] Batched: true, DataFilters: [isnotnull(t_hour#58), isnotnull(t_minute#59), (t_hour#58 = 11), (t_minute#59 < 30), ..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(t_hour), IsNotNull(t_minute), EqualTo(t_hour,11), LessThan(t_minute,30), IsNotNull(t_t..., ReadSchema: struct<t_time_sk:int,t_hour:int,t_minute:int>)
   :  :                       +- NativeSort [s_store_sk#55 ASC NULLS FIRST], false
   :  :                          +- InputAdapter
   :  :                             +- InputAdapter [#55]
   :  :                                +- AQEShuffleRead coalesced
   :  :                                   +- ShuffleQueryStage 38
   :  :                                      +- ReusedExchange [s_store_sk#55], NativeShuffleExchange hashpartitioning(s_store_sk#5, 100), ENSURE_REQUIREMENTS, [plan_id=7]
   :  +- NativeProject [count(1)#60 AS h11_30_to_12#61]
   :     +- NativeHashAggregate HashAgg, List(), [count(1)], [count(1)#60], 0
   :        +- ShuffleQueryStage 79
   :           +- NativeShuffleExchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=23]
   :              +- NativeHashAggregate HashAgg, [partial_count(1)], [count#62], 0
   :                 +- NativeProject
   :                    +- NativeSortMergeJoin [ss_store_sk#63], [s_store_sk#64], Inner
   :                       :- NativeSort [ss_store_sk#63 ASC NULLS FIRST], false
   :                       :  +- InputAdapter
   :                       :     +- AQEShuffleRead coalesced
   :                       :        +- ShuffleQueryStage 74
   :                       :           +- NativeShuffleExchange hashpartitioning(ss_store_sk#63, 100), ENSURE_REQUIREMENTS, [plan_id=24]
   :                       :              +- NativeProject [ss_store_sk#63]
   :                       :                 +- NativeSortMergeJoin [ss_sold_time_sk#65], [t_time_sk#66], Inner
   :                       :                    :- NativeSort [ss_sold_time_sk#65 ASC NULLS FIRST], false
   :                       :                    :  +- InputAdapter
   :                       :                    :     +- InputAdapter [#65, #63]
   :                       :                    :        +- AQEShuffleRead coalesced
   :                       :                    :           +- ShuffleQueryStage 65
   :                       :                    :              +- ReusedExchange [ss_sold_time_sk#65, ss_store_sk#63], NativeShuffleExchange hashpartitioning(ss_sold_time_sk#6, 100), ENSURE_REQUIREMENTS, [plan_id=3]
   :                       :                    +- NativeSort [t_time_sk#66 ASC NULLS FIRST], false
   :                       :                       +- InputAdapter
   :                       :                          +- AQEShuffleRead coalesced
   :                       :                             +- ShuffleQueryStage 43
   :                       :                                +- NativeShuffleExchange hashpartitioning(t_time_sk#66, 100), ENSURE_REQUIREMENTS, [plan_id=25]
   :                       :                                   +- NativeProject [t_time_sk#66]
   :                       :                                      +- NativeFilter ((((isnotnull(t_hour#67) AND isnotnull(t_minute#68)) AND (t_hour#67 = 11)) AND (t_minute#68 >= 30)) AND isnotnull(t_time_sk#66))
   :                       :                                         +- InputAdapter [#66, #67, #68]
   :                       :                                            +- NativeParquetScan  (FileScan parquet [t_time_sk#66,t_hour#67,t_minute#68] Batched: true, DataFilters: [isnotnull(t_hour#67), isnotnull(t_minute#68), (t_hour#67 = 11), (t_minute#68 >= 30),..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(t_hour), IsNotNull(t_minute), EqualTo(t_hour,11), GreaterThanOrEqual(t_minute,30), IsN..., ReadSchema: struct<t_time_sk:int,t_hour:int,t_minute:int>)
   :                       +- NativeSort [s_store_sk#64 ASC NULLS FIRST], false
   :                          +- InputAdapter
   :                             +- InputAdapter [#64]
   :                                +- AQEShuffleRead coalesced
   :                                   +- ShuffleQueryStage 45
   :                                      +- ReusedExchange [s_store_sk#64], NativeShuffleExchange hashpartitioning(s_store_sk#5, 100), ENSURE_REQUIREMENTS, [plan_id=7]
   +- NativeProject [count(1)#69 AS h12_to_12_30#70]
      +- NativeHashAggregate HashAgg, List(), [count(1)], [count(1)#69], 0
         +- ShuffleQueryStage 83
            +- NativeShuffleExchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=26]
               +- NativeHashAggregate HashAgg, [partial_count(1)], [count#71], 0
                  +- NativeProject
                     +- NativeSortMergeJoin [ss_store_sk#72], [s_store_sk#73], Inner
                        :- NativeSort [ss_store_sk#72 ASC NULLS FIRST], false
                        :  +- InputAdapter
                        :     +- AQEShuffleRead coalesced
                        :        +- ShuffleQueryStage 75
                        :           +- NativeShuffleExchange hashpartitioning(ss_store_sk#72, 100), ENSURE_REQUIREMENTS, [plan_id=27]
                        :              +- NativeProject [ss_store_sk#72]
                        :                 +- NativeSortMergeJoin [ss_sold_time_sk#74], [t_time_sk#75], Inner
                        :                    :- NativeSort [ss_sold_time_sk#74 ASC NULLS FIRST], false
                        :                    :  +- InputAdapter
                        :                    :     +- InputAdapter [#74, #72]
                        :                    :        +- AQEShuffleRead coalesced
                        :                    :           +- ShuffleQueryStage 67
                        :                    :              +- ReusedExchange [ss_sold_time_sk#74, ss_store_sk#72], NativeShuffleExchange hashpartitioning(ss_sold_time_sk#6, 100), ENSURE_REQUIREMENTS, [plan_id=3]
                        :                    +- NativeSort [t_time_sk#75 ASC NULLS FIRST], false
                        :                       +- InputAdapter
                        :                          +- AQEShuffleRead coalesced
                        :                             +- ShuffleQueryStage 50
                        :                                +- NativeShuffleExchange hashpartitioning(t_time_sk#75, 100), ENSURE_REQUIREMENTS, [plan_id=28]
                        :                                   +- NativeProject [t_time_sk#75]
                        :                                      +- NativeFilter ((((isnotnull(t_hour#76) AND isnotnull(t_minute#77)) AND (t_hour#76 = 12)) AND (t_minute#77 < 30)) AND isnotnull(t_time_sk#75))
                        :                                         +- InputAdapter [#75, #76, #77]
                        :                                            +- NativeParquetScan  (FileScan parquet [t_time_sk#75,t_hour#76,t_minute#77] Batched: true, DataFilters: [isnotnull(t_hour#76), isnotnull(t_minute#77), (t_hour#76 = 12), (t_minute#77 < 30), ..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(t_hour), IsNotNull(t_minute), EqualTo(t_hour,12), LessThan(t_minute,30), IsNotNull(t_t..., ReadSchema: struct<t_time_sk:int,t_hour:int,t_minute:int>)
                        +- NativeSort [s_store_sk#73 ASC NULLS FIRST], false
                           +- InputAdapter
                              +- InputAdapter [#73]
                                 +- AQEShuffleRead coalesced
                                    +- ShuffleQueryStage 52
                                       +- ReusedExchange [s_store_sk#73], NativeShuffleExchange hashpartitioning(s_store_sk#5, 100), ENSURE_REQUIREMENTS, [plan_id=7]
+- == Initial Plan ==
   CartesianProduct
   :- CartesianProduct
   :  :- CartesianProduct
   :  :  :- CartesianProduct
   :  :  :  :- CartesianProduct
   :  :  :  :  :- CartesianProduct
   :  :  :  :  :  :- CartesianProduct
   :  :  :  :  :  :  :- HashAggregate(keys=[], functions=[count(1)], output=[h8_30_to_9#2])
   :  :  :  :  :  :  :  +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=29]
   :  :  :  :  :  :  :     +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#78])
   :  :  :  :  :  :  :        +- Project
   :  :  :  :  :  :  :           +- SortMergeJoin [ss_store_sk#4], [s_store_sk#5], Inner
   :  :  :  :  :  :  :              :- Sort [ss_store_sk#4 ASC NULLS FIRST], false, 0
   :  :  :  :  :  :  :              :  +- Exchange hashpartitioning(ss_store_sk#4, 100), ENSURE_REQUIREMENTS, [plan_id=30]
   :  :  :  :  :  :  :              :     +- Project [ss_store_sk#4]
   :  :  :  :  :  :  :              :        +- SortMergeJoin [ss_sold_time_sk#6], [t_time_sk#7], Inner
   :  :  :  :  :  :  :              :           :- Sort [ss_sold_time_sk#6 ASC NULLS FIRST], false, 0
   :  :  :  :  :  :  :              :           :  +- Exchange hashpartitioning(ss_sold_time_sk#6, 100), ENSURE_REQUIREMENTS, [plan_id=31]
   :  :  :  :  :  :  :              :           :     +- Project [ss_sold_time_sk#6, ss_store_sk#4]
   :  :  :  :  :  :  :              :           :        +- SortMergeJoin [ss_hdemo_sk#8], [hd_demo_sk#9], Inner
   :  :  :  :  :  :  :              :           :           :- Sort [ss_hdemo_sk#8 ASC NULLS FIRST], false, 0
   :  :  :  :  :  :  :              :           :           :  +- Exchange hashpartitioning(ss_hdemo_sk#8, 100), ENSURE_REQUIREMENTS, [plan_id=32]
   :  :  :  :  :  :  :              :           :           :     +- Filter ((isnotnull(ss_hdemo_sk#8) AND isnotnull(ss_sold_time_sk#6)) AND isnotnull(ss_store_sk#4))
   :  :  :  :  :  :  :              :           :           :        +- FileScan parquet [ss_sold_time_sk#6,ss_hdemo_sk#8,ss_store_sk#4] Batched: true, DataFilters: [isnotnull(ss_hdemo_sk#8), isnotnull(ss_sold_time_sk#6), isnotnull(ss_store_sk#4)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_hdemo_sk), IsNotNull(ss_sold_time_sk), IsNotNull(ss_store_sk)], ReadSchema: struct<ss_sold_time_sk:int,ss_hdemo_sk:int,ss_store_sk:int>
   :  :  :  :  :  :  :              :           :           +- Sort [hd_demo_sk#9 ASC NULLS FIRST], false, 0
   :  :  :  :  :  :  :              :           :              +- Exchange hashpartitioning(hd_demo_sk#9, 100), ENSURE_REQUIREMENTS, [plan_id=33]
   :  :  :  :  :  :  :              :           :                 +- Project [hd_demo_sk#9]
   :  :  :  :  :  :  :              :           :                    +- Filter (((((hd_dep_count#10 = 4) AND (hd_vehicle_count#11 <= 6)) OR ((hd_dep_count#10 = 2) AND (hd_vehicle_count#11 <= 4))) OR ((hd_dep_count#10 = 0) AND (hd_vehicle_count#11 <= 2))) AND isnotnull(hd_demo_sk#9))
   :  :  :  :  :  :  :              :           :                       +- FileScan parquet [hd_demo_sk#9,hd_dep_count#10,hd_vehicle_count#11] Batched: true, DataFilters: [((((hd_dep_count#10 = 4) AND (hd_vehicle_count#11 <= 6)) OR ((hd_dep_count#10 = 2) AND ..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>, PartitionFilters: [], PushedFilters: [Or(Or(And(EqualTo(hd_dep_count,4),LessThanOrEqual(hd_vehicle_count,6)),And(EqualTo(hd_dep_count,..., ReadSchema: struct<hd_demo_sk:int,hd_dep_count:int,hd_vehicle_count:int>
   :  :  :  :  :  :  :              :           +- Sort [t_time_sk#7 ASC NULLS FIRST], false, 0
   :  :  :  :  :  :  :              :              +- Exchange hashpartitioning(t_time_sk#7, 100), ENSURE_REQUIREMENTS, [plan_id=34]
   :  :  :  :  :  :  :              :                 +- Project [t_time_sk#7]
   :  :  :  :  :  :  :              :                    +- Filter ((((isnotnull(t_hour#12) AND isnotnull(t_minute#13)) AND (t_hour#12 = 8)) AND (t_minute#13 >= 30)) AND isnotnull(t_time_sk#7))
   :  :  :  :  :  :  :              :                       +- FileScan parquet [t_time_sk#7,t_hour#12,t_minute#13] Batched: true, DataFilters: [isnotnull(t_hour#12), isnotnull(t_minute#13), (t_hour#12 = 8), (t_minute#13 >= 30), ..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(t_hour), IsNotNull(t_minute), EqualTo(t_hour,8), GreaterThanOrEqual(t_minute,30), IsNo..., ReadSchema: struct<t_time_sk:int,t_hour:int,t_minute:int>
   :  :  :  :  :  :  :              +- Sort [s_store_sk#5 ASC NULLS FIRST], false, 0
   :  :  :  :  :  :  :                 +- Exchange hashpartitioning(s_store_sk#5, 100), ENSURE_REQUIREMENTS, [plan_id=35]
   :  :  :  :  :  :  :                    +- Project [s_store_sk#5]
   :  :  :  :  :  :  :                       +- Filter ((isnotnull(s_store_name#14) AND (s_store_name#14 = ese)) AND isnotnull(s_store_sk#5))
   :  :  :  :  :  :  :                          +- FileScan parquet [s_store_sk#5,s_store_name#14] Batched: true, DataFilters: [isnotnull(s_store_name#14), (s_store_name#14 = ese), isnotnull(s_store_sk#5)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_name), EqualTo(s_store_name,ese), IsNotNull(s_store_sk)], ReadSchema: struct<s_store_sk:int,s_store_name:string>
   :  :  :  :  :  :  +- HashAggregate(keys=[], functions=[count(1)], output=[h9_to_9_30#16])
   :  :  :  :  :  :     +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=36]
   :  :  :  :  :  :        +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#79])
   :  :  :  :  :  :           +- Project
   :  :  :  :  :  :              +- SortMergeJoin [ss_store_sk#18], [s_store_sk#19], Inner
   :  :  :  :  :  :                 :- Sort [ss_store_sk#18 ASC NULLS FIRST], false, 0
   :  :  :  :  :  :                 :  +- Exchange hashpartitioning(ss_store_sk#18, 100), ENSURE_REQUIREMENTS, [plan_id=37]
   :  :  :  :  :  :                 :     +- Project [ss_store_sk#18]
   :  :  :  :  :  :                 :        +- SortMergeJoin [ss_sold_time_sk#20], [t_time_sk#21], Inner
   :  :  :  :  :  :                 :           :- Sort [ss_sold_time_sk#20 ASC NULLS FIRST], false, 0
   :  :  :  :  :  :                 :           :  +- Exchange hashpartitioning(ss_sold_time_sk#20, 100), ENSURE_REQUIREMENTS, [plan_id=38]
   :  :  :  :  :  :                 :           :     +- Project [ss_sold_time_sk#20, ss_store_sk#18]
   :  :  :  :  :  :                 :           :        +- SortMergeJoin [ss_hdemo_sk#80], [hd_demo_sk#81], Inner
   :  :  :  :  :  :                 :           :           :- Sort [ss_hdemo_sk#80 ASC NULLS FIRST], false, 0
   :  :  :  :  :  :                 :           :           :  +- Exchange hashpartitioning(ss_hdemo_sk#80, 100), ENSURE_REQUIREMENTS, [plan_id=39]
   :  :  :  :  :  :                 :           :           :     +- Filter ((isnotnull(ss_hdemo_sk#80) AND isnotnull(ss_sold_time_sk#20)) AND isnotnull(ss_store_sk#18))
   :  :  :  :  :  :                 :           :           :        +- FileScan parquet [ss_sold_time_sk#20,ss_hdemo_sk#80,ss_store_sk#18] Batched: true, DataFilters: [isnotnull(ss_hdemo_sk#80), isnotnull(ss_sold_time_sk#20), isnotnull(ss_store_sk#18)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_hdemo_sk), IsNotNull(ss_sold_time_sk), IsNotNull(ss_store_sk)], ReadSchema: struct<ss_sold_time_sk:int,ss_hdemo_sk:int,ss_store_sk:int>
   :  :  :  :  :  :                 :           :           +- Sort [hd_demo_sk#81 ASC NULLS FIRST], false, 0
   :  :  :  :  :  :                 :           :              +- Exchange hashpartitioning(hd_demo_sk#81, 100), ENSURE_REQUIREMENTS, [plan_id=40]
   :  :  :  :  :  :                 :           :                 +- Project [hd_demo_sk#81]
   :  :  :  :  :  :                 :           :                    +- Filter (((((hd_dep_count#82 = 4) AND (hd_vehicle_count#83 <= 6)) OR ((hd_dep_count#82 = 2) AND (hd_vehicle_count#83 <= 4))) OR ((hd_dep_count#82 = 0) AND (hd_vehicle_count#83 <= 2))) AND isnotnull(hd_demo_sk#81))
   :  :  :  :  :  :                 :           :                       +- FileScan parquet [hd_demo_sk#81,hd_dep_count#82,hd_vehicle_count#83] Batched: true, DataFilters: [((((hd_dep_count#82 = 4) AND (hd_vehicle_count#83 <= 6)) OR ((hd_dep_count#82 = 2) AND ..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>, PartitionFilters: [], PushedFilters: [Or(Or(And(EqualTo(hd_dep_count,4),LessThanOrEqual(hd_vehicle_count,6)),And(EqualTo(hd_dep_count,..., ReadSchema: struct<hd_demo_sk:int,hd_dep_count:int,hd_vehicle_count:int>
   :  :  :  :  :  :                 :           +- Sort [t_time_sk#21 ASC NULLS FIRST], false, 0
   :  :  :  :  :  :                 :              +- Exchange hashpartitioning(t_time_sk#21, 100), ENSURE_REQUIREMENTS, [plan_id=41]
   :  :  :  :  :  :                 :                 +- Project [t_time_sk#21]
   :  :  :  :  :  :                 :                    +- Filter ((((isnotnull(t_hour#22) AND isnotnull(t_minute#23)) AND (t_hour#22 = 9)) AND (t_minute#23 < 30)) AND isnotnull(t_time_sk#21))
   :  :  :  :  :  :                 :                       +- FileScan parquet [t_time_sk#21,t_hour#22,t_minute#23] Batched: true, DataFilters: [isnotnull(t_hour#22), isnotnull(t_minute#23), (t_hour#22 = 9), (t_minute#23 < 30), i..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(t_hour), IsNotNull(t_minute), EqualTo(t_hour,9), LessThan(t_minute,30), IsNotNull(t_ti..., ReadSchema: struct<t_time_sk:int,t_hour:int,t_minute:int>
   :  :  :  :  :  :                 +- Sort [s_store_sk#19 ASC NULLS FIRST], false, 0
   :  :  :  :  :  :                    +- Exchange hashpartitioning(s_store_sk#19, 100), ENSURE_REQUIREMENTS, [plan_id=42]
   :  :  :  :  :  :                       +- Project [s_store_sk#19]
   :  :  :  :  :  :                          +- Filter ((isnotnull(s_store_name#84) AND (s_store_name#84 = ese)) AND isnotnull(s_store_sk#19))
   :  :  :  :  :  :                             +- FileScan parquet [s_store_sk#19,s_store_name#84] Batched: true, DataFilters: [isnotnull(s_store_name#84), (s_store_name#84 = ese), isnotnull(s_store_sk#19)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_name), EqualTo(s_store_name,ese), IsNotNull(s_store_sk)], ReadSchema: struct<s_store_sk:int,s_store_name:string>
   :  :  :  :  :  +- HashAggregate(keys=[], functions=[count(1)], output=[h9_30_to_10#25])
   :  :  :  :  :     +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=43]
   :  :  :  :  :        +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#85])
   :  :  :  :  :           +- Project
   :  :  :  :  :              +- SortMergeJoin [ss_store_sk#27], [s_store_sk#28], Inner
   :  :  :  :  :                 :- Sort [ss_store_sk#27 ASC NULLS FIRST], false, 0
   :  :  :  :  :                 :  +- Exchange hashpartitioning(ss_store_sk#27, 100), ENSURE_REQUIREMENTS, [plan_id=44]
   :  :  :  :  :                 :     +- Project [ss_store_sk#27]
   :  :  :  :  :                 :        +- SortMergeJoin [ss_sold_time_sk#29], [t_time_sk#30], Inner
   :  :  :  :  :                 :           :- Sort [ss_sold_time_sk#29 ASC NULLS FIRST], false, 0
   :  :  :  :  :                 :           :  +- Exchange hashpartitioning(ss_sold_time_sk#29, 100), ENSURE_REQUIREMENTS, [plan_id=45]
   :  :  :  :  :                 :           :     +- Project [ss_sold_time_sk#29, ss_store_sk#27]
   :  :  :  :  :                 :           :        +- SortMergeJoin [ss_hdemo_sk#86], [hd_demo_sk#87], Inner
   :  :  :  :  :                 :           :           :- Sort [ss_hdemo_sk#86 ASC NULLS FIRST], false, 0
   :  :  :  :  :                 :           :           :  +- Exchange hashpartitioning(ss_hdemo_sk#86, 100), ENSURE_REQUIREMENTS, [plan_id=46]
   :  :  :  :  :                 :           :           :     +- Filter ((isnotnull(ss_hdemo_sk#86) AND isnotnull(ss_sold_time_sk#29)) AND isnotnull(ss_store_sk#27))
   :  :  :  :  :                 :           :           :        +- FileScan parquet [ss_sold_time_sk#29,ss_hdemo_sk#86,ss_store_sk#27] Batched: true, DataFilters: [isnotnull(ss_hdemo_sk#86), isnotnull(ss_sold_time_sk#29), isnotnull(ss_store_sk#27)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_hdemo_sk), IsNotNull(ss_sold_time_sk), IsNotNull(ss_store_sk)], ReadSchema: struct<ss_sold_time_sk:int,ss_hdemo_sk:int,ss_store_sk:int>
   :  :  :  :  :                 :           :           +- Sort [hd_demo_sk#87 ASC NULLS FIRST], false, 0
   :  :  :  :  :                 :           :              +- Exchange hashpartitioning(hd_demo_sk#87, 100), ENSURE_REQUIREMENTS, [plan_id=47]
   :  :  :  :  :                 :           :                 +- Project [hd_demo_sk#87]
   :  :  :  :  :                 :           :                    +- Filter (((((hd_dep_count#88 = 4) AND (hd_vehicle_count#89 <= 6)) OR ((hd_dep_count#88 = 2) AND (hd_vehicle_count#89 <= 4))) OR ((hd_dep_count#88 = 0) AND (hd_vehicle_count#89 <= 2))) AND isnotnull(hd_demo_sk#87))
   :  :  :  :  :                 :           :                       +- FileScan parquet [hd_demo_sk#87,hd_dep_count#88,hd_vehicle_count#89] Batched: true, DataFilters: [((((hd_dep_count#88 = 4) AND (hd_vehicle_count#89 <= 6)) OR ((hd_dep_count#88 = 2) AND ..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>, PartitionFilters: [], PushedFilters: [Or(Or(And(EqualTo(hd_dep_count,4),LessThanOrEqual(hd_vehicle_count,6)),And(EqualTo(hd_dep_count,..., ReadSchema: struct<hd_demo_sk:int,hd_dep_count:int,hd_vehicle_count:int>
   :  :  :  :  :                 :           +- Sort [t_time_sk#30 ASC NULLS FIRST], false, 0
   :  :  :  :  :                 :              +- Exchange hashpartitioning(t_time_sk#30, 100), ENSURE_REQUIREMENTS, [plan_id=48]
   :  :  :  :  :                 :                 +- Project [t_time_sk#30]
   :  :  :  :  :                 :                    +- Filter ((((isnotnull(t_hour#31) AND isnotnull(t_minute#32)) AND (t_hour#31 = 9)) AND (t_minute#32 >= 30)) AND isnotnull(t_time_sk#30))
   :  :  :  :  :                 :                       +- FileScan parquet [t_time_sk#30,t_hour#31,t_minute#32] Batched: true, DataFilters: [isnotnull(t_hour#31), isnotnull(t_minute#32), (t_hour#31 = 9), (t_minute#32 >= 30), ..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(t_hour), IsNotNull(t_minute), EqualTo(t_hour,9), GreaterThanOrEqual(t_minute,30), IsNo..., ReadSchema: struct<t_time_sk:int,t_hour:int,t_minute:int>
   :  :  :  :  :                 +- Sort [s_store_sk#28 ASC NULLS FIRST], false, 0
   :  :  :  :  :                    +- Exchange hashpartitioning(s_store_sk#28, 100), ENSURE_REQUIREMENTS, [plan_id=49]
   :  :  :  :  :                       +- Project [s_store_sk#28]
   :  :  :  :  :                          +- Filter ((isnotnull(s_store_name#90) AND (s_store_name#90 = ese)) AND isnotnull(s_store_sk#28))
   :  :  :  :  :                             +- FileScan parquet [s_store_sk#28,s_store_name#90] Batched: true, DataFilters: [isnotnull(s_store_name#90), (s_store_name#90 = ese), isnotnull(s_store_sk#28)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_name), EqualTo(s_store_name,ese), IsNotNull(s_store_sk)], ReadSchema: struct<s_store_sk:int,s_store_name:string>
   :  :  :  :  +- HashAggregate(keys=[], functions=[count(1)], output=[h10_to_10_30#34])
   :  :  :  :     +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=50]
   :  :  :  :        +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#91])
   :  :  :  :           +- Project
   :  :  :  :              +- SortMergeJoin [ss_store_sk#36], [s_store_sk#37], Inner
   :  :  :  :                 :- Sort [ss_store_sk#36 ASC NULLS FIRST], false, 0
   :  :  :  :                 :  +- Exchange hashpartitioning(ss_store_sk#36, 100), ENSURE_REQUIREMENTS, [plan_id=51]
   :  :  :  :                 :     +- Project [ss_store_sk#36]
   :  :  :  :                 :        +- SortMergeJoin [ss_sold_time_sk#38], [t_time_sk#39], Inner
   :  :  :  :                 :           :- Sort [ss_sold_time_sk#38 ASC NULLS FIRST], false, 0
   :  :  :  :                 :           :  +- Exchange hashpartitioning(ss_sold_time_sk#38, 100), ENSURE_REQUIREMENTS, [plan_id=52]
   :  :  :  :                 :           :     +- Project [ss_sold_time_sk#38, ss_store_sk#36]
   :  :  :  :                 :           :        +- SortMergeJoin [ss_hdemo_sk#92], [hd_demo_sk#93], Inner
   :  :  :  :                 :           :           :- Sort [ss_hdemo_sk#92 ASC NULLS FIRST], false, 0
   :  :  :  :                 :           :           :  +- Exchange hashpartitioning(ss_hdemo_sk#92, 100), ENSURE_REQUIREMENTS, [plan_id=53]
   :  :  :  :                 :           :           :     +- Filter ((isnotnull(ss_hdemo_sk#92) AND isnotnull(ss_sold_time_sk#38)) AND isnotnull(ss_store_sk#36))
   :  :  :  :                 :           :           :        +- FileScan parquet [ss_sold_time_sk#38,ss_hdemo_sk#92,ss_store_sk#36] Batched: true, DataFilters: [isnotnull(ss_hdemo_sk#92), isnotnull(ss_sold_time_sk#38), isnotnull(ss_store_sk#36)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_hdemo_sk), IsNotNull(ss_sold_time_sk), IsNotNull(ss_store_sk)], ReadSchema: struct<ss_sold_time_sk:int,ss_hdemo_sk:int,ss_store_sk:int>
   :  :  :  :                 :           :           +- Sort [hd_demo_sk#93 ASC NULLS FIRST], false, 0
   :  :  :  :                 :           :              +- Exchange hashpartitioning(hd_demo_sk#93, 100), ENSURE_REQUIREMENTS, [plan_id=54]
   :  :  :  :                 :           :                 +- Project [hd_demo_sk#93]
   :  :  :  :                 :           :                    +- Filter (((((hd_dep_count#94 = 4) AND (hd_vehicle_count#95 <= 6)) OR ((hd_dep_count#94 = 2) AND (hd_vehicle_count#95 <= 4))) OR ((hd_dep_count#94 = 0) AND (hd_vehicle_count#95 <= 2))) AND isnotnull(hd_demo_sk#93))
   :  :  :  :                 :           :                       +- FileScan parquet [hd_demo_sk#93,hd_dep_count#94,hd_vehicle_count#95] Batched: true, DataFilters: [((((hd_dep_count#94 = 4) AND (hd_vehicle_count#95 <= 6)) OR ((hd_dep_count#94 = 2) AND ..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>, PartitionFilters: [], PushedFilters: [Or(Or(And(EqualTo(hd_dep_count,4),LessThanOrEqual(hd_vehicle_count,6)),And(EqualTo(hd_dep_count,..., ReadSchema: struct<hd_demo_sk:int,hd_dep_count:int,hd_vehicle_count:int>
   :  :  :  :                 :           +- Sort [t_time_sk#39 ASC NULLS FIRST], false, 0
   :  :  :  :                 :              +- Exchange hashpartitioning(t_time_sk#39, 100), ENSURE_REQUIREMENTS, [plan_id=55]
   :  :  :  :                 :                 +- Project [t_time_sk#39]
   :  :  :  :                 :                    +- Filter ((((isnotnull(t_hour#40) AND isnotnull(t_minute#41)) AND (t_hour#40 = 10)) AND (t_minute#41 < 30)) AND isnotnull(t_time_sk#39))
   :  :  :  :                 :                       +- FileScan parquet [t_time_sk#39,t_hour#40,t_minute#41] Batched: true, DataFilters: [isnotnull(t_hour#40), isnotnull(t_minute#41), (t_hour#40 = 10), (t_minute#41 < 30), ..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(t_hour), IsNotNull(t_minute), EqualTo(t_hour,10), LessThan(t_minute,30), IsNotNull(t_t..., ReadSchema: struct<t_time_sk:int,t_hour:int,t_minute:int>
   :  :  :  :                 +- Sort [s_store_sk#37 ASC NULLS FIRST], false, 0
   :  :  :  :                    +- Exchange hashpartitioning(s_store_sk#37, 100), ENSURE_REQUIREMENTS, [plan_id=56]
   :  :  :  :                       +- Project [s_store_sk#37]
   :  :  :  :                          +- Filter ((isnotnull(s_store_name#96) AND (s_store_name#96 = ese)) AND isnotnull(s_store_sk#37))
   :  :  :  :                             +- FileScan parquet [s_store_sk#37,s_store_name#96] Batched: true, DataFilters: [isnotnull(s_store_name#96), (s_store_name#96 = ese), isnotnull(s_store_sk#37)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_name), EqualTo(s_store_name,ese), IsNotNull(s_store_sk)], ReadSchema: struct<s_store_sk:int,s_store_name:string>
   :  :  :  +- HashAggregate(keys=[], functions=[count(1)], output=[h10_30_to_11#43])
   :  :  :     +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=57]
   :  :  :        +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#97])
   :  :  :           +- Project
   :  :  :              +- SortMergeJoin [ss_store_sk#45], [s_store_sk#46], Inner
   :  :  :                 :- Sort [ss_store_sk#45 ASC NULLS FIRST], false, 0
   :  :  :                 :  +- Exchange hashpartitioning(ss_store_sk#45, 100), ENSURE_REQUIREMENTS, [plan_id=58]
   :  :  :                 :     +- Project [ss_store_sk#45]
   :  :  :                 :        +- SortMergeJoin [ss_sold_time_sk#47], [t_time_sk#48], Inner
   :  :  :                 :           :- Sort [ss_sold_time_sk#47 ASC NULLS FIRST], false, 0
   :  :  :                 :           :  +- Exchange hashpartitioning(ss_sold_time_sk#47, 100), ENSURE_REQUIREMENTS, [plan_id=59]
   :  :  :                 :           :     +- Project [ss_sold_time_sk#47, ss_store_sk#45]
   :  :  :                 :           :        +- SortMergeJoin [ss_hdemo_sk#98], [hd_demo_sk#99], Inner
   :  :  :                 :           :           :- Sort [ss_hdemo_sk#98 ASC NULLS FIRST], false, 0
   :  :  :                 :           :           :  +- Exchange hashpartitioning(ss_hdemo_sk#98, 100), ENSURE_REQUIREMENTS, [plan_id=60]
   :  :  :                 :           :           :     +- Filter ((isnotnull(ss_hdemo_sk#98) AND isnotnull(ss_sold_time_sk#47)) AND isnotnull(ss_store_sk#45))
   :  :  :                 :           :           :        +- FileScan parquet [ss_sold_time_sk#47,ss_hdemo_sk#98,ss_store_sk#45] Batched: true, DataFilters: [isnotnull(ss_hdemo_sk#98), isnotnull(ss_sold_time_sk#47), isnotnull(ss_store_sk#45)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_hdemo_sk), IsNotNull(ss_sold_time_sk), IsNotNull(ss_store_sk)], ReadSchema: struct<ss_sold_time_sk:int,ss_hdemo_sk:int,ss_store_sk:int>
   :  :  :                 :           :           +- Sort [hd_demo_sk#99 ASC NULLS FIRST], false, 0
   :  :  :                 :           :              +- Exchange hashpartitioning(hd_demo_sk#99, 100), ENSURE_REQUIREMENTS, [plan_id=61]
   :  :  :                 :           :                 +- Project [hd_demo_sk#99]
   :  :  :                 :           :                    +- Filter (((((hd_dep_count#100 = 4) AND (hd_vehicle_count#101 <= 6)) OR ((hd_dep_count#100 = 2) AND (hd_vehicle_count#101 <= 4))) OR ((hd_dep_count#100 = 0) AND (hd_vehicle_count#101 <= 2))) AND isnotnull(hd_demo_sk#99))
   :  :  :                 :           :                       +- FileScan parquet [hd_demo_sk#99,hd_dep_count#100,hd_vehicle_count#101] Batched: true, DataFilters: [((((hd_dep_count#100 = 4) AND (hd_vehicle_count#101 <= 6)) OR ((hd_dep_count#100 = 2) AND ..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>, PartitionFilters: [], PushedFilters: [Or(Or(And(EqualTo(hd_dep_count,4),LessThanOrEqual(hd_vehicle_count,6)),And(EqualTo(hd_dep_count,..., ReadSchema: struct<hd_demo_sk:int,hd_dep_count:int,hd_vehicle_count:int>
   :  :  :                 :           +- Sort [t_time_sk#48 ASC NULLS FIRST], false, 0
   :  :  :                 :              +- Exchange hashpartitioning(t_time_sk#48, 100), ENSURE_REQUIREMENTS, [plan_id=62]
   :  :  :                 :                 +- Project [t_time_sk#48]
   :  :  :                 :                    +- Filter ((((isnotnull(t_hour#49) AND isnotnull(t_minute#50)) AND (t_hour#49 = 10)) AND (t_minute#50 >= 30)) AND isnotnull(t_time_sk#48))
   :  :  :                 :                       +- FileScan parquet [t_time_sk#48,t_hour#49,t_minute#50] Batched: true, DataFilters: [isnotnull(t_hour#49), isnotnull(t_minute#50), (t_hour#49 = 10), (t_minute#50 >= 30),..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(t_hour), IsNotNull(t_minute), EqualTo(t_hour,10), GreaterThanOrEqual(t_minute,30), IsN..., ReadSchema: struct<t_time_sk:int,t_hour:int,t_minute:int>
   :  :  :                 +- Sort [s_store_sk#46 ASC NULLS FIRST], false, 0
   :  :  :                    +- Exchange hashpartitioning(s_store_sk#46, 100), ENSURE_REQUIREMENTS, [plan_id=63]
   :  :  :                       +- Project [s_store_sk#46]
   :  :  :                          +- Filter ((isnotnull(s_store_name#102) AND (s_store_name#102 = ese)) AND isnotnull(s_store_sk#46))
   :  :  :                             +- FileScan parquet [s_store_sk#46,s_store_name#102] Batched: true, DataFilters: [isnotnull(s_store_name#102), (s_store_name#102 = ese), isnotnull(s_store_sk#46)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_name), EqualTo(s_store_name,ese), IsNotNull(s_store_sk)], ReadSchema: struct<s_store_sk:int,s_store_name:string>
   :  :  +- HashAggregate(keys=[], functions=[count(1)], output=[h11_to_11_30#52])
   :  :     +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=64]
   :  :        +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#103])
   :  :           +- Project
   :  :              +- SortMergeJoin [ss_store_sk#54], [s_store_sk#55], Inner
   :  :                 :- Sort [ss_store_sk#54 ASC NULLS FIRST], false, 0
   :  :                 :  +- Exchange hashpartitioning(ss_store_sk#54, 100), ENSURE_REQUIREMENTS, [plan_id=65]
   :  :                 :     +- Project [ss_store_sk#54]
   :  :                 :        +- SortMergeJoin [ss_sold_time_sk#56], [t_time_sk#57], Inner
   :  :                 :           :- Sort [ss_sold_time_sk#56 ASC NULLS FIRST], false, 0
   :  :                 :           :  +- Exchange hashpartitioning(ss_sold_time_sk#56, 100), ENSURE_REQUIREMENTS, [plan_id=66]
   :  :                 :           :     +- Project [ss_sold_time_sk#56, ss_store_sk#54]
   :  :                 :           :        +- SortMergeJoin [ss_hdemo_sk#104], [hd_demo_sk#105], Inner
   :  :                 :           :           :- Sort [ss_hdemo_sk#104 ASC NULLS FIRST], false, 0
   :  :                 :           :           :  +- Exchange hashpartitioning(ss_hdemo_sk#104, 100), ENSURE_REQUIREMENTS, [plan_id=67]
   :  :                 :           :           :     +- Filter ((isnotnull(ss_hdemo_sk#104) AND isnotnull(ss_sold_time_sk#56)) AND isnotnull(ss_store_sk#54))
   :  :                 :           :           :        +- FileScan parquet [ss_sold_time_sk#56,ss_hdemo_sk#104,ss_store_sk#54] Batched: true, DataFilters: [isnotnull(ss_hdemo_sk#104), isnotnull(ss_sold_time_sk#56), isnotnull(ss_store_sk#54)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_hdemo_sk), IsNotNull(ss_sold_time_sk), IsNotNull(ss_store_sk)], ReadSchema: struct<ss_sold_time_sk:int,ss_hdemo_sk:int,ss_store_sk:int>
   :  :                 :           :           +- Sort [hd_demo_sk#105 ASC NULLS FIRST], false, 0
   :  :                 :           :              +- Exchange hashpartitioning(hd_demo_sk#105, 100), ENSURE_REQUIREMENTS, [plan_id=68]
   :  :                 :           :                 +- Project [hd_demo_sk#105]
   :  :                 :           :                    +- Filter (((((hd_dep_count#106 = 4) AND (hd_vehicle_count#107 <= 6)) OR ((hd_dep_count#106 = 2) AND (hd_vehicle_count#107 <= 4))) OR ((hd_dep_count#106 = 0) AND (hd_vehicle_count#107 <= 2))) AND isnotnull(hd_demo_sk#105))
   :  :                 :           :                       +- FileScan parquet [hd_demo_sk#105,hd_dep_count#106,hd_vehicle_count#107] Batched: true, DataFilters: [((((hd_dep_count#106 = 4) AND (hd_vehicle_count#107 <= 6)) OR ((hd_dep_count#106 = 2) AND ..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>, PartitionFilters: [], PushedFilters: [Or(Or(And(EqualTo(hd_dep_count,4),LessThanOrEqual(hd_vehicle_count,6)),And(EqualTo(hd_dep_count,..., ReadSchema: struct<hd_demo_sk:int,hd_dep_count:int,hd_vehicle_count:int>
   :  :                 :           +- Sort [t_time_sk#57 ASC NULLS FIRST], false, 0
   :  :                 :              +- Exchange hashpartitioning(t_time_sk#57, 100), ENSURE_REQUIREMENTS, [plan_id=69]
   :  :                 :                 +- Project [t_time_sk#57]
   :  :                 :                    +- Filter ((((isnotnull(t_hour#58) AND isnotnull(t_minute#59)) AND (t_hour#58 = 11)) AND (t_minute#59 < 30)) AND isnotnull(t_time_sk#57))
   :  :                 :                       +- FileScan parquet [t_time_sk#57,t_hour#58,t_minute#59] Batched: true, DataFilters: [isnotnull(t_hour#58), isnotnull(t_minute#59), (t_hour#58 = 11), (t_minute#59 < 30), ..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(t_hour), IsNotNull(t_minute), EqualTo(t_hour,11), LessThan(t_minute,30), IsNotNull(t_t..., ReadSchema: struct<t_time_sk:int,t_hour:int,t_minute:int>
   :  :                 +- Sort [s_store_sk#55 ASC NULLS FIRST], false, 0
   :  :                    +- Exchange hashpartitioning(s_store_sk#55, 100), ENSURE_REQUIREMENTS, [plan_id=70]
   :  :                       +- Project [s_store_sk#55]
   :  :                          +- Filter ((isnotnull(s_store_name#108) AND (s_store_name#108 = ese)) AND isnotnull(s_store_sk#55))
   :  :                             +- FileScan parquet [s_store_sk#55,s_store_name#108] Batched: true, DataFilters: [isnotnull(s_store_name#108), (s_store_name#108 = ese), isnotnull(s_store_sk#55)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_name), EqualTo(s_store_name,ese), IsNotNull(s_store_sk)], ReadSchema: struct<s_store_sk:int,s_store_name:string>
   :  +- HashAggregate(keys=[], functions=[count(1)], output=[h11_30_to_12#61])
   :     +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=71]
   :        +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#109])
   :           +- Project
   :              +- SortMergeJoin [ss_store_sk#63], [s_store_sk#64], Inner
   :                 :- Sort [ss_store_sk#63 ASC NULLS FIRST], false, 0
   :                 :  +- Exchange hashpartitioning(ss_store_sk#63, 100), ENSURE_REQUIREMENTS, [plan_id=72]
   :                 :     +- Project [ss_store_sk#63]
   :                 :        +- SortMergeJoin [ss_sold_time_sk#65], [t_time_sk#66], Inner
   :                 :           :- Sort [ss_sold_time_sk#65 ASC NULLS FIRST], false, 0
   :                 :           :  +- Exchange hashpartitioning(ss_sold_time_sk#65, 100), ENSURE_REQUIREMENTS, [plan_id=73]
   :                 :           :     +- Project [ss_sold_time_sk#65, ss_store_sk#63]
   :                 :           :        +- SortMergeJoin [ss_hdemo_sk#110], [hd_demo_sk#111], Inner
   :                 :           :           :- Sort [ss_hdemo_sk#110 ASC NULLS FIRST], false, 0
   :                 :           :           :  +- Exchange hashpartitioning(ss_hdemo_sk#110, 100), ENSURE_REQUIREMENTS, [plan_id=74]
   :                 :           :           :     +- Filter ((isnotnull(ss_hdemo_sk#110) AND isnotnull(ss_sold_time_sk#65)) AND isnotnull(ss_store_sk#63))
   :                 :           :           :        +- FileScan parquet [ss_sold_time_sk#65,ss_hdemo_sk#110,ss_store_sk#63] Batched: true, DataFilters: [isnotnull(ss_hdemo_sk#110), isnotnull(ss_sold_time_sk#65), isnotnull(ss_store_sk#63)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_hdemo_sk), IsNotNull(ss_sold_time_sk), IsNotNull(ss_store_sk)], ReadSchema: struct<ss_sold_time_sk:int,ss_hdemo_sk:int,ss_store_sk:int>
   :                 :           :           +- Sort [hd_demo_sk#111 ASC NULLS FIRST], false, 0
   :                 :           :              +- Exchange hashpartitioning(hd_demo_sk#111, 100), ENSURE_REQUIREMENTS, [plan_id=75]
   :                 :           :                 +- Project [hd_demo_sk#111]
   :                 :           :                    +- Filter (((((hd_dep_count#112 = 4) AND (hd_vehicle_count#113 <= 6)) OR ((hd_dep_count#112 = 2) AND (hd_vehicle_count#113 <= 4))) OR ((hd_dep_count#112 = 0) AND (hd_vehicle_count#113 <= 2))) AND isnotnull(hd_demo_sk#111))
   :                 :           :                       +- FileScan parquet [hd_demo_sk#111,hd_dep_count#112,hd_vehicle_count#113] Batched: true, DataFilters: [((((hd_dep_count#112 = 4) AND (hd_vehicle_count#113 <= 6)) OR ((hd_dep_count#112 = 2) AND ..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>, PartitionFilters: [], PushedFilters: [Or(Or(And(EqualTo(hd_dep_count,4),LessThanOrEqual(hd_vehicle_count,6)),And(EqualTo(hd_dep_count,..., ReadSchema: struct<hd_demo_sk:int,hd_dep_count:int,hd_vehicle_count:int>
   :                 :           +- Sort [t_time_sk#66 ASC NULLS FIRST], false, 0
   :                 :              +- Exchange hashpartitioning(t_time_sk#66, 100), ENSURE_REQUIREMENTS, [plan_id=76]
   :                 :                 +- Project [t_time_sk#66]
   :                 :                    +- Filter ((((isnotnull(t_hour#67) AND isnotnull(t_minute#68)) AND (t_hour#67 = 11)) AND (t_minute#68 >= 30)) AND isnotnull(t_time_sk#66))
   :                 :                       +- FileScan parquet [t_time_sk#66,t_hour#67,t_minute#68] Batched: true, DataFilters: [isnotnull(t_hour#67), isnotnull(t_minute#68), (t_hour#67 = 11), (t_minute#68 >= 30),..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(t_hour), IsNotNull(t_minute), EqualTo(t_hour,11), GreaterThanOrEqual(t_minute,30), IsN..., ReadSchema: struct<t_time_sk:int,t_hour:int,t_minute:int>
   :                 +- Sort [s_store_sk#64 ASC NULLS FIRST], false, 0
   :                    +- Exchange hashpartitioning(s_store_sk#64, 100), ENSURE_REQUIREMENTS, [plan_id=77]
   :                       +- Project [s_store_sk#64]
   :                          +- Filter ((isnotnull(s_store_name#114) AND (s_store_name#114 = ese)) AND isnotnull(s_store_sk#64))
   :                             +- FileScan parquet [s_store_sk#64,s_store_name#114] Batched: true, DataFilters: [isnotnull(s_store_name#114), (s_store_name#114 = ese), isnotnull(s_store_sk#64)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_name), EqualTo(s_store_name,ese), IsNotNull(s_store_sk)], ReadSchema: struct<s_store_sk:int,s_store_name:string>
   +- HashAggregate(keys=[], functions=[count(1)], output=[h12_to_12_30#70])
      +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=78]
         +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#115])
            +- Project
               +- SortMergeJoin [ss_store_sk#72], [s_store_sk#73], Inner
                  :- Sort [ss_store_sk#72 ASC NULLS FIRST], false, 0
                  :  +- Exchange hashpartitioning(ss_store_sk#72, 100), ENSURE_REQUIREMENTS, [plan_id=79]
                  :     +- Project [ss_store_sk#72]
                  :        +- SortMergeJoin [ss_sold_time_sk#74], [t_time_sk#75], Inner
                  :           :- Sort [ss_sold_time_sk#74 ASC NULLS FIRST], false, 0
                  :           :  +- Exchange hashpartitioning(ss_sold_time_sk#74, 100), ENSURE_REQUIREMENTS, [plan_id=80]
                  :           :     +- Project [ss_sold_time_sk#74, ss_store_sk#72]
                  :           :        +- SortMergeJoin [ss_hdemo_sk#116], [hd_demo_sk#117], Inner
                  :           :           :- Sort [ss_hdemo_sk#116 ASC NULLS FIRST], false, 0
                  :           :           :  +- Exchange hashpartitioning(ss_hdemo_sk#116, 100), ENSURE_REQUIREMENTS, [plan_id=81]
                  :           :           :     +- Filter ((isnotnull(ss_hdemo_sk#116) AND isnotnull(ss_sold_time_sk#74)) AND isnotnull(ss_store_sk#72))
                  :           :           :        +- FileScan parquet [ss_sold_time_sk#74,ss_hdemo_sk#116,ss_store_sk#72] Batched: true, DataFilters: [isnotnull(ss_hdemo_sk#116), isnotnull(ss_sold_time_sk#74), isnotnull(ss_store_sk#72)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_hdemo_sk), IsNotNull(ss_sold_time_sk), IsNotNull(ss_store_sk)], ReadSchema: struct<ss_sold_time_sk:int,ss_hdemo_sk:int,ss_store_sk:int>
                  :           :           +- Sort [hd_demo_sk#117 ASC NULLS FIRST], false, 0
                  :           :              +- Exchange hashpartitioning(hd_demo_sk#117, 100), ENSURE_REQUIREMENTS, [plan_id=82]
                  :           :                 +- Project [hd_demo_sk#117]
                  :           :                    +- Filter (((((hd_dep_count#118 = 4) AND (hd_vehicle_count#119 <= 6)) OR ((hd_dep_count#118 = 2) AND (hd_vehicle_count#119 <= 4))) OR ((hd_dep_count#118 = 0) AND (hd_vehicle_count#119 <= 2))) AND isnotnull(hd_demo_sk#117))
                  :           :                       +- FileScan parquet [hd_demo_sk#117,hd_dep_count#118,hd_vehicle_count#119] Batched: true, DataFilters: [((((hd_dep_count#118 = 4) AND (hd_vehicle_count#119 <= 6)) OR ((hd_dep_count#118 = 2) AND ..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>, PartitionFilters: [], PushedFilters: [Or(Or(And(EqualTo(hd_dep_count,4),LessThanOrEqual(hd_vehicle_count,6)),And(EqualTo(hd_dep_count,..., ReadSchema: struct<hd_demo_sk:int,hd_dep_count:int,hd_vehicle_count:int>
                  :           +- Sort [t_time_sk#75 ASC NULLS FIRST], false, 0
                  :              +- Exchange hashpartitioning(t_time_sk#75, 100), ENSURE_REQUIREMENTS, [plan_id=83]
                  :                 +- Project [t_time_sk#75]
                  :                    +- Filter ((((isnotnull(t_hour#76) AND isnotnull(t_minute#77)) AND (t_hour#76 = 12)) AND (t_minute#77 < 30)) AND isnotnull(t_time_sk#75))
                  :                       +- FileScan parquet [t_time_sk#75,t_hour#76,t_minute#77] Batched: true, DataFilters: [isnotnull(t_hour#76), isnotnull(t_minute#77), (t_hour#76 = 12), (t_minute#77 < 30), ..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(t_hour), IsNotNull(t_minute), EqualTo(t_hour,12), LessThan(t_minute,30), IsNotNull(t_t..., ReadSchema: struct<t_time_sk:int,t_hour:int,t_minute:int>
                  +- Sort [s_store_sk#73 ASC NULLS FIRST], false, 0
                     +- Exchange hashpartitioning(s_store_sk#73, 100), ENSURE_REQUIREMENTS, [plan_id=84]
                        +- Project [s_store_sk#73]
                           +- Filter ((isnotnull(s_store_name#120) AND (s_store_name#120 = ese)) AND isnotnull(s_store_sk#73))
                              +- FileScan parquet [s_store_sk#73,s_store_name#120] Batched: true, DataFilters: [isnotnull(s_store_name#120), (s_store_name#120 = ese), isnotnull(s_store_sk#73)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_name), EqualTo(s_store_name,ese), IsNotNull(s_store_sk)], ReadSchema: struct<s_store_sk:int,s_store_name:string>
