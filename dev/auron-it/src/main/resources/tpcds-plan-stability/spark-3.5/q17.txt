AdaptiveSparkPlan isFinalPlan=true
+- == Final Plan ==
   NativeProject [i_item_id#1, i_item_desc#2, s_state#3, count(ss_quantity#4)#5 AS store_sales_quantitycount#6, avg(ss_quantity#4)#7 AS store_sales_quantityave#8, stddev_samp(cast(ss_quantity#4 as double))#9 AS store_sales_quantitystdev#10, (stddev_samp(cast(ss_quantity#4 as double))#9 / avg(ss_quantity#4)#7) AS store_sales_quantitycov#11, count(sr_return_quantity#12)#13 AS as_store_returns_quantitycount#14, avg(sr_return_quantity#12)#15 AS as_store_returns_quantityave#16, stddev_samp(cast(sr_return_quantity#12 as double))#17 AS as_store_returns_quantitystdev#18, (stddev_samp(cast(sr_return_quantity#12 as double))#17 / avg(sr_return_quantity#12)#15) AS store_returns_quantitycov#19, count(cs_quantity#20)#21 AS catalog_sales_quantitycount#22, avg(cs_quantity#20)#23 AS catalog_sales_quantityave#24, (stddev_samp(cast(cs_quantity#20 as double))#25 / avg(cs_quantity#20)#23) AS catalog_sales_quantitystdev#26, (stddev_samp(cast(cs_quantity#20 as double))#25 / avg(cs_quantity#20)#23) AS catalog_sales_quantitycov#27]
   +- NativeHashAggregate HashAgg, ArrayBuffer(i_item_id#1, i_item_desc#2, s_state#3), [i_item_id#1, i_item_desc#2, s_state#3], [count(ss_quantity#4), avg(ss_quantity#4), stddev_samp(cast(ss_quantity#4 as double)), count(sr_return_quantity#12), avg(sr_return_quantity#12), stddev_samp(cast(sr_return_quantity#12 as double)), count(cs_quantity#20), avg(cs_quantity#20), stddev_samp(cast(cs_quantity#20 as double))], [count(ss_quantity#4)#5, avg(ss_quantity#4)#7, stddev_samp(cast(ss_quantity#4 as double))#9, count(sr_return_quantity#12)#13, avg(sr_return_quantity#12)#15, stddev_samp(cast(sr_return_quantity#12 as double))#17, count(cs_quantity#20)#21, avg(cs_quantity#20)#23, stddev_samp(cast(cs_quantity#20 as double))#25], 3
      +- InputAdapter
         +- AQEShuffleRead coalesced
            +- ShuffleQueryStage 15
               +- NativeShuffleExchange hashpartitioning(i_item_id#1, i_item_desc#2, s_state#3, 100), ENSURE_REQUIREMENTS, [plan_id=1]
                  +- NativeHashAggregate HashAgg, [i_item_id#1, i_item_desc#2, s_state#3], [partial_count(_c3#28), partial_avg(_c3#28), partial_stddev_samp(_c4#29), partial_count(_c5#30), partial_avg(_c5#30), partial_stddev_samp(_c6#31), partial_count(_c7#32), partial_avg(_c7#32), partial_stddev_samp(_c8#33)], [count#34, sum#35, count#36, n#37, avg#38, m2#39, count#40, sum#41, count#42, n#43, avg#44, m2#45, count#46, sum#47, count#48, n#49, avg#50, m2#51], 0
                     +- NativeProject [i_item_id#1 AS i_item_id#1, i_item_desc#2 AS i_item_desc#2, s_state#3 AS s_state#3, ss_quantity#4 AS _c3#28, cast(ss_quantity#4 as double) AS _c4#29, sr_return_quantity#12 AS _c5#30, cast(sr_return_quantity#12 as double) AS _c6#31, cs_quantity#20 AS _c7#32, cast(cs_quantity#20 as double) AS _c8#33]
                        +- NativeProject [ss_quantity#4, sr_return_quantity#12, cs_quantity#20, s_state#3, i_item_id#1, i_item_desc#2]
                           +- NativeSortMergeJoin [ss_item_sk#52], [i_item_sk#53], Inner
                              :- NativeSort [ss_item_sk#52 ASC NULLS FIRST], false
                              :  +- InputAdapter
                              :     +- AQEShuffleRead coalesced
                              :        +- ShuffleQueryStage 14
                              :           +- NativeShuffleExchange hashpartitioning(ss_item_sk#52, 100), ENSURE_REQUIREMENTS, [plan_id=2]
                              :              +- NativeProject [ss_item_sk#52, ss_quantity#4, sr_return_quantity#12, cs_quantity#20, s_state#3]
                              :                 +- NativeSortMergeJoin [ss_store_sk#54], [s_store_sk#55], Inner
                              :                    :- NativeSort [ss_store_sk#54 ASC NULLS FIRST], false
                              :                    :  +- InputAdapter
                              :                    :     +- AQEShuffleRead coalesced
                              :                    :        +- ShuffleQueryStage 13
                              :                    :           +- NativeShuffleExchange hashpartitioning(ss_store_sk#54, 100), ENSURE_REQUIREMENTS, [plan_id=3]
                              :                    :              +- NativeProject [ss_item_sk#52, ss_store_sk#54, ss_quantity#4, sr_return_quantity#12, cs_quantity#20]
                              :                    :                 +- NativeSortMergeJoin [cs_sold_date_sk#56], [d_date_sk#57], Inner
                              :                    :                    :- NativeSort [cs_sold_date_sk#56 ASC NULLS FIRST], false
                              :                    :                    :  +- InputAdapter
                              :                    :                    :     +- AQEShuffleRead coalesced
                              :                    :                    :        +- ShuffleQueryStage 12
                              :                    :                    :           +- NativeShuffleExchange hashpartitioning(cs_sold_date_sk#56, 100), ENSURE_REQUIREMENTS, [plan_id=4]
                              :                    :                    :              +- NativeProject [ss_item_sk#52, ss_store_sk#54, ss_quantity#4, sr_return_quantity#12, cs_sold_date_sk#56, cs_quantity#20]
                              :                    :                    :                 +- NativeSortMergeJoin [sr_returned_date_sk#58], [d_date_sk#59], Inner
                              :                    :                    :                    :- NativeSort [sr_returned_date_sk#58 ASC NULLS FIRST], false
                              :                    :                    :                    :  +- InputAdapter
                              :                    :                    :                    :     +- AQEShuffleRead coalesced
                              :                    :                    :                    :        +- ShuffleQueryStage 11
                              :                    :                    :                    :           +- NativeShuffleExchange hashpartitioning(sr_returned_date_sk#58, 100), ENSURE_REQUIREMENTS, [plan_id=5]
                              :                    :                    :                    :              +- NativeProject [ss_item_sk#52, ss_store_sk#54, ss_quantity#4, sr_returned_date_sk#58, sr_return_quantity#12, cs_sold_date_sk#56, cs_quantity#20]
                              :                    :                    :                    :                 +- NativeSortMergeJoin [ss_sold_date_sk#60], [d_date_sk#61], Inner
                              :                    :                    :                    :                    :- NativeSort [ss_sold_date_sk#60 ASC NULLS FIRST], false
                              :                    :                    :                    :                    :  +- InputAdapter
                              :                    :                    :                    :                    :     +- AQEShuffleRead coalesced
                              :                    :                    :                    :                    :        +- ShuffleQueryStage 10
                              :                    :                    :                    :                    :           +- NativeShuffleExchange hashpartitioning(ss_sold_date_sk#60, 100), ENSURE_REQUIREMENTS, [plan_id=6]
                              :                    :                    :                    :                    :              +- NativeProject [ss_sold_date_sk#60, ss_item_sk#52, ss_store_sk#54, ss_quantity#4, sr_returned_date_sk#58, sr_return_quantity#12, cs_sold_date_sk#56, cs_quantity#20]
                              :                    :                    :                    :                    :                 +- NativeSortMergeJoin [sr_customer_sk#62, sr_item_sk#63], [cs_bill_customer_sk#64, cs_item_sk#65], Inner
                              :                    :                    :                    :                    :                    :- NativeSort [sr_customer_sk#62 ASC NULLS FIRST, sr_item_sk#63 ASC NULLS FIRST], false
                              :                    :                    :                    :                    :                    :  +- InputAdapter
                              :                    :                    :                    :                    :                    :     +- AQEShuffleRead coalesced
                              :                    :                    :                    :                    :                    :        +- ShuffleQueryStage 9
                              :                    :                    :                    :                    :                    :           +- NativeShuffleExchange hashpartitioning(sr_customer_sk#62, sr_item_sk#63, 100), ENSURE_REQUIREMENTS, [plan_id=7]
                              :                    :                    :                    :                    :                    :              +- NativeProject [ss_sold_date_sk#60, ss_item_sk#52, ss_store_sk#54, ss_quantity#4, sr_returned_date_sk#58, sr_item_sk#63, sr_customer_sk#62, sr_return_quantity#12]
                              :                    :                    :                    :                    :                    :                 +- NativeSortMergeJoin [ss_customer_sk#66, ss_item_sk#52, ss_ticket_number#67], [sr_customer_sk#62, sr_item_sk#63, sr_ticket_number#68], Inner
                              :                    :                    :                    :                    :                    :                    :- NativeSort [ss_customer_sk#66 ASC NULLS FIRST, ss_item_sk#52 ASC NULLS FIRST, ss_ticket_number#67 ASC NULLS FIRST], false
                              :                    :                    :                    :                    :                    :                    :  +- InputAdapter
                              :                    :                    :                    :                    :                    :                    :     +- AQEShuffleRead coalesced
                              :                    :                    :                    :                    :                    :                    :        +- ShuffleQueryStage 0
                              :                    :                    :                    :                    :                    :                    :           +- NativeShuffleExchange hashpartitioning(ss_customer_sk#66, ss_item_sk#52, ss_ticket_number#67, 100), ENSURE_REQUIREMENTS, [plan_id=8]
                              :                    :                    :                    :                    :                    :                    :              +- NativeFilter ((((isnotnull(ss_customer_sk#66) AND isnotnull(ss_item_sk#52)) AND isnotnull(ss_ticket_number#67)) AND isnotnull(ss_sold_date_sk#60)) AND isnotnull(ss_store_sk#54))
                              :                    :                    :                    :                    :                    :                    :                 +- InputAdapter [#60, #52, #66, #54, #67, #4]
                              :                    :                    :                    :                    :                    :                    :                    +- NativeParquetScan  (FileScan parquet [ss_sold_date_sk#60,ss_item_sk#52,ss_customer_sk#66,ss_store_sk#54,ss_ticket_number#67,ss_quantity#4] Batched: true, DataFilters: [isnotnull(ss_customer_sk#66), isnotnull(ss_item_sk#52), isnotnull(ss_ticket_number#67),..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_customer_sk), IsNotNull(ss_item_sk), IsNotNull(ss_ticket_number), IsNotNull(ss_sold..., ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_customer_sk:int,ss_store_sk:int,ss_ticket_number:int...)
                              :                    :                    :                    :                    :                    :                    +- NativeSort [sr_customer_sk#62 ASC NULLS FIRST, sr_item_sk#63 ASC NULLS FIRST, sr_ticket_number#68 ASC NULLS FIRST], false
                              :                    :                    :                    :                    :                    :                       +- InputAdapter
                              :                    :                    :                    :                    :                    :                          +- AQEShuffleRead coalesced
                              :                    :                    :                    :                    :                    :                             +- ShuffleQueryStage 1
                              :                    :                    :                    :                    :                    :                                +- NativeShuffleExchange hashpartitioning(sr_customer_sk#62, sr_item_sk#63, sr_ticket_number#68, 100), ENSURE_REQUIREMENTS, [plan_id=9]
                              :                    :                    :                    :                    :                    :                                   +- NativeFilter (((isnotnull(sr_customer_sk#62) AND isnotnull(sr_item_sk#63)) AND isnotnull(sr_ticket_number#68)) AND isnotnull(sr_returned_date_sk#58))
                              :                    :                    :                    :                    :                    :                                      +- InputAdapter [#58, #63, #62, #68, #12]
                              :                    :                    :                    :                    :                    :                                         +- NativeParquetScan  (FileScan parquet [sr_returned_date_sk#58,sr_item_sk#63,sr_customer_sk#62,sr_ticket_number#68,sr_return_quantity#12] Batched: true, DataFilters: [isnotnull(sr_customer_sk#62), isnotnull(sr_item_sk#63), isnotnull(sr_ticket_number#68),..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(sr_customer_sk), IsNotNull(sr_item_sk), IsNotNull(sr_ticket_number), IsNotNull(sr_retu..., ReadSchema: struct<sr_returned_date_sk:int,sr_item_sk:int,sr_customer_sk:int,sr_ticket_number:int,sr_return_q...)
                              :                    :                    :                    :                    :                    +- NativeSort [cs_bill_customer_sk#64 ASC NULLS FIRST, cs_item_sk#65 ASC NULLS FIRST], false
                              :                    :                    :                    :                    :                       +- InputAdapter
                              :                    :                    :                    :                    :                          +- AQEShuffleRead coalesced
                              :                    :                    :                    :                    :                             +- ShuffleQueryStage 2
                              :                    :                    :                    :                    :                                +- NativeShuffleExchange hashpartitioning(cs_bill_customer_sk#64, cs_item_sk#65, 100), ENSURE_REQUIREMENTS, [plan_id=10]
                              :                    :                    :                    :                    :                                   +- NativeFilter ((isnotnull(cs_bill_customer_sk#64) AND isnotnull(cs_item_sk#65)) AND isnotnull(cs_sold_date_sk#56))
                              :                    :                    :                    :                    :                                      +- InputAdapter [#56, #64, #65, #20]
                              :                    :                    :                    :                    :                                         +- NativeParquetScan  (FileScan parquet [cs_sold_date_sk#56,cs_bill_customer_sk#64,cs_item_sk#65,cs_quantity#20] Batched: true, DataFilters: [isnotnull(cs_bill_customer_sk#64), isnotnull(cs_item_sk#65), isnotnull(cs_sold_date_sk#69..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cs_bill_customer_sk), IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_bill_customer_sk:int,cs_item_sk:int,cs_quantity:int>)
                              :                    :                    :                    :                    +- NativeSort [d_date_sk#61 ASC NULLS FIRST], false
                              :                    :                    :                    :                       +- InputAdapter
                              :                    :                    :                    :                          +- AQEShuffleRead coalesced
                              :                    :                    :                    :                             +- ShuffleQueryStage 3
                              :                    :                    :                    :                                +- NativeShuffleExchange hashpartitioning(d_date_sk#61, 100), ENSURE_REQUIREMENTS, [plan_id=11]
                              :                    :                    :                    :                                   +- NativeProject [d_date_sk#61]
                              :                    :                    :                    :                                      +- NativeFilter ((isnotnull(d_quarter_name#70) AND (d_quarter_name#70 = 2001Q1)) AND isnotnull(d_date_sk#61))
                              :                    :                    :                    :                                         +- InputAdapter [#61, #70]
                              :                    :                    :                    :                                            +- NativeParquetScan  (FileScan parquet [d_date_sk#61,d_quarter_name#70] Batched: true, DataFilters: [isnotnull(d_quarter_name#70), (d_quarter_name#70 = 2001Q1), isnotnull(d_date_sk#61)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_quarter_name), EqualTo(d_quarter_name,2001Q1), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_quarter_name:string>)
                              :                    :                    :                    +- NativeSort [d_date_sk#59 ASC NULLS FIRST], false
                              :                    :                    :                       +- InputAdapter
                              :                    :                    :                          +- AQEShuffleRead coalesced
                              :                    :                    :                             +- ShuffleQueryStage 4
                              :                    :                    :                                +- NativeShuffleExchange hashpartitioning(d_date_sk#59, 100), ENSURE_REQUIREMENTS, [plan_id=12]
                              :                    :                    :                                   +- NativeProject [d_date_sk#59]
                              :                    :                    :                                      +- NativeFilter (d_quarter_name#71 IN (2001Q1,2001Q2,2001Q3) AND isnotnull(d_date_sk#59))
                              :                    :                    :                                         +- InputAdapter [#59, #71]
                              :                    :                    :                                            +- NativeParquetScan  (FileScan parquet [d_date_sk#59,d_quarter_name#71] Batched: true, DataFilters: [d_quarter_name#71 IN (2001Q1,2001Q2,2001Q3), isnotnull(d_date_sk#59)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [In(d_quarter_name, [2001Q1,2001Q2,2001Q3]), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_quarter_name:string>)
                              :                    :                    +- NativeSort [d_date_sk#57 ASC NULLS FIRST], false
                              :                    :                       +- InputAdapter
                              :                    :                          +- InputAdapter [#57]
                              :                    :                             +- AQEShuffleRead coalesced
                              :                    :                                +- ShuffleQueryStage 6
                              :                    :                                   +- ReusedExchange [d_date_sk#57], NativeShuffleExchange hashpartitioning(d_date_sk#59, 100), ENSURE_REQUIREMENTS, [plan_id=12]
                              :                    +- NativeSort [s_store_sk#55 ASC NULLS FIRST], false
                              :                       +- InputAdapter
                              :                          +- AQEShuffleRead coalesced
                              :                             +- ShuffleQueryStage 7
                              :                                +- NativeShuffleExchange hashpartitioning(s_store_sk#55, 100), ENSURE_REQUIREMENTS, [plan_id=13]
                              :                                   +- NativeFilter isnotnull(s_store_sk#55)
                              :                                      +- InputAdapter [#55, #3]
                              :                                         +- NativeParquetScan  (FileScan parquet [s_store_sk#55,s_state#3] Batched: true, DataFilters: [isnotnull(s_store_sk#55)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk)], ReadSchema: struct<s_store_sk:int,s_state:string>)
                              +- NativeSort [i_item_sk#53 ASC NULLS FIRST], false
                                 +- InputAdapter
                                    +- AQEShuffleRead coalesced
                                       +- ShuffleQueryStage 8
                                          +- NativeShuffleExchange hashpartitioning(i_item_sk#53, 100), ENSURE_REQUIREMENTS, [plan_id=14]
                                             +- NativeFilter isnotnull(i_item_sk#53)
                                                +- InputAdapter [#53, #1, #2]
                                                   +- NativeParquetScan  (FileScan parquet [i_item_sk#53,i_item_id#1,i_item_desc#2] Batched: true, DataFilters: [isnotnull(i_item_sk#53)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_item_id:string,i_item_desc:string>)
+- == Initial Plan ==
   TakeOrderedAndProject(limit=100, orderBy=[i_item_id#1 ASC NULLS FIRST,i_item_desc#2 ASC NULLS FIRST,s_state#3 ASC NULLS FIRST], output=[i_item_id#1,i_item_desc#2,s_state#3,store_sales_quantitycount#6,store_sales_quantityave#8,store_sales_quantitystdev#10,store_sales_quantitycov#11,as_store_returns_quantitycount#14,as_store_returns_quantityave#16,as_store_returns_quantitystdev#18,store_returns_quantitycov#19,catalog_sales_quantitycount#22,catalog_sales_quantityave#24,catalog_sales_quantitystdev#26,catalog_sales_quantitycov#27])
   +- HashAggregate(keys=[i_item_id#1, i_item_desc#2, s_state#3], functions=[count(ss_quantity#4), avg(ss_quantity#4), stddev_samp(cast(ss_quantity#4 as double)), count(sr_return_quantity#12), avg(sr_return_quantity#12), stddev_samp(cast(sr_return_quantity#12 as double)), count(cs_quantity#20), avg(cs_quantity#20), stddev_samp(cast(cs_quantity#20 as double))], output=[i_item_id#1, i_item_desc#2, s_state#3, store_sales_quantitycount#6, store_sales_quantityave#8, store_sales_quantitystdev#10, store_sales_quantitycov#11, as_store_returns_quantitycount#14, as_store_returns_quantityave#16, as_store_returns_quantitystdev#18, store_returns_quantitycov#19, catalog_sales_quantitycount#22, catalog_sales_quantityave#24, catalog_sales_quantitystdev#26, catalog_sales_quantitycov#27])
      +- Exchange hashpartitioning(i_item_id#1, i_item_desc#2, s_state#3, 100), ENSURE_REQUIREMENTS, [plan_id=15]
         +- HashAggregate(keys=[i_item_id#1, i_item_desc#2, s_state#3], functions=[partial_count(ss_quantity#4), partial_avg(ss_quantity#4), partial_stddev_samp(cast(ss_quantity#4 as double)), partial_count(sr_return_quantity#12), partial_avg(sr_return_quantity#12), partial_stddev_samp(cast(sr_return_quantity#12 as double)), partial_count(cs_quantity#20), partial_avg(cs_quantity#20), partial_stddev_samp(cast(cs_quantity#20 as double))], output=[i_item_id#1, i_item_desc#2, s_state#3, count#72, sum#73, count#74, n#75, avg#76, m2#77, count#78, sum#79, count#80, n#81, avg#82, m2#83, count#84, sum#85, count#86, n#87, avg#88, m2#89])
            +- Project [ss_quantity#4, sr_return_quantity#12, cs_quantity#20, s_state#3, i_item_id#1, i_item_desc#2]
               +- SortMergeJoin [ss_item_sk#52], [i_item_sk#53], Inner
                  :- Sort [ss_item_sk#52 ASC NULLS FIRST], false, 0
                  :  +- Exchange hashpartitioning(ss_item_sk#52, 100), ENSURE_REQUIREMENTS, [plan_id=16]
                  :     +- Project [ss_item_sk#52, ss_quantity#4, sr_return_quantity#12, cs_quantity#20, s_state#3]
                  :        +- SortMergeJoin [ss_store_sk#54], [s_store_sk#55], Inner
                  :           :- Sort [ss_store_sk#54 ASC NULLS FIRST], false, 0
                  :           :  +- Exchange hashpartitioning(ss_store_sk#54, 100), ENSURE_REQUIREMENTS, [plan_id=17]
                  :           :     +- Project [ss_item_sk#52, ss_store_sk#54, ss_quantity#4, sr_return_quantity#12, cs_quantity#20]
                  :           :        +- SortMergeJoin [cs_sold_date_sk#56], [d_date_sk#57], Inner
                  :           :           :- Sort [cs_sold_date_sk#56 ASC NULLS FIRST], false, 0
                  :           :           :  +- Exchange hashpartitioning(cs_sold_date_sk#56, 100), ENSURE_REQUIREMENTS, [plan_id=18]
                  :           :           :     +- Project [ss_item_sk#52, ss_store_sk#54, ss_quantity#4, sr_return_quantity#12, cs_sold_date_sk#56, cs_quantity#20]
                  :           :           :        +- SortMergeJoin [sr_returned_date_sk#58], [d_date_sk#59], Inner
                  :           :           :           :- Sort [sr_returned_date_sk#58 ASC NULLS FIRST], false, 0
                  :           :           :           :  +- Exchange hashpartitioning(sr_returned_date_sk#58, 100), ENSURE_REQUIREMENTS, [plan_id=19]
                  :           :           :           :     +- Project [ss_item_sk#52, ss_store_sk#54, ss_quantity#4, sr_returned_date_sk#58, sr_return_quantity#12, cs_sold_date_sk#56, cs_quantity#20]
                  :           :           :           :        +- SortMergeJoin [ss_sold_date_sk#60], [d_date_sk#61], Inner
                  :           :           :           :           :- Sort [ss_sold_date_sk#60 ASC NULLS FIRST], false, 0
                  :           :           :           :           :  +- Exchange hashpartitioning(ss_sold_date_sk#60, 100), ENSURE_REQUIREMENTS, [plan_id=20]
                  :           :           :           :           :     +- Project [ss_sold_date_sk#60, ss_item_sk#52, ss_store_sk#54, ss_quantity#4, sr_returned_date_sk#58, sr_return_quantity#12, cs_sold_date_sk#56, cs_quantity#20]
                  :           :           :           :           :        +- SortMergeJoin [sr_customer_sk#62, sr_item_sk#63], [cs_bill_customer_sk#64, cs_item_sk#65], Inner
                  :           :           :           :           :           :- Sort [sr_customer_sk#62 ASC NULLS FIRST, sr_item_sk#63 ASC NULLS FIRST], false, 0
                  :           :           :           :           :           :  +- Exchange hashpartitioning(sr_customer_sk#62, sr_item_sk#63, 100), ENSURE_REQUIREMENTS, [plan_id=21]
                  :           :           :           :           :           :     +- Project [ss_sold_date_sk#60, ss_item_sk#52, ss_store_sk#54, ss_quantity#4, sr_returned_date_sk#58, sr_item_sk#63, sr_customer_sk#62, sr_return_quantity#12]
                  :           :           :           :           :           :        +- SortMergeJoin [ss_customer_sk#66, ss_item_sk#52, ss_ticket_number#67], [sr_customer_sk#62, sr_item_sk#63, sr_ticket_number#68], Inner
                  :           :           :           :           :           :           :- Sort [ss_customer_sk#66 ASC NULLS FIRST, ss_item_sk#52 ASC NULLS FIRST, ss_ticket_number#67 ASC NULLS FIRST], false, 0
                  :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_customer_sk#66, ss_item_sk#52, ss_ticket_number#67, 100), ENSURE_REQUIREMENTS, [plan_id=22]
                  :           :           :           :           :           :           :     +- Filter ((((isnotnull(ss_customer_sk#66) AND isnotnull(ss_item_sk#52)) AND isnotnull(ss_ticket_number#67)) AND isnotnull(ss_sold_date_sk#60)) AND isnotnull(ss_store_sk#54))
                  :           :           :           :           :           :           :        +- FileScan parquet [ss_sold_date_sk#60,ss_item_sk#52,ss_customer_sk#66,ss_store_sk#54,ss_ticket_number#67,ss_quantity#4] Batched: true, DataFilters: [isnotnull(ss_customer_sk#66), isnotnull(ss_item_sk#52), isnotnull(ss_ticket_number#67),..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_customer_sk), IsNotNull(ss_item_sk), IsNotNull(ss_ticket_number), IsNotNull(ss_sold..., ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_customer_sk:int,ss_store_sk:int,ss_ticket_number:int...
                  :           :           :           :           :           :           +- Sort [sr_customer_sk#62 ASC NULLS FIRST, sr_item_sk#63 ASC NULLS FIRST, sr_ticket_number#68 ASC NULLS FIRST], false, 0
                  :           :           :           :           :           :              +- Exchange hashpartitioning(sr_customer_sk#62, sr_item_sk#63, sr_ticket_number#68, 100), ENSURE_REQUIREMENTS, [plan_id=23]
                  :           :           :           :           :           :                 +- Filter (((isnotnull(sr_customer_sk#62) AND isnotnull(sr_item_sk#63)) AND isnotnull(sr_ticket_number#68)) AND isnotnull(sr_returned_date_sk#58))
                  :           :           :           :           :           :                    +- FileScan parquet [sr_returned_date_sk#58,sr_item_sk#63,sr_customer_sk#62,sr_ticket_number#68,sr_return_quantity#12] Batched: true, DataFilters: [isnotnull(sr_customer_sk#62), isnotnull(sr_item_sk#63), isnotnull(sr_ticket_number#68),..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(sr_customer_sk), IsNotNull(sr_item_sk), IsNotNull(sr_ticket_number), IsNotNull(sr_retu..., ReadSchema: struct<sr_returned_date_sk:int,sr_item_sk:int,sr_customer_sk:int,sr_ticket_number:int,sr_return_q...
                  :           :           :           :           :           +- Sort [cs_bill_customer_sk#64 ASC NULLS FIRST, cs_item_sk#65 ASC NULLS FIRST], false, 0
                  :           :           :           :           :              +- Exchange hashpartitioning(cs_bill_customer_sk#64, cs_item_sk#65, 100), ENSURE_REQUIREMENTS, [plan_id=24]
                  :           :           :           :           :                 +- Filter ((isnotnull(cs_bill_customer_sk#64) AND isnotnull(cs_item_sk#65)) AND isnotnull(cs_sold_date_sk#56))
                  :           :           :           :           :                    +- FileScan parquet [cs_sold_date_sk#56,cs_bill_customer_sk#64,cs_item_sk#65,cs_quantity#20] Batched: true, DataFilters: [isnotnull(cs_bill_customer_sk#64), isnotnull(cs_item_sk#65), isnotnull(cs_sold_date_sk#69..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cs_bill_customer_sk), IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_bill_customer_sk:int,cs_item_sk:int,cs_quantity:int>
                  :           :           :           :           +- Sort [d_date_sk#61 ASC NULLS FIRST], false, 0
                  :           :           :           :              +- Exchange hashpartitioning(d_date_sk#61, 100), ENSURE_REQUIREMENTS, [plan_id=25]
                  :           :           :           :                 +- Project [d_date_sk#61]
                  :           :           :           :                    +- Filter ((isnotnull(d_quarter_name#70) AND (d_quarter_name#70 = 2001Q1)) AND isnotnull(d_date_sk#61))
                  :           :           :           :                       +- FileScan parquet [d_date_sk#61,d_quarter_name#70] Batched: true, DataFilters: [isnotnull(d_quarter_name#70), (d_quarter_name#70 = 2001Q1), isnotnull(d_date_sk#61)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_quarter_name), EqualTo(d_quarter_name,2001Q1), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_quarter_name:string>
                  :           :           :           +- Sort [d_date_sk#59 ASC NULLS FIRST], false, 0
                  :           :           :              +- Exchange hashpartitioning(d_date_sk#59, 100), ENSURE_REQUIREMENTS, [plan_id=26]
                  :           :           :                 +- Project [d_date_sk#59]
                  :           :           :                    +- Filter (d_quarter_name#71 IN (2001Q1,2001Q2,2001Q3) AND isnotnull(d_date_sk#59))
                  :           :           :                       +- FileScan parquet [d_date_sk#59,d_quarter_name#71] Batched: true, DataFilters: [d_quarter_name#71 IN (2001Q1,2001Q2,2001Q3), isnotnull(d_date_sk#59)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [In(d_quarter_name, [2001Q1,2001Q2,2001Q3]), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_quarter_name:string>
                  :           :           +- Sort [d_date_sk#57 ASC NULLS FIRST], false, 0
                  :           :              +- Exchange hashpartitioning(d_date_sk#57, 100), ENSURE_REQUIREMENTS, [plan_id=27]
                  :           :                 +- Project [d_date_sk#57]
                  :           :                    +- Filter (d_quarter_name#90 IN (2001Q1,2001Q2,2001Q3) AND isnotnull(d_date_sk#57))
                  :           :                       +- FileScan parquet [d_date_sk#57,d_quarter_name#90] Batched: true, DataFilters: [d_quarter_name#90 IN (2001Q1,2001Q2,2001Q3), isnotnull(d_date_sk#57)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [In(d_quarter_name, [2001Q1,2001Q2,2001Q3]), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_quarter_name:string>
                  :           +- Sort [s_store_sk#55 ASC NULLS FIRST], false, 0
                  :              +- Exchange hashpartitioning(s_store_sk#55, 100), ENSURE_REQUIREMENTS, [plan_id=28]
                  :                 +- Filter isnotnull(s_store_sk#55)
                  :                    +- FileScan parquet [s_store_sk#55,s_state#3] Batched: true, DataFilters: [isnotnull(s_store_sk#55)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk)], ReadSchema: struct<s_store_sk:int,s_state:string>
                  +- Sort [i_item_sk#53 ASC NULLS FIRST], false, 0
                     +- Exchange hashpartitioning(i_item_sk#53, 100), ENSURE_REQUIREMENTS, [plan_id=29]
                        +- Filter isnotnull(i_item_sk#53)
                           +- FileScan parquet [i_item_sk#53,i_item_id#1,i_item_desc#2] Batched: true, DataFilters: [isnotnull(i_item_sk#53)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_item_id:string,i_item_desc:string>
