AdaptiveSparkPlan isFinalPlan=true
+- == Final Plan ==
   TakeOrderedAndProject(limit=100, orderBy=[customer_id#1 ASC NULLS FIRST,customer_first_name#2 ASC NULLS FIRST,customer_last_name#3 ASC NULLS FIRST,customer_preferred_cust_flag#4 ASC NULLS FIRST,customer_birth_country#5 ASC NULLS FIRST,customer_login#6 ASC NULLS FIRST,customer_email_address#7 ASC NULLS FIRST], output=[customer_id#1,customer_first_name#2,customer_last_name#3,customer_preferred_cust_flag#4,customer_birth_country#5,customer_login#6,customer_email_address#7])
   +- *(2) Project [customer_id#1, customer_first_name#2, customer_last_name#3, customer_preferred_cust_flag#4, customer_birth_country#5, customer_login#6, customer_email_address#7]
      +- *(2) SortMergeJoin [customer_id#8], [customer_id#9], Inner, (CASE WHEN (year_total#10 > 0.000000) THEN (year_total#11 / year_total#10) END > CASE WHEN (year_total#12 > 0.000000) THEN (year_total#13 / year_total#12) END)
         :- NativeProject [customer_id#8, customer_id#1, customer_first_name#2, customer_last_name#3, customer_preferred_cust_flag#4, customer_birth_country#5, customer_login#6, customer_email_address#7, year_total#10, year_total#11, year_total#12]
         :  +- NativeSortMergeJoin [customer_id#8], [customer_id#14], Inner
         :     :- ConvertToNative
         :     :  +- *(1) Project [customer_id#8, customer_id#1, customer_first_name#2, customer_last_name#3, customer_preferred_cust_flag#4, customer_birth_country#5, customer_login#6, customer_email_address#7, year_total#10, year_total#11]
         :     :     +- *(1) SortMergeJoin [customer_id#8], [customer_id#15], Inner, (CASE WHEN (year_total#10 > 0.000000) THEN (year_total#11 / year_total#10) END > CASE WHEN (year_total#16 > 0.000000) THEN (year_total#17 / year_total#16) END)
         :     :        :- NativeProject [customer_id#8, year_total#16, customer_id#1, customer_first_name#2, customer_last_name#3, customer_preferred_cust_flag#4, customer_birth_country#5, customer_login#6, customer_email_address#7, year_total#17, year_total#10]
         :     :        :  +- NativeSortMergeJoin [customer_id#8], [customer_id#18], Inner
         :     :        :     :- NativeSortMergeJoin [customer_id#8], [customer_id#1], Inner
         :     :        :     :  :- NativeSort [customer_id#8 ASC NULLS FIRST], false
         :     :        :     :  :  +- InputAdapter
         :     :        :     :  :     +- AQEShuffleRead coalesced
         :     :        :     :  :        +- ShuffleQueryStage 45
         :     :        :     :  :           +- NativeShuffleExchange hashpartitioning(customer_id#8, 100), ENSURE_REQUIREMENTS, [plan_id=1]
         :     :        :     :  :              +- NativeFilter (isnotnull(year_total#16) AND (year_total#16 > 0.000000))
         :     :        :     :  :                 +- NativeProject [c_customer_id#19 AS customer_id#8, sum(((((ss_ext_list_price#20 - ss_ext_wholesale_cost#21) - ss_ext_discount_amt#22) + ss_ext_sales_price#23) / 2))#24 AS year_total#16]
         :     :        :     :  :                    +- NativeHashAggregate HashAgg, ArrayBuffer(c_customer_id#19, c_first_name#25, c_last_name#26, c_preferred_cust_flag#27, c_birth_country#28, c_login#29, c_email_address#30, d_year#31), [c_customer_id#19, c_first_name#25, c_last_name#26, c_preferred_cust_flag#27, c_birth_country#28, c_login#29, c_email_address#30, d_year#31], [sum(((((ss_ext_list_price#20 - ss_ext_wholesale_cost#21) - ss_ext_discount_amt#22) + ss_ext_sales_price#23) / 2))], [sum(((((ss_ext_list_price#20 - ss_ext_wholesale_cost#21) - ss_ext_discount_amt#22) + ss_ext_sales_price#23) / 2))#24], 8
         :     :        :     :  :                       +- InputAdapter
         :     :        :     :  :                          +- AQEShuffleRead coalesced
         :     :        :     :  :                             +- ShuffleQueryStage 39
         :     :        :     :  :                                +- NativeShuffleExchange hashpartitioning(c_customer_id#19, c_first_name#25, c_last_name#26, c_preferred_cust_flag#27, c_birth_country#28, c_login#29, c_email_address#30, d_year#31, 100), ENSURE_REQUIREMENTS, [plan_id=2]
         :     :        :     :  :                                   +- NativeHashAggregate HashAgg, [c_customer_id#19, c_first_name#25, c_last_name#26, c_preferred_cust_flag#27, c_birth_country#28, c_login#29, c_email_address#30, d_year#31], [partial_sum(_c8#32)], [sum#33, isEmpty#34], 0
         :     :        :     :  :                                      +- NativeProject [c_customer_id#19 AS c_customer_id#19, c_first_name#25 AS c_first_name#25, c_last_name#26 AS c_last_name#26, c_preferred_cust_flag#27 AS c_preferred_cust_flag#27, c_birth_country#28 AS c_birth_country#28, c_login#29 AS c_login#29, c_email_address#30 AS c_email_address#30, d_year#31 AS d_year#31, ((((ss_ext_list_price#20 - ss_ext_wholesale_cost#21) - ss_ext_discount_amt#22) + ss_ext_sales_price#23) / 2) AS _c8#32]
         :     :        :     :  :                                         +- NativeProject [c_customer_id#19, c_first_name#25, c_last_name#26, c_preferred_cust_flag#27, c_birth_country#28, c_login#29, c_email_address#30, ss_ext_discount_amt#22, ss_ext_sales_price#23, ss_ext_wholesale_cost#21, ss_ext_list_price#20, d_year#31]
         :     :        :     :  :                                            +- NativeSortMergeJoin [ss_sold_date_sk#35], [d_date_sk#36], Inner
         :     :        :     :  :                                               :- NativeSort [ss_sold_date_sk#35 ASC NULLS FIRST], false
         :     :        :     :  :                                               :  +- InputAdapter
         :     :        :     :  :                                               :     +- AQEShuffleRead coalesced
         :     :        :     :  :                                               :        +- ShuffleQueryStage 30
         :     :        :     :  :                                               :           +- NativeShuffleExchange hashpartitioning(ss_sold_date_sk#35, 100), ENSURE_REQUIREMENTS, [plan_id=3]
         :     :        :     :  :                                               :              +- NativeProject [c_customer_id#19, c_first_name#25, c_last_name#26, c_preferred_cust_flag#27, c_birth_country#28, c_login#29, c_email_address#30, ss_sold_date_sk#35, ss_ext_discount_amt#22, ss_ext_sales_price#23, ss_ext_wholesale_cost#21, ss_ext_list_price#20]
         :     :        :     :  :                                               :                 +- NativeSortMergeJoin [c_customer_sk#37], [ss_customer_sk#38], Inner
         :     :        :     :  :                                               :                    :- NativeSort [c_customer_sk#37 ASC NULLS FIRST], false
         :     :        :     :  :                                               :                    :  +- InputAdapter
         :     :        :     :  :                                               :                    :     +- AQEShuffleRead coalesced
         :     :        :     :  :                                               :                    :        +- ShuffleQueryStage 0
         :     :        :     :  :                                               :                    :           +- NativeShuffleExchange hashpartitioning(c_customer_sk#37, 100), ENSURE_REQUIREMENTS, [plan_id=4]
         :     :        :     :  :                                               :                    :              +- NativeFilter (isnotnull(c_customer_sk#37) AND isnotnull(c_customer_id#19))
         :     :        :     :  :                                               :                    :                 +- InputAdapter [#37, #19, #25, #26, #27, #28, #29, #30]
         :     :        :     :  :                                               :                    :                    +- NativeParquetScan  (FileScan parquet [c_customer_sk#37,c_customer_id#19,c_first_name#25,c_last_name#26,c_preferred_cust_flag#27,c_birth_country#28,c_login#29,c_email_address#30] Batched: true, DataFilters: [isnotnull(c_customer_sk#37), isnotnull(c_customer_id#19)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_customer_id)], ReadSchema: struct<c_customer_sk:int,c_customer_id:string,c_first_name:string,c_last_name:string,c_preferred_...)
         :     :        :     :  :                                               :                    +- NativeSort [ss_customer_sk#38 ASC NULLS FIRST], false
         :     :        :     :  :                                               :                       +- InputAdapter
         :     :        :     :  :                                               :                          +- AQEShuffleRead coalesced
         :     :        :     :  :                                               :                             +- ShuffleQueryStage 1
         :     :        :     :  :                                               :                                +- NativeShuffleExchange hashpartitioning(ss_customer_sk#38, 100), ENSURE_REQUIREMENTS, [plan_id=5]
         :     :        :     :  :                                               :                                   +- NativeFilter (isnotnull(ss_customer_sk#38) AND isnotnull(ss_sold_date_sk#35))
         :     :        :     :  :                                               :                                      +- InputAdapter [#35, #38, #22, #23, #21, #20]
         :     :        :     :  :                                               :                                         +- NativeParquetScan  (FileScan parquet [ss_sold_date_sk#35,ss_customer_sk#38,ss_ext_discount_amt#22,ss_ext_sales_price#23,ss_ext_wholesale_cost#21,ss_ext_list_price#20] Batched: true, DataFilters: [isnotnull(ss_customer_sk#38), isnotnull(ss_sold_date_sk#35)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_customer_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_ext_discount_amt:decimal(7,2),ss_ext_sales_price...)
         :     :        :     :  :                                               +- NativeSort [d_date_sk#36 ASC NULLS FIRST], false
         :     :        :     :  :                                                  +- InputAdapter
         :     :        :     :  :                                                     +- AQEShuffleRead coalesced
         :     :        :     :  :                                                        +- ShuffleQueryStage 2
         :     :        :     :  :                                                           +- NativeShuffleExchange hashpartitioning(d_date_sk#36, 100), ENSURE_REQUIREMENTS, [plan_id=6]
         :     :        :     :  :                                                              +- NativeFilter ((isnotnull(d_year#31) AND (d_year#31 = 2001)) AND isnotnull(d_date_sk#36))
         :     :        :     :  :                                                                 +- InputAdapter [#36, #31]
         :     :        :     :  :                                                                    +- NativeParquetScan  (FileScan parquet [d_date_sk#36,d_year#31] Batched: true, DataFilters: [isnotnull(d_year#31), (d_year#31 = 2001), isnotnull(d_date_sk#36)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2001), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>)
         :     :        :     :  +- NativeSort [customer_id#1 ASC NULLS FIRST], false
         :     :        :     :     +- InputAdapter
         :     :        :     :        +- AQEShuffleRead coalesced
         :     :        :     :           +- ShuffleQueryStage 47
         :     :        :     :              +- NativeShuffleExchange hashpartitioning(customer_id#1, 100), ENSURE_REQUIREMENTS, [plan_id=7]
         :     :        :     :                 +- NativeProject [c_customer_id#39 AS customer_id#1, c_first_name#40 AS customer_first_name#2, c_last_name#41 AS customer_last_name#3, c_preferred_cust_flag#42 AS customer_preferred_cust_flag#4, c_birth_country#43 AS customer_birth_country#5, c_login#44 AS customer_login#6, c_email_address#45 AS customer_email_address#7, sum(((((ss_ext_list_price#46 - ss_ext_wholesale_cost#47) - ss_ext_discount_amt#48) + ss_ext_sales_price#49) / 2))#24 AS year_total#17]
         :     :        :     :                    +- NativeHashAggregate HashAgg, ArrayBuffer(c_customer_id#39, c_first_name#40, c_last_name#41, c_preferred_cust_flag#42, c_birth_country#43, c_login#44, c_email_address#45, d_year#50), [c_customer_id#39, c_first_name#40, c_last_name#41, c_preferred_cust_flag#42, c_birth_country#43, c_login#44, c_email_address#45, d_year#50], [sum(((((ss_ext_list_price#46 - ss_ext_wholesale_cost#47) - ss_ext_discount_amt#48) + ss_ext_sales_price#49) / 2))], [sum(((((ss_ext_list_price#46 - ss_ext_wholesale_cost#47) - ss_ext_discount_amt#48) + ss_ext_sales_price#49) / 2))#24], 8
         :     :        :     :                       +- InputAdapter
         :     :        :     :                          +- AQEShuffleRead coalesced
         :     :        :     :                             +- ShuffleQueryStage 40
         :     :        :     :                                +- NativeShuffleExchange hashpartitioning(c_customer_id#39, c_first_name#40, c_last_name#41, c_preferred_cust_flag#42, c_birth_country#43, c_login#44, c_email_address#45, d_year#50, 100), ENSURE_REQUIREMENTS, [plan_id=8]
         :     :        :     :                                   +- NativeHashAggregate HashAgg, [c_customer_id#39, c_first_name#40, c_last_name#41, c_preferred_cust_flag#42, c_birth_country#43, c_login#44, c_email_address#45, d_year#50], [partial_sum(_c8#51)], [sum#52, isEmpty#53], 0
         :     :        :     :                                      +- NativeProject [c_customer_id#39 AS c_customer_id#39, c_first_name#40 AS c_first_name#40, c_last_name#41 AS c_last_name#41, c_preferred_cust_flag#42 AS c_preferred_cust_flag#42, c_birth_country#43 AS c_birth_country#43, c_login#44 AS c_login#44, c_email_address#45 AS c_email_address#45, d_year#50 AS d_year#50, ((((ss_ext_list_price#46 - ss_ext_wholesale_cost#47) - ss_ext_discount_amt#48) + ss_ext_sales_price#49) / 2) AS _c8#51]
         :     :        :     :                                         +- NativeProject [c_customer_id#39, c_first_name#40, c_last_name#41, c_preferred_cust_flag#42, c_birth_country#43, c_login#44, c_email_address#45, ss_ext_discount_amt#48, ss_ext_sales_price#49, ss_ext_wholesale_cost#47, ss_ext_list_price#46, d_year#50]
         :     :        :     :                                            +- NativeSortMergeJoin [ss_sold_date_sk#54], [d_date_sk#55], Inner
         :     :        :     :                                               :- NativeSort [ss_sold_date_sk#54 ASC NULLS FIRST], false
         :     :        :     :                                               :  +- InputAdapter
         :     :        :     :                                               :     +- InputAdapter [#39, #40, #41, #42, #43, #44, #45, #54, #48, #49, #47, #46]
         :     :        :     :                                               :        +- AQEShuffleRead coalesced
         :     :        :     :                                               :           +- ShuffleQueryStage 32
         :     :        :     :                                               :              +- ReusedExchange [c_customer_id#39, c_first_name#40, c_last_name#41, c_preferred_cust_flag#42, c_birth_country#43, c_login#44, c_email_address#45, ss_sold_date_sk#54, ss_ext_discount_amt#48, ss_ext_sales_price#49, ss_ext_wholesale_cost#47, ss_ext_list_price#46], NativeShuffleExchange hashpartitioning(ss_sold_date_sk#35, 100), ENSURE_REQUIREMENTS, [plan_id=3]
         :     :        :     :                                               +- NativeSort [d_date_sk#55 ASC NULLS FIRST], false
         :     :        :     :                                                  +- InputAdapter
         :     :        :     :                                                     +- AQEShuffleRead coalesced
         :     :        :     :                                                        +- ShuffleQueryStage 7
         :     :        :     :                                                           +- NativeShuffleExchange hashpartitioning(d_date_sk#55, 100), ENSURE_REQUIREMENTS, [plan_id=9]
         :     :        :     :                                                              +- NativeFilter ((isnotnull(d_year#50) AND (d_year#50 = 2002)) AND isnotnull(d_date_sk#55))
         :     :        :     :                                                                 +- InputAdapter [#55, #50]
         :     :        :     :                                                                    +- NativeParquetScan  (FileScan parquet [d_date_sk#55,d_year#50] Batched: true, DataFilters: [isnotnull(d_year#50), (d_year#50 = 2002), isnotnull(d_date_sk#55)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2002), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>)
         :     :        :     +- NativeSort [customer_id#18 ASC NULLS FIRST], false
         :     :        :        +- InputAdapter
         :     :        :           +- AQEShuffleRead coalesced
         :     :        :              +- ShuffleQueryStage 46
         :     :        :                 +- NativeShuffleExchange hashpartitioning(customer_id#18, 100), ENSURE_REQUIREMENTS, [plan_id=10]
         :     :        :                    +- NativeFilter (isnotnull(year_total#10) AND (year_total#10 > 0.000000))
         :     :        :                       +- NativeProject [c_customer_id#56 AS customer_id#18, sum(((((cs_ext_list_price#57 - cs_ext_wholesale_cost#58) - cs_ext_discount_amt#59) + cs_ext_sales_price#60) / 2))#61 AS year_total#10]
         :     :        :                          +- NativeHashAggregate HashAgg, ArrayBuffer(c_customer_id#56, c_first_name#62, c_last_name#63, c_preferred_cust_flag#64, c_birth_country#65, c_login#66, c_email_address#67, d_year#68), [c_customer_id#56, c_first_name#62, c_last_name#63, c_preferred_cust_flag#64, c_birth_country#65, c_login#66, c_email_address#67, d_year#68], [sum(((((cs_ext_list_price#57 - cs_ext_wholesale_cost#58) - cs_ext_discount_amt#59) + cs_ext_sales_price#60) / 2))], [sum(((((cs_ext_list_price#57 - cs_ext_wholesale_cost#58) - cs_ext_discount_amt#59) + cs_ext_sales_price#60) / 2))#61], 8
         :     :        :                             +- InputAdapter
         :     :        :                                +- AQEShuffleRead coalesced
         :     :        :                                   +- ShuffleQueryStage 41
         :     :        :                                      +- NativeShuffleExchange hashpartitioning(c_customer_id#56, c_first_name#62, c_last_name#63, c_preferred_cust_flag#64, c_birth_country#65, c_login#66, c_email_address#67, d_year#68, 100), ENSURE_REQUIREMENTS, [plan_id=11]
         :     :        :                                         +- NativeHashAggregate HashAgg, [c_customer_id#56, c_first_name#62, c_last_name#63, c_preferred_cust_flag#64, c_birth_country#65, c_login#66, c_email_address#67, d_year#68], [partial_sum(_c8#69)], [sum#70, isEmpty#71], 0
         :     :        :                                            +- NativeProject [c_customer_id#56 AS c_customer_id#56, c_first_name#62 AS c_first_name#62, c_last_name#63 AS c_last_name#63, c_preferred_cust_flag#64 AS c_preferred_cust_flag#64, c_birth_country#65 AS c_birth_country#65, c_login#66 AS c_login#66, c_email_address#67 AS c_email_address#67, d_year#68 AS d_year#68, ((((cs_ext_list_price#57 - cs_ext_wholesale_cost#58) - cs_ext_discount_amt#59) + cs_ext_sales_price#60) / 2) AS _c8#69]
         :     :        :                                               +- NativeProject [c_customer_id#56, c_first_name#62, c_last_name#63, c_preferred_cust_flag#64, c_birth_country#65, c_login#66, c_email_address#67, cs_ext_discount_amt#59, cs_ext_sales_price#60, cs_ext_wholesale_cost#58, cs_ext_list_price#57, d_year#68]
         :     :        :                                                  +- NativeSortMergeJoin [cs_sold_date_sk#72], [d_date_sk#73], Inner
         :     :        :                                                     :- NativeSort [cs_sold_date_sk#72 ASC NULLS FIRST], false
         :     :        :                                                     :  +- InputAdapter
         :     :        :                                                     :     +- AQEShuffleRead coalesced
         :     :        :                                                     :        +- ShuffleQueryStage 33
         :     :        :                                                     :           +- NativeShuffleExchange hashpartitioning(cs_sold_date_sk#72, 100), ENSURE_REQUIREMENTS, [plan_id=12]
         :     :        :                                                     :              +- NativeProject [c_customer_id#56, c_first_name#62, c_last_name#63, c_preferred_cust_flag#64, c_birth_country#65, c_login#66, c_email_address#67, cs_sold_date_sk#72, cs_ext_discount_amt#59, cs_ext_sales_price#60, cs_ext_wholesale_cost#58, cs_ext_list_price#57]
         :     :        :                                                     :                 +- NativeSortMergeJoin [c_customer_sk#74], [cs_bill_customer_sk#75], Inner
         :     :        :                                                     :                    :- NativeSort [c_customer_sk#74 ASC NULLS FIRST], false
         :     :        :                                                     :                    :  +- InputAdapter
         :     :        :                                                     :                    :     +- InputAdapter [#74, #56, #62, #63, #64, #65, #66, #67]
         :     :        :                                                     :                    :        +- AQEShuffleRead coalesced
         :     :        :                                                     :                    :           +- ShuffleQueryStage 9
         :     :        :                                                     :                    :              +- ReusedExchange [c_customer_sk#74, c_customer_id#56, c_first_name#62, c_last_name#63, c_preferred_cust_flag#64, c_birth_country#65, c_login#66, c_email_address#67], NativeShuffleExchange hashpartitioning(c_customer_sk#37, 100), ENSURE_REQUIREMENTS, [plan_id=4]
         :     :        :                                                     :                    +- NativeSort [cs_bill_customer_sk#75 ASC NULLS FIRST], false
         :     :        :                                                     :                       +- InputAdapter
         :     :        :                                                     :                          +- AQEShuffleRead coalesced
         :     :        :                                                     :                             +- ShuffleQueryStage 10
         :     :        :                                                     :                                +- NativeShuffleExchange hashpartitioning(cs_bill_customer_sk#75, 100), ENSURE_REQUIREMENTS, [plan_id=13]
         :     :        :                                                     :                                   +- NativeFilter (isnotnull(cs_bill_customer_sk#75) AND isnotnull(cs_sold_date_sk#72))
         :     :        :                                                     :                                      +- InputAdapter [#72, #75, #59, #60, #58, #57]
         :     :        :                                                     :                                         +- NativeParquetScan  (FileScan parquet [cs_sold_date_sk#72,cs_bill_customer_sk#75,cs_ext_discount_amt#59,cs_ext_sales_price#60,cs_ext_wholesale_cost#58,cs_ext_list_price#57] Batched: true, DataFilters: [isnotnull(cs_bill_customer_sk#75), isnotnull(cs_sold_date_sk#72)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cs_bill_customer_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_bill_customer_sk:int,cs_ext_discount_amt:decimal(7,2),cs_ext_sales_...)
         :     :        :                                                     +- NativeSort [d_date_sk#73 ASC NULLS FIRST], false
         :     :        :                                                        +- InputAdapter
         :     :        :                                                           +- InputAdapter [#73, #68]
         :     :        :                                                              +- AQEShuffleRead coalesced
         :     :        :                                                                 +- ShuffleQueryStage 12
         :     :        :                                                                    +- ReusedExchange [d_date_sk#73, d_year#68], NativeShuffleExchange hashpartitioning(d_date_sk#36, 100), ENSURE_REQUIREMENTS, [plan_id=6]
         :     :        +- NativeSort [customer_id#15 ASC NULLS FIRST], false
         :     :           +- InputAdapter
         :     :              +- AQEShuffleRead coalesced
         :     :                 +- ShuffleQueryStage 48
         :     :                    +- NativeShuffleExchange hashpartitioning(customer_id#15, 100), ENSURE_REQUIREMENTS, [plan_id=14]
         :     :                       +- NativeProject [c_customer_id#76 AS customer_id#15, sum(((((cs_ext_list_price#77 - cs_ext_wholesale_cost#78) - cs_ext_discount_amt#79) + cs_ext_sales_price#80) / 2))#61 AS year_total#11]
         :     :                          +- NativeHashAggregate HashAgg, ArrayBuffer(c_customer_id#76, c_first_name#81, c_last_name#82, c_preferred_cust_flag#83, c_birth_country#84, c_login#85, c_email_address#86, d_year#87), [c_customer_id#76, c_first_name#81, c_last_name#82, c_preferred_cust_flag#83, c_birth_country#84, c_login#85, c_email_address#86, d_year#87], [sum(((((cs_ext_list_price#77 - cs_ext_wholesale_cost#78) - cs_ext_discount_amt#79) + cs_ext_sales_price#80) / 2))], [sum(((((cs_ext_list_price#77 - cs_ext_wholesale_cost#78) - cs_ext_discount_amt#79) + cs_ext_sales_price#80) / 2))#61], 8
         :     :                             +- InputAdapter
         :     :                                +- AQEShuffleRead coalesced
         :     :                                   +- ShuffleQueryStage 42
         :     :                                      +- NativeShuffleExchange hashpartitioning(c_customer_id#76, c_first_name#81, c_last_name#82, c_preferred_cust_flag#83, c_birth_country#84, c_login#85, c_email_address#86, d_year#87, 100), ENSURE_REQUIREMENTS, [plan_id=15]
         :     :                                         +- NativeHashAggregate HashAgg, [c_customer_id#76, c_first_name#81, c_last_name#82, c_preferred_cust_flag#83, c_birth_country#84, c_login#85, c_email_address#86, d_year#87], [partial_sum(_c8#88)], [sum#89, isEmpty#90], 0
         :     :                                            +- NativeProject [c_customer_id#76 AS c_customer_id#76, c_first_name#81 AS c_first_name#81, c_last_name#82 AS c_last_name#82, c_preferred_cust_flag#83 AS c_preferred_cust_flag#83, c_birth_country#84 AS c_birth_country#84, c_login#85 AS c_login#85, c_email_address#86 AS c_email_address#86, d_year#87 AS d_year#87, ((((cs_ext_list_price#77 - cs_ext_wholesale_cost#78) - cs_ext_discount_amt#79) + cs_ext_sales_price#80) / 2) AS _c8#88]
         :     :                                               +- NativeProject [c_customer_id#76, c_first_name#81, c_last_name#82, c_preferred_cust_flag#83, c_birth_country#84, c_login#85, c_email_address#86, cs_ext_discount_amt#79, cs_ext_sales_price#80, cs_ext_wholesale_cost#78, cs_ext_list_price#77, d_year#87]
         :     :                                                  +- NativeSortMergeJoin [cs_sold_date_sk#91], [d_date_sk#92], Inner
         :     :                                                     :- NativeSort [cs_sold_date_sk#91 ASC NULLS FIRST], false
         :     :                                                     :  +- InputAdapter
         :     :                                                     :     +- InputAdapter [#76, #81, #82, #83, #84, #85, #86, #91, #79, #80, #78, #77]
         :     :                                                     :        +- AQEShuffleRead coalesced
         :     :                                                     :           +- ShuffleQueryStage 35
         :     :                                                     :              +- ReusedExchange [c_customer_id#76, c_first_name#81, c_last_name#82, c_preferred_cust_flag#83, c_birth_country#84, c_login#85, c_email_address#86, cs_sold_date_sk#91, cs_ext_discount_amt#79, cs_ext_sales_price#80, cs_ext_wholesale_cost#78, cs_ext_list_price#77], NativeShuffleExchange hashpartitioning(cs_sold_date_sk#72, 100), ENSURE_REQUIREMENTS, [plan_id=12]
         :     :                                                     +- NativeSort [d_date_sk#92 ASC NULLS FIRST], false
         :     :                                                        +- InputAdapter
         :     :                                                           +- InputAdapter [#92, #87]
         :     :                                                              +- AQEShuffleRead coalesced
         :     :                                                                 +- ShuffleQueryStage 18
         :     :                                                                    +- ReusedExchange [d_date_sk#92, d_year#87], NativeShuffleExchange hashpartitioning(d_date_sk#55, 100), ENSURE_REQUIREMENTS, [plan_id=9]
         :     +- NativeSort [customer_id#14 ASC NULLS FIRST], false
         :        +- InputAdapter
         :           +- AQEShuffleRead coalesced
         :              +- ShuffleQueryStage 49
         :                 +- NativeShuffleExchange hashpartitioning(customer_id#14, 100), ENSURE_REQUIREMENTS, [plan_id=16]
         :                    +- NativeFilter (isnotnull(year_total#12) AND (year_total#12 > 0.000000))
         :                       +- NativeProject [c_customer_id#93 AS customer_id#14, sum(((((ws_ext_list_price#94 - ws_ext_wholesale_cost#95) - ws_ext_discount_amt#96) + ws_ext_sales_price#97) / 2))#98 AS year_total#12]
         :                          +- NativeHashAggregate HashAgg, ArrayBuffer(c_customer_id#93, c_first_name#99, c_last_name#100, c_preferred_cust_flag#101, c_birth_country#102, c_login#103, c_email_address#104, d_year#105), [c_customer_id#93, c_first_name#99, c_last_name#100, c_preferred_cust_flag#101, c_birth_country#102, c_login#103, c_email_address#104, d_year#105], [sum(((((ws_ext_list_price#94 - ws_ext_wholesale_cost#95) - ws_ext_discount_amt#96) + ws_ext_sales_price#97) / 2))], [sum(((((ws_ext_list_price#94 - ws_ext_wholesale_cost#95) - ws_ext_discount_amt#96) + ws_ext_sales_price#97) / 2))#98], 8
         :                             +- InputAdapter
         :                                +- AQEShuffleRead coalesced
         :                                   +- ShuffleQueryStage 43
         :                                      +- NativeShuffleExchange hashpartitioning(c_customer_id#93, c_first_name#99, c_last_name#100, c_preferred_cust_flag#101, c_birth_country#102, c_login#103, c_email_address#104, d_year#105, 100), ENSURE_REQUIREMENTS, [plan_id=17]
         :                                         +- NativeHashAggregate HashAgg, [c_customer_id#93, c_first_name#99, c_last_name#100, c_preferred_cust_flag#101, c_birth_country#102, c_login#103, c_email_address#104, d_year#105], [partial_sum(_c8#106)], [sum#107, isEmpty#108], 0
         :                                            +- NativeProject [c_customer_id#93 AS c_customer_id#93, c_first_name#99 AS c_first_name#99, c_last_name#100 AS c_last_name#100, c_preferred_cust_flag#101 AS c_preferred_cust_flag#101, c_birth_country#102 AS c_birth_country#102, c_login#103 AS c_login#103, c_email_address#104 AS c_email_address#104, d_year#105 AS d_year#105, ((((ws_ext_list_price#94 - ws_ext_wholesale_cost#95) - ws_ext_discount_amt#96) + ws_ext_sales_price#97) / 2) AS _c8#106]
         :                                               +- NativeProject [c_customer_id#93, c_first_name#99, c_last_name#100, c_preferred_cust_flag#101, c_birth_country#102, c_login#103, c_email_address#104, ws_ext_discount_amt#96, ws_ext_sales_price#97, ws_ext_wholesale_cost#95, ws_ext_list_price#94, d_year#105]
         :                                                  +- NativeSortMergeJoin [ws_sold_date_sk#109], [d_date_sk#110], Inner
         :                                                     :- NativeSort [ws_sold_date_sk#109 ASC NULLS FIRST], false
         :                                                     :  +- InputAdapter
         :                                                     :     +- AQEShuffleRead coalesced
         :                                                     :        +- ShuffleQueryStage 36
         :                                                     :           +- NativeShuffleExchange hashpartitioning(ws_sold_date_sk#109, 100), ENSURE_REQUIREMENTS, [plan_id=18]
         :                                                     :              +- NativeProject [c_customer_id#93, c_first_name#99, c_last_name#100, c_preferred_cust_flag#101, c_birth_country#102, c_login#103, c_email_address#104, ws_sold_date_sk#109, ws_ext_discount_amt#96, ws_ext_sales_price#97, ws_ext_wholesale_cost#95, ws_ext_list_price#94]
         :                                                     :                 +- NativeSortMergeJoin [c_customer_sk#111], [ws_bill_customer_sk#112], Inner
         :                                                     :                    :- NativeSort [c_customer_sk#111 ASC NULLS FIRST], false
         :                                                     :                    :  +- InputAdapter
         :                                                     :                    :     +- InputAdapter [#111, #93, #99, #100, #101, #102, #103, #104]
         :                                                     :                    :        +- AQEShuffleRead coalesced
         :                                                     :                    :           +- ShuffleQueryStage 20
         :                                                     :                    :              +- ReusedExchange [c_customer_sk#111, c_customer_id#93, c_first_name#99, c_last_name#100, c_preferred_cust_flag#101, c_birth_country#102, c_login#103, c_email_address#104], NativeShuffleExchange hashpartitioning(c_customer_sk#37, 100), ENSURE_REQUIREMENTS, [plan_id=4]
         :                                                     :                    +- NativeSort [ws_bill_customer_sk#112 ASC NULLS FIRST], false
         :                                                     :                       +- InputAdapter
         :                                                     :                          +- AQEShuffleRead coalesced
         :                                                     :                             +- ShuffleQueryStage 21
         :                                                     :                                +- NativeShuffleExchange hashpartitioning(ws_bill_customer_sk#112, 100), ENSURE_REQUIREMENTS, [plan_id=19]
         :                                                     :                                   +- NativeFilter (isnotnull(ws_bill_customer_sk#112) AND isnotnull(ws_sold_date_sk#109))
         :                                                     :                                      +- InputAdapter [#109, #112, #96, #97, #95, #94]
         :                                                     :                                         +- NativeParquetScan  (FileScan parquet [ws_sold_date_sk#109,ws_bill_customer_sk#112,ws_ext_discount_amt#96,ws_ext_sales_price#97,ws_ext_wholesale_cost#95,ws_ext_list_price#94] Batched: true, DataFilters: [isnotnull(ws_bill_customer_sk#112), isnotnull(ws_sold_date_sk#109)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ws_bill_customer_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_bill_customer_sk:int,ws_ext_discount_amt:decimal(7,2),ws_ext_sales_...)
         :                                                     +- NativeSort [d_date_sk#110 ASC NULLS FIRST], false
         :                                                        +- InputAdapter
         :                                                           +- InputAdapter [#110, #105]
         :                                                              +- AQEShuffleRead coalesced
         :                                                                 +- ShuffleQueryStage 23
         :                                                                    +- ReusedExchange [d_date_sk#110, d_year#105], NativeShuffleExchange hashpartitioning(d_date_sk#36, 100), ENSURE_REQUIREMENTS, [plan_id=6]
         +- NativeSort [customer_id#9 ASC NULLS FIRST], false
            +- InputAdapter
               +- AQEShuffleRead coalesced
                  +- ShuffleQueryStage 50
                     +- NativeShuffleExchange hashpartitioning(customer_id#9, 100), ENSURE_REQUIREMENTS, [plan_id=20]
                        +- NativeProject [c_customer_id#113 AS customer_id#9, sum(((((ws_ext_list_price#114 - ws_ext_wholesale_cost#115) - ws_ext_discount_amt#116) + ws_ext_sales_price#117) / 2))#98 AS year_total#13]
                           +- NativeHashAggregate HashAgg, ArrayBuffer(c_customer_id#113, c_first_name#118, c_last_name#119, c_preferred_cust_flag#120, c_birth_country#121, c_login#122, c_email_address#123, d_year#124), [c_customer_id#113, c_first_name#118, c_last_name#119, c_preferred_cust_flag#120, c_birth_country#121, c_login#122, c_email_address#123, d_year#124], [sum(((((ws_ext_list_price#114 - ws_ext_wholesale_cost#115) - ws_ext_discount_amt#116) + ws_ext_sales_price#117) / 2))], [sum(((((ws_ext_list_price#114 - ws_ext_wholesale_cost#115) - ws_ext_discount_amt#116) + ws_ext_sales_price#117) / 2))#98], 8
                              +- InputAdapter
                                 +- AQEShuffleRead coalesced
                                    +- ShuffleQueryStage 44
                                       +- NativeShuffleExchange hashpartitioning(c_customer_id#113, c_first_name#118, c_last_name#119, c_preferred_cust_flag#120, c_birth_country#121, c_login#122, c_email_address#123, d_year#124, 100), ENSURE_REQUIREMENTS, [plan_id=21]
                                          +- NativeHashAggregate HashAgg, [c_customer_id#113, c_first_name#118, c_last_name#119, c_preferred_cust_flag#120, c_birth_country#121, c_login#122, c_email_address#123, d_year#124], [partial_sum(_c8#125)], [sum#126, isEmpty#127], 0
                                             +- NativeProject [c_customer_id#113 AS c_customer_id#113, c_first_name#118 AS c_first_name#118, c_last_name#119 AS c_last_name#119, c_preferred_cust_flag#120 AS c_preferred_cust_flag#120, c_birth_country#121 AS c_birth_country#121, c_login#122 AS c_login#122, c_email_address#123 AS c_email_address#123, d_year#124 AS d_year#124, ((((ws_ext_list_price#114 - ws_ext_wholesale_cost#115) - ws_ext_discount_amt#116) + ws_ext_sales_price#117) / 2) AS _c8#125]
                                                +- NativeProject [c_customer_id#113, c_first_name#118, c_last_name#119, c_preferred_cust_flag#120, c_birth_country#121, c_login#122, c_email_address#123, ws_ext_discount_amt#116, ws_ext_sales_price#117, ws_ext_wholesale_cost#115, ws_ext_list_price#114, d_year#124]
                                                   +- NativeSortMergeJoin [ws_sold_date_sk#128], [d_date_sk#129], Inner
                                                      :- NativeSort [ws_sold_date_sk#128 ASC NULLS FIRST], false
                                                      :  +- InputAdapter
                                                      :     +- InputAdapter [#113, #118, #119, #120, #121, #122, #123, #128, #116, #117, #115, #114]
                                                      :        +- AQEShuffleRead coalesced
                                                      :           +- ShuffleQueryStage 38
                                                      :              +- ReusedExchange [c_customer_id#113, c_first_name#118, c_last_name#119, c_preferred_cust_flag#120, c_birth_country#121, c_login#122, c_email_address#123, ws_sold_date_sk#128, ws_ext_discount_amt#116, ws_ext_sales_price#117, ws_ext_wholesale_cost#115, ws_ext_list_price#114], NativeShuffleExchange hashpartitioning(ws_sold_date_sk#109, 100), ENSURE_REQUIREMENTS, [plan_id=18]
                                                      +- NativeSort [d_date_sk#129 ASC NULLS FIRST], false
                                                         +- InputAdapter
                                                            +- InputAdapter [#129, #124]
                                                               +- AQEShuffleRead coalesced
                                                                  +- ShuffleQueryStage 29
                                                                     +- ReusedExchange [d_date_sk#129, d_year#124], NativeShuffleExchange hashpartitioning(d_date_sk#55, 100), ENSURE_REQUIREMENTS, [plan_id=9]
+- == Initial Plan ==
   TakeOrderedAndProject(limit=100, orderBy=[customer_id#1 ASC NULLS FIRST,customer_first_name#2 ASC NULLS FIRST,customer_last_name#3 ASC NULLS FIRST,customer_preferred_cust_flag#4 ASC NULLS FIRST,customer_birth_country#5 ASC NULLS FIRST,customer_login#6 ASC NULLS FIRST,customer_email_address#7 ASC NULLS FIRST], output=[customer_id#1,customer_first_name#2,customer_last_name#3,customer_preferred_cust_flag#4,customer_birth_country#5,customer_login#6,customer_email_address#7])
   +- Project [customer_id#1, customer_first_name#2, customer_last_name#3, customer_preferred_cust_flag#4, customer_birth_country#5, customer_login#6, customer_email_address#7]
      +- SortMergeJoin [customer_id#8], [customer_id#9], Inner, (CASE WHEN (year_total#10 > 0.000000) THEN (year_total#11 / year_total#10) END > CASE WHEN (year_total#12 > 0.000000) THEN (year_total#13 / year_total#12) END)
         :- Project [customer_id#8, customer_id#1, customer_first_name#2, customer_last_name#3, customer_preferred_cust_flag#4, customer_birth_country#5, customer_login#6, customer_email_address#7, year_total#10, year_total#11, year_total#12]
         :  +- SortMergeJoin [customer_id#8], [customer_id#14], Inner
         :     :- Project [customer_id#8, customer_id#1, customer_first_name#2, customer_last_name#3, customer_preferred_cust_flag#4, customer_birth_country#5, customer_login#6, customer_email_address#7, year_total#10, year_total#11]
         :     :  +- SortMergeJoin [customer_id#8], [customer_id#15], Inner, (CASE WHEN (year_total#10 > 0.000000) THEN (year_total#11 / year_total#10) END > CASE WHEN (year_total#16 > 0.000000) THEN (year_total#17 / year_total#16) END)
         :     :     :- Project [customer_id#8, year_total#16, customer_id#1, customer_first_name#2, customer_last_name#3, customer_preferred_cust_flag#4, customer_birth_country#5, customer_login#6, customer_email_address#7, year_total#17, year_total#10]
         :     :     :  +- SortMergeJoin [customer_id#8], [customer_id#18], Inner
         :     :     :     :- SortMergeJoin [customer_id#8], [customer_id#1], Inner
         :     :     :     :  :- Sort [customer_id#8 ASC NULLS FIRST], false, 0
         :     :     :     :  :  +- Exchange hashpartitioning(customer_id#8, 100), ENSURE_REQUIREMENTS, [plan_id=22]
         :     :     :     :  :     +- Filter (isnotnull(year_total#16) AND (year_total#16 > 0.000000))
         :     :     :     :  :        +- HashAggregate(keys=[c_customer_id#19, c_first_name#25, c_last_name#26, c_preferred_cust_flag#27, c_birth_country#28, c_login#29, c_email_address#30, d_year#31], functions=[sum(((((ss_ext_list_price#20 - ss_ext_wholesale_cost#21) - ss_ext_discount_amt#22) + ss_ext_sales_price#23) / 2))], output=[customer_id#8, year_total#16])
         :     :     :     :  :           +- Exchange hashpartitioning(c_customer_id#19, c_first_name#25, c_last_name#26, c_preferred_cust_flag#27, c_birth_country#28, c_login#29, c_email_address#30, d_year#31, 100), ENSURE_REQUIREMENTS, [plan_id=23]
         :     :     :     :  :              +- HashAggregate(keys=[c_customer_id#19, c_first_name#25, c_last_name#26, c_preferred_cust_flag#27, c_birth_country#28, c_login#29, c_email_address#30, d_year#31], functions=[partial_sum(((((ss_ext_list_price#20 - ss_ext_wholesale_cost#21) - ss_ext_discount_amt#22) + ss_ext_sales_price#23) / 2))], output=[c_customer_id#19, c_first_name#25, c_last_name#26, c_preferred_cust_flag#27, c_birth_country#28, c_login#29, c_email_address#30, d_year#31, sum#130, isEmpty#131])
         :     :     :     :  :                 +- Project [c_customer_id#19, c_first_name#25, c_last_name#26, c_preferred_cust_flag#27, c_birth_country#28, c_login#29, c_email_address#30, ss_ext_discount_amt#22, ss_ext_sales_price#23, ss_ext_wholesale_cost#21, ss_ext_list_price#20, d_year#31]
         :     :     :     :  :                    +- SortMergeJoin [ss_sold_date_sk#35], [d_date_sk#36], Inner
         :     :     :     :  :                       :- Sort [ss_sold_date_sk#35 ASC NULLS FIRST], false, 0
         :     :     :     :  :                       :  +- Exchange hashpartitioning(ss_sold_date_sk#35, 100), ENSURE_REQUIREMENTS, [plan_id=24]
         :     :     :     :  :                       :     +- Project [c_customer_id#19, c_first_name#25, c_last_name#26, c_preferred_cust_flag#27, c_birth_country#28, c_login#29, c_email_address#30, ss_sold_date_sk#35, ss_ext_discount_amt#22, ss_ext_sales_price#23, ss_ext_wholesale_cost#21, ss_ext_list_price#20]
         :     :     :     :  :                       :        +- SortMergeJoin [c_customer_sk#37], [ss_customer_sk#38], Inner
         :     :     :     :  :                       :           :- Sort [c_customer_sk#37 ASC NULLS FIRST], false, 0
         :     :     :     :  :                       :           :  +- Exchange hashpartitioning(c_customer_sk#37, 100), ENSURE_REQUIREMENTS, [plan_id=25]
         :     :     :     :  :                       :           :     +- Filter (isnotnull(c_customer_sk#37) AND isnotnull(c_customer_id#19))
         :     :     :     :  :                       :           :        +- FileScan parquet [c_customer_sk#37,c_customer_id#19,c_first_name#25,c_last_name#26,c_preferred_cust_flag#27,c_birth_country#28,c_login#29,c_email_address#30] Batched: true, DataFilters: [isnotnull(c_customer_sk#37), isnotnull(c_customer_id#19)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_customer_id)], ReadSchema: struct<c_customer_sk:int,c_customer_id:string,c_first_name:string,c_last_name:string,c_preferred_...
         :     :     :     :  :                       :           +- Sort [ss_customer_sk#38 ASC NULLS FIRST], false, 0
         :     :     :     :  :                       :              +- Exchange hashpartitioning(ss_customer_sk#38, 100), ENSURE_REQUIREMENTS, [plan_id=26]
         :     :     :     :  :                       :                 +- Filter (isnotnull(ss_customer_sk#38) AND isnotnull(ss_sold_date_sk#35))
         :     :     :     :  :                       :                    +- FileScan parquet [ss_sold_date_sk#35,ss_customer_sk#38,ss_ext_discount_amt#22,ss_ext_sales_price#23,ss_ext_wholesale_cost#21,ss_ext_list_price#20] Batched: true, DataFilters: [isnotnull(ss_customer_sk#38), isnotnull(ss_sold_date_sk#35)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_customer_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_ext_discount_amt:decimal(7,2),ss_ext_sales_price...
         :     :     :     :  :                       +- Sort [d_date_sk#36 ASC NULLS FIRST], false, 0
         :     :     :     :  :                          +- Exchange hashpartitioning(d_date_sk#36, 100), ENSURE_REQUIREMENTS, [plan_id=27]
         :     :     :     :  :                             +- Filter ((isnotnull(d_year#31) AND (d_year#31 = 2001)) AND isnotnull(d_date_sk#36))
         :     :     :     :  :                                +- FileScan parquet [d_date_sk#36,d_year#31] Batched: true, DataFilters: [isnotnull(d_year#31), (d_year#31 = 2001), isnotnull(d_date_sk#36)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2001), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
         :     :     :     :  +- Sort [customer_id#1 ASC NULLS FIRST], false, 0
         :     :     :     :     +- Exchange hashpartitioning(customer_id#1, 100), ENSURE_REQUIREMENTS, [plan_id=28]
         :     :     :     :        +- HashAggregate(keys=[c_customer_id#39, c_first_name#40, c_last_name#41, c_preferred_cust_flag#42, c_birth_country#43, c_login#44, c_email_address#45, d_year#50], functions=[sum(((((ss_ext_list_price#46 - ss_ext_wholesale_cost#47) - ss_ext_discount_amt#48) + ss_ext_sales_price#49) / 2))], output=[customer_id#1, customer_first_name#2, customer_last_name#3, customer_preferred_cust_flag#4, customer_birth_country#5, customer_login#6, customer_email_address#7, year_total#17])
         :     :     :     :           +- Exchange hashpartitioning(c_customer_id#39, c_first_name#40, c_last_name#41, c_preferred_cust_flag#42, c_birth_country#43, c_login#44, c_email_address#45, d_year#50, 100), ENSURE_REQUIREMENTS, [plan_id=29]
         :     :     :     :              +- HashAggregate(keys=[c_customer_id#39, c_first_name#40, c_last_name#41, c_preferred_cust_flag#42, c_birth_country#43, c_login#44, c_email_address#45, d_year#50], functions=[partial_sum(((((ss_ext_list_price#46 - ss_ext_wholesale_cost#47) - ss_ext_discount_amt#48) + ss_ext_sales_price#49) / 2))], output=[c_customer_id#39, c_first_name#40, c_last_name#41, c_preferred_cust_flag#42, c_birth_country#43, c_login#44, c_email_address#45, d_year#50, sum#132, isEmpty#133])
         :     :     :     :                 +- Project [c_customer_id#39, c_first_name#40, c_last_name#41, c_preferred_cust_flag#42, c_birth_country#43, c_login#44, c_email_address#45, ss_ext_discount_amt#48, ss_ext_sales_price#49, ss_ext_wholesale_cost#47, ss_ext_list_price#46, d_year#50]
         :     :     :     :                    +- SortMergeJoin [ss_sold_date_sk#54], [d_date_sk#55], Inner
         :     :     :     :                       :- Sort [ss_sold_date_sk#54 ASC NULLS FIRST], false, 0
         :     :     :     :                       :  +- Exchange hashpartitioning(ss_sold_date_sk#54, 100), ENSURE_REQUIREMENTS, [plan_id=30]
         :     :     :     :                       :     +- Project [c_customer_id#39, c_first_name#40, c_last_name#41, c_preferred_cust_flag#42, c_birth_country#43, c_login#44, c_email_address#45, ss_sold_date_sk#54, ss_ext_discount_amt#48, ss_ext_sales_price#49, ss_ext_wholesale_cost#47, ss_ext_list_price#46]
         :     :     :     :                       :        +- SortMergeJoin [c_customer_sk#134], [ss_customer_sk#135], Inner
         :     :     :     :                       :           :- Sort [c_customer_sk#134 ASC NULLS FIRST], false, 0
         :     :     :     :                       :           :  +- Exchange hashpartitioning(c_customer_sk#134, 100), ENSURE_REQUIREMENTS, [plan_id=31]
         :     :     :     :                       :           :     +- Filter (isnotnull(c_customer_sk#134) AND isnotnull(c_customer_id#39))
         :     :     :     :                       :           :        +- FileScan parquet [c_customer_sk#134,c_customer_id#39,c_first_name#40,c_last_name#41,c_preferred_cust_flag#42,c_birth_country#43,c_login#44,c_email_address#45] Batched: true, DataFilters: [isnotnull(c_customer_sk#134), isnotnull(c_customer_id#39)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_customer_id)], ReadSchema: struct<c_customer_sk:int,c_customer_id:string,c_first_name:string,c_last_name:string,c_preferred_...
         :     :     :     :                       :           +- Sort [ss_customer_sk#135 ASC NULLS FIRST], false, 0
         :     :     :     :                       :              +- Exchange hashpartitioning(ss_customer_sk#135, 100), ENSURE_REQUIREMENTS, [plan_id=32]
         :     :     :     :                       :                 +- Filter (isnotnull(ss_customer_sk#135) AND isnotnull(ss_sold_date_sk#54))
         :     :     :     :                       :                    +- FileScan parquet [ss_sold_date_sk#54,ss_customer_sk#135,ss_ext_discount_amt#48,ss_ext_sales_price#49,ss_ext_wholesale_cost#47,ss_ext_list_price#46] Batched: true, DataFilters: [isnotnull(ss_customer_sk#135), isnotnull(ss_sold_date_sk#54)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_customer_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_ext_discount_amt:decimal(7,2),ss_ext_sales_price...
         :     :     :     :                       +- Sort [d_date_sk#55 ASC NULLS FIRST], false, 0
         :     :     :     :                          +- Exchange hashpartitioning(d_date_sk#55, 100), ENSURE_REQUIREMENTS, [plan_id=33]
         :     :     :     :                             +- Filter ((isnotnull(d_year#50) AND (d_year#50 = 2002)) AND isnotnull(d_date_sk#55))
         :     :     :     :                                +- FileScan parquet [d_date_sk#55,d_year#50] Batched: true, DataFilters: [isnotnull(d_year#50), (d_year#50 = 2002), isnotnull(d_date_sk#55)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2002), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
         :     :     :     +- Sort [customer_id#18 ASC NULLS FIRST], false, 0
         :     :     :        +- Exchange hashpartitioning(customer_id#18, 100), ENSURE_REQUIREMENTS, [plan_id=34]
         :     :     :           +- Filter (isnotnull(year_total#10) AND (year_total#10 > 0.000000))
         :     :     :              +- HashAggregate(keys=[c_customer_id#56, c_first_name#62, c_last_name#63, c_preferred_cust_flag#64, c_birth_country#65, c_login#66, c_email_address#67, d_year#68], functions=[sum(((((cs_ext_list_price#57 - cs_ext_wholesale_cost#58) - cs_ext_discount_amt#59) + cs_ext_sales_price#60) / 2))], output=[customer_id#18, year_total#10])
         :     :     :                 +- Exchange hashpartitioning(c_customer_id#56, c_first_name#62, c_last_name#63, c_preferred_cust_flag#64, c_birth_country#65, c_login#66, c_email_address#67, d_year#68, 100), ENSURE_REQUIREMENTS, [plan_id=35]
         :     :     :                    +- HashAggregate(keys=[c_customer_id#56, c_first_name#62, c_last_name#63, c_preferred_cust_flag#64, c_birth_country#65, c_login#66, c_email_address#67, d_year#68], functions=[partial_sum(((((cs_ext_list_price#57 - cs_ext_wholesale_cost#58) - cs_ext_discount_amt#59) + cs_ext_sales_price#60) / 2))], output=[c_customer_id#56, c_first_name#62, c_last_name#63, c_preferred_cust_flag#64, c_birth_country#65, c_login#66, c_email_address#67, d_year#68, sum#136, isEmpty#137])
         :     :     :                       +- Project [c_customer_id#56, c_first_name#62, c_last_name#63, c_preferred_cust_flag#64, c_birth_country#65, c_login#66, c_email_address#67, cs_ext_discount_amt#59, cs_ext_sales_price#60, cs_ext_wholesale_cost#58, cs_ext_list_price#57, d_year#68]
         :     :     :                          +- SortMergeJoin [cs_sold_date_sk#72], [d_date_sk#73], Inner
         :     :     :                             :- Sort [cs_sold_date_sk#72 ASC NULLS FIRST], false, 0
         :     :     :                             :  +- Exchange hashpartitioning(cs_sold_date_sk#72, 100), ENSURE_REQUIREMENTS, [plan_id=36]
         :     :     :                             :     +- Project [c_customer_id#56, c_first_name#62, c_last_name#63, c_preferred_cust_flag#64, c_birth_country#65, c_login#66, c_email_address#67, cs_sold_date_sk#72, cs_ext_discount_amt#59, cs_ext_sales_price#60, cs_ext_wholesale_cost#58, cs_ext_list_price#57]
         :     :     :                             :        +- SortMergeJoin [c_customer_sk#74], [cs_bill_customer_sk#75], Inner
         :     :     :                             :           :- Sort [c_customer_sk#74 ASC NULLS FIRST], false, 0
         :     :     :                             :           :  +- Exchange hashpartitioning(c_customer_sk#74, 100), ENSURE_REQUIREMENTS, [plan_id=37]
         :     :     :                             :           :     +- Filter (isnotnull(c_customer_sk#74) AND isnotnull(c_customer_id#56))
         :     :     :                             :           :        +- FileScan parquet [c_customer_sk#74,c_customer_id#56,c_first_name#62,c_last_name#63,c_preferred_cust_flag#64,c_birth_country#65,c_login#66,c_email_address#67] Batched: true, DataFilters: [isnotnull(c_customer_sk#74), isnotnull(c_customer_id#56)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_customer_id)], ReadSchema: struct<c_customer_sk:int,c_customer_id:string,c_first_name:string,c_last_name:string,c_preferred_...
         :     :     :                             :           +- Sort [cs_bill_customer_sk#75 ASC NULLS FIRST], false, 0
         :     :     :                             :              +- Exchange hashpartitioning(cs_bill_customer_sk#75, 100), ENSURE_REQUIREMENTS, [plan_id=38]
         :     :     :                             :                 +- Filter (isnotnull(cs_bill_customer_sk#75) AND isnotnull(cs_sold_date_sk#72))
         :     :     :                             :                    +- FileScan parquet [cs_sold_date_sk#72,cs_bill_customer_sk#75,cs_ext_discount_amt#59,cs_ext_sales_price#60,cs_ext_wholesale_cost#58,cs_ext_list_price#57] Batched: true, DataFilters: [isnotnull(cs_bill_customer_sk#75), isnotnull(cs_sold_date_sk#72)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cs_bill_customer_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_bill_customer_sk:int,cs_ext_discount_amt:decimal(7,2),cs_ext_sales_...
         :     :     :                             +- Sort [d_date_sk#73 ASC NULLS FIRST], false, 0
         :     :     :                                +- Exchange hashpartitioning(d_date_sk#73, 100), ENSURE_REQUIREMENTS, [plan_id=39]
         :     :     :                                   +- Filter ((isnotnull(d_year#68) AND (d_year#68 = 2001)) AND isnotnull(d_date_sk#73))
         :     :     :                                      +- FileScan parquet [d_date_sk#73,d_year#68] Batched: true, DataFilters: [isnotnull(d_year#68), (d_year#68 = 2001), isnotnull(d_date_sk#73)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2001), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
         :     :     +- Sort [customer_id#15 ASC NULLS FIRST], false, 0
         :     :        +- Exchange hashpartitioning(customer_id#15, 100), ENSURE_REQUIREMENTS, [plan_id=40]
         :     :           +- HashAggregate(keys=[c_customer_id#76, c_first_name#81, c_last_name#82, c_preferred_cust_flag#83, c_birth_country#84, c_login#85, c_email_address#86, d_year#87], functions=[sum(((((cs_ext_list_price#77 - cs_ext_wholesale_cost#78) - cs_ext_discount_amt#79) + cs_ext_sales_price#80) / 2))], output=[customer_id#15, year_total#11])
         :     :              +- Exchange hashpartitioning(c_customer_id#76, c_first_name#81, c_last_name#82, c_preferred_cust_flag#83, c_birth_country#84, c_login#85, c_email_address#86, d_year#87, 100), ENSURE_REQUIREMENTS, [plan_id=41]
         :     :                 +- HashAggregate(keys=[c_customer_id#76, c_first_name#81, c_last_name#82, c_preferred_cust_flag#83, c_birth_country#84, c_login#85, c_email_address#86, d_year#87], functions=[partial_sum(((((cs_ext_list_price#77 - cs_ext_wholesale_cost#78) - cs_ext_discount_amt#79) + cs_ext_sales_price#80) / 2))], output=[c_customer_id#76, c_first_name#81, c_last_name#82, c_preferred_cust_flag#83, c_birth_country#84, c_login#85, c_email_address#86, d_year#87, sum#138, isEmpty#139])
         :     :                    +- Project [c_customer_id#76, c_first_name#81, c_last_name#82, c_preferred_cust_flag#83, c_birth_country#84, c_login#85, c_email_address#86, cs_ext_discount_amt#79, cs_ext_sales_price#80, cs_ext_wholesale_cost#78, cs_ext_list_price#77, d_year#87]
         :     :                       +- SortMergeJoin [cs_sold_date_sk#91], [d_date_sk#92], Inner
         :     :                          :- Sort [cs_sold_date_sk#91 ASC NULLS FIRST], false, 0
         :     :                          :  +- Exchange hashpartitioning(cs_sold_date_sk#91, 100), ENSURE_REQUIREMENTS, [plan_id=42]
         :     :                          :     +- Project [c_customer_id#76, c_first_name#81, c_last_name#82, c_preferred_cust_flag#83, c_birth_country#84, c_login#85, c_email_address#86, cs_sold_date_sk#91, cs_ext_discount_amt#79, cs_ext_sales_price#80, cs_ext_wholesale_cost#78, cs_ext_list_price#77]
         :     :                          :        +- SortMergeJoin [c_customer_sk#140], [cs_bill_customer_sk#141], Inner
         :     :                          :           :- Sort [c_customer_sk#140 ASC NULLS FIRST], false, 0
         :     :                          :           :  +- Exchange hashpartitioning(c_customer_sk#140, 100), ENSURE_REQUIREMENTS, [plan_id=43]
         :     :                          :           :     +- Filter (isnotnull(c_customer_sk#140) AND isnotnull(c_customer_id#76))
         :     :                          :           :        +- FileScan parquet [c_customer_sk#140,c_customer_id#76,c_first_name#81,c_last_name#82,c_preferred_cust_flag#83,c_birth_country#84,c_login#85,c_email_address#86] Batched: true, DataFilters: [isnotnull(c_customer_sk#140), isnotnull(c_customer_id#76)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_customer_id)], ReadSchema: struct<c_customer_sk:int,c_customer_id:string,c_first_name:string,c_last_name:string,c_preferred_...
         :     :                          :           +- Sort [cs_bill_customer_sk#141 ASC NULLS FIRST], false, 0
         :     :                          :              +- Exchange hashpartitioning(cs_bill_customer_sk#141, 100), ENSURE_REQUIREMENTS, [plan_id=44]
         :     :                          :                 +- Filter (isnotnull(cs_bill_customer_sk#141) AND isnotnull(cs_sold_date_sk#91))
         :     :                          :                    +- FileScan parquet [cs_sold_date_sk#91,cs_bill_customer_sk#141,cs_ext_discount_amt#79,cs_ext_sales_price#80,cs_ext_wholesale_cost#78,cs_ext_list_price#77] Batched: true, DataFilters: [isnotnull(cs_bill_customer_sk#141), isnotnull(cs_sold_date_sk#91)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cs_bill_customer_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_bill_customer_sk:int,cs_ext_discount_amt:decimal(7,2),cs_ext_sales_...
         :     :                          +- Sort [d_date_sk#92 ASC NULLS FIRST], false, 0
         :     :                             +- Exchange hashpartitioning(d_date_sk#92, 100), ENSURE_REQUIREMENTS, [plan_id=45]
         :     :                                +- Filter ((isnotnull(d_year#87) AND (d_year#87 = 2002)) AND isnotnull(d_date_sk#92))
         :     :                                   +- FileScan parquet [d_date_sk#92,d_year#87] Batched: true, DataFilters: [isnotnull(d_year#87), (d_year#87 = 2002), isnotnull(d_date_sk#92)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2002), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
         :     +- Sort [customer_id#14 ASC NULLS FIRST], false, 0
         :        +- Exchange hashpartitioning(customer_id#14, 100), ENSURE_REQUIREMENTS, [plan_id=46]
         :           +- Filter (isnotnull(year_total#12) AND (year_total#12 > 0.000000))
         :              +- HashAggregate(keys=[c_customer_id#93, c_first_name#99, c_last_name#100, c_preferred_cust_flag#101, c_birth_country#102, c_login#103, c_email_address#104, d_year#105], functions=[sum(((((ws_ext_list_price#94 - ws_ext_wholesale_cost#95) - ws_ext_discount_amt#96) + ws_ext_sales_price#97) / 2))], output=[customer_id#14, year_total#12])
         :                 +- Exchange hashpartitioning(c_customer_id#93, c_first_name#99, c_last_name#100, c_preferred_cust_flag#101, c_birth_country#102, c_login#103, c_email_address#104, d_year#105, 100), ENSURE_REQUIREMENTS, [plan_id=47]
         :                    +- HashAggregate(keys=[c_customer_id#93, c_first_name#99, c_last_name#100, c_preferred_cust_flag#101, c_birth_country#102, c_login#103, c_email_address#104, d_year#105], functions=[partial_sum(((((ws_ext_list_price#94 - ws_ext_wholesale_cost#95) - ws_ext_discount_amt#96) + ws_ext_sales_price#97) / 2))], output=[c_customer_id#93, c_first_name#99, c_last_name#100, c_preferred_cust_flag#101, c_birth_country#102, c_login#103, c_email_address#104, d_year#105, sum#142, isEmpty#143])
         :                       +- Project [c_customer_id#93, c_first_name#99, c_last_name#100, c_preferred_cust_flag#101, c_birth_country#102, c_login#103, c_email_address#104, ws_ext_discount_amt#96, ws_ext_sales_price#97, ws_ext_wholesale_cost#95, ws_ext_list_price#94, d_year#105]
         :                          +- SortMergeJoin [ws_sold_date_sk#109], [d_date_sk#110], Inner
         :                             :- Sort [ws_sold_date_sk#109 ASC NULLS FIRST], false, 0
         :                             :  +- Exchange hashpartitioning(ws_sold_date_sk#109, 100), ENSURE_REQUIREMENTS, [plan_id=48]
         :                             :     +- Project [c_customer_id#93, c_first_name#99, c_last_name#100, c_preferred_cust_flag#101, c_birth_country#102, c_login#103, c_email_address#104, ws_sold_date_sk#109, ws_ext_discount_amt#96, ws_ext_sales_price#97, ws_ext_wholesale_cost#95, ws_ext_list_price#94]
         :                             :        +- SortMergeJoin [c_customer_sk#111], [ws_bill_customer_sk#112], Inner
         :                             :           :- Sort [c_customer_sk#111 ASC NULLS FIRST], false, 0
         :                             :           :  +- Exchange hashpartitioning(c_customer_sk#111, 100), ENSURE_REQUIREMENTS, [plan_id=49]
         :                             :           :     +- Filter (isnotnull(c_customer_sk#111) AND isnotnull(c_customer_id#93))
         :                             :           :        +- FileScan parquet [c_customer_sk#111,c_customer_id#93,c_first_name#99,c_last_name#100,c_preferred_cust_flag#101,c_birth_country#102,c_login#103,c_email_address#104] Batched: true, DataFilters: [isnotnull(c_customer_sk#111), isnotnull(c_customer_id#93)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_customer_id)], ReadSchema: struct<c_customer_sk:int,c_customer_id:string,c_first_name:string,c_last_name:string,c_preferred_...
         :                             :           +- Sort [ws_bill_customer_sk#112 ASC NULLS FIRST], false, 0
         :                             :              +- Exchange hashpartitioning(ws_bill_customer_sk#112, 100), ENSURE_REQUIREMENTS, [plan_id=50]
         :                             :                 +- Filter (isnotnull(ws_bill_customer_sk#112) AND isnotnull(ws_sold_date_sk#109))
         :                             :                    +- FileScan parquet [ws_sold_date_sk#109,ws_bill_customer_sk#112,ws_ext_discount_amt#96,ws_ext_sales_price#97,ws_ext_wholesale_cost#95,ws_ext_list_price#94] Batched: true, DataFilters: [isnotnull(ws_bill_customer_sk#112), isnotnull(ws_sold_date_sk#109)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ws_bill_customer_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_bill_customer_sk:int,ws_ext_discount_amt:decimal(7,2),ws_ext_sales_...
         :                             +- Sort [d_date_sk#110 ASC NULLS FIRST], false, 0
         :                                +- Exchange hashpartitioning(d_date_sk#110, 100), ENSURE_REQUIREMENTS, [plan_id=51]
         :                                   +- Filter ((isnotnull(d_year#105) AND (d_year#105 = 2001)) AND isnotnull(d_date_sk#110))
         :                                      +- FileScan parquet [d_date_sk#110,d_year#105] Batched: true, DataFilters: [isnotnull(d_year#105), (d_year#105 = 2001), isnotnull(d_date_sk#110)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2001), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
         +- Sort [customer_id#9 ASC NULLS FIRST], false, 0
            +- Exchange hashpartitioning(customer_id#9, 100), ENSURE_REQUIREMENTS, [plan_id=52]
               +- HashAggregate(keys=[c_customer_id#113, c_first_name#118, c_last_name#119, c_preferred_cust_flag#120, c_birth_country#121, c_login#122, c_email_address#123, d_year#124], functions=[sum(((((ws_ext_list_price#114 - ws_ext_wholesale_cost#115) - ws_ext_discount_amt#116) + ws_ext_sales_price#117) / 2))], output=[customer_id#9, year_total#13])
                  +- Exchange hashpartitioning(c_customer_id#113, c_first_name#118, c_last_name#119, c_preferred_cust_flag#120, c_birth_country#121, c_login#122, c_email_address#123, d_year#124, 100), ENSURE_REQUIREMENTS, [plan_id=53]
                     +- HashAggregate(keys=[c_customer_id#113, c_first_name#118, c_last_name#119, c_preferred_cust_flag#120, c_birth_country#121, c_login#122, c_email_address#123, d_year#124], functions=[partial_sum(((((ws_ext_list_price#114 - ws_ext_wholesale_cost#115) - ws_ext_discount_amt#116) + ws_ext_sales_price#117) / 2))], output=[c_customer_id#113, c_first_name#118, c_last_name#119, c_preferred_cust_flag#120, c_birth_country#121, c_login#122, c_email_address#123, d_year#124, sum#144, isEmpty#145])
                        +- Project [c_customer_id#113, c_first_name#118, c_last_name#119, c_preferred_cust_flag#120, c_birth_country#121, c_login#122, c_email_address#123, ws_ext_discount_amt#116, ws_ext_sales_price#117, ws_ext_wholesale_cost#115, ws_ext_list_price#114, d_year#124]
                           +- SortMergeJoin [ws_sold_date_sk#128], [d_date_sk#129], Inner
                              :- Sort [ws_sold_date_sk#128 ASC NULLS FIRST], false, 0
                              :  +- Exchange hashpartitioning(ws_sold_date_sk#128, 100), ENSURE_REQUIREMENTS, [plan_id=54]
                              :     +- Project [c_customer_id#113, c_first_name#118, c_last_name#119, c_preferred_cust_flag#120, c_birth_country#121, c_login#122, c_email_address#123, ws_sold_date_sk#128, ws_ext_discount_amt#116, ws_ext_sales_price#117, ws_ext_wholesale_cost#115, ws_ext_list_price#114]
                              :        +- SortMergeJoin [c_customer_sk#146], [ws_bill_customer_sk#147], Inner
                              :           :- Sort [c_customer_sk#146 ASC NULLS FIRST], false, 0
                              :           :  +- Exchange hashpartitioning(c_customer_sk#146, 100), ENSURE_REQUIREMENTS, [plan_id=55]
                              :           :     +- Filter (isnotnull(c_customer_sk#146) AND isnotnull(c_customer_id#113))
                              :           :        +- FileScan parquet [c_customer_sk#146,c_customer_id#113,c_first_name#118,c_last_name#119,c_preferred_cust_flag#120,c_birth_country#121,c_login#122,c_email_address#123] Batched: true, DataFilters: [isnotnull(c_customer_sk#146), isnotnull(c_customer_id#113)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_customer_id)], ReadSchema: struct<c_customer_sk:int,c_customer_id:string,c_first_name:string,c_last_name:string,c_preferred_...
                              :           +- Sort [ws_bill_customer_sk#147 ASC NULLS FIRST], false, 0
                              :              +- Exchange hashpartitioning(ws_bill_customer_sk#147, 100), ENSURE_REQUIREMENTS, [plan_id=56]
                              :                 +- Filter (isnotnull(ws_bill_customer_sk#147) AND isnotnull(ws_sold_date_sk#128))
                              :                    +- FileScan parquet [ws_sold_date_sk#128,ws_bill_customer_sk#147,ws_ext_discount_amt#116,ws_ext_sales_price#117,ws_ext_wholesale_cost#115,ws_ext_list_price#114] Batched: true, DataFilters: [isnotnull(ws_bill_customer_sk#147), isnotnull(ws_sold_date_sk#128)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ws_bill_customer_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_bill_customer_sk:int,ws_ext_discount_amt:decimal(7,2),ws_ext_sales_...
                              +- Sort [d_date_sk#129 ASC NULLS FIRST], false, 0
                                 +- Exchange hashpartitioning(d_date_sk#129, 100), ENSURE_REQUIREMENTS, [plan_id=57]
                                    +- Filter ((isnotnull(d_year#124) AND (d_year#124 = 2002)) AND isnotnull(d_date_sk#129))
                                       +- FileScan parquet [d_date_sk#129,d_year#124] Batched: true, DataFilters: [isnotnull(d_year#124), (d_year#124 = 2002), isnotnull(d_date_sk#129)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2002), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
