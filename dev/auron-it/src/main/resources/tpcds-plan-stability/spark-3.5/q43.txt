AdaptiveSparkPlan isFinalPlan=true
+- == Final Plan ==
   NativeTakeOrdered 100, [s_store_name#1 ASC NULLS FIRST, s_store_id#2 ASC NULLS FIRST, sun_sales#3 ASC NULLS FIRST, mon_sales#4 ASC NULLS FIRST, tue_sales#5 ASC NULLS FIRST, wed_sales#6 ASC NULLS FIRST, thu_sales#7 ASC NULLS FIRST, fri_sales#8 ASC NULLS FIRST, sat_sales#9 ASC NULLS FIRST]
   +- NativeProject [s_store_name#1, s_store_id#2, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#10 = Sunday) THEN ss_sales_price#11 END))#12,17,2) AS sun_sales#3, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#10 = Monday) THEN ss_sales_price#11 END))#13,17,2) AS mon_sales#4, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#10 = Tuesday) THEN ss_sales_price#11 END))#14,17,2) AS tue_sales#5, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#10 = Wednesday) THEN ss_sales_price#11 END))#15,17,2) AS wed_sales#6, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#10 = Thursday) THEN ss_sales_price#11 END))#16,17,2) AS thu_sales#7, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#10 = Friday) THEN ss_sales_price#11 END))#17,17,2) AS fri_sales#8, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#10 = Saturday) THEN ss_sales_price#11 END))#18,17,2) AS sat_sales#9]
      +- NativeHashAggregate HashAgg, ArrayBuffer(s_store_name#1, s_store_id#2), [s_store_name#1, s_store_id#2], [sum(UnscaledValue(CASE WHEN (d_day_name#10 = Sunday) THEN ss_sales_price#11 END)), sum(UnscaledValue(CASE WHEN (d_day_name#10 = Monday) THEN ss_sales_price#11 END)), sum(UnscaledValue(CASE WHEN (d_day_name#10 = Tuesday) THEN ss_sales_price#11 END)), sum(UnscaledValue(CASE WHEN (d_day_name#10 = Wednesday) THEN ss_sales_price#11 END)), sum(UnscaledValue(CASE WHEN (d_day_name#10 = Thursday) THEN ss_sales_price#11 END)), sum(UnscaledValue(CASE WHEN (d_day_name#10 = Friday) THEN ss_sales_price#11 END)), sum(UnscaledValue(CASE WHEN (d_day_name#10 = Saturday) THEN ss_sales_price#11 END))], [sum(UnscaledValue(CASE WHEN (d_day_name#10 = Sunday) THEN ss_sales_price#11 END))#12, sum(UnscaledValue(CASE WHEN (d_day_name#10 = Monday) THEN ss_sales_price#11 END))#13, sum(UnscaledValue(CASE WHEN (d_day_name#10 = Tuesday) THEN ss_sales_price#11 END))#14, sum(UnscaledValue(CASE WHEN (d_day_name#10 = Wednesday) THEN ss_sales_price#11 END))#15, sum(UnscaledValue(CASE WHEN (d_day_name#10 = Thursday) THEN ss_sales_price#11 END))#16, sum(UnscaledValue(CASE WHEN (d_day_name#10 = Friday) THEN ss_sales_price#11 END))#17, sum(UnscaledValue(CASE WHEN (d_day_name#10 = Saturday) THEN ss_sales_price#11 END))#18], 2
         +- InputAdapter
            +- AQEShuffleRead coalesced
               +- ShuffleQueryStage 4
                  +- NativeShuffleExchange hashpartitioning(s_store_name#1, s_store_id#2, 100), ENSURE_REQUIREMENTS, [plan_id=1]
                     +- NativeHashAggregate HashAgg, [s_store_name#1, s_store_id#2], [partial_sum(_c2#19), partial_sum(_c3#20), partial_sum(_c4#21), partial_sum(_c5#22), partial_sum(_c6#23), partial_sum(_c7#24), partial_sum(_c8#25)], [sum#26, sum#27, sum#28, sum#29, sum#30, sum#31, sum#32], 0
                        +- NativeProject [s_store_name#1 AS s_store_name#1, s_store_id#2 AS s_store_id#2, UnscaledValue(CASE WHEN (d_day_name#10 = Sunday) THEN ss_sales_price#11 END) AS _c2#19, UnscaledValue(CASE WHEN (d_day_name#10 = Monday) THEN ss_sales_price#11 END) AS _c3#20, UnscaledValue(CASE WHEN (d_day_name#10 = Tuesday) THEN ss_sales_price#11 END) AS _c4#21, UnscaledValue(CASE WHEN (d_day_name#10 = Wednesday) THEN ss_sales_price#11 END) AS _c5#22, UnscaledValue(CASE WHEN (d_day_name#10 = Thursday) THEN ss_sales_price#11 END) AS _c6#23, UnscaledValue(CASE WHEN (d_day_name#10 = Friday) THEN ss_sales_price#11 END) AS _c7#24, UnscaledValue(CASE WHEN (d_day_name#10 = Saturday) THEN ss_sales_price#11 END) AS _c8#25]
                           +- NativeProject [d_day_name#10, ss_sales_price#11, s_store_id#2, s_store_name#1]
                              +- NativeSortMergeJoin [ss_store_sk#33], [s_store_sk#34], Inner
                                 :- NativeSort [ss_store_sk#33 ASC NULLS FIRST], false
                                 :  +- InputAdapter
                                 :     +- AQEShuffleRead coalesced
                                 :        +- ShuffleQueryStage 3
                                 :           +- NativeShuffleExchange hashpartitioning(ss_store_sk#33, 100), ENSURE_REQUIREMENTS, [plan_id=2]
                                 :              +- NativeProject [d_day_name#10, ss_store_sk#33, ss_sales_price#11]
                                 :                 +- NativeSortMergeJoin [d_date_sk#35], [ss_sold_date_sk#36], Inner
                                 :                    :- NativeSort [d_date_sk#35 ASC NULLS FIRST], false
                                 :                    :  +- InputAdapter
                                 :                    :     +- AQEShuffleRead coalesced
                                 :                    :        +- ShuffleQueryStage 0
                                 :                    :           +- NativeShuffleExchange hashpartitioning(d_date_sk#35, 100), ENSURE_REQUIREMENTS, [plan_id=3]
                                 :                    :              +- NativeProject [d_date_sk#35, d_day_name#10]
                                 :                    :                 +- NativeFilter ((isnotnull(d_year#37) AND (d_year#37 = 2000)) AND isnotnull(d_date_sk#35))
                                 :                    :                    +- InputAdapter [#35, #37, #10]
                                 :                    :                       +- NativeParquetScan  (FileScan parquet [d_date_sk#35,d_year#37,d_day_name#10] Batched: true, DataFilters: [isnotnull(d_year#37), (d_year#37 = 2000), isnotnull(d_date_sk#35)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2000), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_day_name:string>)
                                 :                    +- NativeSort [ss_sold_date_sk#36 ASC NULLS FIRST], false
                                 :                       +- InputAdapter
                                 :                          +- AQEShuffleRead coalesced
                                 :                             +- ShuffleQueryStage 1
                                 :                                +- NativeShuffleExchange hashpartitioning(ss_sold_date_sk#36, 100), ENSURE_REQUIREMENTS, [plan_id=4]
                                 :                                   +- NativeFilter (isnotnull(ss_sold_date_sk#36) AND isnotnull(ss_store_sk#33))
                                 :                                      +- InputAdapter [#36, #33, #11]
                                 :                                         +- NativeParquetScan  (FileScan parquet [ss_sold_date_sk#36,ss_store_sk#33,ss_sales_price#11] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#36), isnotnull(ss_store_sk#33)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_store_sk:int,ss_sales_price:decimal(7,2)>)
                                 +- NativeSort [s_store_sk#34 ASC NULLS FIRST], false
                                    +- InputAdapter
                                       +- AQEShuffleRead coalesced
                                          +- ShuffleQueryStage 2
                                             +- NativeShuffleExchange hashpartitioning(s_store_sk#34, 100), ENSURE_REQUIREMENTS, [plan_id=5]
                                                +- NativeProject [s_store_sk#34, s_store_id#2, s_store_name#1]
                                                   +- NativeFilter ((isnotnull(s_gmt_offset#38) AND (s_gmt_offset#38 = -5.00)) AND isnotnull(s_store_sk#34))
                                                      +- InputAdapter [#34, #2, #1, #38]
                                                         +- NativeParquetScan  (FileScan parquet [s_store_sk#34,s_store_id#2,s_store_name#1,s_gmt_offset#38] Batched: true, DataFilters: [isnotnull(s_gmt_offset#38), (s_gmt_offset#38 = -5.00), isnotnull(s_store_sk#34)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(s_gmt_offset), EqualTo(s_gmt_offset,-5.00), IsNotNull(s_store_sk)], ReadSchema: struct<s_store_sk:int,s_store_id:string,s_store_name:string,s_gmt_offset:decimal(5,2)>)
+- == Initial Plan ==
   TakeOrderedAndProject(limit=100, orderBy=[s_store_name#1 ASC NULLS FIRST,s_store_id#2 ASC NULLS FIRST,sun_sales#3 ASC NULLS FIRST,mon_sales#4 ASC NULLS FIRST,tue_sales#5 ASC NULLS FIRST,wed_sales#6 ASC NULLS FIRST,thu_sales#7 ASC NULLS FIRST,fri_sales#8 ASC NULLS FIRST,sat_sales#9 ASC NULLS FIRST], output=[s_store_name#1,s_store_id#2,sun_sales#3,mon_sales#4,tue_sales#5,wed_sales#6,thu_sales#7,fri_sales#8,sat_sales#9])
   +- HashAggregate(keys=[s_store_name#1, s_store_id#2], functions=[sum(UnscaledValue(CASE WHEN (d_day_name#10 = Sunday) THEN ss_sales_price#11 END)), sum(UnscaledValue(CASE WHEN (d_day_name#10 = Monday) THEN ss_sales_price#11 END)), sum(UnscaledValue(CASE WHEN (d_day_name#10 = Tuesday) THEN ss_sales_price#11 END)), sum(UnscaledValue(CASE WHEN (d_day_name#10 = Wednesday) THEN ss_sales_price#11 END)), sum(UnscaledValue(CASE WHEN (d_day_name#10 = Thursday) THEN ss_sales_price#11 END)), sum(UnscaledValue(CASE WHEN (d_day_name#10 = Friday) THEN ss_sales_price#11 END)), sum(UnscaledValue(CASE WHEN (d_day_name#10 = Saturday) THEN ss_sales_price#11 END))], output=[s_store_name#1, s_store_id#2, sun_sales#3, mon_sales#4, tue_sales#5, wed_sales#6, thu_sales#7, fri_sales#8, sat_sales#9])
      +- Exchange hashpartitioning(s_store_name#1, s_store_id#2, 100), ENSURE_REQUIREMENTS, [plan_id=6]
         +- HashAggregate(keys=[s_store_name#1, s_store_id#2], functions=[partial_sum(UnscaledValue(CASE WHEN (d_day_name#10 = Sunday) THEN ss_sales_price#11 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#10 = Monday) THEN ss_sales_price#11 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#10 = Tuesday) THEN ss_sales_price#11 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#10 = Wednesday) THEN ss_sales_price#11 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#10 = Thursday) THEN ss_sales_price#11 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#10 = Friday) THEN ss_sales_price#11 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#10 = Saturday) THEN ss_sales_price#11 END))], output=[s_store_name#1, s_store_id#2, sum#39, sum#40, sum#41, sum#42, sum#43, sum#44, sum#45])
            +- Project [d_day_name#10, ss_sales_price#11, s_store_id#2, s_store_name#1]
               +- SortMergeJoin [ss_store_sk#33], [s_store_sk#34], Inner
                  :- Sort [ss_store_sk#33 ASC NULLS FIRST], false, 0
                  :  +- Exchange hashpartitioning(ss_store_sk#33, 100), ENSURE_REQUIREMENTS, [plan_id=7]
                  :     +- Project [d_day_name#10, ss_store_sk#33, ss_sales_price#11]
                  :        +- SortMergeJoin [d_date_sk#35], [ss_sold_date_sk#36], Inner
                  :           :- Sort [d_date_sk#35 ASC NULLS FIRST], false, 0
                  :           :  +- Exchange hashpartitioning(d_date_sk#35, 100), ENSURE_REQUIREMENTS, [plan_id=8]
                  :           :     +- Project [d_date_sk#35, d_day_name#10]
                  :           :        +- Filter ((isnotnull(d_year#37) AND (d_year#37 = 2000)) AND isnotnull(d_date_sk#35))
                  :           :           +- FileScan parquet [d_date_sk#35,d_year#37,d_day_name#10] Batched: true, DataFilters: [isnotnull(d_year#37), (d_year#37 = 2000), isnotnull(d_date_sk#35)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2000), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_day_name:string>
                  :           +- Sort [ss_sold_date_sk#36 ASC NULLS FIRST], false, 0
                  :              +- Exchange hashpartitioning(ss_sold_date_sk#36, 100), ENSURE_REQUIREMENTS, [plan_id=9]
                  :                 +- Filter (isnotnull(ss_sold_date_sk#36) AND isnotnull(ss_store_sk#33))
                  :                    +- FileScan parquet [ss_sold_date_sk#36,ss_store_sk#33,ss_sales_price#11] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#36), isnotnull(ss_store_sk#33)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_store_sk:int,ss_sales_price:decimal(7,2)>
                  +- Sort [s_store_sk#34 ASC NULLS FIRST], false, 0
                     +- Exchange hashpartitioning(s_store_sk#34, 100), ENSURE_REQUIREMENTS, [plan_id=10]
                        +- Project [s_store_sk#34, s_store_id#2, s_store_name#1]
                           +- Filter ((isnotnull(s_gmt_offset#38) AND (s_gmt_offset#38 = -5.00)) AND isnotnull(s_store_sk#34))
                              +- FileScan parquet [s_store_sk#34,s_store_id#2,s_store_name#1,s_gmt_offset#38] Batched: true, DataFilters: [isnotnull(s_gmt_offset#38), (s_gmt_offset#38 = -5.00), isnotnull(s_store_sk#34)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(s_gmt_offset), EqualTo(s_gmt_offset,-5.00), IsNotNull(s_store_sk)], ReadSchema: struct<s_store_sk:int,s_store_id:string,s_store_name:string,s_gmt_offset:decimal(5,2)>
