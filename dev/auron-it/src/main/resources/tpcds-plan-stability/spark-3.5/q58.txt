AdaptiveSparkPlan isFinalPlan=true
+- == Final Plan ==
   TakeOrderedAndProject(limit=100, orderBy=[item_id#1 ASC NULLS FIRST,ss_item_rev#2 ASC NULLS FIRST], output=[item_id#1,ss_item_rev#2,ss_dev#3,cs_item_rev#4,cs_dev#5,ws_item_rev#6,ws_dev#7,average#8])
   +- *(2) Project [item_id#1, ss_item_rev#2, (((ss_item_rev#2 / ((ss_item_rev#2 + cs_item_rev#4) + ws_item_rev#6)) / 3) * 100) AS ss_dev#3, cs_item_rev#4, (((cs_item_rev#4 / ((ss_item_rev#2 + cs_item_rev#4) + ws_item_rev#6)) / 3) * 100) AS cs_dev#5, ws_item_rev#6, (((ws_item_rev#6 / ((ss_item_rev#2 + cs_item_rev#4) + ws_item_rev#6)) / 3) * 100) AS ws_dev#7, (((ss_item_rev#2 + cs_item_rev#4) + ws_item_rev#6) / 3) AS average#8]
      +- *(2) SortMergeJoin [item_id#1], [item_id#9], Inner, ((((((((cast(ss_item_rev#2 as decimal(19,3)) >= (0.9 * ws_item_rev#6)) AND (cast(ss_item_rev#2 as decimal(20,3)) <= (1.1 * ws_item_rev#6))) AND (cast(cs_item_rev#4 as decimal(19,3)) >= (0.9 * ws_item_rev#6))) AND (cast(cs_item_rev#4 as decimal(20,3)) <= (1.1 * ws_item_rev#6))) AND (cast(ws_item_rev#6 as decimal(19,3)) >= (0.9 * ss_item_rev#2))) AND (cast(ws_item_rev#6 as decimal(20,3)) <= (1.1 * ss_item_rev#2))) AND (cast(ws_item_rev#6 as decimal(19,3)) >= (0.9 * cs_item_rev#4))) AND (cast(ws_item_rev#6 as decimal(20,3)) <= (1.1 * cs_item_rev#4)))
         :- *(1) Project [item_id#1, ss_item_rev#2, cs_item_rev#4]
         :  +- *(1) SortMergeJoin [item_id#1], [item_id#10], Inner, ((((cast(ss_item_rev#2 as decimal(19,3)) >= (0.9 * cs_item_rev#4)) AND (cast(ss_item_rev#2 as decimal(20,3)) <= (1.1 * cs_item_rev#4))) AND (cast(cs_item_rev#4 as decimal(19,3)) >= (0.9 * ss_item_rev#2))) AND (cast(cs_item_rev#4 as decimal(20,3)) <= (1.1 * ss_item_rev#2)))
         :     :- NativeSort [item_id#1 ASC NULLS FIRST], false
         :     :  +- NativeFilter isnotnull(ss_item_rev#2)
         :     :     +- NativeProject [i_item_id#11 AS item_id#1, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#12))#13,17,2) AS ss_item_rev#2]
         :     :        +- NativeHashAggregate HashAgg, ArrayBuffer(i_item_id#11), [i_item_id#11], [sum(UnscaledValue(ss_ext_sales_price#12))], [sum(UnscaledValue(ss_ext_sales_price#12))#13], 1
         :     :           +- InputAdapter
         :     :              +- AQEShuffleRead coalesced
         :     :                 +- ShuffleQueryStage X
         :     :                    +- NativeShuffleExchange hashpartitioning(i_item_id#11, 100), ENSURE_REQUIREMENTS, [plan_id=1]
         :     :                       +- NativeHashAggregate HashAgg, [i_item_id#11], [partial_sum(_c1#14)], [sum#15], 0
         :     :                          +- NativeProject [i_item_id#11 AS i_item_id#11, UnscaledValue(ss_ext_sales_price#12) AS _c1#14]
         :     :                             +- NativeProject [ss_ext_sales_price#12, i_item_id#11]
         :     :                                +- NativeSortMergeJoin [ss_sold_date_sk#16], [d_date_sk#17], Inner
         :     :                                   :- NativeSort [ss_sold_date_sk#16 ASC NULLS FIRST], false
         :     :                                   :  +- InputAdapter
         :     :                                   :     +- AQEShuffleRead coalesced
         :     :                                   :        +- ShuffleQueryStage X
         :     :                                   :           +- NativeShuffleExchange hashpartitioning(ss_sold_date_sk#16, 100), ENSURE_REQUIREMENTS, [plan_id=2]
         :     :                                   :              +- NativeProject [ss_sold_date_sk#16, ss_ext_sales_price#12, i_item_id#11]
         :     :                                   :                 +- NativeSortMergeJoin [ss_item_sk#18], [i_item_sk#19], Inner
         :     :                                   :                    :- NativeSort [ss_item_sk#18 ASC NULLS FIRST], false
         :     :                                   :                    :  +- InputAdapter
         :     :                                   :                    :     +- AQEShuffleRead coalesced
         :     :                                   :                    :        +- ShuffleQueryStage X
         :     :                                   :                    :           +- NativeShuffleExchange hashpartitioning(ss_item_sk#18, 100), ENSURE_REQUIREMENTS, [plan_id=3]
         :     :                                   :                    :              +- NativeFilter (isnotnull(ss_item_sk#18) AND isnotnull(ss_sold_date_sk#16))
         :     :                                   :                    :                 +- InputAdapter [#16, #18, #12]
         :     :                                   :                    :                    +- NativeParquetScan  (FileScan parquet [ss_sold_date_sk#16,ss_item_sk#18,ss_ext_sales_price#12] Batched: true, DataFilters: [isnotnull(ss_item_sk#18), isnotnull(ss_sold_date_sk#16)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_ext_sales_price:decimal(7,2)>)
         :     :                                   :                    +- NativeSort [i_item_sk#19 ASC NULLS FIRST], false
         :     :                                   :                       +- InputAdapter
         :     :                                   :                          +- AQEShuffleRead coalesced
         :     :                                   :                             +- ShuffleQueryStage X
         :     :                                   :                                +- NativeShuffleExchange hashpartitioning(i_item_sk#19, 100), ENSURE_REQUIREMENTS, [plan_id=4]
         :     :                                   :                                   +- NativeFilter (isnotnull(i_item_sk#19) AND isnotnull(i_item_id#11))
         :     :                                   :                                      +- InputAdapter [#19, #11]
         :     :                                   :                                         +- NativeParquetScan  (FileScan parquet [i_item_sk#19,i_item_id#11] Batched: true, DataFilters: [isnotnull(i_item_sk#19), isnotnull(i_item_id#11)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_item_id)], ReadSchema: struct<i_item_sk:int,i_item_id:string>)
         :     :                                   +- NativeSort [d_date_sk#17 ASC NULLS FIRST], false
         :     :                                      +- InputAdapter
         :     :                                         +- AQEShuffleRead coalesced
         :     :                                            +- ShuffleQueryStage X
         :     :                                               +- NativeShuffleExchange hashpartitioning(d_date_sk#17, 100), ENSURE_REQUIREMENTS, [plan_id=5]
         :     :                                                  +- NativeProject [d_date_sk#17]
         :     :                                                     +- NativeSortMergeJoin [d_date#20], [d_date#21], LeftSemi
         :     :                                                        :- NativeSort [d_date#20 ASC NULLS FIRST], false
         :     :                                                        :  +- InputAdapter
         :     :                                                        :     +- AQEShuffleRead coalesced
         :     :                                                        :        +- ShuffleQueryStage X
         :     :                                                        :           +- NativeShuffleExchange hashpartitioning(d_date#20, 100), ENSURE_REQUIREMENTS, [plan_id=6]
         :     :                                                        :              +- NativeFilter isnotnull(d_date_sk#17)
         :     :                                                        :                 +- InputAdapter [#17, #20]
         :     :                                                        :                    +- NativeParquetScan  (FileScan parquet [d_date_sk#17,d_date#20] Batched: true, DataFilters: [isnotnull(d_date_sk#17)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_date:date>)
         :     :                                                        +- NativeSort [d_date#21 ASC NULLS FIRST], false
         :     :                                                           +- InputAdapter
         :     :                                                              +- AQEShuffleRead coalesced
         :     :                                                                 +- ShuffleQueryStage X
         :     :                                                                    +- NativeShuffleExchange hashpartitioning(d_date#21, 100), ENSURE_REQUIREMENTS, [plan_id=7]
         :     :                                                                       +- NativeProject [d_date#21]
         :     :                                                                          +- NativeFilter (isnotnull(d_week_seq#22) AND (d_week_seq#22 = Subquery subquery#23, [id=#24]))
         :     :                                                                             :  +- Subquery subquery#23, [id=#24]
         :     :                                                                             :     +- AdaptiveSparkPlan isFinalPlan=true
                                                                                                   +- == Final Plan ==
                                                                                                      NativeProject [d_week_seq#25]
                                                                                                      +- NativeFilter (isnotnull(d_date#26) AND (d_date#26 = 2000-01-03))
                                                                                                         +- InputAdapter [#26, #25]
                                                                                                            +- NativeParquetScan  (FileScan parquet [d_date#26,d_week_seq#25] Batched: true, DataFilters: [isnotnull(d_date#26), (d_date#26 = 2000-01-03)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_date), EqualTo(d_date,2000-01-03)], ReadSchema: struct<d_date:date,d_week_seq:int>)
                                                                                                   +- == Initial Plan ==
                                                                                                      Project [d_week_seq#25]
                                                                                                      +- Filter (isnotnull(d_date#26) AND (d_date#26 = 2000-01-03))
                                                                                                         +- FileScan parquet [d_date#26,d_week_seq#25] Batched: true, DataFilters: [isnotnull(d_date#26), (d_date#26 = 2000-01-03)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_date), EqualTo(d_date,2000-01-03)], ReadSchema: struct<d_date:date,d_week_seq:int>
         :     :                                                                             +- InputAdapter [#21, #22]
         :     :                                                                                +- NativeParquetScan  (FileScan parquet [d_date#21,d_week_seq#22] Batched: true, DataFilters: [isnotnull(d_week_seq#22)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_week_seq)], ReadSchema: struct<d_date:date,d_week_seq:int>)
         :     +- NativeSort [item_id#10 ASC NULLS FIRST], false
         :        +- NativeFilter isnotnull(cs_item_rev#4)
         :           +- NativeProject [i_item_id#27 AS item_id#10, MakeDecimal(sum(UnscaledValue(cs_ext_sales_price#28))#29,17,2) AS cs_item_rev#4]
         :              +- NativeHashAggregate HashAgg, ArrayBuffer(i_item_id#27), [i_item_id#27], [sum(UnscaledValue(cs_ext_sales_price#28))], [sum(UnscaledValue(cs_ext_sales_price#28))#29], 1
         :                 +- InputAdapter
         :                    +- AQEShuffleRead coalesced
         :                       +- ShuffleQueryStage X
         :                          +- NativeShuffleExchange hashpartitioning(i_item_id#27, 100), ENSURE_REQUIREMENTS, [plan_id=8]
         :                             +- NativeHashAggregate HashAgg, [i_item_id#27], [partial_sum(_c1#30)], [sum#31], 0
         :                                +- NativeProject [i_item_id#27 AS i_item_id#27, UnscaledValue(cs_ext_sales_price#28) AS _c1#30]
         :                                   +- NativeProject [cs_ext_sales_price#28, i_item_id#27]
         :                                      +- NativeSortMergeJoin [cs_sold_date_sk#32], [d_date_sk#33], Inner
         :                                         :- NativeSort [cs_sold_date_sk#32 ASC NULLS FIRST], false
         :                                         :  +- InputAdapter
         :                                         :     +- AQEShuffleRead coalesced
         :                                         :        +- ShuffleQueryStage X
         :                                         :           +- NativeShuffleExchange hashpartitioning(cs_sold_date_sk#32, 100), ENSURE_REQUIREMENTS, [plan_id=9]
         :                                         :              +- NativeProject [cs_sold_date_sk#32, cs_ext_sales_price#28, i_item_id#27]
         :                                         :                 +- NativeSortMergeJoin [cs_item_sk#34], [i_item_sk#35], Inner
         :                                         :                    :- NativeSort [cs_item_sk#34 ASC NULLS FIRST], false
         :                                         :                    :  +- InputAdapter
         :                                         :                    :     +- AQEShuffleRead coalesced
         :                                         :                    :        +- ShuffleQueryStage X
         :                                         :                    :           +- NativeShuffleExchange hashpartitioning(cs_item_sk#34, 100), ENSURE_REQUIREMENTS, [plan_id=10]
         :                                         :                    :              +- NativeFilter (isnotnull(cs_item_sk#34) AND isnotnull(cs_sold_date_sk#32))
         :                                         :                    :                 +- InputAdapter [#32, #34, #28]
         :                                         :                    :                    +- NativeParquetScan  (FileScan parquet [cs_sold_date_sk#32,cs_item_sk#34,cs_ext_sales_price#28] Batched: true, DataFilters: [isnotnull(cs_item_sk#34), isnotnull(cs_sold_date_sk#32)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int,cs_ext_sales_price:decimal(7,2)>)
         :                                         :                    +- NativeSort [i_item_sk#35 ASC NULLS FIRST], false
         :                                         :                       +- InputAdapter
         :                                         :                          +- InputAdapter [#35, #27]
         :                                         :                             +- AQEShuffleRead coalesced
         :                                         :                                +- ShuffleQueryStage X
         :                                         :                                   +- ReusedExchange [i_item_sk#35, i_item_id#27], NativeShuffleExchange hashpartitioning(i_item_sk#19, 100), ENSURE_REQUIREMENTS, [plan_id=4]
         :                                         +- NativeSort [d_date_sk#33 ASC NULLS FIRST], false
         :                                            +- InputAdapter
         :                                               +- InputAdapter [#33]
         :                                                  +- AQEShuffleRead coalesced
         :                                                     +- ShuffleQueryStage X
         :                                                        +- ReusedExchange [d_date_sk#33], NativeShuffleExchange hashpartitioning(d_date_sk#17, 100), ENSURE_REQUIREMENTS, [plan_id=5]
         +- NativeSort [item_id#9 ASC NULLS FIRST], false
            +- NativeFilter isnotnull(ws_item_rev#6)
               +- NativeProject [i_item_id#36 AS item_id#9, MakeDecimal(sum(UnscaledValue(ws_ext_sales_price#37))#38,17,2) AS ws_item_rev#6]
                  +- NativeHashAggregate HashAgg, ArrayBuffer(i_item_id#36), [i_item_id#36], [sum(UnscaledValue(ws_ext_sales_price#37))], [sum(UnscaledValue(ws_ext_sales_price#37))#38], 1
                     +- InputAdapter
                        +- AQEShuffleRead coalesced
                           +- ShuffleQueryStage X
                              +- NativeShuffleExchange hashpartitioning(i_item_id#36, 100), ENSURE_REQUIREMENTS, [plan_id=11]
                                 +- NativeHashAggregate HashAgg, [i_item_id#36], [partial_sum(_c1#39)], [sum#40], 0
                                    +- NativeProject [i_item_id#36 AS i_item_id#36, UnscaledValue(ws_ext_sales_price#37) AS _c1#39]
                                       +- NativeProject [ws_ext_sales_price#37, i_item_id#36]
                                          +- NativeSortMergeJoin [ws_sold_date_sk#41], [d_date_sk#42], Inner
                                             :- NativeSort [ws_sold_date_sk#41 ASC NULLS FIRST], false
                                             :  +- InputAdapter
                                             :     +- AQEShuffleRead coalesced
                                             :        +- ShuffleQueryStage X
                                             :           +- NativeShuffleExchange hashpartitioning(ws_sold_date_sk#41, 100), ENSURE_REQUIREMENTS, [plan_id=12]
                                             :              +- NativeProject [ws_sold_date_sk#41, ws_ext_sales_price#37, i_item_id#36]
                                             :                 +- NativeSortMergeJoin [ws_item_sk#43], [i_item_sk#44], Inner
                                             :                    :- NativeSort [ws_item_sk#43 ASC NULLS FIRST], false
                                             :                    :  +- InputAdapter
                                             :                    :     +- AQEShuffleRead coalesced
                                             :                    :        +- ShuffleQueryStage X
                                             :                    :           +- NativeShuffleExchange hashpartitioning(ws_item_sk#43, 100), ENSURE_REQUIREMENTS, [plan_id=13]
                                             :                    :              +- NativeFilter (isnotnull(ws_item_sk#43) AND isnotnull(ws_sold_date_sk#41))
                                             :                    :                 +- InputAdapter [#41, #43, #37]
                                             :                    :                    +- NativeParquetScan  (FileScan parquet [ws_sold_date_sk#41,ws_item_sk#43,ws_ext_sales_price#37] Batched: true, DataFilters: [isnotnull(ws_item_sk#43), isnotnull(ws_sold_date_sk#41)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int,ws_ext_sales_price:decimal(7,2)>)
                                             :                    +- NativeSort [i_item_sk#44 ASC NULLS FIRST], false
                                             :                       +- InputAdapter
                                             :                          +- InputAdapter [#44, #36]
                                             :                             +- AQEShuffleRead coalesced
                                             :                                +- ShuffleQueryStage X
                                             :                                   +- ReusedExchange [i_item_sk#44, i_item_id#36], NativeShuffleExchange hashpartitioning(i_item_sk#19, 100), ENSURE_REQUIREMENTS, [plan_id=4]
                                             +- NativeSort [d_date_sk#42 ASC NULLS FIRST], false
                                                +- InputAdapter
                                                   +- InputAdapter [#42]
                                                      +- AQEShuffleRead coalesced
                                                         +- ShuffleQueryStage X
                                                            +- ReusedExchange [d_date_sk#42], NativeShuffleExchange hashpartitioning(d_date_sk#17, 100), ENSURE_REQUIREMENTS, [plan_id=5]
+- == Initial Plan ==
   TakeOrderedAndProject(limit=100, orderBy=[item_id#1 ASC NULLS FIRST,ss_item_rev#2 ASC NULLS FIRST], output=[item_id#1,ss_item_rev#2,ss_dev#3,cs_item_rev#4,cs_dev#5,ws_item_rev#6,ws_dev#7,average#8])
   +- Project [item_id#1, ss_item_rev#2, (((ss_item_rev#2 / ((ss_item_rev#2 + cs_item_rev#4) + ws_item_rev#6)) / 3) * 100) AS ss_dev#3, cs_item_rev#4, (((cs_item_rev#4 / ((ss_item_rev#2 + cs_item_rev#4) + ws_item_rev#6)) / 3) * 100) AS cs_dev#5, ws_item_rev#6, (((ws_item_rev#6 / ((ss_item_rev#2 + cs_item_rev#4) + ws_item_rev#6)) / 3) * 100) AS ws_dev#7, (((ss_item_rev#2 + cs_item_rev#4) + ws_item_rev#6) / 3) AS average#8]
      +- SortMergeJoin [item_id#1], [item_id#9], Inner, ((((((((cast(ss_item_rev#2 as decimal(19,3)) >= (0.9 * ws_item_rev#6)) AND (cast(ss_item_rev#2 as decimal(20,3)) <= (1.1 * ws_item_rev#6))) AND (cast(cs_item_rev#4 as decimal(19,3)) >= (0.9 * ws_item_rev#6))) AND (cast(cs_item_rev#4 as decimal(20,3)) <= (1.1 * ws_item_rev#6))) AND (cast(ws_item_rev#6 as decimal(19,3)) >= (0.9 * ss_item_rev#2))) AND (cast(ws_item_rev#6 as decimal(20,3)) <= (1.1 * ss_item_rev#2))) AND (cast(ws_item_rev#6 as decimal(19,3)) >= (0.9 * cs_item_rev#4))) AND (cast(ws_item_rev#6 as decimal(20,3)) <= (1.1 * cs_item_rev#4)))
         :- Project [item_id#1, ss_item_rev#2, cs_item_rev#4]
         :  +- SortMergeJoin [item_id#1], [item_id#10], Inner, ((((cast(ss_item_rev#2 as decimal(19,3)) >= (0.9 * cs_item_rev#4)) AND (cast(ss_item_rev#2 as decimal(20,3)) <= (1.1 * cs_item_rev#4))) AND (cast(cs_item_rev#4 as decimal(19,3)) >= (0.9 * ss_item_rev#2))) AND (cast(cs_item_rev#4 as decimal(20,3)) <= (1.1 * ss_item_rev#2)))
         :     :- Sort [item_id#1 ASC NULLS FIRST], false, 0
         :     :  +- Filter isnotnull(ss_item_rev#2)
         :     :     +- HashAggregate(keys=[i_item_id#11], functions=[sum(UnscaledValue(ss_ext_sales_price#12))], output=[item_id#1, ss_item_rev#2])
         :     :        +- Exchange hashpartitioning(i_item_id#11, 100), ENSURE_REQUIREMENTS, [plan_id=14]
         :     :           +- HashAggregate(keys=[i_item_id#11], functions=[partial_sum(UnscaledValue(ss_ext_sales_price#12))], output=[i_item_id#11, sum#45])
         :     :              +- Project [ss_ext_sales_price#12, i_item_id#11]
         :     :                 +- SortMergeJoin [ss_sold_date_sk#16], [d_date_sk#17], Inner
         :     :                    :- Sort [ss_sold_date_sk#16 ASC NULLS FIRST], false, 0
         :     :                    :  +- Exchange hashpartitioning(ss_sold_date_sk#16, 100), ENSURE_REQUIREMENTS, [plan_id=15]
         :     :                    :     +- Project [ss_sold_date_sk#16, ss_ext_sales_price#12, i_item_id#11]
         :     :                    :        +- SortMergeJoin [ss_item_sk#18], [i_item_sk#19], Inner
         :     :                    :           :- Sort [ss_item_sk#18 ASC NULLS FIRST], false, 0
         :     :                    :           :  +- Exchange hashpartitioning(ss_item_sk#18, 100), ENSURE_REQUIREMENTS, [plan_id=16]
         :     :                    :           :     +- Filter (isnotnull(ss_item_sk#18) AND isnotnull(ss_sold_date_sk#16))
         :     :                    :           :        +- FileScan parquet [ss_sold_date_sk#16,ss_item_sk#18,ss_ext_sales_price#12] Batched: true, DataFilters: [isnotnull(ss_item_sk#18), isnotnull(ss_sold_date_sk#16)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_ext_sales_price:decimal(7,2)>
         :     :                    :           +- Sort [i_item_sk#19 ASC NULLS FIRST], false, 0
         :     :                    :              +- Exchange hashpartitioning(i_item_sk#19, 100), ENSURE_REQUIREMENTS, [plan_id=17]
         :     :                    :                 +- Filter (isnotnull(i_item_sk#19) AND isnotnull(i_item_id#11))
         :     :                    :                    +- FileScan parquet [i_item_sk#19,i_item_id#11] Batched: true, DataFilters: [isnotnull(i_item_sk#19), isnotnull(i_item_id#11)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_item_id)], ReadSchema: struct<i_item_sk:int,i_item_id:string>
         :     :                    +- Sort [d_date_sk#17 ASC NULLS FIRST], false, 0
         :     :                       +- Exchange hashpartitioning(d_date_sk#17, 100), ENSURE_REQUIREMENTS, [plan_id=18]
         :     :                          +- Project [d_date_sk#17]
         :     :                             +- SortMergeJoin [d_date#20], [d_date#21], LeftSemi
         :     :                                :- Sort [d_date#20 ASC NULLS FIRST], false, 0
         :     :                                :  +- Exchange hashpartitioning(d_date#20, 100), ENSURE_REQUIREMENTS, [plan_id=19]
         :     :                                :     +- Filter isnotnull(d_date_sk#17)
         :     :                                :        +- FileScan parquet [d_date_sk#17,d_date#20] Batched: true, DataFilters: [isnotnull(d_date_sk#17)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_date:date>
         :     :                                +- Sort [d_date#21 ASC NULLS FIRST], false, 0
         :     :                                   +- Exchange hashpartitioning(d_date#21, 100), ENSURE_REQUIREMENTS, [plan_id=20]
         :     :                                      +- Project [d_date#21]
         :     :                                         +- Filter (isnotnull(d_week_seq#22) AND (d_week_seq#22 = Subquery subquery#23, [id=#24]))
         :     :                                            :  +- Subquery subquery#23, [id=#24]
         :     :                                            :     +- AdaptiveSparkPlan isFinalPlan=true
                                                                  +- == Final Plan ==
                                                                     NativeProject [d_week_seq#25]
                                                                     +- NativeFilter (isnotnull(d_date#26) AND (d_date#26 = 2000-01-03))
                                                                        +- InputAdapter [#26, #25]
                                                                           +- NativeParquetScan  (FileScan parquet [d_date#26,d_week_seq#25] Batched: true, DataFilters: [isnotnull(d_date#26), (d_date#26 = 2000-01-03)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_date), EqualTo(d_date,2000-01-03)], ReadSchema: struct<d_date:date,d_week_seq:int>)
                                                                  +- == Initial Plan ==
                                                                     Project [d_week_seq#25]
                                                                     +- Filter (isnotnull(d_date#26) AND (d_date#26 = 2000-01-03))
                                                                        +- FileScan parquet [d_date#26,d_week_seq#25] Batched: true, DataFilters: [isnotnull(d_date#26), (d_date#26 = 2000-01-03)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_date), EqualTo(d_date,2000-01-03)], ReadSchema: struct<d_date:date,d_week_seq:int>
         :     :                                            +- FileScan parquet [d_date#21,d_week_seq#22] Batched: true, DataFilters: [isnotnull(d_week_seq#22)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_week_seq)], ReadSchema: struct<d_date:date,d_week_seq:int>
         :     +- Sort [item_id#10 ASC NULLS FIRST], false, 0
         :        +- Filter isnotnull(cs_item_rev#4)
         :           +- HashAggregate(keys=[i_item_id#27], functions=[sum(UnscaledValue(cs_ext_sales_price#28))], output=[item_id#10, cs_item_rev#4])
         :              +- Exchange hashpartitioning(i_item_id#27, 100), ENSURE_REQUIREMENTS, [plan_id=21]
         :                 +- HashAggregate(keys=[i_item_id#27], functions=[partial_sum(UnscaledValue(cs_ext_sales_price#28))], output=[i_item_id#27, sum#46])
         :                    +- Project [cs_ext_sales_price#28, i_item_id#27]
         :                       +- SortMergeJoin [cs_sold_date_sk#32], [d_date_sk#33], Inner
         :                          :- Sort [cs_sold_date_sk#32 ASC NULLS FIRST], false, 0
         :                          :  +- Exchange hashpartitioning(cs_sold_date_sk#32, 100), ENSURE_REQUIREMENTS, [plan_id=22]
         :                          :     +- Project [cs_sold_date_sk#32, cs_ext_sales_price#28, i_item_id#27]
         :                          :        +- SortMergeJoin [cs_item_sk#34], [i_item_sk#35], Inner
         :                          :           :- Sort [cs_item_sk#34 ASC NULLS FIRST], false, 0
         :                          :           :  +- Exchange hashpartitioning(cs_item_sk#34, 100), ENSURE_REQUIREMENTS, [plan_id=23]
         :                          :           :     +- Filter (isnotnull(cs_item_sk#34) AND isnotnull(cs_sold_date_sk#32))
         :                          :           :        +- FileScan parquet [cs_sold_date_sk#32,cs_item_sk#34,cs_ext_sales_price#28] Batched: true, DataFilters: [isnotnull(cs_item_sk#34), isnotnull(cs_sold_date_sk#32)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int,cs_ext_sales_price:decimal(7,2)>
         :                          :           +- Sort [i_item_sk#35 ASC NULLS FIRST], false, 0
         :                          :              +- Exchange hashpartitioning(i_item_sk#35, 100), ENSURE_REQUIREMENTS, [plan_id=24]
         :                          :                 +- Filter (isnotnull(i_item_sk#35) AND isnotnull(i_item_id#27))
         :                          :                    +- FileScan parquet [i_item_sk#35,i_item_id#27] Batched: true, DataFilters: [isnotnull(i_item_sk#35), isnotnull(i_item_id#27)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_item_id)], ReadSchema: struct<i_item_sk:int,i_item_id:string>
         :                          +- Sort [d_date_sk#33 ASC NULLS FIRST], false, 0
         :                             +- Exchange hashpartitioning(d_date_sk#33, 100), ENSURE_REQUIREMENTS, [plan_id=25]
         :                                +- Project [d_date_sk#33]
         :                                   +- SortMergeJoin [d_date#47], [d_date#48], LeftSemi
         :                                      :- Sort [d_date#47 ASC NULLS FIRST], false, 0
         :                                      :  +- Exchange hashpartitioning(d_date#47, 100), ENSURE_REQUIREMENTS, [plan_id=26]
         :                                      :     +- Filter isnotnull(d_date_sk#33)
         :                                      :        +- FileScan parquet [d_date_sk#33,d_date#47] Batched: true, DataFilters: [isnotnull(d_date_sk#33)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_date:date>
         :                                      +- Sort [d_date#48 ASC NULLS FIRST], false, 0
         :                                         +- Exchange hashpartitioning(d_date#48, 100), ENSURE_REQUIREMENTS, [plan_id=27]
         :                                            +- Project [d_date#48]
         :                                               +- Filter (isnotnull(d_week_seq#49) AND (d_week_seq#49 = Subquery subquery#50, [id=#51]))
         :                                                  :  +- Subquery subquery#50, [id=#51]
         :                                                  :     +- AdaptiveSparkPlan isFinalPlan=false
         :                                                  :        +- Project [d_week_seq#25]
         :                                                  :           +- Filter (isnotnull(d_date#26) AND (d_date#26 = 2000-01-03))
         :                                                  :              +- FileScan parquet [d_date#26,d_week_seq#25] Batched: true, DataFilters: [isnotnull(d_date#26), (d_date#26 = 2000-01-03)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_date), EqualTo(d_date,2000-01-03)], ReadSchema: struct<d_date:date,d_week_seq:int>
         :                                                  +- FileScan parquet [d_date#48,d_week_seq#49] Batched: true, DataFilters: [isnotnull(d_week_seq#49)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_week_seq)], ReadSchema: struct<d_date:date,d_week_seq:int>
         +- Sort [item_id#9 ASC NULLS FIRST], false, 0
            +- Filter isnotnull(ws_item_rev#6)
               +- HashAggregate(keys=[i_item_id#36], functions=[sum(UnscaledValue(ws_ext_sales_price#37))], output=[item_id#9, ws_item_rev#6])
                  +- Exchange hashpartitioning(i_item_id#36, 100), ENSURE_REQUIREMENTS, [plan_id=28]
                     +- HashAggregate(keys=[i_item_id#36], functions=[partial_sum(UnscaledValue(ws_ext_sales_price#37))], output=[i_item_id#36, sum#52])
                        +- Project [ws_ext_sales_price#37, i_item_id#36]
                           +- SortMergeJoin [ws_sold_date_sk#41], [d_date_sk#42], Inner
                              :- Sort [ws_sold_date_sk#41 ASC NULLS FIRST], false, 0
                              :  +- Exchange hashpartitioning(ws_sold_date_sk#41, 100), ENSURE_REQUIREMENTS, [plan_id=29]
                              :     +- Project [ws_sold_date_sk#41, ws_ext_sales_price#37, i_item_id#36]
                              :        +- SortMergeJoin [ws_item_sk#43], [i_item_sk#44], Inner
                              :           :- Sort [ws_item_sk#43 ASC NULLS FIRST], false, 0
                              :           :  +- Exchange hashpartitioning(ws_item_sk#43, 100), ENSURE_REQUIREMENTS, [plan_id=30]
                              :           :     +- Filter (isnotnull(ws_item_sk#43) AND isnotnull(ws_sold_date_sk#41))
                              :           :        +- FileScan parquet [ws_sold_date_sk#41,ws_item_sk#43,ws_ext_sales_price#37] Batched: true, DataFilters: [isnotnull(ws_item_sk#43), isnotnull(ws_sold_date_sk#41)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int,ws_ext_sales_price:decimal(7,2)>
                              :           +- Sort [i_item_sk#44 ASC NULLS FIRST], false, 0
                              :              +- Exchange hashpartitioning(i_item_sk#44, 100), ENSURE_REQUIREMENTS, [plan_id=31]
                              :                 +- Filter (isnotnull(i_item_sk#44) AND isnotnull(i_item_id#36))
                              :                    +- FileScan parquet [i_item_sk#44,i_item_id#36] Batched: true, DataFilters: [isnotnull(i_item_sk#44), isnotnull(i_item_id#36)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_item_id)], ReadSchema: struct<i_item_sk:int,i_item_id:string>
                              +- Sort [d_date_sk#42 ASC NULLS FIRST], false, 0
                                 +- Exchange hashpartitioning(d_date_sk#42, 100), ENSURE_REQUIREMENTS, [plan_id=32]
                                    +- Project [d_date_sk#42]
                                       +- SortMergeJoin [d_date#53], [d_date#54], LeftSemi
                                          :- Sort [d_date#53 ASC NULLS FIRST], false, 0
                                          :  +- Exchange hashpartitioning(d_date#53, 100), ENSURE_REQUIREMENTS, [plan_id=33]
                                          :     +- Filter isnotnull(d_date_sk#42)
                                          :        +- FileScan parquet [d_date_sk#42,d_date#53] Batched: true, DataFilters: [isnotnull(d_date_sk#42)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_date:date>
                                          +- Sort [d_date#54 ASC NULLS FIRST], false, 0
                                             +- Exchange hashpartitioning(d_date#54, 100), ENSURE_REQUIREMENTS, [plan_id=34]
                                                +- Project [d_date#54]
                                                   +- Filter (isnotnull(d_week_seq#55) AND (d_week_seq#55 = Subquery subquery#56, [id=#57]))
                                                      :  +- Subquery subquery#56, [id=#57]
                                                      :     +- AdaptiveSparkPlan isFinalPlan=false
                                                      :        +- Project [d_week_seq#25]
                                                      :           +- Filter (isnotnull(d_date#26) AND (d_date#26 = 2000-01-03))
                                                      :              +- FileScan parquet [d_date#26,d_week_seq#25] Batched: true, DataFilters: [isnotnull(d_date#26), (d_date#26 = 2000-01-03)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_date), EqualTo(d_date,2000-01-03)], ReadSchema: struct<d_date:date,d_week_seq:int>
                                                      +- FileScan parquet [d_date#54,d_week_seq#55] Batched: true, DataFilters: [isnotnull(d_week_seq#55)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_week_seq)], ReadSchema: struct<d_date:date,d_week_seq:int>
