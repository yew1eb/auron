AdaptiveSparkPlan isFinalPlan=true
+- == Final Plan ==
   NativeSort [product_name#1 ASC NULLS FIRST, store_name#2 ASC NULLS FIRST, cnt#3 ASC NULLS FIRST, s1#4 ASC NULLS FIRST, s1#5 ASC NULLS FIRST], true
   +- InputAdapter
      +- AQEShuffleRead coalesced
         +- ShuffleQueryStage 100
            +- NativeShuffleExchange rangepartitioning(product_name#1 ASC NULLS FIRST, store_name#2 ASC NULLS FIRST, cnt#3 ASC NULLS FIRST, s1#4 ASC NULLS FIRST, s1#5 ASC NULLS FIRST, 100), ENSURE_REQUIREMENTS, [plan_id=1]
               +- ConvertToNative
                  +- *(3) Project [product_name#1, store_name#2, store_zip#6, b_street_number#7, b_streen_name#8, b_city#9, b_zip#10, c_street_number#11, c_street_name#12, c_city#13, c_zip#14, syear#15, cnt#16, s1#4, s2#17, s3#18, s1#5, s2#19, s3#20, syear#21, cnt#3]
                     +- *(3) SortMergeJoin [item_sk#22, store_name#2, store_zip#6], [item_sk#23, store_name#24, store_zip#25], Inner, (cnt#3 <= cnt#16)
                        :- NativeSort [item_sk#22 ASC NULLS FIRST, store_name#2 ASC NULLS FIRST, store_zip#6 ASC NULLS FIRST], false
                        :  +- InputAdapter
                        :     +- AQEShuffleRead coalesced
                        :        +- ShuffleQueryStage 97
                        :           +- NativeShuffleExchange hashpartitioning(item_sk#22, store_name#2, store_zip#6, 100), ENSURE_REQUIREMENTS, [plan_id=2]
                        :              +- NativeProject [i_product_name#26 AS product_name#1, i_item_sk#27 AS item_sk#22, s_store_name#28 AS store_name#2, s_zip#29 AS store_zip#6, ca_street_number#30 AS b_street_number#7, ca_street_name#31 AS b_streen_name#8, ca_city#32 AS b_city#9, ca_zip#33 AS b_zip#10, ca_street_number#34 AS c_street_number#11, ca_street_name#35 AS c_street_name#12, ca_city#36 AS c_city#13, ca_zip#37 AS c_zip#14, d_year#38 AS syear#15, count(1)#39 AS cnt#16, MakeDecimal(sum(UnscaledValue(ss_wholesale_cost#40))#41,17,2) AS s1#4, MakeDecimal(sum(UnscaledValue(ss_list_price#42))#43,17,2) AS s2#17, MakeDecimal(sum(UnscaledValue(ss_coupon_amt#44))#45,17,2) AS s3#18]
                        :                 +- NativeHashAggregate HashAgg, ArrayBuffer(i_product_name#26, i_item_sk#27, s_store_name#28, s_zip#29, ca_street_number#30, ca_street_name#31, ca_city#32, ca_zip#33, ca_street_number#34, ca_street_name#35, ca_city#36, ca_zip#37, d_year#38, d_year#46, d_year#47), [i_product_name#26, i_item_sk#27, s_store_name#28, s_zip#29, ca_street_number#30, ca_street_name#31, ca_city#32, ca_zip#33, ca_street_number#34, ca_street_name#35, ca_city#36, ca_zip#37, d_year#38, d_year#46, d_year#47], [count(1), sum(UnscaledValue(ss_wholesale_cost#40)), sum(UnscaledValue(ss_list_price#42)), sum(UnscaledValue(ss_coupon_amt#44))], [count(1)#39, sum(UnscaledValue(ss_wholesale_cost#40))#41, sum(UnscaledValue(ss_list_price#42))#43, sum(UnscaledValue(ss_coupon_amt#44))#45], 15
                        :                    +- NativeHashAggregate HashAgg, [i_product_name#26, i_item_sk#27, s_store_name#28, s_zip#29, ca_street_number#30, ca_street_name#31, ca_city#32, ca_zip#33, ca_street_number#34, ca_street_name#35, ca_city#36, ca_zip#37, d_year#38, d_year#46, d_year#47], [partial_count(1), partial_sum(_c15#48), partial_sum(_c16#49), partial_sum(_c17#50)], [count#51, sum#52, sum#53, sum#54], 0
                        :                       +- NativeProject [i_product_name#26 AS i_product_name#26, i_item_sk#27 AS i_item_sk#27, s_store_name#28 AS s_store_name#28, s_zip#29 AS s_zip#29, ca_street_number#30 AS ca_street_number#30, ca_street_name#31 AS ca_street_name#31, ca_city#32 AS ca_city#32, ca_zip#33 AS ca_zip#33, ca_street_number#34 AS ca_street_number#34, ca_street_name#35 AS ca_street_name#35, ca_city#36 AS ca_city#36, ca_zip#37 AS ca_zip#37, d_year#38 AS d_year#38, d_year#46 AS d_year#46, d_year#47 AS d_year#47, UnscaledValue(ss_wholesale_cost#40) AS _c15#48, UnscaledValue(ss_list_price#42) AS _c16#49, UnscaledValue(ss_coupon_amt#44) AS _c17#50]
                        :                          +- NativeProject [ss_wholesale_cost#40, ss_list_price#42, ss_coupon_amt#44, d_year#38, d_year#46, d_year#47, s_store_name#28, s_zip#29, ca_street_number#30, ca_street_name#31, ca_city#32, ca_zip#33, ca_street_number#34, ca_street_name#35, ca_city#36, ca_zip#37, i_item_sk#27, i_product_name#26]
                        :                             +- NativeSortMergeJoin [ss_item_sk#55], [i_item_sk#27], Inner
                        :                                :- NativeSort [ss_item_sk#55 ASC NULLS FIRST], false
                        :                                :  +- InputAdapter
                        :                                :     +- AQEShuffleRead coalesced
                        :                                :        +- ShuffleQueryStage 95
                        :                                :           +- NativeShuffleExchange hashpartitioning(ss_item_sk#55, 100), ENSURE_REQUIREMENTS, [plan_id=3]
                        :                                :              +- NativeProject [ss_item_sk#55, ss_wholesale_cost#40, ss_list_price#42, ss_coupon_amt#44, d_year#38, s_store_name#28, s_zip#29, d_year#46, d_year#47, ca_street_number#30, ca_street_name#31, ca_city#32, ca_zip#33, ca_street_number#34, ca_street_name#35, ca_city#36, ca_zip#37]
                        :                                :                 +- NativeSortMergeJoin [hd_income_band_sk#56], [ib_income_band_sk#57], Inner
                        :                                :                    :- NativeSort [hd_income_band_sk#56 ASC NULLS FIRST], false
                        :                                :                    :  +- InputAdapter
                        :                                :                    :     +- AQEShuffleRead coalesced
                        :                                :                    :        +- ShuffleQueryStage 93
                        :                                :                    :           +- NativeShuffleExchange hashpartitioning(hd_income_band_sk#56, 100), ENSURE_REQUIREMENTS, [plan_id=4]
                        :                                :                    :              +- NativeProject [ss_item_sk#55, ss_wholesale_cost#40, ss_list_price#42, ss_coupon_amt#44, d_year#38, s_store_name#28, s_zip#29, d_year#46, d_year#47, hd_income_band_sk#56, ca_street_number#30, ca_street_name#31, ca_city#32, ca_zip#33, ca_street_number#34, ca_street_name#35, ca_city#36, ca_zip#37]
                        :                                :                    :                 +- NativeSortMergeJoin [hd_income_band_sk#58], [ib_income_band_sk#59], Inner
                        :                                :                    :                    :- NativeSort [hd_income_band_sk#58 ASC NULLS FIRST], false
                        :                                :                    :                    :  +- InputAdapter
                        :                                :                    :                    :     +- AQEShuffleRead coalesced
                        :                                :                    :                    :        +- ShuffleQueryStage 91
                        :                                :                    :                    :           +- NativeShuffleExchange hashpartitioning(hd_income_band_sk#58, 100), ENSURE_REQUIREMENTS, [plan_id=5]
                        :                                :                    :                    :              +- NativeProject [ss_item_sk#55, ss_wholesale_cost#40, ss_list_price#42, ss_coupon_amt#44, d_year#38, s_store_name#28, s_zip#29, d_year#46, d_year#47, hd_income_band_sk#58, hd_income_band_sk#56, ca_street_number#30, ca_street_name#31, ca_city#32, ca_zip#33, ca_street_number#34, ca_street_name#35, ca_city#36, ca_zip#37]
                        :                                :                    :                    :                 +- NativeSortMergeJoin [c_current_addr_sk#60], [ca_address_sk#61], Inner
                        :                                :                    :                    :                    :- NativeSort [c_current_addr_sk#60 ASC NULLS FIRST], false
                        :                                :                    :                    :                    :  +- InputAdapter
                        :                                :                    :                    :                    :     +- AQEShuffleRead coalesced
                        :                                :                    :                    :                    :        +- ShuffleQueryStage 89
                        :                                :                    :                    :                    :           +- NativeShuffleExchange hashpartitioning(c_current_addr_sk#60, 100), ENSURE_REQUIREMENTS, [plan_id=6]
                        :                                :                    :                    :                    :              +- NativeProject [ss_item_sk#55, ss_wholesale_cost#40, ss_list_price#42, ss_coupon_amt#44, d_year#38, s_store_name#28, s_zip#29, c_current_addr_sk#60, d_year#46, d_year#47, hd_income_band_sk#58, hd_income_band_sk#56, ca_street_number#30, ca_street_name#31, ca_city#32, ca_zip#33]
                        :                                :                    :                    :                    :                 +- NativeSortMergeJoin [ss_addr_sk#62], [ca_address_sk#63], Inner
                        :                                :                    :                    :                    :                    :- NativeSort [ss_addr_sk#62 ASC NULLS FIRST], false
                        :                                :                    :                    :                    :                    :  +- InputAdapter
                        :                                :                    :                    :                    :                    :     +- AQEShuffleRead coalesced
                        :                                :                    :                    :                    :                    :        +- ShuffleQueryStage 87
                        :                                :                    :                    :                    :                    :           +- NativeShuffleExchange hashpartitioning(ss_addr_sk#62, 100), ENSURE_REQUIREMENTS, [plan_id=7]
                        :                                :                    :                    :                    :                    :              +- NativeProject [ss_item_sk#55, ss_addr_sk#62, ss_wholesale_cost#40, ss_list_price#42, ss_coupon_amt#44, d_year#38, s_store_name#28, s_zip#29, c_current_addr_sk#60, d_year#46, d_year#47, hd_income_band_sk#58, hd_income_band_sk#56]
                        :                                :                    :                    :                    :                    :                 +- NativeSortMergeJoin [c_current_hdemo_sk#64], [hd_demo_sk#65], Inner
                        :                                :                    :                    :                    :                    :                    :- NativeSort [c_current_hdemo_sk#64 ASC NULLS FIRST], false
                        :                                :                    :                    :                    :                    :                    :  +- InputAdapter
                        :                                :                    :                    :                    :                    :                    :     +- AQEShuffleRead coalesced
                        :                                :                    :                    :                    :                    :                    :        +- ShuffleQueryStage 85
                        :                                :                    :                    :                    :                    :                    :           +- NativeShuffleExchange hashpartitioning(c_current_hdemo_sk#64, 100), ENSURE_REQUIREMENTS, [plan_id=8]
                        :                                :                    :                    :                    :                    :                    :              +- NativeProject [ss_item_sk#55, ss_addr_sk#62, ss_wholesale_cost#40, ss_list_price#42, ss_coupon_amt#44, d_year#38, s_store_name#28, s_zip#29, c_current_hdemo_sk#64, c_current_addr_sk#60, d_year#46, d_year#47, hd_income_band_sk#58]
                        :                                :                    :                    :                    :                    :                    :                 +- NativeSortMergeJoin [ss_hdemo_sk#66], [hd_demo_sk#67], Inner
                        :                                :                    :                    :                    :                    :                    :                    :- NativeSort [ss_hdemo_sk#66 ASC NULLS FIRST], false
                        :                                :                    :                    :                    :                    :                    :                    :  +- InputAdapter
                        :                                :                    :                    :                    :                    :                    :                    :     +- AQEShuffleRead coalesced
                        :                                :                    :                    :                    :                    :                    :                    :        +- ShuffleQueryStage 84
                        :                                :                    :                    :                    :                    :                    :                    :           +- NativeShuffleExchange hashpartitioning(ss_hdemo_sk#66, 100), ENSURE_REQUIREMENTS, [plan_id=9]
                        :                                :                    :                    :                    :                    :                    :                    :              +- NativeProject [ss_item_sk#55, ss_hdemo_sk#66, ss_addr_sk#62, ss_wholesale_cost#40, ss_list_price#42, ss_coupon_amt#44, d_year#38, s_store_name#28, s_zip#29, c_current_hdemo_sk#64, c_current_addr_sk#60, d_year#46, d_year#47]
                        :                                :                    :                    :                    :                    :                    :                    :                 +- NativeSortMergeJoin [ss_promo_sk#68], [p_promo_sk#69], Inner
                        :                                :                    :                    :                    :                    :                    :                    :                    :- NativeSort [ss_promo_sk#68 ASC NULLS FIRST], false
                        :                                :                    :                    :                    :                    :                    :                    :                    :  +- InputAdapter
                        :                                :                    :                    :                    :                    :                    :                    :                    :     +- AQEShuffleRead coalesced
                        :                                :                    :                    :                    :                    :                    :                    :                    :        +- ShuffleQueryStage 82
                        :                                :                    :                    :                    :                    :                    :                    :                    :           +- NativeShuffleExchange hashpartitioning(ss_promo_sk#68, 100), ENSURE_REQUIREMENTS, [plan_id=10]
                        :                                :                    :                    :                    :                    :                    :                    :                    :              +- ConvertToNative
                        :                                :                    :                    :                    :                    :                    :                    :                    :                 +- *(1) Project [ss_item_sk#55, ss_hdemo_sk#66, ss_addr_sk#62, ss_promo_sk#68, ss_wholesale_cost#40, ss_list_price#42, ss_coupon_amt#44, d_year#38, s_store_name#28, s_zip#29, c_current_hdemo_sk#64, c_current_addr_sk#60, d_year#46, d_year#47]
                        :                                :                    :                    :                    :                    :                    :                    :                    :                    +- *(1) SortMergeJoin [c_current_cdemo_sk#70], [cd_demo_sk#71], Inner, NOT (cd_marital_status#72 = cd_marital_status#73)
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :- NativeSort [c_current_cdemo_sk#70 ASC NULLS FIRST], false
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :  +- InputAdapter
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :     +- AQEShuffleRead coalesced
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :        +- ShuffleQueryStage 80
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :           +- NativeShuffleExchange hashpartitioning(c_current_cdemo_sk#70, 100), ENSURE_REQUIREMENTS, [plan_id=11]
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :              +- NativeProject [ss_item_sk#55, ss_hdemo_sk#66, ss_addr_sk#62, ss_promo_sk#68, ss_wholesale_cost#40, ss_list_price#42, ss_coupon_amt#44, d_year#38, s_store_name#28, s_zip#29, c_current_cdemo_sk#70, c_current_hdemo_sk#64, c_current_addr_sk#60, d_year#46, d_year#47, cd_marital_status#72]
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                 +- NativeSortMergeJoin [ss_cdemo_sk#74], [cd_demo_sk#75], Inner
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :- NativeSort [ss_cdemo_sk#74 ASC NULLS FIRST], false
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :  +- InputAdapter
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :     +- AQEShuffleRead coalesced
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :        +- ShuffleQueryStage 78
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :           +- NativeShuffleExchange hashpartitioning(ss_cdemo_sk#74, 100), ENSURE_REQUIREMENTS, [plan_id=12]
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :              +- NativeProject [ss_item_sk#55, ss_cdemo_sk#74, ss_hdemo_sk#66, ss_addr_sk#62, ss_promo_sk#68, ss_wholesale_cost#40, ss_list_price#42, ss_coupon_amt#44, d_year#38, s_store_name#28, s_zip#29, c_current_cdemo_sk#70, c_current_hdemo_sk#64, c_current_addr_sk#60, d_year#46, d_year#47]
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                 +- NativeSortMergeJoin [c_first_shipto_date_sk#76], [d_date_sk#77], Inner
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :- NativeSort [c_first_shipto_date_sk#76 ASC NULLS FIRST], false
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :  +- InputAdapter
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :     +- AQEShuffleRead coalesced
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :        +- ShuffleQueryStage 76
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :           +- NativeShuffleExchange hashpartitioning(c_first_shipto_date_sk#76, 100), ENSURE_REQUIREMENTS, [plan_id=13]
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :              +- NativeProject [ss_item_sk#55, ss_cdemo_sk#74, ss_hdemo_sk#66, ss_addr_sk#62, ss_promo_sk#68, ss_wholesale_cost#40, ss_list_price#42, ss_coupon_amt#44, d_year#38, s_store_name#28, s_zip#29, c_current_cdemo_sk#70, c_current_hdemo_sk#64, c_current_addr_sk#60, c_first_shipto_date_sk#76, d_year#46]
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                 +- NativeSortMergeJoin [c_first_sales_date_sk#78], [d_date_sk#79], Inner
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :- NativeSort [c_first_sales_date_sk#78 ASC NULLS FIRST], false
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :  +- InputAdapter
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :     +- AQEShuffleRead coalesced
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :        +- ShuffleQueryStage 74
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :           +- NativeShuffleExchange hashpartitioning(c_first_sales_date_sk#78, 100), ENSURE_REQUIREMENTS, [plan_id=14]
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :              +- NativeProject [ss_item_sk#55, ss_cdemo_sk#74, ss_hdemo_sk#66, ss_addr_sk#62, ss_promo_sk#68, ss_wholesale_cost#40, ss_list_price#42, ss_coupon_amt#44, d_year#38, s_store_name#28, s_zip#29, c_current_cdemo_sk#70, c_current_hdemo_sk#64, c_current_addr_sk#60, c_first_shipto_date_sk#76, c_first_sales_date_sk#78]
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                 +- NativeSortMergeJoin [ss_customer_sk#80], [c_customer_sk#81], Inner
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :- NativeSort [ss_customer_sk#80 ASC NULLS FIRST], false
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :  +- InputAdapter
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :     +- AQEShuffleRead coalesced
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :        +- ShuffleQueryStage 72
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :           +- NativeShuffleExchange hashpartitioning(ss_customer_sk#80, 100), ENSURE_REQUIREMENTS, [plan_id=15]
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :              +- NativeProject [ss_item_sk#55, ss_customer_sk#80, ss_cdemo_sk#74, ss_hdemo_sk#66, ss_addr_sk#62, ss_promo_sk#68, ss_wholesale_cost#40, ss_list_price#42, ss_coupon_amt#44, d_year#38, s_store_name#28, s_zip#29]
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                 +- NativeSortMergeJoin [ss_store_sk#82], [s_store_sk#83], Inner
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :- NativeSort [ss_store_sk#82 ASC NULLS FIRST], false
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :  +- InputAdapter
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :     +- AQEShuffleRead coalesced
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :        +- ShuffleQueryStage 70
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :           +- NativeShuffleExchange hashpartitioning(ss_store_sk#82, 100), ENSURE_REQUIREMENTS, [plan_id=16]
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :              +- NativeProject [ss_item_sk#55, ss_customer_sk#80, ss_cdemo_sk#74, ss_hdemo_sk#66, ss_addr_sk#62, ss_store_sk#82, ss_promo_sk#68, ss_wholesale_cost#40, ss_list_price#42, ss_coupon_amt#44, d_year#38]
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                 +- NativeSortMergeJoin [ss_sold_date_sk#84], [d_date_sk#85], Inner
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :- NativeSort [ss_sold_date_sk#84 ASC NULLS FIRST], false
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :  +- InputAdapter
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :     +- AQEShuffleRead coalesced
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :        +- ShuffleQueryStage 67
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :           +- NativeShuffleExchange hashpartitioning(ss_sold_date_sk#84, 100), ENSURE_REQUIREMENTS, [plan_id=17]
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :              +- NativeProject [ss_sold_date_sk#84, ss_item_sk#55, ss_customer_sk#80, ss_cdemo_sk#74, ss_hdemo_sk#66, ss_addr_sk#62, ss_store_sk#82, ss_promo_sk#68, ss_wholesale_cost#40, ss_list_price#42, ss_coupon_amt#44]
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                 +- NativeSortMergeJoin [ss_item_sk#55], [cs_item_sk#86], Inner
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                    :- NativeSort [ss_item_sk#55 ASC NULLS FIRST], false
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                    :  +- InputAdapter
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                    :     +- AQEShuffleRead coalesced
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                    :        +- ShuffleQueryStage 61
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                    :           +- NativeShuffleExchange hashpartitioning(ss_item_sk#55, 100), ENSURE_REQUIREMENTS, [plan_id=18]
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                    :              +- NativeProject [ss_sold_date_sk#84, ss_item_sk#55, ss_customer_sk#80, ss_cdemo_sk#74, ss_hdemo_sk#66, ss_addr_sk#62, ss_store_sk#82, ss_promo_sk#68, ss_wholesale_cost#40, ss_list_price#42, ss_coupon_amt#44]
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                    :                 +- NativeSortMergeJoin [ss_item_sk#55, ss_ticket_number#87], [sr_item_sk#88, sr_ticket_number#89], Inner
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                    :                    :- NativeSort [ss_item_sk#55 ASC NULLS FIRST, ss_ticket_number#87 ASC NULLS FIRST], false
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                    :                    :  +- InputAdapter
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                    :                    :     +- AQEShuffleRead coalesced
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                    :                    :        +- ShuffleQueryStage 0
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                    :                    :           +- NativeShuffleExchange hashpartitioning(ss_item_sk#55, ss_ticket_number#87, 100), ENSURE_REQUIREMENTS, [plan_id=19]
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                    :                    :              +- NativeFilter ((((((((isnotnull(ss_item_sk#55) AND isnotnull(ss_ticket_number#87)) AND isnotnull(ss_sold_date_sk#84)) AND isnotnull(ss_store_sk#82)) AND isnotnull(ss_customer_sk#80)) AND isnotnull(ss_cdemo_sk#74)) AND isnotnull(ss_promo_sk#68)) AND isnotnull(ss_hdemo_sk#66)) AND isnotnull(ss_addr_sk#62))
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                    :                    :                 +- InputAdapter [#84, #55, #80, #74, #66, #62, #82, #68, #87, #40, #42, #44]
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                    :                    :                    +- NativeParquetScan  (FileScan parquet [ss_sold_date_sk#84,ss_item_sk#55,ss_customer_sk#80,ss_cdemo_sk#74,ss_hdemo_sk#66,ss_addr_sk#62,ss_store_sk#82,ss_promo_sk#68,ss_ticket_number#87,ss_wholesale_cost#40,ss_list_price#42,ss_coupon_amt#44] Batched: true, DataFilters: [isnotnull(ss_item_sk#55), isnotnull(ss_ticket_number#87), isnotnull(ss_sold_date_sk#84)..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_ticket_number), IsNotNull(ss_sold_date_sk), IsNotNull(ss_sto..., ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_customer_sk:int,ss_cdemo_sk:int,ss_hdemo_sk:int,ss_a...)
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                    :                    +- NativeSort [sr_item_sk#88 ASC NULLS FIRST, sr_ticket_number#89 ASC NULLS FIRST], false
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                    :                       +- InputAdapter
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                    :                          +- AQEShuffleRead coalesced
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                    :                             +- ShuffleQueryStage 1
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                    :                                +- NativeShuffleExchange hashpartitioning(sr_item_sk#88, sr_ticket_number#89, 100), ENSURE_REQUIREMENTS, [plan_id=20]
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                    :                                   +- NativeFilter (isnotnull(sr_item_sk#88) AND isnotnull(sr_ticket_number#89))
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                    :                                      +- InputAdapter [#88, #89]
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                    :                                         +- NativeParquetScan  (FileScan parquet [sr_item_sk#88,sr_ticket_number#89] Batched: true, DataFilters: [isnotnull(sr_item_sk#88), isnotnull(sr_ticket_number#89)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(sr_item_sk), IsNotNull(sr_ticket_number)], ReadSchema: struct<sr_item_sk:int,sr_ticket_number:int>)
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                    +- NativeSort [cs_item_sk#86 ASC NULLS FIRST], false
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                       +- NativeProject [cs_item_sk#86]
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                          +- NativeFilter ((isnotnull(sale#90) AND isnotnull(refund#91)) AND (cast(sale#90 as decimal(21,2)) > (2 * refund#91)))
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                             +- NativeProject [cs_item_sk#86, MakeDecimal(sum(UnscaledValue(cs_ext_list_price#92))#93,17,2) AS sale#90, sum(((cr_refunded_cash#94 + cr_reversed_charge#95) + cr_store_credit#96))#97 AS refund#91]
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                                +- NativeHashAggregate HashAgg, ArrayBuffer(cs_item_sk#86), [cs_item_sk#86], [sum(UnscaledValue(cs_ext_list_price#92)), sum(((cr_refunded_cash#94 + cr_reversed_charge#95) + cr_store_credit#96))], [sum(UnscaledValue(cs_ext_list_price#92))#93, sum(((cr_refunded_cash#94 + cr_reversed_charge#95) + cr_store_credit#96))#97], 1
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                                   +- InputAdapter
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                                      +- AQEShuffleRead coalesced
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                                         +- ShuffleQueryStage 64
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                                            +- NativeShuffleExchange hashpartitioning(cs_item_sk#86, 100), ENSURE_REQUIREMENTS, [plan_id=21]
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                                               +- NativeHashAggregate HashAgg, [cs_item_sk#86], [partial_sum(_c1#98), partial_sum(_c2#99)], [sum#100, sum#101, isEmpty#102], 0
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                                                  +- NativeProject [cs_item_sk#86 AS cs_item_sk#86, UnscaledValue(cs_ext_list_price#92) AS _c1#98, ((cr_refunded_cash#94 + cr_reversed_charge#95) + cr_store_credit#96) AS _c2#99]
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                                                     +- NativeProject [cs_item_sk#86, cs_ext_list_price#92, cr_refunded_cash#94, cr_reversed_charge#95, cr_store_credit#96]
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                                                        +- NativeSortMergeJoin [cs_item_sk#86, cs_order_number#103], [cr_item_sk#104, cr_order_number#105], Inner
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                                                           :- NativeSort [cs_item_sk#86 ASC NULLS FIRST, cs_order_number#103 ASC NULLS FIRST], false
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                                                           :  +- InputAdapter
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                                                           :     +- AQEShuffleRead coalesced
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                                                           :        +- ShuffleQueryStage 2
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                                                           :           +- NativeShuffleExchange hashpartitioning(cs_item_sk#86, cs_order_number#103, 100), ENSURE_REQUIREMENTS, [plan_id=22]
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                                                           :              +- NativeFilter (isnotnull(cs_item_sk#86) AND isnotnull(cs_order_number#103))
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                                                           :                 +- InputAdapter [#86, #103, #92]
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                                                           :                    +- NativeParquetScan  (FileScan parquet [cs_item_sk#86,cs_order_number#103,cs_ext_list_price#92] Batched: true, DataFilters: [isnotnull(cs_item_sk#86), isnotnull(cs_order_number#103)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_order_number)], ReadSchema: struct<cs_item_sk:int,cs_order_number:int,cs_ext_list_price:decimal(7,2)>)
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                                                           +- NativeSort [cr_item_sk#104 ASC NULLS FIRST, cr_order_number#105 ASC NULLS FIRST], false
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                                                              +- InputAdapter
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                                                                 +- AQEShuffleRead coalesced
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                                                                    +- ShuffleQueryStage 3
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                                                                       +- NativeShuffleExchange hashpartitioning(cr_item_sk#104, cr_order_number#105, 100), ENSURE_REQUIREMENTS, [plan_id=23]
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                                                                          +- NativeFilter (isnotnull(cr_item_sk#104) AND isnotnull(cr_order_number#105))
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                                                                             +- InputAdapter [#104, #105, #94, #95, #96]
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :                                                                                +- NativeParquetScan  (FileScan parquet [cr_item_sk#104,cr_order_number#105,cr_refunded_cash#94,cr_reversed_charge#95,cr_store_credit#96] Batched: true, DataFilters: [isnotnull(cr_item_sk#104), isnotnull(cr_order_number#105)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cr_item_sk), IsNotNull(cr_order_number)], ReadSchema: struct<cr_item_sk:int,cr_order_number:int,cr_refunded_cash:decimal(7,2),cr_reversed_charge:decima...)
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    +- NativeSort [d_date_sk#85 ASC NULLS FIRST], false
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                       +- InputAdapter
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                          +- AQEShuffleRead coalesced
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                             +- ShuffleQueryStage 4
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                                +- NativeShuffleExchange hashpartitioning(d_date_sk#85, 100), ENSURE_REQUIREMENTS, [plan_id=24]
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                                   +- NativeFilter ((isnotnull(d_year#38) AND (d_year#38 = 1999)) AND isnotnull(d_date_sk#85))
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                                      +- InputAdapter [#85, #38]
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                                         +- NativeParquetScan  (FileScan parquet [d_date_sk#85,d_year#38] Batched: true, DataFilters: [isnotnull(d_year#38), (d_year#38 = 1999), isnotnull(d_date_sk#85)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,1999), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>)
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    +- NativeSort [s_store_sk#83 ASC NULLS FIRST], false
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                       +- InputAdapter
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                          +- AQEShuffleRead coalesced
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                             +- ShuffleQueryStage 5
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                                +- NativeShuffleExchange hashpartitioning(s_store_sk#83, 100), ENSURE_REQUIREMENTS, [plan_id=25]
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                                   +- NativeFilter ((isnotnull(s_store_sk#83) AND isnotnull(s_store_name#28)) AND isnotnull(s_zip#29))
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                                      +- InputAdapter [#83, #28, #29]
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                                         +- NativeParquetScan  (FileScan parquet [s_store_sk#83,s_store_name#28,s_zip#29] Batched: true, DataFilters: [isnotnull(s_store_sk#83), isnotnull(s_store_name#28), isnotnull(s_zip#29)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk), IsNotNull(s_store_name), IsNotNull(s_zip)], ReadSchema: struct<s_store_sk:int,s_store_name:string,s_zip:string>)
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    +- NativeSort [c_customer_sk#81 ASC NULLS FIRST], false
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                       +- InputAdapter
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                          +- AQEShuffleRead coalesced
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                             +- ShuffleQueryStage 6
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                                +- NativeShuffleExchange hashpartitioning(c_customer_sk#81, 100), ENSURE_REQUIREMENTS, [plan_id=26]
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                                   +- NativeFilter (((((isnotnull(c_customer_sk#81) AND isnotnull(c_first_sales_date_sk#78)) AND isnotnull(c_first_shipto_date_sk#76)) AND isnotnull(c_current_cdemo_sk#70)) AND isnotnull(c_current_hdemo_sk#64)) AND isnotnull(c_current_addr_sk#60))
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                                      +- InputAdapter [#81, #70, #64, #60, #76, #78]
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                                         +- NativeParquetScan  (FileScan parquet [c_customer_sk#81,c_current_cdemo_sk#70,c_current_hdemo_sk#64,c_current_addr_sk#60,c_first_shipto_date_sk#76,c_first_sales_date_sk#78] Batched: true, DataFilters: [isnotnull(c_customer_sk#81), isnotnull(c_first_sales_date_sk#78), isnotnull(c_first_shipto..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_first_sales_date_sk), IsNotNull(c_first_shipto_date_sk), I..., ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_hdemo_sk:int,c_current_addr_sk:int,c_fi...)
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    +- NativeSort [d_date_sk#79 ASC NULLS FIRST], false
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                       +- InputAdapter
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                          +- AQEShuffleRead coalesced
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                             +- ShuffleQueryStage 7
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                                +- NativeShuffleExchange hashpartitioning(d_date_sk#79, 100), ENSURE_REQUIREMENTS, [plan_id=27]
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                                   +- NativeFilter isnotnull(d_date_sk#79)
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                                      +- InputAdapter [#79, #46]
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                                         +- NativeParquetScan  (FileScan parquet [d_date_sk#79,d_year#46] Batched: true, DataFilters: [isnotnull(d_date_sk#79)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>)
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    +- NativeSort [d_date_sk#77 ASC NULLS FIRST], false
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                       +- InputAdapter
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                          +- InputAdapter [#77, #47]
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                             +- AQEShuffleRead coalesced
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                                +- ShuffleQueryStage 9
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    :                                   +- ReusedExchange [d_date_sk#77, d_year#47], NativeShuffleExchange hashpartitioning(d_date_sk#79, 100), ENSURE_REQUIREMENTS, [plan_id=27]
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                    +- NativeSort [cd_demo_sk#75 ASC NULLS FIRST], false
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                       +- InputAdapter
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                          +- AQEShuffleRead coalesced
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                             +- ShuffleQueryStage 10
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                                +- NativeShuffleExchange hashpartitioning(cd_demo_sk#75, 100), ENSURE_REQUIREMENTS, [plan_id=28]
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                                   +- NativeFilter (isnotnull(cd_demo_sk#75) AND isnotnull(cd_marital_status#72))
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                                      +- InputAdapter [#75, #72]
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       :                                         +- NativeParquetScan  (FileScan parquet [cd_demo_sk#75,cd_marital_status#72] Batched: true, DataFilters: [isnotnull(cd_demo_sk#75), isnotnull(cd_marital_status#72)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>, PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>)
                        :                                :                    :                    :                    :                    :                    :                    :                    :                       +- NativeSort [cd_demo_sk#71 ASC NULLS FIRST], false
                        :                                :                    :                    :                    :                    :                    :                    :                    :                          +- InputAdapter
                        :                                :                    :                    :                    :                    :                    :                    :                    :                             +- InputAdapter [#71, #73]
                        :                                :                    :                    :                    :                    :                    :                    :                    :                                +- AQEShuffleRead coalesced
                        :                                :                    :                    :                    :                    :                    :                    :                    :                                   +- ShuffleQueryStage 12
                        :                                :                    :                    :                    :                    :                    :                    :                    :                                      +- ReusedExchange [cd_demo_sk#71, cd_marital_status#73], NativeShuffleExchange hashpartitioning(cd_demo_sk#75, 100), ENSURE_REQUIREMENTS, [plan_id=28]
                        :                                :                    :                    :                    :                    :                    :                    :                    +- NativeSort [p_promo_sk#69 ASC NULLS FIRST], false
                        :                                :                    :                    :                    :                    :                    :                    :                       +- InputAdapter
                        :                                :                    :                    :                    :                    :                    :                    :                          +- AQEShuffleRead coalesced
                        :                                :                    :                    :                    :                    :                    :                    :                             +- ShuffleQueryStage 13
                        :                                :                    :                    :                    :                    :                    :                    :                                +- NativeShuffleExchange hashpartitioning(p_promo_sk#69, 100), ENSURE_REQUIREMENTS, [plan_id=29]
                        :                                :                    :                    :                    :                    :                    :                    :                                   +- NativeFilter isnotnull(p_promo_sk#69)
                        :                                :                    :                    :                    :                    :                    :                    :                                      +- InputAdapter [#69]
                        :                                :                    :                    :                    :                    :                    :                    :                                         +- NativeParquetScan  (FileScan parquet [p_promo_sk#69] Batched: true, DataFilters: [isnotnull(p_promo_sk#69)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(p_promo_sk)], ReadSchema: struct<p_promo_sk:int>)
                        :                                :                    :                    :                    :                    :                    :                    +- NativeSort [hd_demo_sk#67 ASC NULLS FIRST], false
                        :                                :                    :                    :                    :                    :                    :                       +- InputAdapter
                        :                                :                    :                    :                    :                    :                    :                          +- AQEShuffleRead coalesced
                        :                                :                    :                    :                    :                    :                    :                             +- ShuffleQueryStage 14
                        :                                :                    :                    :                    :                    :                    :                                +- NativeShuffleExchange hashpartitioning(hd_demo_sk#67, 100), ENSURE_REQUIREMENTS, [plan_id=30]
                        :                                :                    :                    :                    :                    :                    :                                   +- NativeFilter (isnotnull(hd_demo_sk#67) AND isnotnull(hd_income_band_sk#58))
                        :                                :                    :                    :                    :                    :                    :                                      +- InputAdapter [#67, #58]
                        :                                :                    :                    :                    :                    :                    :                                         +- NativeParquetScan  (FileScan parquet [hd_demo_sk#67,hd_income_band_sk#58] Batched: true, DataFilters: [isnotnull(hd_demo_sk#67), isnotnull(hd_income_band_sk#58)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>, PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>)
                        :                                :                    :                    :                    :                    :                    +- NativeSort [hd_demo_sk#65 ASC NULLS FIRST], false
                        :                                :                    :                    :                    :                    :                       +- InputAdapter
                        :                                :                    :                    :                    :                    :                          +- InputAdapter [#65, #56]
                        :                                :                    :                    :                    :                    :                             +- AQEShuffleRead coalesced
                        :                                :                    :                    :                    :                    :                                +- ShuffleQueryStage 16
                        :                                :                    :                    :                    :                    :                                   +- ReusedExchange [hd_demo_sk#65, hd_income_band_sk#56], NativeShuffleExchange hashpartitioning(hd_demo_sk#67, 100), ENSURE_REQUIREMENTS, [plan_id=30]
                        :                                :                    :                    :                    :                    +- NativeSort [ca_address_sk#63 ASC NULLS FIRST], false
                        :                                :                    :                    :                    :                       +- InputAdapter
                        :                                :                    :                    :                    :                          +- AQEShuffleRead coalesced
                        :                                :                    :                    :                    :                             +- ShuffleQueryStage 17
                        :                                :                    :                    :                    :                                +- NativeShuffleExchange hashpartitioning(ca_address_sk#63, 100), ENSURE_REQUIREMENTS, [plan_id=31]
                        :                                :                    :                    :                    :                                   +- NativeFilter isnotnull(ca_address_sk#63)
                        :                                :                    :                    :                    :                                      +- InputAdapter [#63, #30, #31, #32, #33]
                        :                                :                    :                    :                    :                                         +- NativeParquetScan  (FileScan parquet [ca_address_sk#63,ca_street_number#30,ca_street_name#31,ca_city#32,ca_zip#33] Batched: true, DataFilters: [isnotnull(ca_address_sk#63)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>)
                        :                                :                    :                    :                    +- NativeSort [ca_address_sk#61 ASC NULLS FIRST], false
                        :                                :                    :                    :                       +- InputAdapter
                        :                                :                    :                    :                          +- InputAdapter [#61, #34, #35, #36, #37]
                        :                                :                    :                    :                             +- AQEShuffleRead coalesced
                        :                                :                    :                    :                                +- ShuffleQueryStage 19
                        :                                :                    :                    :                                   +- ReusedExchange [ca_address_sk#61, ca_street_number#34, ca_street_name#35, ca_city#36, ca_zip#37], NativeShuffleExchange hashpartitioning(ca_address_sk#63, 100), ENSURE_REQUIREMENTS, [plan_id=31]
                        :                                :                    :                    +- NativeSort [ib_income_band_sk#59 ASC NULLS FIRST], false
                        :                                :                    :                       +- InputAdapter
                        :                                :                    :                          +- AQEShuffleRead coalesced
                        :                                :                    :                             +- ShuffleQueryStage 20
                        :                                :                    :                                +- NativeShuffleExchange hashpartitioning(ib_income_band_sk#59, 100), ENSURE_REQUIREMENTS, [plan_id=32]
                        :                                :                    :                                   +- NativeFilter isnotnull(ib_income_band_sk#59)
                        :                                :                    :                                      +- InputAdapter [#59]
                        :                                :                    :                                         +- NativeParquetScan  (FileScan parquet [ib_income_band_sk#59] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#59)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>)
                        :                                :                    +- NativeSort [ib_income_band_sk#57 ASC NULLS FIRST], false
                        :                                :                       +- InputAdapter
                        :                                :                          +- InputAdapter [#57]
                        :                                :                             +- AQEShuffleRead coalesced
                        :                                :                                +- ShuffleQueryStage 22
                        :                                :                                   +- ReusedExchange [ib_income_band_sk#57], NativeShuffleExchange hashpartitioning(ib_income_band_sk#59, 100), ENSURE_REQUIREMENTS, [plan_id=32]
                        :                                +- NativeSort [i_item_sk#27 ASC NULLS FIRST], false
                        :                                   +- InputAdapter
                        :                                      +- AQEShuffleRead coalesced
                        :                                         +- ShuffleQueryStage 23
                        :                                            +- NativeShuffleExchange hashpartitioning(i_item_sk#27, 100), ENSURE_REQUIREMENTS, [plan_id=33]
                        :                                               +- NativeProject [i_item_sk#27, i_product_name#26]
                        :                                                  +- NativeFilter ((((((isnotnull(i_current_price#106) AND i_color#107 IN (purple,burlywood,indian,spring,floral,medium)) AND (i_current_price#106 >= 64.00)) AND (i_current_price#106 <= 74.00)) AND (i_current_price#106 >= 65.00)) AND (i_current_price#106 <= 79.00)) AND isnotnull(i_item_sk#27))
                        :                                                     +- InputAdapter [#27, #106, #107, #26]
                        :                                                        +- NativeParquetScan  (FileScan parquet [i_item_sk#27,i_current_price#106,i_color#107,i_product_name#26] Batched: true, DataFilters: [isnotnull(i_current_price#106), i_color#107 IN (purple,burlywood,indian,spring,floral,medium..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_current_price), In(i_color, [burlywood,floral,indian,medium,purple,spring]), Greater..., ReadSchema: struct<i_item_sk:int,i_current_price:decimal(7,2),i_color:string,i_product_name:string>)
                        +- NativeSort [item_sk#23 ASC NULLS FIRST, store_name#24 ASC NULLS FIRST, store_zip#25 ASC NULLS FIRST], false
                           +- InputAdapter
                              +- AQEShuffleRead coalesced
                                 +- ShuffleQueryStage 99
                                    +- NativeShuffleExchange hashpartitioning(item_sk#23, store_name#24, store_zip#25, 100), ENSURE_REQUIREMENTS, [plan_id=34]
                                       +- NativeProject [i_item_sk#108 AS item_sk#23, s_store_name#109 AS store_name#24, s_zip#110 AS store_zip#25, d_year#111 AS syear#21, count(1)#39 AS cnt#3, MakeDecimal(sum(UnscaledValue(ss_wholesale_cost#112))#41,17,2) AS s1#5, MakeDecimal(sum(UnscaledValue(ss_list_price#113))#43,17,2) AS s2#19, MakeDecimal(sum(UnscaledValue(ss_coupon_amt#114))#45,17,2) AS s3#20]
                                          +- NativeHashAggregate HashAgg, ArrayBuffer(i_product_name#115, i_item_sk#108, s_store_name#109, s_zip#110, ca_street_number#116, ca_street_name#117, ca_city#118, ca_zip#119, ca_street_number#120, ca_street_name#121, ca_city#122, ca_zip#123, d_year#111, d_year#124, d_year#125), [i_product_name#115, i_item_sk#108, s_store_name#109, s_zip#110, ca_street_number#116, ca_street_name#117, ca_city#118, ca_zip#119, ca_street_number#120, ca_street_name#121, ca_city#122, ca_zip#123, d_year#111, d_year#124, d_year#125], [count(1), sum(UnscaledValue(ss_wholesale_cost#112)), sum(UnscaledValue(ss_list_price#113)), sum(UnscaledValue(ss_coupon_amt#114))], [count(1)#39, sum(UnscaledValue(ss_wholesale_cost#112))#41, sum(UnscaledValue(ss_list_price#113))#43, sum(UnscaledValue(ss_coupon_amt#114))#45], 15
                                             +- NativeHashAggregate HashAgg, [i_product_name#115, i_item_sk#108, s_store_name#109, s_zip#110, ca_street_number#116, ca_street_name#117, ca_city#118, ca_zip#119, ca_street_number#120, ca_street_name#121, ca_city#122, ca_zip#123, d_year#111, d_year#124, d_year#125], [partial_count(1), partial_sum(_c15#126), partial_sum(_c16#127), partial_sum(_c17#128)], [count#51, sum#129, sum#130, sum#131], 0
                                                +- NativeProject [i_product_name#115 AS i_product_name#115, i_item_sk#108 AS i_item_sk#108, s_store_name#109 AS s_store_name#109, s_zip#110 AS s_zip#110, ca_street_number#116 AS ca_street_number#116, ca_street_name#117 AS ca_street_name#117, ca_city#118 AS ca_city#118, ca_zip#119 AS ca_zip#119, ca_street_number#120 AS ca_street_number#120, ca_street_name#121 AS ca_street_name#121, ca_city#122 AS ca_city#122, ca_zip#123 AS ca_zip#123, d_year#111 AS d_year#111, d_year#124 AS d_year#124, d_year#125 AS d_year#125, UnscaledValue(ss_wholesale_cost#112) AS _c15#126, UnscaledValue(ss_list_price#113) AS _c16#127, UnscaledValue(ss_coupon_amt#114) AS _c17#128]
                                                   +- NativeProject [ss_wholesale_cost#112, ss_list_price#113, ss_coupon_amt#114, d_year#111, d_year#124, d_year#125, s_store_name#109, s_zip#110, ca_street_number#116, ca_street_name#117, ca_city#118, ca_zip#119, ca_street_number#120, ca_street_name#121, ca_city#122, ca_zip#123, i_item_sk#108, i_product_name#115]
                                                      +- NativeSortMergeJoin [ss_item_sk#132], [i_item_sk#108], Inner
                                                         :- NativeSort [ss_item_sk#132 ASC NULLS FIRST], false
                                                         :  +- InputAdapter
                                                         :     +- AQEShuffleRead coalesced
                                                         :        +- ShuffleQueryStage 98
                                                         :           +- NativeShuffleExchange hashpartitioning(ss_item_sk#132, 100), ENSURE_REQUIREMENTS, [plan_id=35]
                                                         :              +- NativeProject [ss_item_sk#132, ss_wholesale_cost#112, ss_list_price#113, ss_coupon_amt#114, d_year#111, s_store_name#109, s_zip#110, d_year#124, d_year#125, ca_street_number#116, ca_street_name#117, ca_city#118, ca_zip#119, ca_street_number#120, ca_street_name#121, ca_city#122, ca_zip#123]
                                                         :                 +- NativeSortMergeJoin [hd_income_band_sk#133], [ib_income_band_sk#134], Inner
                                                         :                    :- NativeSort [hd_income_band_sk#133 ASC NULLS FIRST], false
                                                         :                    :  +- InputAdapter
                                                         :                    :     +- AQEShuffleRead coalesced
                                                         :                    :        +- ShuffleQueryStage 96
                                                         :                    :           +- NativeShuffleExchange hashpartitioning(hd_income_band_sk#133, 100), ENSURE_REQUIREMENTS, [plan_id=36]
                                                         :                    :              +- NativeProject [ss_item_sk#132, ss_wholesale_cost#112, ss_list_price#113, ss_coupon_amt#114, d_year#111, s_store_name#109, s_zip#110, d_year#124, d_year#125, hd_income_band_sk#133, ca_street_number#116, ca_street_name#117, ca_city#118, ca_zip#119, ca_street_number#120, ca_street_name#121, ca_city#122, ca_zip#123]
                                                         :                    :                 +- NativeSortMergeJoin [hd_income_band_sk#135], [ib_income_band_sk#136], Inner
                                                         :                    :                    :- NativeSort [hd_income_band_sk#135 ASC NULLS FIRST], false
                                                         :                    :                    :  +- InputAdapter
                                                         :                    :                    :     +- AQEShuffleRead coalesced
                                                         :                    :                    :        +- ShuffleQueryStage 94
                                                         :                    :                    :           +- NativeShuffleExchange hashpartitioning(hd_income_band_sk#135, 100), ENSURE_REQUIREMENTS, [plan_id=37]
                                                         :                    :                    :              +- NativeProject [ss_item_sk#132, ss_wholesale_cost#112, ss_list_price#113, ss_coupon_amt#114, d_year#111, s_store_name#109, s_zip#110, d_year#124, d_year#125, hd_income_band_sk#135, hd_income_band_sk#133, ca_street_number#116, ca_street_name#117, ca_city#118, ca_zip#119, ca_street_number#120, ca_street_name#121, ca_city#122, ca_zip#123]
                                                         :                    :                    :                 +- NativeSortMergeJoin [c_current_addr_sk#137], [ca_address_sk#138], Inner
                                                         :                    :                    :                    :- NativeSort [c_current_addr_sk#137 ASC NULLS FIRST], false
                                                         :                    :                    :                    :  +- InputAdapter
                                                         :                    :                    :                    :     +- AQEShuffleRead coalesced
                                                         :                    :                    :                    :        +- ShuffleQueryStage 92
                                                         :                    :                    :                    :           +- NativeShuffleExchange hashpartitioning(c_current_addr_sk#137, 100), ENSURE_REQUIREMENTS, [plan_id=38]
                                                         :                    :                    :                    :              +- NativeProject [ss_item_sk#132, ss_wholesale_cost#112, ss_list_price#113, ss_coupon_amt#114, d_year#111, s_store_name#109, s_zip#110, c_current_addr_sk#137, d_year#124, d_year#125, hd_income_band_sk#135, hd_income_band_sk#133, ca_street_number#116, ca_street_name#117, ca_city#118, ca_zip#119]
                                                         :                    :                    :                    :                 +- NativeSortMergeJoin [ss_addr_sk#139], [ca_address_sk#140], Inner
                                                         :                    :                    :                    :                    :- NativeSort [ss_addr_sk#139 ASC NULLS FIRST], false
                                                         :                    :                    :                    :                    :  +- InputAdapter
                                                         :                    :                    :                    :                    :     +- AQEShuffleRead coalesced
                                                         :                    :                    :                    :                    :        +- ShuffleQueryStage 90
                                                         :                    :                    :                    :                    :           +- NativeShuffleExchange hashpartitioning(ss_addr_sk#139, 100), ENSURE_REQUIREMENTS, [plan_id=39]
                                                         :                    :                    :                    :                    :              +- NativeProject [ss_item_sk#132, ss_addr_sk#139, ss_wholesale_cost#112, ss_list_price#113, ss_coupon_amt#114, d_year#111, s_store_name#109, s_zip#110, c_current_addr_sk#137, d_year#124, d_year#125, hd_income_band_sk#135, hd_income_band_sk#133]
                                                         :                    :                    :                    :                    :                 +- NativeSortMergeJoin [c_current_hdemo_sk#141], [hd_demo_sk#142], Inner
                                                         :                    :                    :                    :                    :                    :- NativeSort [c_current_hdemo_sk#141 ASC NULLS FIRST], false
                                                         :                    :                    :                    :                    :                    :  +- InputAdapter
                                                         :                    :                    :                    :                    :                    :     +- AQEShuffleRead coalesced
                                                         :                    :                    :                    :                    :                    :        +- ShuffleQueryStage 88
                                                         :                    :                    :                    :                    :                    :           +- NativeShuffleExchange hashpartitioning(c_current_hdemo_sk#141, 100), ENSURE_REQUIREMENTS, [plan_id=40]
                                                         :                    :                    :                    :                    :                    :              +- NativeProject [ss_item_sk#132, ss_addr_sk#139, ss_wholesale_cost#112, ss_list_price#113, ss_coupon_amt#114, d_year#111, s_store_name#109, s_zip#110, c_current_hdemo_sk#141, c_current_addr_sk#137, d_year#124, d_year#125, hd_income_band_sk#135]
                                                         :                    :                    :                    :                    :                    :                 +- NativeSortMergeJoin [ss_hdemo_sk#143], [hd_demo_sk#144], Inner
                                                         :                    :                    :                    :                    :                    :                    :- NativeSort [ss_hdemo_sk#143 ASC NULLS FIRST], false
                                                         :                    :                    :                    :                    :                    :                    :  +- InputAdapter
                                                         :                    :                    :                    :                    :                    :                    :     +- AQEShuffleRead coalesced
                                                         :                    :                    :                    :                    :                    :                    :        +- ShuffleQueryStage 86
                                                         :                    :                    :                    :                    :                    :                    :           +- NativeShuffleExchange hashpartitioning(ss_hdemo_sk#143, 100), ENSURE_REQUIREMENTS, [plan_id=41]
                                                         :                    :                    :                    :                    :                    :                    :              +- NativeProject [ss_item_sk#132, ss_hdemo_sk#143, ss_addr_sk#139, ss_wholesale_cost#112, ss_list_price#113, ss_coupon_amt#114, d_year#111, s_store_name#109, s_zip#110, c_current_hdemo_sk#141, c_current_addr_sk#137, d_year#124, d_year#125]
                                                         :                    :                    :                    :                    :                    :                    :                 +- NativeSortMergeJoin [ss_promo_sk#145], [p_promo_sk#146], Inner
                                                         :                    :                    :                    :                    :                    :                    :                    :- NativeSort [ss_promo_sk#145 ASC NULLS FIRST], false
                                                         :                    :                    :                    :                    :                    :                    :                    :  +- InputAdapter
                                                         :                    :                    :                    :                    :                    :                    :                    :     +- AQEShuffleRead coalesced
                                                         :                    :                    :                    :                    :                    :                    :                    :        +- ShuffleQueryStage 83
                                                         :                    :                    :                    :                    :                    :                    :                    :           +- NativeShuffleExchange hashpartitioning(ss_promo_sk#145, 100), ENSURE_REQUIREMENTS, [plan_id=42]
                                                         :                    :                    :                    :                    :                    :                    :                    :              +- ConvertToNative
                                                         :                    :                    :                    :                    :                    :                    :                    :                 +- *(2) Project [ss_item_sk#132, ss_hdemo_sk#143, ss_addr_sk#139, ss_promo_sk#145, ss_wholesale_cost#112, ss_list_price#113, ss_coupon_amt#114, d_year#111, s_store_name#109, s_zip#110, c_current_hdemo_sk#141, c_current_addr_sk#137, d_year#124, d_year#125]
                                                         :                    :                    :                    :                    :                    :                    :                    :                    +- *(2) SortMergeJoin [c_current_cdemo_sk#147], [cd_demo_sk#148], Inner, NOT (cd_marital_status#149 = cd_marital_status#150)
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :- NativeSort [c_current_cdemo_sk#147 ASC NULLS FIRST], false
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :  +- InputAdapter
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :     +- AQEShuffleRead coalesced
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :        +- ShuffleQueryStage 81
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :           +- NativeShuffleExchange hashpartitioning(c_current_cdemo_sk#147, 100), ENSURE_REQUIREMENTS, [plan_id=43]
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :              +- NativeProject [ss_item_sk#132, ss_hdemo_sk#143, ss_addr_sk#139, ss_promo_sk#145, ss_wholesale_cost#112, ss_list_price#113, ss_coupon_amt#114, d_year#111, s_store_name#109, s_zip#110, c_current_cdemo_sk#147, c_current_hdemo_sk#141, c_current_addr_sk#137, d_year#124, d_year#125, cd_marital_status#149]
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                 +- NativeSortMergeJoin [ss_cdemo_sk#151], [cd_demo_sk#152], Inner
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :- NativeSort [ss_cdemo_sk#151 ASC NULLS FIRST], false
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :  +- InputAdapter
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :     +- AQEShuffleRead coalesced
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :        +- ShuffleQueryStage 79
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :           +- NativeShuffleExchange hashpartitioning(ss_cdemo_sk#151, 100), ENSURE_REQUIREMENTS, [plan_id=44]
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :              +- NativeProject [ss_item_sk#132, ss_cdemo_sk#151, ss_hdemo_sk#143, ss_addr_sk#139, ss_promo_sk#145, ss_wholesale_cost#112, ss_list_price#113, ss_coupon_amt#114, d_year#111, s_store_name#109, s_zip#110, c_current_cdemo_sk#147, c_current_hdemo_sk#141, c_current_addr_sk#137, d_year#124, d_year#125]
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                 +- NativeSortMergeJoin [c_first_shipto_date_sk#153], [d_date_sk#154], Inner
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :- NativeSort [c_first_shipto_date_sk#153 ASC NULLS FIRST], false
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :  +- InputAdapter
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :     +- AQEShuffleRead coalesced
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :        +- ShuffleQueryStage 77
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :           +- NativeShuffleExchange hashpartitioning(c_first_shipto_date_sk#153, 100), ENSURE_REQUIREMENTS, [plan_id=45]
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :              +- NativeProject [ss_item_sk#132, ss_cdemo_sk#151, ss_hdemo_sk#143, ss_addr_sk#139, ss_promo_sk#145, ss_wholesale_cost#112, ss_list_price#113, ss_coupon_amt#114, d_year#111, s_store_name#109, s_zip#110, c_current_cdemo_sk#147, c_current_hdemo_sk#141, c_current_addr_sk#137, c_first_shipto_date_sk#153, d_year#124]
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                 +- NativeSortMergeJoin [c_first_sales_date_sk#155], [d_date_sk#156], Inner
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :- NativeSort [c_first_sales_date_sk#155 ASC NULLS FIRST], false
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :  +- InputAdapter
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :     +- AQEShuffleRead coalesced
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :        +- ShuffleQueryStage 75
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :           +- NativeShuffleExchange hashpartitioning(c_first_sales_date_sk#155, 100), ENSURE_REQUIREMENTS, [plan_id=46]
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :              +- NativeProject [ss_item_sk#132, ss_cdemo_sk#151, ss_hdemo_sk#143, ss_addr_sk#139, ss_promo_sk#145, ss_wholesale_cost#112, ss_list_price#113, ss_coupon_amt#114, d_year#111, s_store_name#109, s_zip#110, c_current_cdemo_sk#147, c_current_hdemo_sk#141, c_current_addr_sk#137, c_first_shipto_date_sk#153, c_first_sales_date_sk#155]
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                 +- NativeSortMergeJoin [ss_customer_sk#157], [c_customer_sk#158], Inner
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :- NativeSort [ss_customer_sk#157 ASC NULLS FIRST], false
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :  +- InputAdapter
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :     +- AQEShuffleRead coalesced
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :        +- ShuffleQueryStage 73
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :           +- NativeShuffleExchange hashpartitioning(ss_customer_sk#157, 100), ENSURE_REQUIREMENTS, [plan_id=47]
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :              +- NativeProject [ss_item_sk#132, ss_customer_sk#157, ss_cdemo_sk#151, ss_hdemo_sk#143, ss_addr_sk#139, ss_promo_sk#145, ss_wholesale_cost#112, ss_list_price#113, ss_coupon_amt#114, d_year#111, s_store_name#109, s_zip#110]
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                 +- NativeSortMergeJoin [ss_store_sk#159], [s_store_sk#160], Inner
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :- NativeSort [ss_store_sk#159 ASC NULLS FIRST], false
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :  +- InputAdapter
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :     +- AQEShuffleRead coalesced
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :        +- ShuffleQueryStage 71
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :           +- NativeShuffleExchange hashpartitioning(ss_store_sk#159, 100), ENSURE_REQUIREMENTS, [plan_id=48]
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :              +- NativeProject [ss_item_sk#132, ss_customer_sk#157, ss_cdemo_sk#151, ss_hdemo_sk#143, ss_addr_sk#139, ss_store_sk#159, ss_promo_sk#145, ss_wholesale_cost#112, ss_list_price#113, ss_coupon_amt#114, d_year#111]
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                 +- NativeSortMergeJoin [ss_sold_date_sk#161], [d_date_sk#162], Inner
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :- NativeSort [ss_sold_date_sk#161 ASC NULLS FIRST], false
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :  +- InputAdapter
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :     +- InputAdapter [#161, #132, #157, #151, #143, #139, #159, #145, #112, #113, #114]
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :        +- AQEShuffleRead coalesced
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :           +- ShuffleQueryStage 69
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    :              +- ReusedExchange [ss_sold_date_sk#161, ss_item_sk#132, ss_customer_sk#157, ss_cdemo_sk#151, ss_hdemo_sk#143, ss_addr_sk#139, ss_store_sk#159, ss_promo_sk#145, ss_wholesale_cost#112, ss_list_price#113, ss_coupon_amt#114], NativeShuffleExchange hashpartitioning(ss_sold_date_sk#84, 100), ENSURE_REQUIREMENTS, [plan_id=17]
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                    +- NativeSort [d_date_sk#162 ASC NULLS FIRST], false
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                       +- InputAdapter
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                          +- AQEShuffleRead coalesced
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                             +- ShuffleQueryStage 32
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                                +- NativeShuffleExchange hashpartitioning(d_date_sk#162, 100), ENSURE_REQUIREMENTS, [plan_id=49]
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                                   +- NativeFilter ((isnotnull(d_year#111) AND (d_year#111 = 2000)) AND isnotnull(d_date_sk#162))
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                                      +- InputAdapter [#162, #111]
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    :                                         +- NativeParquetScan  (FileScan parquet [d_date_sk#162,d_year#111] Batched: true, DataFilters: [isnotnull(d_year#111), (d_year#111 = 2000), isnotnull(d_date_sk#162)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2000), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>)
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                    +- NativeSort [s_store_sk#160 ASC NULLS FIRST], false
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                       +- InputAdapter
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                          +- InputAdapter [#160, #109, #110]
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                             +- AQEShuffleRead coalesced
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                                +- ShuffleQueryStage 34
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    :                                   +- ReusedExchange [s_store_sk#160, s_store_name#109, s_zip#110], NativeShuffleExchange hashpartitioning(s_store_sk#83, 100), ENSURE_REQUIREMENTS, [plan_id=25]
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                    +- NativeSort [c_customer_sk#158 ASC NULLS FIRST], false
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                       +- InputAdapter
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                          +- InputAdapter [#158, #147, #141, #137, #153, #155]
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                             +- AQEShuffleRead coalesced
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                                +- ShuffleQueryStage 36
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    :                                   +- ReusedExchange [c_customer_sk#158, c_current_cdemo_sk#147, c_current_hdemo_sk#141, c_current_addr_sk#137, c_first_shipto_date_sk#153, c_first_sales_date_sk#155], NativeShuffleExchange hashpartitioning(c_customer_sk#81, 100), ENSURE_REQUIREMENTS, [plan_id=26]
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                    +- NativeSort [d_date_sk#156 ASC NULLS FIRST], false
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                       +- InputAdapter
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                          +- InputAdapter [#156, #124]
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                             +- AQEShuffleRead coalesced
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                                +- ShuffleQueryStage 38
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    :                                   +- ReusedExchange [d_date_sk#156, d_year#124], NativeShuffleExchange hashpartitioning(d_date_sk#79, 100), ENSURE_REQUIREMENTS, [plan_id=27]
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                    +- NativeSort [d_date_sk#154 ASC NULLS FIRST], false
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                       +- InputAdapter
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                          +- InputAdapter [#154, #125]
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                             +- AQEShuffleRead coalesced
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                                +- ShuffleQueryStage 40
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    :                                   +- ReusedExchange [d_date_sk#154, d_year#125], NativeShuffleExchange hashpartitioning(d_date_sk#79, 100), ENSURE_REQUIREMENTS, [plan_id=27]
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                    +- NativeSort [cd_demo_sk#152 ASC NULLS FIRST], false
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                       +- InputAdapter
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                          +- InputAdapter [#152, #149]
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                             +- AQEShuffleRead coalesced
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                                +- ShuffleQueryStage 42
                                                         :                    :                    :                    :                    :                    :                    :                    :                       :                                   +- ReusedExchange [cd_demo_sk#152, cd_marital_status#149], NativeShuffleExchange hashpartitioning(cd_demo_sk#75, 100), ENSURE_REQUIREMENTS, [plan_id=28]
                                                         :                    :                    :                    :                    :                    :                    :                    :                       +- NativeSort [cd_demo_sk#148 ASC NULLS FIRST], false
                                                         :                    :                    :                    :                    :                    :                    :                    :                          +- InputAdapter
                                                         :                    :                    :                    :                    :                    :                    :                    :                             +- InputAdapter [#148, #150]
                                                         :                    :                    :                    :                    :                    :                    :                    :                                +- AQEShuffleRead coalesced
                                                         :                    :                    :                    :                    :                    :                    :                    :                                   +- ShuffleQueryStage 44
                                                         :                    :                    :                    :                    :                    :                    :                    :                                      +- ReusedExchange [cd_demo_sk#148, cd_marital_status#150], NativeShuffleExchange hashpartitioning(cd_demo_sk#75, 100), ENSURE_REQUIREMENTS, [plan_id=28]
                                                         :                    :                    :                    :                    :                    :                    :                    +- NativeSort [p_promo_sk#146 ASC NULLS FIRST], false
                                                         :                    :                    :                    :                    :                    :                    :                       +- InputAdapter
                                                         :                    :                    :                    :                    :                    :                    :                          +- InputAdapter [#146]
                                                         :                    :                    :                    :                    :                    :                    :                             +- AQEShuffleRead coalesced
                                                         :                    :                    :                    :                    :                    :                    :                                +- ShuffleQueryStage 46
                                                         :                    :                    :                    :                    :                    :                    :                                   +- ReusedExchange [p_promo_sk#146], NativeShuffleExchange hashpartitioning(p_promo_sk#69, 100), ENSURE_REQUIREMENTS, [plan_id=29]
                                                         :                    :                    :                    :                    :                    :                    +- NativeSort [hd_demo_sk#144 ASC NULLS FIRST], false
                                                         :                    :                    :                    :                    :                    :                       +- InputAdapter
                                                         :                    :                    :                    :                    :                    :                          +- InputAdapter [#144, #135]
                                                         :                    :                    :                    :                    :                    :                             +- AQEShuffleRead coalesced
                                                         :                    :                    :                    :                    :                    :                                +- ShuffleQueryStage 48
                                                         :                    :                    :                    :                    :                    :                                   +- ReusedExchange [hd_demo_sk#144, hd_income_band_sk#135], NativeShuffleExchange hashpartitioning(hd_demo_sk#67, 100), ENSURE_REQUIREMENTS, [plan_id=30]
                                                         :                    :                    :                    :                    :                    +- NativeSort [hd_demo_sk#142 ASC NULLS FIRST], false
                                                         :                    :                    :                    :                    :                       +- InputAdapter
                                                         :                    :                    :                    :                    :                          +- InputAdapter [#142, #133]
                                                         :                    :                    :                    :                    :                             +- AQEShuffleRead coalesced
                                                         :                    :                    :                    :                    :                                +- ShuffleQueryStage 50
                                                         :                    :                    :                    :                    :                                   +- ReusedExchange [hd_demo_sk#142, hd_income_band_sk#133], NativeShuffleExchange hashpartitioning(hd_demo_sk#67, 100), ENSURE_REQUIREMENTS, [plan_id=30]
                                                         :                    :                    :                    :                    +- NativeSort [ca_address_sk#140 ASC NULLS FIRST], false
                                                         :                    :                    :                    :                       +- InputAdapter
                                                         :                    :                    :                    :                          +- InputAdapter [#140, #116, #117, #118, #119]
                                                         :                    :                    :                    :                             +- AQEShuffleRead coalesced
                                                         :                    :                    :                    :                                +- ShuffleQueryStage 52
                                                         :                    :                    :                    :                                   +- ReusedExchange [ca_address_sk#140, ca_street_number#116, ca_street_name#117, ca_city#118, ca_zip#119], NativeShuffleExchange hashpartitioning(ca_address_sk#63, 100), ENSURE_REQUIREMENTS, [plan_id=31]
                                                         :                    :                    :                    +- NativeSort [ca_address_sk#138 ASC NULLS FIRST], false
                                                         :                    :                    :                       +- InputAdapter
                                                         :                    :                    :                          +- InputAdapter [#138, #120, #121, #122, #123]
                                                         :                    :                    :                             +- AQEShuffleRead coalesced
                                                         :                    :                    :                                +- ShuffleQueryStage 54
                                                         :                    :                    :                                   +- ReusedExchange [ca_address_sk#138, ca_street_number#120, ca_street_name#121, ca_city#122, ca_zip#123], NativeShuffleExchange hashpartitioning(ca_address_sk#63, 100), ENSURE_REQUIREMENTS, [plan_id=31]
                                                         :                    :                    +- NativeSort [ib_income_band_sk#136 ASC NULLS FIRST], false
                                                         :                    :                       +- InputAdapter
                                                         :                    :                          +- InputAdapter [#136]
                                                         :                    :                             +- AQEShuffleRead coalesced
                                                         :                    :                                +- ShuffleQueryStage 56
                                                         :                    :                                   +- ReusedExchange [ib_income_band_sk#136], NativeShuffleExchange hashpartitioning(ib_income_band_sk#59, 100), ENSURE_REQUIREMENTS, [plan_id=32]
                                                         :                    +- NativeSort [ib_income_band_sk#134 ASC NULLS FIRST], false
                                                         :                       +- InputAdapter
                                                         :                          +- InputAdapter [#134]
                                                         :                             +- AQEShuffleRead coalesced
                                                         :                                +- ShuffleQueryStage 58
                                                         :                                   +- ReusedExchange [ib_income_band_sk#134], NativeShuffleExchange hashpartitioning(ib_income_band_sk#59, 100), ENSURE_REQUIREMENTS, [plan_id=32]
                                                         +- NativeSort [i_item_sk#108 ASC NULLS FIRST], false
                                                            +- InputAdapter
                                                               +- InputAdapter [#108, #115]
                                                                  +- AQEShuffleRead coalesced
                                                                     +- ShuffleQueryStage 60
                                                                        +- ReusedExchange [i_item_sk#108, i_product_name#115], NativeShuffleExchange hashpartitioning(i_item_sk#27, 100), ENSURE_REQUIREMENTS, [plan_id=33]
+- == Initial Plan ==
   Sort [product_name#1 ASC NULLS FIRST, store_name#2 ASC NULLS FIRST, cnt#3 ASC NULLS FIRST, s1#4 ASC NULLS FIRST, s1#5 ASC NULLS FIRST], true, 0
   +- Exchange rangepartitioning(product_name#1 ASC NULLS FIRST, store_name#2 ASC NULLS FIRST, cnt#3 ASC NULLS FIRST, s1#4 ASC NULLS FIRST, s1#5 ASC NULLS FIRST, 100), ENSURE_REQUIREMENTS, [plan_id=50]
      +- Project [product_name#1, store_name#2, store_zip#6, b_street_number#7, b_streen_name#8, b_city#9, b_zip#10, c_street_number#11, c_street_name#12, c_city#13, c_zip#14, syear#15, cnt#16, s1#4, s2#17, s3#18, s1#5, s2#19, s3#20, syear#21, cnt#3]
         +- SortMergeJoin [item_sk#22, store_name#2, store_zip#6], [item_sk#23, store_name#24, store_zip#25], Inner, (cnt#3 <= cnt#16)
            :- Sort [item_sk#22 ASC NULLS FIRST, store_name#2 ASC NULLS FIRST, store_zip#6 ASC NULLS FIRST], false, 0
            :  +- Exchange hashpartitioning(item_sk#22, store_name#2, store_zip#6, 100), ENSURE_REQUIREMENTS, [plan_id=51]
            :     +- HashAggregate(keys=[i_product_name#26, i_item_sk#27, s_store_name#28, s_zip#29, ca_street_number#30, ca_street_name#31, ca_city#32, ca_zip#33, ca_street_number#34, ca_street_name#35, ca_city#36, ca_zip#37, d_year#38, d_year#46, d_year#47], functions=[count(1), sum(UnscaledValue(ss_wholesale_cost#40)), sum(UnscaledValue(ss_list_price#42)), sum(UnscaledValue(ss_coupon_amt#44))], output=[product_name#1, item_sk#22, store_name#2, store_zip#6, b_street_number#7, b_streen_name#8, b_city#9, b_zip#10, c_street_number#11, c_street_name#12, c_city#13, c_zip#14, syear#15, cnt#16, s1#4, s2#17, s3#18])
            :        +- HashAggregate(keys=[i_product_name#26, i_item_sk#27, s_store_name#28, s_zip#29, ca_street_number#30, ca_street_name#31, ca_city#32, ca_zip#33, ca_street_number#34, ca_street_name#35, ca_city#36, ca_zip#37, d_year#38, d_year#46, d_year#47], functions=[partial_count(1), partial_sum(UnscaledValue(ss_wholesale_cost#40)), partial_sum(UnscaledValue(ss_list_price#42)), partial_sum(UnscaledValue(ss_coupon_amt#44))], output=[i_product_name#26, i_item_sk#27, s_store_name#28, s_zip#29, ca_street_number#30, ca_street_name#31, ca_city#32, ca_zip#33, ca_street_number#34, ca_street_name#35, ca_city#36, ca_zip#37, d_year#38, d_year#46, d_year#47, count#163, sum#164, sum#165, sum#166])
            :           +- Project [ss_wholesale_cost#40, ss_list_price#42, ss_coupon_amt#44, d_year#38, d_year#46, d_year#47, s_store_name#28, s_zip#29, ca_street_number#30, ca_street_name#31, ca_city#32, ca_zip#33, ca_street_number#34, ca_street_name#35, ca_city#36, ca_zip#37, i_item_sk#27, i_product_name#26]
            :              +- SortMergeJoin [ss_item_sk#55], [i_item_sk#27], Inner
            :                 :- Sort [ss_item_sk#55 ASC NULLS FIRST], false, 0
            :                 :  +- Exchange hashpartitioning(ss_item_sk#55, 100), ENSURE_REQUIREMENTS, [plan_id=52]
            :                 :     +- Project [ss_item_sk#55, ss_wholesale_cost#40, ss_list_price#42, ss_coupon_amt#44, d_year#38, s_store_name#28, s_zip#29, d_year#46, d_year#47, ca_street_number#30, ca_street_name#31, ca_city#32, ca_zip#33, ca_street_number#34, ca_street_name#35, ca_city#36, ca_zip#37]
            :                 :        +- SortMergeJoin [hd_income_band_sk#56], [ib_income_band_sk#57], Inner
            :                 :           :- Sort [hd_income_band_sk#56 ASC NULLS FIRST], false, 0
            :                 :           :  +- Exchange hashpartitioning(hd_income_band_sk#56, 100), ENSURE_REQUIREMENTS, [plan_id=53]
            :                 :           :     +- Project [ss_item_sk#55, ss_wholesale_cost#40, ss_list_price#42, ss_coupon_amt#44, d_year#38, s_store_name#28, s_zip#29, d_year#46, d_year#47, hd_income_band_sk#56, ca_street_number#30, ca_street_name#31, ca_city#32, ca_zip#33, ca_street_number#34, ca_street_name#35, ca_city#36, ca_zip#37]
            :                 :           :        +- SortMergeJoin [hd_income_band_sk#58], [ib_income_band_sk#59], Inner
            :                 :           :           :- Sort [hd_income_band_sk#58 ASC NULLS FIRST], false, 0
            :                 :           :           :  +- Exchange hashpartitioning(hd_income_band_sk#58, 100), ENSURE_REQUIREMENTS, [plan_id=54]
            :                 :           :           :     +- Project [ss_item_sk#55, ss_wholesale_cost#40, ss_list_price#42, ss_coupon_amt#44, d_year#38, s_store_name#28, s_zip#29, d_year#46, d_year#47, hd_income_band_sk#58, hd_income_band_sk#56, ca_street_number#30, ca_street_name#31, ca_city#32, ca_zip#33, ca_street_number#34, ca_street_name#35, ca_city#36, ca_zip#37]
            :                 :           :           :        +- SortMergeJoin [c_current_addr_sk#60], [ca_address_sk#61], Inner
            :                 :           :           :           :- Sort [c_current_addr_sk#60 ASC NULLS FIRST], false, 0
            :                 :           :           :           :  +- Exchange hashpartitioning(c_current_addr_sk#60, 100), ENSURE_REQUIREMENTS, [plan_id=55]
            :                 :           :           :           :     +- Project [ss_item_sk#55, ss_wholesale_cost#40, ss_list_price#42, ss_coupon_amt#44, d_year#38, s_store_name#28, s_zip#29, c_current_addr_sk#60, d_year#46, d_year#47, hd_income_band_sk#58, hd_income_band_sk#56, ca_street_number#30, ca_street_name#31, ca_city#32, ca_zip#33]
            :                 :           :           :           :        +- SortMergeJoin [ss_addr_sk#62], [ca_address_sk#63], Inner
            :                 :           :           :           :           :- Sort [ss_addr_sk#62 ASC NULLS FIRST], false, 0
            :                 :           :           :           :           :  +- Exchange hashpartitioning(ss_addr_sk#62, 100), ENSURE_REQUIREMENTS, [plan_id=56]
            :                 :           :           :           :           :     +- Project [ss_item_sk#55, ss_addr_sk#62, ss_wholesale_cost#40, ss_list_price#42, ss_coupon_amt#44, d_year#38, s_store_name#28, s_zip#29, c_current_addr_sk#60, d_year#46, d_year#47, hd_income_band_sk#58, hd_income_band_sk#56]
            :                 :           :           :           :           :        +- SortMergeJoin [c_current_hdemo_sk#64], [hd_demo_sk#65], Inner
            :                 :           :           :           :           :           :- Sort [c_current_hdemo_sk#64 ASC NULLS FIRST], false, 0
            :                 :           :           :           :           :           :  +- Exchange hashpartitioning(c_current_hdemo_sk#64, 100), ENSURE_REQUIREMENTS, [plan_id=57]
            :                 :           :           :           :           :           :     +- Project [ss_item_sk#55, ss_addr_sk#62, ss_wholesale_cost#40, ss_list_price#42, ss_coupon_amt#44, d_year#38, s_store_name#28, s_zip#29, c_current_hdemo_sk#64, c_current_addr_sk#60, d_year#46, d_year#47, hd_income_band_sk#58]
            :                 :           :           :           :           :           :        +- SortMergeJoin [ss_hdemo_sk#66], [hd_demo_sk#67], Inner
            :                 :           :           :           :           :           :           :- Sort [ss_hdemo_sk#66 ASC NULLS FIRST], false, 0
            :                 :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_hdemo_sk#66, 100), ENSURE_REQUIREMENTS, [plan_id=58]
            :                 :           :           :           :           :           :           :     +- Project [ss_item_sk#55, ss_hdemo_sk#66, ss_addr_sk#62, ss_wholesale_cost#40, ss_list_price#42, ss_coupon_amt#44, d_year#38, s_store_name#28, s_zip#29, c_current_hdemo_sk#64, c_current_addr_sk#60, d_year#46, d_year#47]
            :                 :           :           :           :           :           :           :        +- SortMergeJoin [ss_promo_sk#68], [p_promo_sk#69], Inner
            :                 :           :           :           :           :           :           :           :- Sort [ss_promo_sk#68 ASC NULLS FIRST], false, 0
            :                 :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_promo_sk#68, 100), ENSURE_REQUIREMENTS, [plan_id=59]
            :                 :           :           :           :           :           :           :           :     +- Project [ss_item_sk#55, ss_hdemo_sk#66, ss_addr_sk#62, ss_promo_sk#68, ss_wholesale_cost#40, ss_list_price#42, ss_coupon_amt#44, d_year#38, s_store_name#28, s_zip#29, c_current_hdemo_sk#64, c_current_addr_sk#60, d_year#46, d_year#47]
            :                 :           :           :           :           :           :           :           :        +- SortMergeJoin [c_current_cdemo_sk#70], [cd_demo_sk#71], Inner, NOT (cd_marital_status#72 = cd_marital_status#73)
            :                 :           :           :           :           :           :           :           :           :- Sort [c_current_cdemo_sk#70 ASC NULLS FIRST], false, 0
            :                 :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(c_current_cdemo_sk#70, 100), ENSURE_REQUIREMENTS, [plan_id=60]
            :                 :           :           :           :           :           :           :           :           :     +- Project [ss_item_sk#55, ss_hdemo_sk#66, ss_addr_sk#62, ss_promo_sk#68, ss_wholesale_cost#40, ss_list_price#42, ss_coupon_amt#44, d_year#38, s_store_name#28, s_zip#29, c_current_cdemo_sk#70, c_current_hdemo_sk#64, c_current_addr_sk#60, d_year#46, d_year#47, cd_marital_status#72]
            :                 :           :           :           :           :           :           :           :           :        +- SortMergeJoin [ss_cdemo_sk#74], [cd_demo_sk#75], Inner
            :                 :           :           :           :           :           :           :           :           :           :- Sort [ss_cdemo_sk#74 ASC NULLS FIRST], false, 0
            :                 :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_cdemo_sk#74, 100), ENSURE_REQUIREMENTS, [plan_id=61]
            :                 :           :           :           :           :           :           :           :           :           :     +- Project [ss_item_sk#55, ss_cdemo_sk#74, ss_hdemo_sk#66, ss_addr_sk#62, ss_promo_sk#68, ss_wholesale_cost#40, ss_list_price#42, ss_coupon_amt#44, d_year#38, s_store_name#28, s_zip#29, c_current_cdemo_sk#70, c_current_hdemo_sk#64, c_current_addr_sk#60, d_year#46, d_year#47]
            :                 :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [c_first_shipto_date_sk#76], [d_date_sk#77], Inner
            :                 :           :           :           :           :           :           :           :           :           :           :- Sort [c_first_shipto_date_sk#76 ASC NULLS FIRST], false, 0
            :                 :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(c_first_shipto_date_sk#76, 100), ENSURE_REQUIREMENTS, [plan_id=62]
            :                 :           :           :           :           :           :           :           :           :           :           :     +- Project [ss_item_sk#55, ss_cdemo_sk#74, ss_hdemo_sk#66, ss_addr_sk#62, ss_promo_sk#68, ss_wholesale_cost#40, ss_list_price#42, ss_coupon_amt#44, d_year#38, s_store_name#28, s_zip#29, c_current_cdemo_sk#70, c_current_hdemo_sk#64, c_current_addr_sk#60, c_first_shipto_date_sk#76, d_year#46]
            :                 :           :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [c_first_sales_date_sk#78], [d_date_sk#79], Inner
            :                 :           :           :           :           :           :           :           :           :           :           :           :- Sort [c_first_sales_date_sk#78 ASC NULLS FIRST], false, 0
            :                 :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(c_first_sales_date_sk#78, 100), ENSURE_REQUIREMENTS, [plan_id=63]
            :                 :           :           :           :           :           :           :           :           :           :           :           :     +- Project [ss_item_sk#55, ss_cdemo_sk#74, ss_hdemo_sk#66, ss_addr_sk#62, ss_promo_sk#68, ss_wholesale_cost#40, ss_list_price#42, ss_coupon_amt#44, d_year#38, s_store_name#28, s_zip#29, c_current_cdemo_sk#70, c_current_hdemo_sk#64, c_current_addr_sk#60, c_first_shipto_date_sk#76, c_first_sales_date_sk#78]
            :                 :           :           :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [ss_customer_sk#80], [c_customer_sk#81], Inner
            :                 :           :           :           :           :           :           :           :           :           :           :           :           :- Sort [ss_customer_sk#80 ASC NULLS FIRST], false, 0
            :                 :           :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_customer_sk#80, 100), ENSURE_REQUIREMENTS, [plan_id=64]
            :                 :           :           :           :           :           :           :           :           :           :           :           :           :     +- Project [ss_item_sk#55, ss_customer_sk#80, ss_cdemo_sk#74, ss_hdemo_sk#66, ss_addr_sk#62, ss_promo_sk#68, ss_wholesale_cost#40, ss_list_price#42, ss_coupon_amt#44, d_year#38, s_store_name#28, s_zip#29]
            :                 :           :           :           :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [ss_store_sk#82], [s_store_sk#83], Inner
            :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :- Sort [ss_store_sk#82 ASC NULLS FIRST], false, 0
            :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_store_sk#82, 100), ENSURE_REQUIREMENTS, [plan_id=65]
            :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :     +- Project [ss_item_sk#55, ss_customer_sk#80, ss_cdemo_sk#74, ss_hdemo_sk#66, ss_addr_sk#62, ss_store_sk#82, ss_promo_sk#68, ss_wholesale_cost#40, ss_list_price#42, ss_coupon_amt#44, d_year#38]
            :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [ss_sold_date_sk#84], [d_date_sk#85], Inner
            :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :- Sort [ss_sold_date_sk#84 ASC NULLS FIRST], false, 0
            :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_sold_date_sk#84, 100), ENSURE_REQUIREMENTS, [plan_id=66]
            :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :     +- Project [ss_sold_date_sk#84, ss_item_sk#55, ss_customer_sk#80, ss_cdemo_sk#74, ss_hdemo_sk#66, ss_addr_sk#62, ss_store_sk#82, ss_promo_sk#68, ss_wholesale_cost#40, ss_list_price#42, ss_coupon_amt#44]
            :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [ss_item_sk#55], [cs_item_sk#86], Inner
            :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :- Sort [ss_item_sk#55 ASC NULLS FIRST], false, 0
            :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_item_sk#55, 100), ENSURE_REQUIREMENTS, [plan_id=67]
            :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :     +- Project [ss_sold_date_sk#84, ss_item_sk#55, ss_customer_sk#80, ss_cdemo_sk#74, ss_hdemo_sk#66, ss_addr_sk#62, ss_store_sk#82, ss_promo_sk#68, ss_wholesale_cost#40, ss_list_price#42, ss_coupon_amt#44]
            :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [ss_item_sk#55, ss_ticket_number#87], [sr_item_sk#88, sr_ticket_number#89], Inner
            :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :- Sort [ss_item_sk#55 ASC NULLS FIRST, ss_ticket_number#87 ASC NULLS FIRST], false, 0
            :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_item_sk#55, ss_ticket_number#87, 100), ENSURE_REQUIREMENTS, [plan_id=68]
            :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :     +- Filter ((((((((isnotnull(ss_item_sk#55) AND isnotnull(ss_ticket_number#87)) AND isnotnull(ss_sold_date_sk#84)) AND isnotnull(ss_store_sk#82)) AND isnotnull(ss_customer_sk#80)) AND isnotnull(ss_cdemo_sk#74)) AND isnotnull(ss_promo_sk#68)) AND isnotnull(ss_hdemo_sk#66)) AND isnotnull(ss_addr_sk#62))
            :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :        +- FileScan parquet [ss_sold_date_sk#84,ss_item_sk#55,ss_customer_sk#80,ss_cdemo_sk#74,ss_hdemo_sk#66,ss_addr_sk#62,ss_store_sk#82,ss_promo_sk#68,ss_ticket_number#87,ss_wholesale_cost#40,ss_list_price#42,ss_coupon_amt#44] Batched: true, DataFilters: [isnotnull(ss_item_sk#55), isnotnull(ss_ticket_number#87), isnotnull(ss_sold_date_sk#84)..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_ticket_number), IsNotNull(ss_sold_date_sk), IsNotNull(ss_sto..., ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_customer_sk:int,ss_cdemo_sk:int,ss_hdemo_sk:int,ss_a...
            :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           +- Sort [sr_item_sk#88 ASC NULLS FIRST, sr_ticket_number#89 ASC NULLS FIRST], false, 0
            :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(sr_item_sk#88, sr_ticket_number#89, 100), ENSURE_REQUIREMENTS, [plan_id=69]
            :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                 +- Filter (isnotnull(sr_item_sk#88) AND isnotnull(sr_ticket_number#89))
            :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                    +- FileScan parquet [sr_item_sk#88,sr_ticket_number#89] Batched: true, DataFilters: [isnotnull(sr_item_sk#88), isnotnull(sr_ticket_number#89)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(sr_item_sk), IsNotNull(sr_ticket_number)], ReadSchema: struct<sr_item_sk:int,sr_ticket_number:int>
            :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           +- Sort [cs_item_sk#86 ASC NULLS FIRST], false, 0
            :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :              +- Project [cs_item_sk#86]
            :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                 +- Filter ((isnotnull(sale#90) AND isnotnull(refund#91)) AND (cast(sale#90 as decimal(21,2)) > (2 * refund#91)))
            :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                    +- HashAggregate(keys=[cs_item_sk#86], functions=[sum(UnscaledValue(cs_ext_list_price#92)), sum(((cr_refunded_cash#94 + cr_reversed_charge#95) + cr_store_credit#96))], output=[cs_item_sk#86, sale#90, refund#91])
            :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                       +- Exchange hashpartitioning(cs_item_sk#86, 100), ENSURE_REQUIREMENTS, [plan_id=70]
            :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                          +- HashAggregate(keys=[cs_item_sk#86], functions=[partial_sum(UnscaledValue(cs_ext_list_price#92)), partial_sum(((cr_refunded_cash#94 + cr_reversed_charge#95) + cr_store_credit#96))], output=[cs_item_sk#86, sum#167, sum#168, isEmpty#169])
            :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                             +- Project [cs_item_sk#86, cs_ext_list_price#92, cr_refunded_cash#94, cr_reversed_charge#95, cr_store_credit#96]
            :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                +- SortMergeJoin [cs_item_sk#86, cs_order_number#103], [cr_item_sk#104, cr_order_number#105], Inner
            :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                   :- Sort [cs_item_sk#86 ASC NULLS FIRST, cs_order_number#103 ASC NULLS FIRST], false, 0
            :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                   :  +- Exchange hashpartitioning(cs_item_sk#86, cs_order_number#103, 100), ENSURE_REQUIREMENTS, [plan_id=71]
            :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                   :     +- Filter (isnotnull(cs_item_sk#86) AND isnotnull(cs_order_number#103))
            :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                   :        +- FileScan parquet [cs_item_sk#86,cs_order_number#103,cs_ext_list_price#92] Batched: true, DataFilters: [isnotnull(cs_item_sk#86), isnotnull(cs_order_number#103)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_order_number)], ReadSchema: struct<cs_item_sk:int,cs_order_number:int,cs_ext_list_price:decimal(7,2)>
            :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                   +- Sort [cr_item_sk#104 ASC NULLS FIRST, cr_order_number#105 ASC NULLS FIRST], false, 0
            :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                      +- Exchange hashpartitioning(cr_item_sk#104, cr_order_number#105, 100), ENSURE_REQUIREMENTS, [plan_id=72]
            :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                         +- Filter (isnotnull(cr_item_sk#104) AND isnotnull(cr_order_number#105))
            :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                            +- FileScan parquet [cr_item_sk#104,cr_order_number#105,cr_refunded_cash#94,cr_reversed_charge#95,cr_store_credit#96] Batched: true, DataFilters: [isnotnull(cr_item_sk#104), isnotnull(cr_order_number#105)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cr_item_sk), IsNotNull(cr_order_number)], ReadSchema: struct<cr_item_sk:int,cr_order_number:int,cr_refunded_cash:decimal(7,2),cr_reversed_charge:decima...
            :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           +- Sort [d_date_sk#85 ASC NULLS FIRST], false, 0
            :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(d_date_sk#85, 100), ENSURE_REQUIREMENTS, [plan_id=73]
            :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :                 +- Filter ((isnotnull(d_year#38) AND (d_year#38 = 1999)) AND isnotnull(d_date_sk#85))
            :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :                    +- FileScan parquet [d_date_sk#85,d_year#38] Batched: true, DataFilters: [isnotnull(d_year#38), (d_year#38 = 1999), isnotnull(d_date_sk#85)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,1999), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
            :                 :           :           :           :           :           :           :           :           :           :           :           :           :           +- Sort [s_store_sk#83 ASC NULLS FIRST], false, 0
            :                 :           :           :           :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(s_store_sk#83, 100), ENSURE_REQUIREMENTS, [plan_id=74]
            :                 :           :           :           :           :           :           :           :           :           :           :           :           :                 +- Filter ((isnotnull(s_store_sk#83) AND isnotnull(s_store_name#28)) AND isnotnull(s_zip#29))
            :                 :           :           :           :           :           :           :           :           :           :           :           :           :                    +- FileScan parquet [s_store_sk#83,s_store_name#28,s_zip#29] Batched: true, DataFilters: [isnotnull(s_store_sk#83), isnotnull(s_store_name#28), isnotnull(s_zip#29)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk), IsNotNull(s_store_name), IsNotNull(s_zip)], ReadSchema: struct<s_store_sk:int,s_store_name:string,s_zip:string>
            :                 :           :           :           :           :           :           :           :           :           :           :           :           +- Sort [c_customer_sk#81 ASC NULLS FIRST], false, 0
            :                 :           :           :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(c_customer_sk#81, 100), ENSURE_REQUIREMENTS, [plan_id=75]
            :                 :           :           :           :           :           :           :           :           :           :           :           :                 +- Filter (((((isnotnull(c_customer_sk#81) AND isnotnull(c_first_sales_date_sk#78)) AND isnotnull(c_first_shipto_date_sk#76)) AND isnotnull(c_current_cdemo_sk#70)) AND isnotnull(c_current_hdemo_sk#64)) AND isnotnull(c_current_addr_sk#60))
            :                 :           :           :           :           :           :           :           :           :           :           :           :                    +- FileScan parquet [c_customer_sk#81,c_current_cdemo_sk#70,c_current_hdemo_sk#64,c_current_addr_sk#60,c_first_shipto_date_sk#76,c_first_sales_date_sk#78] Batched: true, DataFilters: [isnotnull(c_customer_sk#81), isnotnull(c_first_sales_date_sk#78), isnotnull(c_first_shipto..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_first_sales_date_sk), IsNotNull(c_first_shipto_date_sk), I..., ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_hdemo_sk:int,c_current_addr_sk:int,c_fi...
            :                 :           :           :           :           :           :           :           :           :           :           :           +- Sort [d_date_sk#79 ASC NULLS FIRST], false, 0
            :                 :           :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(d_date_sk#79, 100), ENSURE_REQUIREMENTS, [plan_id=76]
            :                 :           :           :           :           :           :           :           :           :           :           :                 +- Filter isnotnull(d_date_sk#79)
            :                 :           :           :           :           :           :           :           :           :           :           :                    +- FileScan parquet [d_date_sk#79,d_year#46] Batched: true, DataFilters: [isnotnull(d_date_sk#79)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
            :                 :           :           :           :           :           :           :           :           :           :           +- Sort [d_date_sk#77 ASC NULLS FIRST], false, 0
            :                 :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(d_date_sk#77, 100), ENSURE_REQUIREMENTS, [plan_id=77]
            :                 :           :           :           :           :           :           :           :           :           :                 +- Filter isnotnull(d_date_sk#77)
            :                 :           :           :           :           :           :           :           :           :           :                    +- FileScan parquet [d_date_sk#77,d_year#47] Batched: true, DataFilters: [isnotnull(d_date_sk#77)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
            :                 :           :           :           :           :           :           :           :           :           +- Sort [cd_demo_sk#75 ASC NULLS FIRST], false, 0
            :                 :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(cd_demo_sk#75, 100), ENSURE_REQUIREMENTS, [plan_id=78]
            :                 :           :           :           :           :           :           :           :           :                 +- Filter (isnotnull(cd_demo_sk#75) AND isnotnull(cd_marital_status#72))
            :                 :           :           :           :           :           :           :           :           :                    +- FileScan parquet [cd_demo_sk#75,cd_marital_status#72] Batched: true, DataFilters: [isnotnull(cd_demo_sk#75), isnotnull(cd_marital_status#72)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>, PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
            :                 :           :           :           :           :           :           :           :           +- Sort [cd_demo_sk#71 ASC NULLS FIRST], false, 0
            :                 :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(cd_demo_sk#71, 100), ENSURE_REQUIREMENTS, [plan_id=79]
            :                 :           :           :           :           :           :           :           :                 +- Filter (isnotnull(cd_demo_sk#71) AND isnotnull(cd_marital_status#73))
            :                 :           :           :           :           :           :           :           :                    +- FileScan parquet [cd_demo_sk#71,cd_marital_status#73] Batched: true, DataFilters: [isnotnull(cd_demo_sk#71), isnotnull(cd_marital_status#73)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>, PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
            :                 :           :           :           :           :           :           :           +- Sort [p_promo_sk#69 ASC NULLS FIRST], false, 0
            :                 :           :           :           :           :           :           :              +- Exchange hashpartitioning(p_promo_sk#69, 100), ENSURE_REQUIREMENTS, [plan_id=80]
            :                 :           :           :           :           :           :           :                 +- Filter isnotnull(p_promo_sk#69)
            :                 :           :           :           :           :           :           :                    +- FileScan parquet [p_promo_sk#69] Batched: true, DataFilters: [isnotnull(p_promo_sk#69)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(p_promo_sk)], ReadSchema: struct<p_promo_sk:int>
            :                 :           :           :           :           :           :           +- Sort [hd_demo_sk#67 ASC NULLS FIRST], false, 0
            :                 :           :           :           :           :           :              +- Exchange hashpartitioning(hd_demo_sk#67, 100), ENSURE_REQUIREMENTS, [plan_id=81]
            :                 :           :           :           :           :           :                 +- Filter (isnotnull(hd_demo_sk#67) AND isnotnull(hd_income_band_sk#58))
            :                 :           :           :           :           :           :                    +- FileScan parquet [hd_demo_sk#67,hd_income_band_sk#58] Batched: true, DataFilters: [isnotnull(hd_demo_sk#67), isnotnull(hd_income_band_sk#58)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>, PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
            :                 :           :           :           :           :           +- Sort [hd_demo_sk#65 ASC NULLS FIRST], false, 0
            :                 :           :           :           :           :              +- Exchange hashpartitioning(hd_demo_sk#65, 100), ENSURE_REQUIREMENTS, [plan_id=82]
            :                 :           :           :           :           :                 +- Filter (isnotnull(hd_demo_sk#65) AND isnotnull(hd_income_band_sk#56))
            :                 :           :           :           :           :                    +- FileScan parquet [hd_demo_sk#65,hd_income_band_sk#56] Batched: true, DataFilters: [isnotnull(hd_demo_sk#65), isnotnull(hd_income_band_sk#56)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>, PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
            :                 :           :           :           :           +- Sort [ca_address_sk#63 ASC NULLS FIRST], false, 0
            :                 :           :           :           :              +- Exchange hashpartitioning(ca_address_sk#63, 100), ENSURE_REQUIREMENTS, [plan_id=83]
            :                 :           :           :           :                 +- Filter isnotnull(ca_address_sk#63)
            :                 :           :           :           :                    +- FileScan parquet [ca_address_sk#63,ca_street_number#30,ca_street_name#31,ca_city#32,ca_zip#33] Batched: true, DataFilters: [isnotnull(ca_address_sk#63)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
            :                 :           :           :           +- Sort [ca_address_sk#61 ASC NULLS FIRST], false, 0
            :                 :           :           :              +- Exchange hashpartitioning(ca_address_sk#61, 100), ENSURE_REQUIREMENTS, [plan_id=84]
            :                 :           :           :                 +- Filter isnotnull(ca_address_sk#61)
            :                 :           :           :                    +- FileScan parquet [ca_address_sk#61,ca_street_number#34,ca_street_name#35,ca_city#36,ca_zip#37] Batched: true, DataFilters: [isnotnull(ca_address_sk#61)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
            :                 :           :           +- Sort [ib_income_band_sk#59 ASC NULLS FIRST], false, 0
            :                 :           :              +- Exchange hashpartitioning(ib_income_band_sk#59, 100), ENSURE_REQUIREMENTS, [plan_id=85]
            :                 :           :                 +- Filter isnotnull(ib_income_band_sk#59)
            :                 :           :                    +- FileScan parquet [ib_income_band_sk#59] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#59)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
            :                 :           +- Sort [ib_income_band_sk#57 ASC NULLS FIRST], false, 0
            :                 :              +- Exchange hashpartitioning(ib_income_band_sk#57, 100), ENSURE_REQUIREMENTS, [plan_id=86]
            :                 :                 +- Filter isnotnull(ib_income_band_sk#57)
            :                 :                    +- FileScan parquet [ib_income_band_sk#57] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#57)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
            :                 +- Sort [i_item_sk#27 ASC NULLS FIRST], false, 0
            :                    +- Exchange hashpartitioning(i_item_sk#27, 100), ENSURE_REQUIREMENTS, [plan_id=87]
            :                       +- Project [i_item_sk#27, i_product_name#26]
            :                          +- Filter ((((((isnotnull(i_current_price#106) AND i_color#107 IN (purple,burlywood,indian,spring,floral,medium)) AND (i_current_price#106 >= 64.00)) AND (i_current_price#106 <= 74.00)) AND (i_current_price#106 >= 65.00)) AND (i_current_price#106 <= 79.00)) AND isnotnull(i_item_sk#27))
            :                             +- FileScan parquet [i_item_sk#27,i_current_price#106,i_color#107,i_product_name#26] Batched: true, DataFilters: [isnotnull(i_current_price#106), i_color#107 IN (purple,burlywood,indian,spring,floral,medium..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_current_price), In(i_color, [burlywood,floral,indian,medium,purple,spring]), Greater..., ReadSchema: struct<i_item_sk:int,i_current_price:decimal(7,2),i_color:string,i_product_name:string>
            +- Sort [item_sk#23 ASC NULLS FIRST, store_name#24 ASC NULLS FIRST, store_zip#25 ASC NULLS FIRST], false, 0
               +- Exchange hashpartitioning(item_sk#23, store_name#24, store_zip#25, 100), ENSURE_REQUIREMENTS, [plan_id=88]
                  +- HashAggregate(keys=[i_product_name#115, i_item_sk#108, s_store_name#109, s_zip#110, ca_street_number#116, ca_street_name#117, ca_city#118, ca_zip#119, ca_street_number#120, ca_street_name#121, ca_city#122, ca_zip#123, d_year#111, d_year#124, d_year#125], functions=[count(1), sum(UnscaledValue(ss_wholesale_cost#112)), sum(UnscaledValue(ss_list_price#113)), sum(UnscaledValue(ss_coupon_amt#114))], output=[item_sk#23, store_name#24, store_zip#25, syear#21, cnt#3, s1#5, s2#19, s3#20])
                     +- HashAggregate(keys=[i_product_name#115, i_item_sk#108, s_store_name#109, s_zip#110, ca_street_number#116, ca_street_name#117, ca_city#118, ca_zip#119, ca_street_number#120, ca_street_name#121, ca_city#122, ca_zip#123, d_year#111, d_year#124, d_year#125], functions=[partial_count(1), partial_sum(UnscaledValue(ss_wholesale_cost#112)), partial_sum(UnscaledValue(ss_list_price#113)), partial_sum(UnscaledValue(ss_coupon_amt#114))], output=[i_product_name#115, i_item_sk#108, s_store_name#109, s_zip#110, ca_street_number#116, ca_street_name#117, ca_city#118, ca_zip#119, ca_street_number#120, ca_street_name#121, ca_city#122, ca_zip#123, d_year#111, d_year#124, d_year#125, count#163, sum#170, sum#171, sum#172])
                        +- Project [ss_wholesale_cost#112, ss_list_price#113, ss_coupon_amt#114, d_year#111, d_year#124, d_year#125, s_store_name#109, s_zip#110, ca_street_number#116, ca_street_name#117, ca_city#118, ca_zip#119, ca_street_number#120, ca_street_name#121, ca_city#122, ca_zip#123, i_item_sk#108, i_product_name#115]
                           +- SortMergeJoin [ss_item_sk#132], [i_item_sk#108], Inner
                              :- Sort [ss_item_sk#132 ASC NULLS FIRST], false, 0
                              :  +- Exchange hashpartitioning(ss_item_sk#132, 100), ENSURE_REQUIREMENTS, [plan_id=89]
                              :     +- Project [ss_item_sk#132, ss_wholesale_cost#112, ss_list_price#113, ss_coupon_amt#114, d_year#111, s_store_name#109, s_zip#110, d_year#124, d_year#125, ca_street_number#116, ca_street_name#117, ca_city#118, ca_zip#119, ca_street_number#120, ca_street_name#121, ca_city#122, ca_zip#123]
                              :        +- SortMergeJoin [hd_income_band_sk#133], [ib_income_band_sk#134], Inner
                              :           :- Sort [hd_income_band_sk#133 ASC NULLS FIRST], false, 0
                              :           :  +- Exchange hashpartitioning(hd_income_band_sk#133, 100), ENSURE_REQUIREMENTS, [plan_id=90]
                              :           :     +- Project [ss_item_sk#132, ss_wholesale_cost#112, ss_list_price#113, ss_coupon_amt#114, d_year#111, s_store_name#109, s_zip#110, d_year#124, d_year#125, hd_income_band_sk#133, ca_street_number#116, ca_street_name#117, ca_city#118, ca_zip#119, ca_street_number#120, ca_street_name#121, ca_city#122, ca_zip#123]
                              :           :        +- SortMergeJoin [hd_income_band_sk#135], [ib_income_band_sk#136], Inner
                              :           :           :- Sort [hd_income_band_sk#135 ASC NULLS FIRST], false, 0
                              :           :           :  +- Exchange hashpartitioning(hd_income_band_sk#135, 100), ENSURE_REQUIREMENTS, [plan_id=91]
                              :           :           :     +- Project [ss_item_sk#132, ss_wholesale_cost#112, ss_list_price#113, ss_coupon_amt#114, d_year#111, s_store_name#109, s_zip#110, d_year#124, d_year#125, hd_income_band_sk#135, hd_income_band_sk#133, ca_street_number#116, ca_street_name#117, ca_city#118, ca_zip#119, ca_street_number#120, ca_street_name#121, ca_city#122, ca_zip#123]
                              :           :           :        +- SortMergeJoin [c_current_addr_sk#137], [ca_address_sk#138], Inner
                              :           :           :           :- Sort [c_current_addr_sk#137 ASC NULLS FIRST], false, 0
                              :           :           :           :  +- Exchange hashpartitioning(c_current_addr_sk#137, 100), ENSURE_REQUIREMENTS, [plan_id=92]
                              :           :           :           :     +- Project [ss_item_sk#132, ss_wholesale_cost#112, ss_list_price#113, ss_coupon_amt#114, d_year#111, s_store_name#109, s_zip#110, c_current_addr_sk#137, d_year#124, d_year#125, hd_income_band_sk#135, hd_income_band_sk#133, ca_street_number#116, ca_street_name#117, ca_city#118, ca_zip#119]
                              :           :           :           :        +- SortMergeJoin [ss_addr_sk#139], [ca_address_sk#140], Inner
                              :           :           :           :           :- Sort [ss_addr_sk#139 ASC NULLS FIRST], false, 0
                              :           :           :           :           :  +- Exchange hashpartitioning(ss_addr_sk#139, 100), ENSURE_REQUIREMENTS, [plan_id=93]
                              :           :           :           :           :     +- Project [ss_item_sk#132, ss_addr_sk#139, ss_wholesale_cost#112, ss_list_price#113, ss_coupon_amt#114, d_year#111, s_store_name#109, s_zip#110, c_current_addr_sk#137, d_year#124, d_year#125, hd_income_band_sk#135, hd_income_band_sk#133]
                              :           :           :           :           :        +- SortMergeJoin [c_current_hdemo_sk#141], [hd_demo_sk#142], Inner
                              :           :           :           :           :           :- Sort [c_current_hdemo_sk#141 ASC NULLS FIRST], false, 0
                              :           :           :           :           :           :  +- Exchange hashpartitioning(c_current_hdemo_sk#141, 100), ENSURE_REQUIREMENTS, [plan_id=94]
                              :           :           :           :           :           :     +- Project [ss_item_sk#132, ss_addr_sk#139, ss_wholesale_cost#112, ss_list_price#113, ss_coupon_amt#114, d_year#111, s_store_name#109, s_zip#110, c_current_hdemo_sk#141, c_current_addr_sk#137, d_year#124, d_year#125, hd_income_band_sk#135]
                              :           :           :           :           :           :        +- SortMergeJoin [ss_hdemo_sk#143], [hd_demo_sk#144], Inner
                              :           :           :           :           :           :           :- Sort [ss_hdemo_sk#143 ASC NULLS FIRST], false, 0
                              :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_hdemo_sk#143, 100), ENSURE_REQUIREMENTS, [plan_id=95]
                              :           :           :           :           :           :           :     +- Project [ss_item_sk#132, ss_hdemo_sk#143, ss_addr_sk#139, ss_wholesale_cost#112, ss_list_price#113, ss_coupon_amt#114, d_year#111, s_store_name#109, s_zip#110, c_current_hdemo_sk#141, c_current_addr_sk#137, d_year#124, d_year#125]
                              :           :           :           :           :           :           :        +- SortMergeJoin [ss_promo_sk#145], [p_promo_sk#146], Inner
                              :           :           :           :           :           :           :           :- Sort [ss_promo_sk#145 ASC NULLS FIRST], false, 0
                              :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_promo_sk#145, 100), ENSURE_REQUIREMENTS, [plan_id=96]
                              :           :           :           :           :           :           :           :     +- Project [ss_item_sk#132, ss_hdemo_sk#143, ss_addr_sk#139, ss_promo_sk#145, ss_wholesale_cost#112, ss_list_price#113, ss_coupon_amt#114, d_year#111, s_store_name#109, s_zip#110, c_current_hdemo_sk#141, c_current_addr_sk#137, d_year#124, d_year#125]
                              :           :           :           :           :           :           :           :        +- SortMergeJoin [c_current_cdemo_sk#147], [cd_demo_sk#148], Inner, NOT (cd_marital_status#149 = cd_marital_status#150)
                              :           :           :           :           :           :           :           :           :- Sort [c_current_cdemo_sk#147 ASC NULLS FIRST], false, 0
                              :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(c_current_cdemo_sk#147, 100), ENSURE_REQUIREMENTS, [plan_id=97]
                              :           :           :           :           :           :           :           :           :     +- Project [ss_item_sk#132, ss_hdemo_sk#143, ss_addr_sk#139, ss_promo_sk#145, ss_wholesale_cost#112, ss_list_price#113, ss_coupon_amt#114, d_year#111, s_store_name#109, s_zip#110, c_current_cdemo_sk#147, c_current_hdemo_sk#141, c_current_addr_sk#137, d_year#124, d_year#125, cd_marital_status#149]
                              :           :           :           :           :           :           :           :           :        +- SortMergeJoin [ss_cdemo_sk#151], [cd_demo_sk#152], Inner
                              :           :           :           :           :           :           :           :           :           :- Sort [ss_cdemo_sk#151 ASC NULLS FIRST], false, 0
                              :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_cdemo_sk#151, 100), ENSURE_REQUIREMENTS, [plan_id=98]
                              :           :           :           :           :           :           :           :           :           :     +- Project [ss_item_sk#132, ss_cdemo_sk#151, ss_hdemo_sk#143, ss_addr_sk#139, ss_promo_sk#145, ss_wholesale_cost#112, ss_list_price#113, ss_coupon_amt#114, d_year#111, s_store_name#109, s_zip#110, c_current_cdemo_sk#147, c_current_hdemo_sk#141, c_current_addr_sk#137, d_year#124, d_year#125]
                              :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [c_first_shipto_date_sk#153], [d_date_sk#154], Inner
                              :           :           :           :           :           :           :           :           :           :           :- Sort [c_first_shipto_date_sk#153 ASC NULLS FIRST], false, 0
                              :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(c_first_shipto_date_sk#153, 100), ENSURE_REQUIREMENTS, [plan_id=99]
                              :           :           :           :           :           :           :           :           :           :           :     +- Project [ss_item_sk#132, ss_cdemo_sk#151, ss_hdemo_sk#143, ss_addr_sk#139, ss_promo_sk#145, ss_wholesale_cost#112, ss_list_price#113, ss_coupon_amt#114, d_year#111, s_store_name#109, s_zip#110, c_current_cdemo_sk#147, c_current_hdemo_sk#141, c_current_addr_sk#137, c_first_shipto_date_sk#153, d_year#124]
                              :           :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [c_first_sales_date_sk#155], [d_date_sk#156], Inner
                              :           :           :           :           :           :           :           :           :           :           :           :- Sort [c_first_sales_date_sk#155 ASC NULLS FIRST], false, 0
                              :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(c_first_sales_date_sk#155, 100), ENSURE_REQUIREMENTS, [plan_id=100]
                              :           :           :           :           :           :           :           :           :           :           :           :     +- Project [ss_item_sk#132, ss_cdemo_sk#151, ss_hdemo_sk#143, ss_addr_sk#139, ss_promo_sk#145, ss_wholesale_cost#112, ss_list_price#113, ss_coupon_amt#114, d_year#111, s_store_name#109, s_zip#110, c_current_cdemo_sk#147, c_current_hdemo_sk#141, c_current_addr_sk#137, c_first_shipto_date_sk#153, c_first_sales_date_sk#155]
                              :           :           :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [ss_customer_sk#157], [c_customer_sk#158], Inner
                              :           :           :           :           :           :           :           :           :           :           :           :           :- Sort [ss_customer_sk#157 ASC NULLS FIRST], false, 0
                              :           :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_customer_sk#157, 100), ENSURE_REQUIREMENTS, [plan_id=101]
                              :           :           :           :           :           :           :           :           :           :           :           :           :     +- Project [ss_item_sk#132, ss_customer_sk#157, ss_cdemo_sk#151, ss_hdemo_sk#143, ss_addr_sk#139, ss_promo_sk#145, ss_wholesale_cost#112, ss_list_price#113, ss_coupon_amt#114, d_year#111, s_store_name#109, s_zip#110]
                              :           :           :           :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [ss_store_sk#159], [s_store_sk#160], Inner
                              :           :           :           :           :           :           :           :           :           :           :           :           :           :- Sort [ss_store_sk#159 ASC NULLS FIRST], false, 0
                              :           :           :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_store_sk#159, 100), ENSURE_REQUIREMENTS, [plan_id=102]
                              :           :           :           :           :           :           :           :           :           :           :           :           :           :     +- Project [ss_item_sk#132, ss_customer_sk#157, ss_cdemo_sk#151, ss_hdemo_sk#143, ss_addr_sk#139, ss_store_sk#159, ss_promo_sk#145, ss_wholesale_cost#112, ss_list_price#113, ss_coupon_amt#114, d_year#111]
                              :           :           :           :           :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [ss_sold_date_sk#161], [d_date_sk#162], Inner
                              :           :           :           :           :           :           :           :           :           :           :           :           :           :           :- Sort [ss_sold_date_sk#161 ASC NULLS FIRST], false, 0
                              :           :           :           :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_sold_date_sk#161, 100), ENSURE_REQUIREMENTS, [plan_id=103]
                              :           :           :           :           :           :           :           :           :           :           :           :           :           :           :     +- Project [ss_sold_date_sk#161, ss_item_sk#132, ss_customer_sk#157, ss_cdemo_sk#151, ss_hdemo_sk#143, ss_addr_sk#139, ss_store_sk#159, ss_promo_sk#145, ss_wholesale_cost#112, ss_list_price#113, ss_coupon_amt#114]
                              :           :           :           :           :           :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [ss_item_sk#132], [cs_item_sk#173], Inner
                              :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :- Sort [ss_item_sk#132 ASC NULLS FIRST], false, 0
                              :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_item_sk#132, 100), ENSURE_REQUIREMENTS, [plan_id=104]
                              :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :     +- Project [ss_sold_date_sk#161, ss_item_sk#132, ss_customer_sk#157, ss_cdemo_sk#151, ss_hdemo_sk#143, ss_addr_sk#139, ss_store_sk#159, ss_promo_sk#145, ss_wholesale_cost#112, ss_list_price#113, ss_coupon_amt#114]
                              :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [ss_item_sk#132, ss_ticket_number#174], [sr_item_sk#175, sr_ticket_number#176], Inner
                              :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :- Sort [ss_item_sk#132 ASC NULLS FIRST, ss_ticket_number#174 ASC NULLS FIRST], false, 0
                              :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_item_sk#132, ss_ticket_number#174, 100), ENSURE_REQUIREMENTS, [plan_id=105]
                              :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :     +- Filter ((((((((isnotnull(ss_item_sk#132) AND isnotnull(ss_ticket_number#174)) AND isnotnull(ss_sold_date_sk#161)) AND isnotnull(ss_store_sk#159)) AND isnotnull(ss_customer_sk#157)) AND isnotnull(ss_cdemo_sk#151)) AND isnotnull(ss_promo_sk#145)) AND isnotnull(ss_hdemo_sk#143)) AND isnotnull(ss_addr_sk#139))
                              :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :        +- FileScan parquet [ss_sold_date_sk#161,ss_item_sk#132,ss_customer_sk#157,ss_cdemo_sk#151,ss_hdemo_sk#143,ss_addr_sk#139,ss_store_sk#159,ss_promo_sk#145,ss_ticket_number#174,ss_wholesale_cost#112,ss_list_price#113,ss_coupon_amt#114] Batched: true, DataFilters: [isnotnull(ss_item_sk#132), isnotnull(ss_ticket_number#174), isnotnull(ss_sold_date_sk#161)..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_ticket_number), IsNotNull(ss_sold_date_sk), IsNotNull(ss_sto..., ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_customer_sk:int,ss_cdemo_sk:int,ss_hdemo_sk:int,ss_a...
                              :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           +- Sort [sr_item_sk#175 ASC NULLS FIRST, sr_ticket_number#176 ASC NULLS FIRST], false, 0
                              :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(sr_item_sk#175, sr_ticket_number#176, 100), ENSURE_REQUIREMENTS, [plan_id=106]
                              :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                 +- Filter (isnotnull(sr_item_sk#175) AND isnotnull(sr_ticket_number#176))
                              :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                    +- FileScan parquet [sr_item_sk#175,sr_ticket_number#176] Batched: true, DataFilters: [isnotnull(sr_item_sk#175), isnotnull(sr_ticket_number#176)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(sr_item_sk), IsNotNull(sr_ticket_number)], ReadSchema: struct<sr_item_sk:int,sr_ticket_number:int>
                              :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           +- Sort [cs_item_sk#173 ASC NULLS FIRST], false, 0
                              :           :           :           :           :           :           :           :           :           :           :           :           :           :           :              +- Project [cs_item_sk#173]
                              :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                 +- Filter ((isnotnull(sale#90) AND isnotnull(refund#91)) AND (cast(sale#90 as decimal(21,2)) > (2 * refund#91)))
                              :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                    +- HashAggregate(keys=[cs_item_sk#173], functions=[sum(UnscaledValue(cs_ext_list_price#177)), sum(((cr_refunded_cash#178 + cr_reversed_charge#179) + cr_store_credit#180))], output=[cs_item_sk#173, sale#90, refund#91])
                              :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                       +- Exchange hashpartitioning(cs_item_sk#173, 100), ENSURE_REQUIREMENTS, [plan_id=107]
                              :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                          +- HashAggregate(keys=[cs_item_sk#173], functions=[partial_sum(UnscaledValue(cs_ext_list_price#177)), partial_sum(((cr_refunded_cash#178 + cr_reversed_charge#179) + cr_store_credit#180))], output=[cs_item_sk#173, sum#181, sum#182, isEmpty#183])
                              :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                             +- Project [cs_item_sk#173, cs_ext_list_price#177, cr_refunded_cash#178, cr_reversed_charge#179, cr_store_credit#180]
                              :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                +- SortMergeJoin [cs_item_sk#173, cs_order_number#184], [cr_item_sk#185, cr_order_number#186], Inner
                              :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                   :- Sort [cs_item_sk#173 ASC NULLS FIRST, cs_order_number#184 ASC NULLS FIRST], false, 0
                              :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                   :  +- Exchange hashpartitioning(cs_item_sk#173, cs_order_number#184, 100), ENSURE_REQUIREMENTS, [plan_id=108]
                              :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                   :     +- Filter (isnotnull(cs_item_sk#173) AND isnotnull(cs_order_number#184))
                              :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                   :        +- FileScan parquet [cs_item_sk#173,cs_order_number#184,cs_ext_list_price#177] Batched: true, DataFilters: [isnotnull(cs_item_sk#173), isnotnull(cs_order_number#184)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_order_number)], ReadSchema: struct<cs_item_sk:int,cs_order_number:int,cs_ext_list_price:decimal(7,2)>
                              :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                   +- Sort [cr_item_sk#185 ASC NULLS FIRST, cr_order_number#186 ASC NULLS FIRST], false, 0
                              :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                      +- Exchange hashpartitioning(cr_item_sk#185, cr_order_number#186, 100), ENSURE_REQUIREMENTS, [plan_id=109]
                              :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                         +- Filter (isnotnull(cr_item_sk#185) AND isnotnull(cr_order_number#186))
                              :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                            +- FileScan parquet [cr_item_sk#185,cr_order_number#186,cr_refunded_cash#178,cr_reversed_charge#179,cr_store_credit#180] Batched: true, DataFilters: [isnotnull(cr_item_sk#185), isnotnull(cr_order_number#186)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cr_item_sk), IsNotNull(cr_order_number)], ReadSchema: struct<cr_item_sk:int,cr_order_number:int,cr_refunded_cash:decimal(7,2),cr_reversed_charge:decima...
                              :           :           :           :           :           :           :           :           :           :           :           :           :           :           +- Sort [d_date_sk#162 ASC NULLS FIRST], false, 0
                              :           :           :           :           :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(d_date_sk#162, 100), ENSURE_REQUIREMENTS, [plan_id=110]
                              :           :           :           :           :           :           :           :           :           :           :           :           :           :                 +- Filter ((isnotnull(d_year#111) AND (d_year#111 = 2000)) AND isnotnull(d_date_sk#162))
                              :           :           :           :           :           :           :           :           :           :           :           :           :           :                    +- FileScan parquet [d_date_sk#162,d_year#111] Batched: true, DataFilters: [isnotnull(d_year#111), (d_year#111 = 2000), isnotnull(d_date_sk#162)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2000), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                              :           :           :           :           :           :           :           :           :           :           :           :           :           +- Sort [s_store_sk#160 ASC NULLS FIRST], false, 0
                              :           :           :           :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(s_store_sk#160, 100), ENSURE_REQUIREMENTS, [plan_id=111]
                              :           :           :           :           :           :           :           :           :           :           :           :           :                 +- Filter ((isnotnull(s_store_sk#160) AND isnotnull(s_store_name#109)) AND isnotnull(s_zip#110))
                              :           :           :           :           :           :           :           :           :           :           :           :           :                    +- FileScan parquet [s_store_sk#160,s_store_name#109,s_zip#110] Batched: true, DataFilters: [isnotnull(s_store_sk#160), isnotnull(s_store_name#109), isnotnull(s_zip#110)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk), IsNotNull(s_store_name), IsNotNull(s_zip)], ReadSchema: struct<s_store_sk:int,s_store_name:string,s_zip:string>
                              :           :           :           :           :           :           :           :           :           :           :           :           +- Sort [c_customer_sk#158 ASC NULLS FIRST], false, 0
                              :           :           :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(c_customer_sk#158, 100), ENSURE_REQUIREMENTS, [plan_id=112]
                              :           :           :           :           :           :           :           :           :           :           :           :                 +- Filter (((((isnotnull(c_customer_sk#158) AND isnotnull(c_first_sales_date_sk#155)) AND isnotnull(c_first_shipto_date_sk#153)) AND isnotnull(c_current_cdemo_sk#147)) AND isnotnull(c_current_hdemo_sk#141)) AND isnotnull(c_current_addr_sk#137))
                              :           :           :           :           :           :           :           :           :           :           :           :                    +- FileScan parquet [c_customer_sk#158,c_current_cdemo_sk#147,c_current_hdemo_sk#141,c_current_addr_sk#137,c_first_shipto_date_sk#153,c_first_sales_date_sk#155] Batched: true, DataFilters: [isnotnull(c_customer_sk#158), isnotnull(c_first_sales_date_sk#155), isnotnull(c_first_shipto..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_first_sales_date_sk), IsNotNull(c_first_shipto_date_sk), I..., ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_hdemo_sk:int,c_current_addr_sk:int,c_fi...
                              :           :           :           :           :           :           :           :           :           :           :           +- Sort [d_date_sk#156 ASC NULLS FIRST], false, 0
                              :           :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(d_date_sk#156, 100), ENSURE_REQUIREMENTS, [plan_id=113]
                              :           :           :           :           :           :           :           :           :           :           :                 +- Filter isnotnull(d_date_sk#156)
                              :           :           :           :           :           :           :           :           :           :           :                    +- FileScan parquet [d_date_sk#156,d_year#124] Batched: true, DataFilters: [isnotnull(d_date_sk#156)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                              :           :           :           :           :           :           :           :           :           :           +- Sort [d_date_sk#154 ASC NULLS FIRST], false, 0
                              :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(d_date_sk#154, 100), ENSURE_REQUIREMENTS, [plan_id=114]
                              :           :           :           :           :           :           :           :           :           :                 +- Filter isnotnull(d_date_sk#154)
                              :           :           :           :           :           :           :           :           :           :                    +- FileScan parquet [d_date_sk#154,d_year#125] Batched: true, DataFilters: [isnotnull(d_date_sk#154)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                              :           :           :           :           :           :           :           :           :           +- Sort [cd_demo_sk#152 ASC NULLS FIRST], false, 0
                              :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(cd_demo_sk#152, 100), ENSURE_REQUIREMENTS, [plan_id=115]
                              :           :           :           :           :           :           :           :           :                 +- Filter (isnotnull(cd_demo_sk#152) AND isnotnull(cd_marital_status#149))
                              :           :           :           :           :           :           :           :           :                    +- FileScan parquet [cd_demo_sk#152,cd_marital_status#149] Batched: true, DataFilters: [isnotnull(cd_demo_sk#152), isnotnull(cd_marital_status#149)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>, PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
                              :           :           :           :           :           :           :           :           +- Sort [cd_demo_sk#148 ASC NULLS FIRST], false, 0
                              :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(cd_demo_sk#148, 100), ENSURE_REQUIREMENTS, [plan_id=116]
                              :           :           :           :           :           :           :           :                 +- Filter (isnotnull(cd_demo_sk#148) AND isnotnull(cd_marital_status#150))
                              :           :           :           :           :           :           :           :                    +- FileScan parquet [cd_demo_sk#148,cd_marital_status#150] Batched: true, DataFilters: [isnotnull(cd_demo_sk#148), isnotnull(cd_marital_status#150)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>, PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
                              :           :           :           :           :           :           :           +- Sort [p_promo_sk#146 ASC NULLS FIRST], false, 0
                              :           :           :           :           :           :           :              +- Exchange hashpartitioning(p_promo_sk#146, 100), ENSURE_REQUIREMENTS, [plan_id=117]
                              :           :           :           :           :           :           :                 +- Filter isnotnull(p_promo_sk#146)
                              :           :           :           :           :           :           :                    +- FileScan parquet [p_promo_sk#146] Batched: true, DataFilters: [isnotnull(p_promo_sk#146)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(p_promo_sk)], ReadSchema: struct<p_promo_sk:int>
                              :           :           :           :           :           :           +- Sort [hd_demo_sk#144 ASC NULLS FIRST], false, 0
                              :           :           :           :           :           :              +- Exchange hashpartitioning(hd_demo_sk#144, 100), ENSURE_REQUIREMENTS, [plan_id=118]
                              :           :           :           :           :           :                 +- Filter (isnotnull(hd_demo_sk#144) AND isnotnull(hd_income_band_sk#135))
                              :           :           :           :           :           :                    +- FileScan parquet [hd_demo_sk#144,hd_income_band_sk#135] Batched: true, DataFilters: [isnotnull(hd_demo_sk#144), isnotnull(hd_income_band_sk#135)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>, PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
                              :           :           :           :           :           +- Sort [hd_demo_sk#142 ASC NULLS FIRST], false, 0
                              :           :           :           :           :              +- Exchange hashpartitioning(hd_demo_sk#142, 100), ENSURE_REQUIREMENTS, [plan_id=119]
                              :           :           :           :           :                 +- Filter (isnotnull(hd_demo_sk#142) AND isnotnull(hd_income_band_sk#133))
                              :           :           :           :           :                    +- FileScan parquet [hd_demo_sk#142,hd_income_band_sk#133] Batched: true, DataFilters: [isnotnull(hd_demo_sk#142), isnotnull(hd_income_band_sk#133)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>, PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
                              :           :           :           :           +- Sort [ca_address_sk#140 ASC NULLS FIRST], false, 0
                              :           :           :           :              +- Exchange hashpartitioning(ca_address_sk#140, 100), ENSURE_REQUIREMENTS, [plan_id=120]
                              :           :           :           :                 +- Filter isnotnull(ca_address_sk#140)
                              :           :           :           :                    +- FileScan parquet [ca_address_sk#140,ca_street_number#116,ca_street_name#117,ca_city#118,ca_zip#119] Batched: true, DataFilters: [isnotnull(ca_address_sk#140)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
                              :           :           :           +- Sort [ca_address_sk#138 ASC NULLS FIRST], false, 0
                              :           :           :              +- Exchange hashpartitioning(ca_address_sk#138, 100), ENSURE_REQUIREMENTS, [plan_id=121]
                              :           :           :                 +- Filter isnotnull(ca_address_sk#138)
                              :           :           :                    +- FileScan parquet [ca_address_sk#138,ca_street_number#120,ca_street_name#121,ca_city#122,ca_zip#123] Batched: true, DataFilters: [isnotnull(ca_address_sk#138)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
                              :           :           +- Sort [ib_income_band_sk#136 ASC NULLS FIRST], false, 0
                              :           :              +- Exchange hashpartitioning(ib_income_band_sk#136, 100), ENSURE_REQUIREMENTS, [plan_id=122]
                              :           :                 +- Filter isnotnull(ib_income_band_sk#136)
                              :           :                    +- FileScan parquet [ib_income_band_sk#136] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#136)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
                              :           +- Sort [ib_income_band_sk#134 ASC NULLS FIRST], false, 0
                              :              +- Exchange hashpartitioning(ib_income_band_sk#134, 100), ENSURE_REQUIREMENTS, [plan_id=123]
                              :                 +- Filter isnotnull(ib_income_band_sk#134)
                              :                    +- FileScan parquet [ib_income_band_sk#134] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#134)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
                              +- Sort [i_item_sk#108 ASC NULLS FIRST], false, 0
                                 +- Exchange hashpartitioning(i_item_sk#108, 100), ENSURE_REQUIREMENTS, [plan_id=124]
                                    +- Project [i_item_sk#108, i_product_name#115]
                                       +- Filter ((((((isnotnull(i_current_price#187) AND i_color#188 IN (purple,burlywood,indian,spring,floral,medium)) AND (i_current_price#187 >= 64.00)) AND (i_current_price#187 <= 74.00)) AND (i_current_price#187 >= 65.00)) AND (i_current_price#187 <= 79.00)) AND isnotnull(i_item_sk#108))
                                          +- FileScan parquet [i_item_sk#108,i_current_price#187,i_color#188,i_product_name#115] Batched: true, DataFilters: [isnotnull(i_current_price#187), i_color#188 IN (purple,burlywood,indian,spring,floral,medium..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_current_price), In(i_color, [burlywood,floral,indian,medium,purple,spring]), Greater..., ReadSchema: struct<i_item_sk:int,i_current_price:decimal(7,2),i_color:string,i_product_name:string>
