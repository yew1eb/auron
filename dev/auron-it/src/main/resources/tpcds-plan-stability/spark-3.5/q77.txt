AdaptiveSparkPlan isFinalPlan=true
+- == Final Plan ==
   NativeTakeOrdered 100, [channel#1 ASC NULLS FIRST, id#2 ASC NULLS FIRST, sales#3 ASC NULLS FIRST]
   +- NativeProject [channel#1, id#2, sum(sales#4)#5 AS sales#3, sum(returns#6)#7 AS returns#8, sum(profit#9)#10 AS profit#11]
      +- NativeHashAggregate HashAgg, Vector(channel#1, id#2, spark_grouping_id#12), [channel#1, id#2, spark_grouping_id#12], [sum(sales#4), sum(returns#6), sum(profit#9)], [sum(sales#4)#5, sum(returns#6)#7, sum(profit#9)#10], 3
         +- InputAdapter
            +- AQEShuffleRead coalesced
               +- ShuffleQueryStage X
                  +- NativeShuffleExchange hashpartitioning(channel#1, id#2, spark_grouping_id#12, 100), ENSURE_REQUIREMENTS, [plan_id=1]
                     +- NativeHashAggregate HashAgg, [channel#1, id#2, spark_grouping_id#12], [partial_sum(sales#4), partial_sum(returns#6), partial_sum(profit#9)], [sum#13, isEmpty#14, sum#15, isEmpty#16, sum#17, isEmpty#18], 0
                        +- !NativeExpand [[sales#4, returns#6, profit#9, channel#19, id#20, 0], [sales#4, returns#6, profit#9, channel#19, null, 1], [sales#4, returns#6, profit#9, null, null, 3]], [sales#4, returns#6, profit#9, channel#1, id#2, spark_grouping_id#12]
                           +- InputAdapter [#4, #6, #9, #19, #20]
                              +- NativeUnion [sales#4, returns#6, profit#9, channel#19, id#20]
                                 :- NativeProject [sales#4, coalesce(returns#21, 0.00) AS returns#6, (profit#22 - coalesce(profit_loss#23, 0.00)) AS profit#9, store channel AS channel#19, s_store_sk#24 AS id#20]
                                 :  +- NativeSortMergeJoin [s_store_sk#24], [s_store_sk#25], LeftOuter
                                 :     :- NativeSort [s_store_sk#24 ASC NULLS FIRST], false
                                 :     :  +- NativeProject [s_store_sk#24, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#26))#27,17,2) AS sales#4, MakeDecimal(sum(UnscaledValue(ss_net_profit#28))#29,17,2) AS profit#22]
                                 :     :     +- NativeHashAggregate HashAgg, ArrayBuffer(s_store_sk#24), [s_store_sk#24], [sum(UnscaledValue(ss_ext_sales_price#26)), sum(UnscaledValue(ss_net_profit#28))], [sum(UnscaledValue(ss_ext_sales_price#26))#27, sum(UnscaledValue(ss_net_profit#28))#29], 1
                                 :     :        +- NativeHashAggregate HashAgg, [s_store_sk#24], [partial_sum(_c1#30), partial_sum(_c2#31)], [sum#32, sum#33], 0
                                 :     :           +- NativeProject [s_store_sk#24 AS s_store_sk#24, UnscaledValue(ss_ext_sales_price#26) AS _c1#30, UnscaledValue(ss_net_profit#28) AS _c2#31]
                                 :     :              +- NativeProject [ss_ext_sales_price#26, ss_net_profit#28, s_store_sk#24]
                                 :     :                 +- NativeSortMergeJoin [ss_store_sk#34], [s_store_sk#24], Inner
                                 :     :                    :- NativeSort [ss_store_sk#34 ASC NULLS FIRST], false
                                 :     :                    :  +- InputAdapter
                                 :     :                    :     +- AQEShuffleRead coalesced
                                 :     :                    :        +- ShuffleQueryStage X
                                 :     :                    :           +- NativeShuffleExchange hashpartitioning(ss_store_sk#34, 100), ENSURE_REQUIREMENTS, [plan_id=2]
                                 :     :                    :              +- NativeProject [ss_store_sk#34, ss_ext_sales_price#26, ss_net_profit#28]
                                 :     :                    :                 +- NativeSortMergeJoin [ss_sold_date_sk#35], [d_date_sk#36], Inner
                                 :     :                    :                    :- NativeSort [ss_sold_date_sk#35 ASC NULLS FIRST], false
                                 :     :                    :                    :  +- InputAdapter
                                 :     :                    :                    :     +- AQEShuffleRead coalesced
                                 :     :                    :                    :        +- ShuffleQueryStage X
                                 :     :                    :                    :           +- NativeShuffleExchange hashpartitioning(ss_sold_date_sk#35, 100), ENSURE_REQUIREMENTS, [plan_id=3]
                                 :     :                    :                    :              +- NativeFilter (isnotnull(ss_sold_date_sk#35) AND isnotnull(ss_store_sk#34))
                                 :     :                    :                    :                 +- InputAdapter [#35, #34, #26, #28]
                                 :     :                    :                    :                    +- NativeParquetScan  (FileScan parquet [ss_sold_date_sk#35,ss_store_sk#34,ss_ext_sales_price#26,ss_net_profit#28] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#35), isnotnull(ss_store_sk#34)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_store_sk:int,ss_ext_sales_price:decimal(7,2),ss_net_profit:decimal(...)
                                 :     :                    :                    +- NativeSort [d_date_sk#36 ASC NULLS FIRST], false
                                 :     :                    :                       +- InputAdapter
                                 :     :                    :                          +- AQEShuffleRead coalesced
                                 :     :                    :                             +- ShuffleQueryStage X
                                 :     :                    :                                +- NativeShuffleExchange hashpartitioning(d_date_sk#36, 100), ENSURE_REQUIREMENTS, [plan_id=4]
                                 :     :                    :                                   +- NativeProject [d_date_sk#36]
                                 :     :                    :                                      +- NativeFilter (((isnotnull(d_date#37) AND (d_date#37 >= 2000-08-03)) AND (d_date#37 <= 2000-09-02)) AND isnotnull(d_date_sk#36))
                                 :     :                    :                                         +- InputAdapter [#36, #37]
                                 :     :                    :                                            +- NativeParquetScan  (FileScan parquet [d_date_sk#36,d_date#37] Batched: true, DataFilters: [isnotnull(d_date#37), (d_date#37 >= 2000-08-03), (d_date#37 <= 2000-09-02), isnotnull(d..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_date), GreaterThanOrEqual(d_date,2000-08-03), LessThanOrEqual(d_date,2000-09-02), Is..., ReadSchema: struct<d_date_sk:int,d_date:date>)
                                 :     :                    +- NativeSort [s_store_sk#24 ASC NULLS FIRST], false
                                 :     :                       +- InputAdapter
                                 :     :                          +- AQEShuffleRead coalesced
                                 :     :                             +- ShuffleQueryStage X
                                 :     :                                +- NativeShuffleExchange hashpartitioning(s_store_sk#24, 100), ENSURE_REQUIREMENTS, [plan_id=5]
                                 :     :                                   +- NativeFilter isnotnull(s_store_sk#24)
                                 :     :                                      +- InputAdapter [#24]
                                 :     :                                         +- NativeParquetScan  (FileScan parquet [s_store_sk#24] Batched: true, DataFilters: [isnotnull(s_store_sk#24)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk)], ReadSchema: struct<s_store_sk:int>)
                                 :     +- NativeSort [s_store_sk#25 ASC NULLS FIRST], false
                                 :        +- NativeProject [s_store_sk#25, MakeDecimal(sum(UnscaledValue(sr_return_amt#38))#39,17,2) AS returns#21, MakeDecimal(sum(UnscaledValue(sr_net_loss#40))#41,17,2) AS profit_loss#23]
                                 :           +- NativeHashAggregate HashAgg, ArrayBuffer(s_store_sk#25), [s_store_sk#25], [sum(UnscaledValue(sr_return_amt#38)), sum(UnscaledValue(sr_net_loss#40))], [sum(UnscaledValue(sr_return_amt#38))#39, sum(UnscaledValue(sr_net_loss#40))#41], 1
                                 :              +- NativeHashAggregate HashAgg, [s_store_sk#25], [partial_sum(_c1#42), partial_sum(_c2#43)], [sum#44, sum#45], 0
                                 :                 +- NativeProject [s_store_sk#25 AS s_store_sk#25, UnscaledValue(sr_return_amt#38) AS _c1#42, UnscaledValue(sr_net_loss#40) AS _c2#43]
                                 :                    +- NativeProject [sr_return_amt#38, sr_net_loss#40, s_store_sk#25]
                                 :                       +- NativeSortMergeJoin [sr_store_sk#46], [s_store_sk#25], Inner
                                 :                          :- NativeSort [sr_store_sk#46 ASC NULLS FIRST], false
                                 :                          :  +- InputAdapter
                                 :                          :     +- AQEShuffleRead coalesced
                                 :                          :        +- ShuffleQueryStage X
                                 :                          :           +- NativeShuffleExchange hashpartitioning(sr_store_sk#46, 100), ENSURE_REQUIREMENTS, [plan_id=6]
                                 :                          :              +- NativeProject [sr_store_sk#46, sr_return_amt#38, sr_net_loss#40]
                                 :                          :                 +- NativeSortMergeJoin [sr_returned_date_sk#47], [d_date_sk#48], Inner
                                 :                          :                    :- NativeSort [sr_returned_date_sk#47 ASC NULLS FIRST], false
                                 :                          :                    :  +- InputAdapter
                                 :                          :                    :     +- AQEShuffleRead coalesced
                                 :                          :                    :        +- ShuffleQueryStage X
                                 :                          :                    :           +- NativeShuffleExchange hashpartitioning(sr_returned_date_sk#47, 100), ENSURE_REQUIREMENTS, [plan_id=7]
                                 :                          :                    :              +- NativeFilter (isnotnull(sr_returned_date_sk#47) AND isnotnull(sr_store_sk#46))
                                 :                          :                    :                 +- InputAdapter [#47, #46, #38, #40]
                                 :                          :                    :                    +- NativeParquetScan  (FileScan parquet [sr_returned_date_sk#47,sr_store_sk#46,sr_return_amt#38,sr_net_loss#40] Batched: true, DataFilters: [isnotnull(sr_returned_date_sk#47), isnotnull(sr_store_sk#46)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(sr_returned_date_sk), IsNotNull(sr_store_sk)], ReadSchema: struct<sr_returned_date_sk:int,sr_store_sk:int,sr_return_amt:decimal(7,2),sr_net_loss:decimal(7,2)>)
                                 :                          :                    +- NativeSort [d_date_sk#48 ASC NULLS FIRST], false
                                 :                          :                       +- InputAdapter
                                 :                          :                          +- InputAdapter [#48]
                                 :                          :                             +- AQEShuffleRead coalesced
                                 :                          :                                +- ShuffleQueryStage X
                                 :                          :                                   +- ReusedExchange [d_date_sk#48], NativeShuffleExchange hashpartitioning(d_date_sk#36, 100), ENSURE_REQUIREMENTS, [plan_id=4]
                                 :                          +- NativeSort [s_store_sk#25 ASC NULLS FIRST], false
                                 :                             +- InputAdapter
                                 :                                +- InputAdapter [#25]
                                 :                                   +- AQEShuffleRead coalesced
                                 :                                      +- ShuffleQueryStage X
                                 :                                         +- ReusedExchange [s_store_sk#25], NativeShuffleExchange hashpartitioning(s_store_sk#24, 100), ENSURE_REQUIREMENTS, [plan_id=5]
                                 :- ConvertToNative
                                 :  +- *(1) Project [sales#49, returns#50, (profit#51 - profit_loss#52) AS profit#53, catalog channel AS channel#54, cs_call_center_sk#55 AS id#56]
                                 :     +- CartesianProduct
                                 :        :- NativeProject [cs_call_center_sk#55, MakeDecimal(sum(UnscaledValue(cs_ext_sales_price#57))#58,17,2) AS sales#49, MakeDecimal(sum(UnscaledValue(cs_net_profit#59))#60,17,2) AS profit#51]
                                 :        :  +- NativeHashAggregate HashAgg, ArrayBuffer(cs_call_center_sk#55), [cs_call_center_sk#55], [sum(UnscaledValue(cs_ext_sales_price#57)), sum(UnscaledValue(cs_net_profit#59))], [sum(UnscaledValue(cs_ext_sales_price#57))#58, sum(UnscaledValue(cs_net_profit#59))#60], 1
                                 :        :     +- InputAdapter
                                 :        :        +- AQEShuffleRead coalesced
                                 :        :           +- ShuffleQueryStage X
                                 :        :              +- NativeShuffleExchange hashpartitioning(cs_call_center_sk#55, 100), ENSURE_REQUIREMENTS, [plan_id=8]
                                 :        :                 +- NativeHashAggregate HashAgg, [cs_call_center_sk#55], [partial_sum(_c1#61), partial_sum(_c2#62)], [sum#63, sum#64], 0
                                 :        :                    +- NativeProject [cs_call_center_sk#55 AS cs_call_center_sk#55, UnscaledValue(cs_ext_sales_price#57) AS _c1#61, UnscaledValue(cs_net_profit#59) AS _c2#62]
                                 :        :                       +- NativeProject [cs_call_center_sk#55, cs_ext_sales_price#57, cs_net_profit#59]
                                 :        :                          +- NativeSortMergeJoin [cs_sold_date_sk#65], [d_date_sk#66], Inner
                                 :        :                             :- NativeSort [cs_sold_date_sk#65 ASC NULLS FIRST], false
                                 :        :                             :  +- InputAdapter
                                 :        :                             :     +- AQEShuffleRead coalesced
                                 :        :                             :        +- ShuffleQueryStage X
                                 :        :                             :           +- NativeShuffleExchange hashpartitioning(cs_sold_date_sk#65, 100), ENSURE_REQUIREMENTS, [plan_id=9]
                                 :        :                             :              +- NativeFilter isnotnull(cs_sold_date_sk#65)
                                 :        :                             :                 +- InputAdapter [#65, #55, #57, #59]
                                 :        :                             :                    +- NativeParquetScan  (FileScan parquet [cs_sold_date_sk#65,cs_call_center_sk#55,cs_ext_sales_price#57,cs_net_profit#59] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#65)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_call_center_sk:int,cs_ext_sales_price:decimal(7,2),cs_net_profit:de...)
                                 :        :                             +- NativeSort [d_date_sk#66 ASC NULLS FIRST], false
                                 :        :                                +- InputAdapter
                                 :        :                                   +- InputAdapter [#66]
                                 :        :                                      +- AQEShuffleRead coalesced
                                 :        :                                         +- ShuffleQueryStage X
                                 :        :                                            +- ReusedExchange [d_date_sk#66], NativeShuffleExchange hashpartitioning(d_date_sk#36, 100), ENSURE_REQUIREMENTS, [plan_id=4]
                                 :        +- NativeProject [MakeDecimal(sum(UnscaledValue(cr_return_amount#67))#68,17,2) AS returns#50, MakeDecimal(sum(UnscaledValue(cr_net_loss#69))#70,17,2) AS profit_loss#52]
                                 :           +- NativeHashAggregate HashAgg, List(), [sum(UnscaledValue(cr_return_amount#67)), sum(UnscaledValue(cr_net_loss#69))], [sum(UnscaledValue(cr_return_amount#67))#68, sum(UnscaledValue(cr_net_loss#69))#70], 0
                                 :              +- ShuffleQueryStage X
                                 :                 +- NativeShuffleExchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=10]
                                 :                    +- NativeHashAggregate HashAgg, [partial_sum(_c0#71), partial_sum(_c1#72)], [sum#73, sum#74], 0
                                 :                       +- NativeProject [UnscaledValue(cr_return_amount#67) AS _c0#71, UnscaledValue(cr_net_loss#69) AS _c1#72]
                                 :                          +- NativeProject [cr_return_amount#67, cr_net_loss#69]
                                 :                             +- NativeSortMergeJoin [cr_returned_date_sk#75], [d_date_sk#76], Inner
                                 :                                :- NativeSort [cr_returned_date_sk#75 ASC NULLS FIRST], false
                                 :                                :  +- InputAdapter
                                 :                                :     +- AQEShuffleRead coalesced
                                 :                                :        +- ShuffleQueryStage X
                                 :                                :           +- NativeShuffleExchange hashpartitioning(cr_returned_date_sk#75, 100), ENSURE_REQUIREMENTS, [plan_id=11]
                                 :                                :              +- NativeFilter isnotnull(cr_returned_date_sk#75)
                                 :                                :                 +- InputAdapter [#75, #67, #69]
                                 :                                :                    +- NativeParquetScan  (FileScan parquet [cr_returned_date_sk#75,cr_return_amount#67,cr_net_loss#69] Batched: true, DataFilters: [isnotnull(cr_returned_date_sk#75)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cr_returned_date_sk)], ReadSchema: struct<cr_returned_date_sk:int,cr_return_amount:decimal(7,2),cr_net_loss:decimal(7,2)>)
                                 :                                +- NativeSort [d_date_sk#76 ASC NULLS FIRST], false
                                 :                                   +- InputAdapter
                                 :                                      +- InputAdapter [#76]
                                 :                                         +- AQEShuffleRead coalesced
                                 :                                            +- ShuffleQueryStage X
                                 :                                               +- ReusedExchange [d_date_sk#76], NativeShuffleExchange hashpartitioning(d_date_sk#36, 100), ENSURE_REQUIREMENTS, [plan_id=4]
                                 +- NativeProject [sales#77, coalesce(returns#78, 0.00) AS returns#79, (profit#80 - coalesce(profit_loss#81, 0.00)) AS profit#82, web channel AS channel#83, wp_web_page_sk#84 AS id#85]
                                    +- NativeSortMergeJoin [wp_web_page_sk#84], [wp_web_page_sk#86], LeftOuter
                                       :- NativeSort [wp_web_page_sk#84 ASC NULLS FIRST], false
                                       :  +- NativeProject [wp_web_page_sk#84, MakeDecimal(sum(UnscaledValue(ws_ext_sales_price#87))#88,17,2) AS sales#77, MakeDecimal(sum(UnscaledValue(ws_net_profit#89))#90,17,2) AS profit#80]
                                       :     +- NativeHashAggregate HashAgg, ArrayBuffer(wp_web_page_sk#84), [wp_web_page_sk#84], [sum(UnscaledValue(ws_ext_sales_price#87)), sum(UnscaledValue(ws_net_profit#89))], [sum(UnscaledValue(ws_ext_sales_price#87))#88, sum(UnscaledValue(ws_net_profit#89))#90], 1
                                       :        +- NativeHashAggregate HashAgg, [wp_web_page_sk#84], [partial_sum(_c1#91), partial_sum(_c2#92)], [sum#93, sum#94], 0
                                       :           +- NativeProject [wp_web_page_sk#84 AS wp_web_page_sk#84, UnscaledValue(ws_ext_sales_price#87) AS _c1#91, UnscaledValue(ws_net_profit#89) AS _c2#92]
                                       :              +- NativeProject [ws_ext_sales_price#87, ws_net_profit#89, wp_web_page_sk#84]
                                       :                 +- NativeSortMergeJoin [ws_web_page_sk#95], [wp_web_page_sk#84], Inner
                                       :                    :- NativeSort [ws_web_page_sk#95 ASC NULLS FIRST], false
                                       :                    :  +- InputAdapter
                                       :                    :     +- AQEShuffleRead coalesced
                                       :                    :        +- ShuffleQueryStage X
                                       :                    :           +- NativeShuffleExchange hashpartitioning(ws_web_page_sk#95, 100), ENSURE_REQUIREMENTS, [plan_id=12]
                                       :                    :              +- NativeProject [ws_web_page_sk#95, ws_ext_sales_price#87, ws_net_profit#89]
                                       :                    :                 +- NativeSortMergeJoin [ws_sold_date_sk#96], [d_date_sk#97], Inner
                                       :                    :                    :- NativeSort [ws_sold_date_sk#96 ASC NULLS FIRST], false
                                       :                    :                    :  +- InputAdapter
                                       :                    :                    :     +- AQEShuffleRead coalesced
                                       :                    :                    :        +- ShuffleQueryStage X
                                       :                    :                    :           +- NativeShuffleExchange hashpartitioning(ws_sold_date_sk#96, 100), ENSURE_REQUIREMENTS, [plan_id=13]
                                       :                    :                    :              +- NativeFilter (isnotnull(ws_sold_date_sk#96) AND isnotnull(ws_web_page_sk#95))
                                       :                    :                    :                 +- InputAdapter [#96, #95, #87, #89]
                                       :                    :                    :                    +- NativeParquetScan  (FileScan parquet [ws_sold_date_sk#96,ws_web_page_sk#95,ws_ext_sales_price#87,ws_net_profit#89] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#96), isnotnull(ws_web_page_sk#95)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk), IsNotNull(ws_web_page_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_web_page_sk:int,ws_ext_sales_price:decimal(7,2),ws_net_profit:decim...)
                                       :                    :                    +- NativeSort [d_date_sk#97 ASC NULLS FIRST], false
                                       :                    :                       +- InputAdapter
                                       :                    :                          +- InputAdapter [#97]
                                       :                    :                             +- AQEShuffleRead coalesced
                                       :                    :                                +- ShuffleQueryStage X
                                       :                    :                                   +- ReusedExchange [d_date_sk#97], NativeShuffleExchange hashpartitioning(d_date_sk#36, 100), ENSURE_REQUIREMENTS, [plan_id=4]
                                       :                    +- NativeSort [wp_web_page_sk#84 ASC NULLS FIRST], false
                                       :                       +- InputAdapter
                                       :                          +- AQEShuffleRead coalesced
                                       :                             +- ShuffleQueryStage X
                                       :                                +- NativeShuffleExchange hashpartitioning(wp_web_page_sk#84, 100), ENSURE_REQUIREMENTS, [plan_id=14]
                                       :                                   +- NativeFilter isnotnull(wp_web_page_sk#84)
                                       :                                      +- InputAdapter [#84]
                                       :                                         +- NativeParquetScan  (FileScan parquet [wp_web_page_sk#84] Batched: true, DataFilters: [isnotnull(wp_web_page_sk#84)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(wp_web_page_sk)], ReadSchema: struct<wp_web_page_sk:int>)
                                       +- NativeSort [wp_web_page_sk#86 ASC NULLS FIRST], false
                                          +- NativeProject [wp_web_page_sk#86, MakeDecimal(sum(UnscaledValue(wr_return_amt#98))#99,17,2) AS returns#78, MakeDecimal(sum(UnscaledValue(wr_net_loss#100))#101,17,2) AS profit_loss#81]
                                             +- NativeHashAggregate HashAgg, ArrayBuffer(wp_web_page_sk#86), [wp_web_page_sk#86], [sum(UnscaledValue(wr_return_amt#98)), sum(UnscaledValue(wr_net_loss#100))], [sum(UnscaledValue(wr_return_amt#98))#99, sum(UnscaledValue(wr_net_loss#100))#101], 1
                                                +- NativeHashAggregate HashAgg, [wp_web_page_sk#86], [partial_sum(_c1#102), partial_sum(_c2#103)], [sum#104, sum#105], 0
                                                   +- NativeProject [wp_web_page_sk#86 AS wp_web_page_sk#86, UnscaledValue(wr_return_amt#98) AS _c1#102, UnscaledValue(wr_net_loss#100) AS _c2#103]
                                                      +- NativeProject [wr_return_amt#98, wr_net_loss#100, wp_web_page_sk#86]
                                                         +- NativeSortMergeJoin [wr_web_page_sk#106], [wp_web_page_sk#86], Inner
                                                            :- NativeSort [wr_web_page_sk#106 ASC NULLS FIRST], false
                                                            :  +- InputAdapter
                                                            :     +- AQEShuffleRead coalesced
                                                            :        +- ShuffleQueryStage X
                                                            :           +- NativeShuffleExchange hashpartitioning(wr_web_page_sk#106, 100), ENSURE_REQUIREMENTS, [plan_id=15]
                                                            :              +- NativeProject [wr_web_page_sk#106, wr_return_amt#98, wr_net_loss#100]
                                                            :                 +- NativeSortMergeJoin [wr_returned_date_sk#107], [d_date_sk#108], Inner
                                                            :                    :- NativeSort [wr_returned_date_sk#107 ASC NULLS FIRST], false
                                                            :                    :  +- InputAdapter
                                                            :                    :     +- AQEShuffleRead coalesced
                                                            :                    :        +- ShuffleQueryStage X
                                                            :                    :           +- NativeShuffleExchange hashpartitioning(wr_returned_date_sk#107, 100), ENSURE_REQUIREMENTS, [plan_id=16]
                                                            :                    :              +- NativeFilter (isnotnull(wr_returned_date_sk#107) AND isnotnull(wr_web_page_sk#106))
                                                            :                    :                 +- InputAdapter [#107, #106, #98, #100]
                                                            :                    :                    +- NativeParquetScan  (FileScan parquet [wr_returned_date_sk#107,wr_web_page_sk#106,wr_return_amt#98,wr_net_loss#100] Batched: true, DataFilters: [isnotnull(wr_returned_date_sk#107), isnotnull(wr_web_page_sk#106)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(wr_returned_date_sk), IsNotNull(wr_web_page_sk)], ReadSchema: struct<wr_returned_date_sk:int,wr_web_page_sk:int,wr_return_amt:decimal(7,2),wr_net_loss:decimal(...)
                                                            :                    +- NativeSort [d_date_sk#108 ASC NULLS FIRST], false
                                                            :                       +- InputAdapter
                                                            :                          +- InputAdapter [#108]
                                                            :                             +- AQEShuffleRead coalesced
                                                            :                                +- ShuffleQueryStage X
                                                            :                                   +- ReusedExchange [d_date_sk#108], NativeShuffleExchange hashpartitioning(d_date_sk#36, 100), ENSURE_REQUIREMENTS, [plan_id=4]
                                                            +- NativeSort [wp_web_page_sk#86 ASC NULLS FIRST], false
                                                               +- InputAdapter
                                                                  +- InputAdapter [#86]
                                                                     +- AQEShuffleRead coalesced
                                                                        +- ShuffleQueryStage X
                                                                           +- ReusedExchange [wp_web_page_sk#86], NativeShuffleExchange hashpartitioning(wp_web_page_sk#84, 100), ENSURE_REQUIREMENTS, [plan_id=14]
+- == Initial Plan ==
   TakeOrderedAndProject(limit=100, orderBy=[channel#1 ASC NULLS FIRST,id#2 ASC NULLS FIRST,sales#3 ASC NULLS FIRST], output=[channel#1,id#2,sales#3,returns#8,profit#11])
   +- HashAggregate(keys=[channel#1, id#2, spark_grouping_id#12], functions=[sum(sales#4), sum(returns#6), sum(profit#9)], output=[channel#1, id#2, sales#3, returns#8, profit#11])
      +- Exchange hashpartitioning(channel#1, id#2, spark_grouping_id#12, 100), ENSURE_REQUIREMENTS, [plan_id=17]
         +- HashAggregate(keys=[channel#1, id#2, spark_grouping_id#12], functions=[partial_sum(sales#4), partial_sum(returns#6), partial_sum(profit#9)], output=[channel#1, id#2, spark_grouping_id#12, sum#109, isEmpty#110, sum#111, isEmpty#112, sum#113, isEmpty#114])
            +- Expand [[sales#4, returns#6, profit#9, channel#19, id#20, 0], [sales#4, returns#6, profit#9, channel#19, null, 1], [sales#4, returns#6, profit#9, null, null, 3]], [sales#4, returns#6, profit#9, channel#1, id#2, spark_grouping_id#12]
               +- Union
                  :- Project [sales#4, coalesce(returns#21, 0.00) AS returns#6, (profit#22 - coalesce(profit_loss#23, 0.00)) AS profit#9, store channel AS channel#19, s_store_sk#24 AS id#20]
                  :  +- SortMergeJoin [s_store_sk#24], [s_store_sk#25], LeftOuter
                  :     :- Sort [s_store_sk#24 ASC NULLS FIRST], false, 0
                  :     :  +- HashAggregate(keys=[s_store_sk#24], functions=[sum(UnscaledValue(ss_ext_sales_price#26)), sum(UnscaledValue(ss_net_profit#28))], output=[s_store_sk#24, sales#4, profit#22])
                  :     :     +- HashAggregate(keys=[s_store_sk#24], functions=[partial_sum(UnscaledValue(ss_ext_sales_price#26)), partial_sum(UnscaledValue(ss_net_profit#28))], output=[s_store_sk#24, sum#115, sum#116])
                  :     :        +- Project [ss_ext_sales_price#26, ss_net_profit#28, s_store_sk#24]
                  :     :           +- SortMergeJoin [ss_store_sk#34], [s_store_sk#24], Inner
                  :     :              :- Sort [ss_store_sk#34 ASC NULLS FIRST], false, 0
                  :     :              :  +- Exchange hashpartitioning(ss_store_sk#34, 100), ENSURE_REQUIREMENTS, [plan_id=18]
                  :     :              :     +- Project [ss_store_sk#34, ss_ext_sales_price#26, ss_net_profit#28]
                  :     :              :        +- SortMergeJoin [ss_sold_date_sk#35], [d_date_sk#36], Inner
                  :     :              :           :- Sort [ss_sold_date_sk#35 ASC NULLS FIRST], false, 0
                  :     :              :           :  +- Exchange hashpartitioning(ss_sold_date_sk#35, 100), ENSURE_REQUIREMENTS, [plan_id=19]
                  :     :              :           :     +- Filter (isnotnull(ss_sold_date_sk#35) AND isnotnull(ss_store_sk#34))
                  :     :              :           :        +- FileScan parquet [ss_sold_date_sk#35,ss_store_sk#34,ss_ext_sales_price#26,ss_net_profit#28] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#35), isnotnull(ss_store_sk#34)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_store_sk:int,ss_ext_sales_price:decimal(7,2),ss_net_profit:decimal(...
                  :     :              :           +- Sort [d_date_sk#36 ASC NULLS FIRST], false, 0
                  :     :              :              +- Exchange hashpartitioning(d_date_sk#36, 100), ENSURE_REQUIREMENTS, [plan_id=20]
                  :     :              :                 +- Project [d_date_sk#36]
                  :     :              :                    +- Filter (((isnotnull(d_date#37) AND (d_date#37 >= 2000-08-03)) AND (d_date#37 <= 2000-09-02)) AND isnotnull(d_date_sk#36))
                  :     :              :                       +- FileScan parquet [d_date_sk#36,d_date#37] Batched: true, DataFilters: [isnotnull(d_date#37), (d_date#37 >= 2000-08-03), (d_date#37 <= 2000-09-02), isnotnull(d..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_date), GreaterThanOrEqual(d_date,2000-08-03), LessThanOrEqual(d_date,2000-09-02), Is..., ReadSchema: struct<d_date_sk:int,d_date:date>
                  :     :              +- Sort [s_store_sk#24 ASC NULLS FIRST], false, 0
                  :     :                 +- Exchange hashpartitioning(s_store_sk#24, 100), ENSURE_REQUIREMENTS, [plan_id=21]
                  :     :                    +- Filter isnotnull(s_store_sk#24)
                  :     :                       +- FileScan parquet [s_store_sk#24] Batched: true, DataFilters: [isnotnull(s_store_sk#24)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk)], ReadSchema: struct<s_store_sk:int>
                  :     +- Sort [s_store_sk#25 ASC NULLS FIRST], false, 0
                  :        +- HashAggregate(keys=[s_store_sk#25], functions=[sum(UnscaledValue(sr_return_amt#38)), sum(UnscaledValue(sr_net_loss#40))], output=[s_store_sk#25, returns#21, profit_loss#23])
                  :           +- HashAggregate(keys=[s_store_sk#25], functions=[partial_sum(UnscaledValue(sr_return_amt#38)), partial_sum(UnscaledValue(sr_net_loss#40))], output=[s_store_sk#25, sum#117, sum#118])
                  :              +- Project [sr_return_amt#38, sr_net_loss#40, s_store_sk#25]
                  :                 +- SortMergeJoin [sr_store_sk#46], [s_store_sk#25], Inner
                  :                    :- Sort [sr_store_sk#46 ASC NULLS FIRST], false, 0
                  :                    :  +- Exchange hashpartitioning(sr_store_sk#46, 100), ENSURE_REQUIREMENTS, [plan_id=22]
                  :                    :     +- Project [sr_store_sk#46, sr_return_amt#38, sr_net_loss#40]
                  :                    :        +- SortMergeJoin [sr_returned_date_sk#47], [d_date_sk#48], Inner
                  :                    :           :- Sort [sr_returned_date_sk#47 ASC NULLS FIRST], false, 0
                  :                    :           :  +- Exchange hashpartitioning(sr_returned_date_sk#47, 100), ENSURE_REQUIREMENTS, [plan_id=23]
                  :                    :           :     +- Filter (isnotnull(sr_returned_date_sk#47) AND isnotnull(sr_store_sk#46))
                  :                    :           :        +- FileScan parquet [sr_returned_date_sk#47,sr_store_sk#46,sr_return_amt#38,sr_net_loss#40] Batched: true, DataFilters: [isnotnull(sr_returned_date_sk#47), isnotnull(sr_store_sk#46)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(sr_returned_date_sk), IsNotNull(sr_store_sk)], ReadSchema: struct<sr_returned_date_sk:int,sr_store_sk:int,sr_return_amt:decimal(7,2),sr_net_loss:decimal(7,2)>
                  :                    :           +- Sort [d_date_sk#48 ASC NULLS FIRST], false, 0
                  :                    :              +- Exchange hashpartitioning(d_date_sk#48, 100), ENSURE_REQUIREMENTS, [plan_id=24]
                  :                    :                 +- Project [d_date_sk#48]
                  :                    :                    +- Filter (((isnotnull(d_date#119) AND (d_date#119 >= 2000-08-03)) AND (d_date#119 <= 2000-09-02)) AND isnotnull(d_date_sk#48))
                  :                    :                       +- FileScan parquet [d_date_sk#48,d_date#119] Batched: true, DataFilters: [isnotnull(d_date#119), (d_date#119 >= 2000-08-03), (d_date#119 <= 2000-09-02), isnotnull(d..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_date), GreaterThanOrEqual(d_date,2000-08-03), LessThanOrEqual(d_date,2000-09-02), Is..., ReadSchema: struct<d_date_sk:int,d_date:date>
                  :                    +- Sort [s_store_sk#25 ASC NULLS FIRST], false, 0
                  :                       +- Exchange hashpartitioning(s_store_sk#25, 100), ENSURE_REQUIREMENTS, [plan_id=25]
                  :                          +- Filter isnotnull(s_store_sk#25)
                  :                             +- FileScan parquet [s_store_sk#25] Batched: true, DataFilters: [isnotnull(s_store_sk#25)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk)], ReadSchema: struct<s_store_sk:int>
                  :- Project [sales#49, returns#50, (profit#51 - profit_loss#52) AS profit#53, catalog channel AS channel#54, cs_call_center_sk#55 AS id#56]
                  :  +- CartesianProduct
                  :     :- HashAggregate(keys=[cs_call_center_sk#55], functions=[sum(UnscaledValue(cs_ext_sales_price#57)), sum(UnscaledValue(cs_net_profit#59))], output=[cs_call_center_sk#55, sales#49, profit#51])
                  :     :  +- Exchange hashpartitioning(cs_call_center_sk#55, 100), ENSURE_REQUIREMENTS, [plan_id=26]
                  :     :     +- HashAggregate(keys=[cs_call_center_sk#55], functions=[partial_sum(UnscaledValue(cs_ext_sales_price#57)), partial_sum(UnscaledValue(cs_net_profit#59))], output=[cs_call_center_sk#55, sum#120, sum#121])
                  :     :        +- Project [cs_call_center_sk#55, cs_ext_sales_price#57, cs_net_profit#59]
                  :     :           +- SortMergeJoin [cs_sold_date_sk#65], [d_date_sk#66], Inner
                  :     :              :- Sort [cs_sold_date_sk#65 ASC NULLS FIRST], false, 0
                  :     :              :  +- Exchange hashpartitioning(cs_sold_date_sk#65, 100), ENSURE_REQUIREMENTS, [plan_id=27]
                  :     :              :     +- Filter isnotnull(cs_sold_date_sk#65)
                  :     :              :        +- FileScan parquet [cs_sold_date_sk#65,cs_call_center_sk#55,cs_ext_sales_price#57,cs_net_profit#59] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#65)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_call_center_sk:int,cs_ext_sales_price:decimal(7,2),cs_net_profit:de...
                  :     :              +- Sort [d_date_sk#66 ASC NULLS FIRST], false, 0
                  :     :                 +- Exchange hashpartitioning(d_date_sk#66, 100), ENSURE_REQUIREMENTS, [plan_id=28]
                  :     :                    +- Project [d_date_sk#66]
                  :     :                       +- Filter (((isnotnull(d_date#122) AND (d_date#122 >= 2000-08-03)) AND (d_date#122 <= 2000-09-02)) AND isnotnull(d_date_sk#66))
                  :     :                          +- FileScan parquet [d_date_sk#66,d_date#122] Batched: true, DataFilters: [isnotnull(d_date#122), (d_date#122 >= 2000-08-03), (d_date#122 <= 2000-09-02), isnotnull(d..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_date), GreaterThanOrEqual(d_date,2000-08-03), LessThanOrEqual(d_date,2000-09-02), Is..., ReadSchema: struct<d_date_sk:int,d_date:date>
                  :     +- HashAggregate(keys=[], functions=[sum(UnscaledValue(cr_return_amount#67)), sum(UnscaledValue(cr_net_loss#69))], output=[returns#50, profit_loss#52])
                  :        +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=29]
                  :           +- HashAggregate(keys=[], functions=[partial_sum(UnscaledValue(cr_return_amount#67)), partial_sum(UnscaledValue(cr_net_loss#69))], output=[sum#123, sum#124])
                  :              +- Project [cr_return_amount#67, cr_net_loss#69]
                  :                 +- SortMergeJoin [cr_returned_date_sk#75], [d_date_sk#76], Inner
                  :                    :- Sort [cr_returned_date_sk#75 ASC NULLS FIRST], false, 0
                  :                    :  +- Exchange hashpartitioning(cr_returned_date_sk#75, 100), ENSURE_REQUIREMENTS, [plan_id=30]
                  :                    :     +- Filter isnotnull(cr_returned_date_sk#75)
                  :                    :        +- FileScan parquet [cr_returned_date_sk#75,cr_return_amount#67,cr_net_loss#69] Batched: true, DataFilters: [isnotnull(cr_returned_date_sk#75)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cr_returned_date_sk)], ReadSchema: struct<cr_returned_date_sk:int,cr_return_amount:decimal(7,2),cr_net_loss:decimal(7,2)>
                  :                    +- Sort [d_date_sk#76 ASC NULLS FIRST], false, 0
                  :                       +- Exchange hashpartitioning(d_date_sk#76, 100), ENSURE_REQUIREMENTS, [plan_id=31]
                  :                          +- Project [d_date_sk#76]
                  :                             +- Filter (((isnotnull(d_date#125) AND (d_date#125 >= 2000-08-03)) AND (d_date#125 <= 2000-09-02)) AND isnotnull(d_date_sk#76))
                  :                                +- FileScan parquet [d_date_sk#76,d_date#125] Batched: true, DataFilters: [isnotnull(d_date#125), (d_date#125 >= 2000-08-03), (d_date#125 <= 2000-09-02), isnotnull(d..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_date), GreaterThanOrEqual(d_date,2000-08-03), LessThanOrEqual(d_date,2000-09-02), Is..., ReadSchema: struct<d_date_sk:int,d_date:date>
                  +- Project [sales#77, coalesce(returns#78, 0.00) AS returns#79, (profit#80 - coalesce(profit_loss#81, 0.00)) AS profit#82, web channel AS channel#83, wp_web_page_sk#84 AS id#85]
                     +- SortMergeJoin [wp_web_page_sk#84], [wp_web_page_sk#86], LeftOuter
                        :- Sort [wp_web_page_sk#84 ASC NULLS FIRST], false, 0
                        :  +- HashAggregate(keys=[wp_web_page_sk#84], functions=[sum(UnscaledValue(ws_ext_sales_price#87)), sum(UnscaledValue(ws_net_profit#89))], output=[wp_web_page_sk#84, sales#77, profit#80])
                        :     +- HashAggregate(keys=[wp_web_page_sk#84], functions=[partial_sum(UnscaledValue(ws_ext_sales_price#87)), partial_sum(UnscaledValue(ws_net_profit#89))], output=[wp_web_page_sk#84, sum#126, sum#127])
                        :        +- Project [ws_ext_sales_price#87, ws_net_profit#89, wp_web_page_sk#84]
                        :           +- SortMergeJoin [ws_web_page_sk#95], [wp_web_page_sk#84], Inner
                        :              :- Sort [ws_web_page_sk#95 ASC NULLS FIRST], false, 0
                        :              :  +- Exchange hashpartitioning(ws_web_page_sk#95, 100), ENSURE_REQUIREMENTS, [plan_id=32]
                        :              :     +- Project [ws_web_page_sk#95, ws_ext_sales_price#87, ws_net_profit#89]
                        :              :        +- SortMergeJoin [ws_sold_date_sk#96], [d_date_sk#97], Inner
                        :              :           :- Sort [ws_sold_date_sk#96 ASC NULLS FIRST], false, 0
                        :              :           :  +- Exchange hashpartitioning(ws_sold_date_sk#96, 100), ENSURE_REQUIREMENTS, [plan_id=33]
                        :              :           :     +- Filter (isnotnull(ws_sold_date_sk#96) AND isnotnull(ws_web_page_sk#95))
                        :              :           :        +- FileScan parquet [ws_sold_date_sk#96,ws_web_page_sk#95,ws_ext_sales_price#87,ws_net_profit#89] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#96), isnotnull(ws_web_page_sk#95)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk), IsNotNull(ws_web_page_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_web_page_sk:int,ws_ext_sales_price:decimal(7,2),ws_net_profit:decim...
                        :              :           +- Sort [d_date_sk#97 ASC NULLS FIRST], false, 0
                        :              :              +- Exchange hashpartitioning(d_date_sk#97, 100), ENSURE_REQUIREMENTS, [plan_id=34]
                        :              :                 +- Project [d_date_sk#97]
                        :              :                    +- Filter (((isnotnull(d_date#128) AND (d_date#128 >= 2000-08-03)) AND (d_date#128 <= 2000-09-02)) AND isnotnull(d_date_sk#97))
                        :              :                       +- FileScan parquet [d_date_sk#97,d_date#128] Batched: true, DataFilters: [isnotnull(d_date#128), (d_date#128 >= 2000-08-03), (d_date#128 <= 2000-09-02), isnotnull(d..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_date), GreaterThanOrEqual(d_date,2000-08-03), LessThanOrEqual(d_date,2000-09-02), Is..., ReadSchema: struct<d_date_sk:int,d_date:date>
                        :              +- Sort [wp_web_page_sk#84 ASC NULLS FIRST], false, 0
                        :                 +- Exchange hashpartitioning(wp_web_page_sk#84, 100), ENSURE_REQUIREMENTS, [plan_id=35]
                        :                    +- Filter isnotnull(wp_web_page_sk#84)
                        :                       +- FileScan parquet [wp_web_page_sk#84] Batched: true, DataFilters: [isnotnull(wp_web_page_sk#84)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(wp_web_page_sk)], ReadSchema: struct<wp_web_page_sk:int>
                        +- Sort [wp_web_page_sk#86 ASC NULLS FIRST], false, 0
                           +- HashAggregate(keys=[wp_web_page_sk#86], functions=[sum(UnscaledValue(wr_return_amt#98)), sum(UnscaledValue(wr_net_loss#100))], output=[wp_web_page_sk#86, returns#78, profit_loss#81])
                              +- HashAggregate(keys=[wp_web_page_sk#86], functions=[partial_sum(UnscaledValue(wr_return_amt#98)), partial_sum(UnscaledValue(wr_net_loss#100))], output=[wp_web_page_sk#86, sum#129, sum#130])
                                 +- Project [wr_return_amt#98, wr_net_loss#100, wp_web_page_sk#86]
                                    +- SortMergeJoin [wr_web_page_sk#106], [wp_web_page_sk#86], Inner
                                       :- Sort [wr_web_page_sk#106 ASC NULLS FIRST], false, 0
                                       :  +- Exchange hashpartitioning(wr_web_page_sk#106, 100), ENSURE_REQUIREMENTS, [plan_id=36]
                                       :     +- Project [wr_web_page_sk#106, wr_return_amt#98, wr_net_loss#100]
                                       :        +- SortMergeJoin [wr_returned_date_sk#107], [d_date_sk#108], Inner
                                       :           :- Sort [wr_returned_date_sk#107 ASC NULLS FIRST], false, 0
                                       :           :  +- Exchange hashpartitioning(wr_returned_date_sk#107, 100), ENSURE_REQUIREMENTS, [plan_id=37]
                                       :           :     +- Filter (isnotnull(wr_returned_date_sk#107) AND isnotnull(wr_web_page_sk#106))
                                       :           :        +- FileScan parquet [wr_returned_date_sk#107,wr_web_page_sk#106,wr_return_amt#98,wr_net_loss#100] Batched: true, DataFilters: [isnotnull(wr_returned_date_sk#107), isnotnull(wr_web_page_sk#106)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(wr_returned_date_sk), IsNotNull(wr_web_page_sk)], ReadSchema: struct<wr_returned_date_sk:int,wr_web_page_sk:int,wr_return_amt:decimal(7,2),wr_net_loss:decimal(...
                                       :           +- Sort [d_date_sk#108 ASC NULLS FIRST], false, 0
                                       :              +- Exchange hashpartitioning(d_date_sk#108, 100), ENSURE_REQUIREMENTS, [plan_id=38]
                                       :                 +- Project [d_date_sk#108]
                                       :                    +- Filter (((isnotnull(d_date#131) AND (d_date#131 >= 2000-08-03)) AND (d_date#131 <= 2000-09-02)) AND isnotnull(d_date_sk#108))
                                       :                       +- FileScan parquet [d_date_sk#108,d_date#131] Batched: true, DataFilters: [isnotnull(d_date#131), (d_date#131 >= 2000-08-03), (d_date#131 <= 2000-09-02), isnotnull(d..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_date), GreaterThanOrEqual(d_date,2000-08-03), LessThanOrEqual(d_date,2000-09-02), Is..., ReadSchema: struct<d_date_sk:int,d_date:date>
                                       +- Sort [wp_web_page_sk#86 ASC NULLS FIRST], false, 0
                                          +- Exchange hashpartitioning(wp_web_page_sk#86, 100), ENSURE_REQUIREMENTS, [plan_id=39]
                                             +- Filter isnotnull(wp_web_page_sk#86)
                                                +- FileScan parquet [wp_web_page_sk#86] Batched: true, DataFilters: [isnotnull(wp_web_page_sk#86)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<dir>], PartitionFilters: [], PushedFilters: [IsNotNull(wp_web_page_sk)], ReadSchema: struct<wp_web_page_sk:int>
