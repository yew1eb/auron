AdaptiveSparkPlan isFinalPlan=true
+- == Final Plan ==
   NativeTakeOrdered 100, [channel#1 ASC NULLS FIRST, i_brand_id#2 ASC NULLS FIRST, i_class_id#3 ASC NULLS FIRST, i_category_id#4 ASC NULLS FIRST]
   +- NativeProject [channel#1, i_brand_id#2, i_class_id#3, i_category_id#4, sum(sales#5)#6 AS sum(sales)#7, sum(number_sales#8)#9 AS sum(number_sales)#10]
      +- NativeHashAggregate HashAgg, ArrayBuffer(channel#1, i_brand_id#2, i_class_id#3, i_category_id#4, spark_grouping_id#11), [channel#1, i_brand_id#2, i_class_id#3, i_category_id#4, spark_grouping_id#11], [sum(sales#5), sum(number_sales#8)], [sum(sales#5)#6, sum(number_sales#8)#9], 5
         +- InputAdapter
            +- AQEShuffleRead coalesced
               +- ShuffleQueryStage X
                  +- NativeShuffleExchange hashpartitioning(channel#1, i_brand_id#2, i_class_id#3, i_category_id#4, spark_grouping_id#11, 100), ENSURE_REQUIREMENTS, [plan_id=1]
                     +- NativeHashAggregate HashAgg, [channel#1, i_brand_id#2, i_class_id#3, i_category_id#4, spark_grouping_id#11], [partial_sum(sales#5), partial_sum(number_sales#8)], [sum#12, isEmpty#13, sum#14], 0
                        +- !NativeExpand [[sales#5, number_sales#8, channel#15, i_brand_id#16, i_class_id#17, i_category_id#18, 0], [sales#5, number_sales#8, channel#15, i_brand_id#16, i_class_id#17, null, 1], [sales#5, number_sales#8, channel#15, i_brand_id#16, null, null, 3], [sales#5, number_sales#8, channel#15, null, null, null, 7], [sales#5, number_sales#8, null, null, null, null, 15]], [sales#5, number_sales#8, channel#1, i_brand_id#2, i_class_id#3, i_category_id#4, spark_grouping_id#11]
                           +- InputAdapter [#5, #19, #15, #16, #17, #18]
                              +- NativeUnion [sales#5, number_sales#8, channel#15, i_brand_id#16, i_class_id#17, i_category_id#18]
                                 :- NativeProject [sales#5, number_sales#8, store AS channel#15, i_brand_id#20 AS i_brand_id#16, i_class_id#21 AS i_class_id#17, i_category_id#22 AS i_category_id#18]
                                 :  +- NativeFilter (isnotnull(sales#5) AND (cast(sales#5 as decimal(32,6)) > cast(Subquery subquery#23, [id=#24] as decimal(32,6))))
                                 :     :  +- Subquery subquery#23, [id=#24]
                                 :     :     +- AdaptiveSparkPlan isFinalPlan=true
                                             +- == Final Plan ==
                                                NativeProject [avg((cast(quantity#25 as decimal(10,0)) * list_price#26))#27 AS average_sales#28]
                                                +- NativeHashAggregate HashAgg, List(), [avg((cast(quantity#25 as decimal(10,0)) * list_price#26))], [avg((cast(quantity#25 as decimal(10,0)) * list_price#26))#27], 0
                                                   +- ShuffleQueryStage X
                                                      +- NativeShuffleExchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=2]
                                                         +- NativeHashAggregate HashAgg, [partial_avg(_c0#29)], [sum#30, count#31], 0
                                                            +- NativeProject [(cast(quantity#25 as decimal(10,0)) * list_price#26) AS _c0#29]
                                                               +- InputAdapter [#25, #26]
                                                                  +- NativeUnion [quantity#25, list_price#26]
                                                                     :- NativeProject [ss_quantity#32 AS quantity#25, ss_list_price#33 AS list_price#26]
                                                                     :  +- NativeSortMergeJoin [ss_sold_date_sk#34], [d_date_sk#35], Inner
                                                                     :     :- NativeSort [ss_sold_date_sk#34 ASC NULLS FIRST], false
                                                                     :     :  +- InputAdapter
                                                                     :     :     +- AQEShuffleRead coalesced
                                                                     :     :        +- ShuffleQueryStage X
                                                                     :     :           +- NativeShuffleExchange hashpartitioning(ss_sold_date_sk#34, 100), ENSURE_REQUIREMENTS, [plan_id=3]
                                                                     :     :              +- NativeFilter isnotnull(ss_sold_date_sk#34)
                                                                     :     :                 +- InputAdapter [#34, #32, #33]
                                                                     :     :                    +- NativeParquetScan  (FileScan parquet [ss_sold_date_sk#34,ss_quantity#32,ss_list_price#33] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#34)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>)
                                                                     :     +- NativeSort [d_date_sk#35 ASC NULLS FIRST], false
                                                                     :        +- InputAdapter
                                                                     :           +- InputAdapter [#35]
                                                                     :              +- AQEShuffleRead coalesced
                                                                     :                 +- ShuffleQueryStage X
                                                                     :                    +- ReusedExchange [d_date_sk#35], NativeShuffleExchange hashpartitioning(d_date_sk#36, 100), ENSURE_REQUIREMENTS, [plan_id=4]
                                                                     :- NativeProject [cs_quantity#37 AS quantity#38, cs_list_price#39 AS list_price#40]
                                                                     :  +- NativeSortMergeJoin [cs_sold_date_sk#41], [d_date_sk#42], Inner
                                                                     :     :- NativeSort [cs_sold_date_sk#41 ASC NULLS FIRST], false
                                                                     :     :  +- InputAdapter
                                                                     :     :     +- AQEShuffleRead coalesced
                                                                     :     :        +- ShuffleQueryStage X
                                                                     :     :           +- NativeShuffleExchange hashpartitioning(cs_sold_date_sk#41, 100), ENSURE_REQUIREMENTS, [plan_id=5]
                                                                     :     :              +- NativeFilter isnotnull(cs_sold_date_sk#41)
                                                                     :     :                 +- InputAdapter [#41, #37, #39]
                                                                     :     :                    +- NativeParquetScan  (FileScan parquet [cs_sold_date_sk#41,cs_quantity#37,cs_list_price#39] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#41)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>)
                                                                     :     +- NativeSort [d_date_sk#42 ASC NULLS FIRST], false
                                                                     :        +- InputAdapter
                                                                     :           +- InputAdapter [#42]
                                                                     :              +- AQEShuffleRead coalesced
                                                                     :                 +- ShuffleQueryStage X
                                                                     :                    +- ReusedExchange [d_date_sk#42], NativeShuffleExchange hashpartitioning(d_date_sk#36, 100), ENSURE_REQUIREMENTS, [plan_id=4]
                                                                     +- NativeProject [ws_quantity#43 AS quantity#44, ws_list_price#45 AS list_price#46]
                                                                        +- NativeSortMergeJoin [ws_sold_date_sk#47], [d_date_sk#48], Inner
                                                                           :- NativeSort [ws_sold_date_sk#47 ASC NULLS FIRST], false
                                                                           :  +- InputAdapter
                                                                           :     +- AQEShuffleRead coalesced
                                                                           :        +- ShuffleQueryStage X
                                                                           :           +- NativeShuffleExchange hashpartitioning(ws_sold_date_sk#47, 100), ENSURE_REQUIREMENTS, [plan_id=6]
                                                                           :              +- NativeFilter isnotnull(ws_sold_date_sk#47)
                                                                           :                 +- InputAdapter [#47, #43, #45]
                                                                           :                    +- NativeParquetScan  (FileScan parquet [ws_sold_date_sk#47,ws_quantity#43,ws_list_price#45] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#47)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>)
                                                                           +- NativeSort [d_date_sk#48 ASC NULLS FIRST], false
                                                                              +- InputAdapter
                                                                                 +- InputAdapter [#48]
                                                                                    +- AQEShuffleRead coalesced
                                                                                       +- ShuffleQueryStage X
                                                                                          +- ReusedExchange [d_date_sk#48], NativeShuffleExchange hashpartitioning(d_date_sk#36, 100), ENSURE_REQUIREMENTS, [plan_id=4]
                                             +- == Initial Plan ==
                                                HashAggregate(keys=[], functions=[avg((cast(quantity#25 as decimal(10,0)) * list_price#26))], output=[average_sales#28])
                                                +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=7]
                                                   +- HashAggregate(keys=[], functions=[partial_avg((cast(quantity#25 as decimal(10,0)) * list_price#26))], output=[sum#49, count#50])
                                                      +- Union
                                                         :- Project [ss_quantity#32 AS quantity#25, ss_list_price#33 AS list_price#26]
                                                         :  +- SortMergeJoin [ss_sold_date_sk#34], [d_date_sk#35], Inner
                                                         :     :- Sort [ss_sold_date_sk#34 ASC NULLS FIRST], false, 0
                                                         :     :  +- Exchange hashpartitioning(ss_sold_date_sk#34, 100), ENSURE_REQUIREMENTS, [plan_id=8]
                                                         :     :     +- Filter isnotnull(ss_sold_date_sk#34)
                                                         :     :        +- FileScan parquet [ss_sold_date_sk#34,ss_quantity#32,ss_list_price#33] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#34)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
                                                         :     +- Sort [d_date_sk#35 ASC NULLS FIRST], false, 0
                                                         :        +- Exchange hashpartitioning(d_date_sk#35, 100), ENSURE_REQUIREMENTS, [plan_id=9]
                                                         :           +- Project [d_date_sk#35]
                                                         :              +- Filter (((isnotnull(d_year#51) AND (d_year#51 >= 1999)) AND (d_year#51 <= 2001)) AND isnotnull(d_date_sk#35))
                                                         :                 +- FileScan parquet [d_date_sk#35,d_year#51] Batched: true, DataFilters: [isnotnull(d_year#51), (d_year#51 >= 1999), (d_year#51 <= 2001), isnotnull(d_date_sk#52..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                                         :- Project [cs_quantity#37 AS quantity#38, cs_list_price#39 AS list_price#40]
                                                         :  +- SortMergeJoin [cs_sold_date_sk#41], [d_date_sk#42], Inner
                                                         :     :- Sort [cs_sold_date_sk#41 ASC NULLS FIRST], false, 0
                                                         :     :  +- Exchange hashpartitioning(cs_sold_date_sk#41, 100), ENSURE_REQUIREMENTS, [plan_id=10]
                                                         :     :     +- Filter isnotnull(cs_sold_date_sk#41)
                                                         :     :        +- FileScan parquet [cs_sold_date_sk#41,cs_quantity#37,cs_list_price#39] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#41)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>
                                                         :     +- Sort [d_date_sk#42 ASC NULLS FIRST], false, 0
                                                         :        +- Exchange hashpartitioning(d_date_sk#42, 100), ENSURE_REQUIREMENTS, [plan_id=11]
                                                         :           +- Project [d_date_sk#42]
                                                         :              +- Filter (((isnotnull(d_year#53) AND (d_year#53 >= 1999)) AND (d_year#53 <= 2001)) AND isnotnull(d_date_sk#42))
                                                         :                 +- FileScan parquet [d_date_sk#42,d_year#53] Batched: true, DataFilters: [isnotnull(d_year#53), (d_year#53 >= 1999), (d_year#53 <= 2001), isnotnull(d_date_sk#52..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                                         +- Project [ws_quantity#43 AS quantity#44, ws_list_price#45 AS list_price#46]
                                                            +- SortMergeJoin [ws_sold_date_sk#47], [d_date_sk#48], Inner
                                                               :- Sort [ws_sold_date_sk#47 ASC NULLS FIRST], false, 0
                                                               :  +- Exchange hashpartitioning(ws_sold_date_sk#47, 100), ENSURE_REQUIREMENTS, [plan_id=12]
                                                               :     +- Filter isnotnull(ws_sold_date_sk#47)
                                                               :        +- FileScan parquet [ws_sold_date_sk#47,ws_quantity#43,ws_list_price#45] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#47)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
                                                               +- Sort [d_date_sk#48 ASC NULLS FIRST], false, 0
                                                                  +- Exchange hashpartitioning(d_date_sk#48, 100), ENSURE_REQUIREMENTS, [plan_id=13]
                                                                     +- Project [d_date_sk#48]
                                                                        +- Filter (((isnotnull(d_year#54) AND (d_year#54 >= 1999)) AND (d_year#54 <= 2001)) AND isnotnull(d_date_sk#48))
                                                                           +- FileScan parquet [d_date_sk#48,d_year#54] Batched: true, DataFilters: [isnotnull(d_year#54), (d_year#54 >= 1999), (d_year#54 <= 2001), isnotnull(d_date_sk#55..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                 :     +- NativeProject [i_brand_id#20, i_class_id#21, i_category_id#22, sum((cast(ss_quantity#56 as decimal(10,0)) * ss_list_price#57))#58 AS sales#5, count(1)#59 AS number_sales#8]
                                 :        +- NativeHashAggregate HashAgg, ArrayBuffer(i_brand_id#20, i_class_id#21, i_category_id#22), [i_brand_id#20, i_class_id#21, i_category_id#22], [sum((cast(ss_quantity#56 as decimal(10,0)) * ss_list_price#57)), count(1)], [sum((cast(ss_quantity#56 as decimal(10,0)) * ss_list_price#57))#58, count(1)#59], 3
                                 :           +- InputAdapter
                                 :              +- AQEShuffleRead coalesced
                                 :                 +- ShuffleQueryStage X
                                 :                    +- NativeShuffleExchange hashpartitioning(i_brand_id#20, i_class_id#21, i_category_id#22, 100), ENSURE_REQUIREMENTS, [plan_id=14]
                                 :                       +- NativeHashAggregate HashAgg, [i_brand_id#20, i_class_id#21, i_category_id#22], [partial_sum(_c3#60), partial_count(1)], [sum#61, isEmpty#62, count#63], 0
                                 :                          +- NativeProject [i_brand_id#20 AS i_brand_id#20, i_class_id#21 AS i_class_id#21, i_category_id#22 AS i_category_id#22, (cast(ss_quantity#56 as decimal(10,0)) * ss_list_price#57) AS _c3#60]
                                 :                             +- NativeProject [ss_quantity#56, ss_list_price#57, i_brand_id#20, i_class_id#21, i_category_id#22]
                                 :                                +- NativeSortMergeJoin [ss_sold_date_sk#64], [d_date_sk#65], Inner
                                 :                                   :- NativeSort [ss_sold_date_sk#64 ASC NULLS FIRST], false
                                 :                                   :  +- InputAdapter
                                 :                                   :     +- AQEShuffleRead coalesced
                                 :                                   :        +- ShuffleQueryStage X
                                 :                                   :           +- NativeShuffleExchange hashpartitioning(ss_sold_date_sk#64, 100), ENSURE_REQUIREMENTS, [plan_id=15]
                                 :                                   :              +- NativeProject [ss_sold_date_sk#64, ss_quantity#56, ss_list_price#57, i_brand_id#20, i_class_id#21, i_category_id#22]
                                 :                                   :                 +- NativeSortMergeJoin [ss_item_sk#66], [i_item_sk#67], Inner
                                 :                                   :                    :- NativeSortMergeJoin [ss_item_sk#66], [ss_item_sk#68], LeftSemi
                                 :                                   :                    :  :- NativeSort [ss_item_sk#66 ASC NULLS FIRST], false
                                 :                                   :                    :  :  +- InputAdapter
                                 :                                   :                    :  :     +- AQEShuffleRead coalesced
                                 :                                   :                    :  :        +- ShuffleQueryStage X
                                 :                                   :                    :  :           +- NativeShuffleExchange hashpartitioning(ss_item_sk#66, 100), ENSURE_REQUIREMENTS, [plan_id=16]
                                 :                                   :                    :  :              +- NativeFilter (isnotnull(ss_item_sk#66) AND isnotnull(ss_sold_date_sk#64))
                                 :                                   :                    :  :                 +- InputAdapter [#64, #66, #56, #57]
                                 :                                   :                    :  :                    +- NativeParquetScan  (FileScan parquet [ss_sold_date_sk#64,ss_item_sk#66,ss_quantity#56,ss_list_price#57] Batched: true, DataFilters: [isnotnull(ss_item_sk#66), isnotnull(ss_sold_date_sk#64)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>)
                                 :                                   :                    :  +- NativeSort [ss_item_sk#68 ASC NULLS FIRST], false
                                 :                                   :                    :     +- InputAdapter
                                 :                                   :                    :        +- AQEShuffleRead coalesced
                                 :                                   :                    :           +- ShuffleQueryStage X
                                 :                                   :                    :              +- NativeShuffleExchange hashpartitioning(ss_item_sk#68, 100), ENSURE_REQUIREMENTS, [plan_id=17]
                                 :                                   :                    :                 +- NativeProject [i_item_sk#69 AS ss_item_sk#68]
                                 :                                   :                    :                    +- NativeSortMergeJoin [i_brand_id#70, i_class_id#71, i_category_id#72], [brand_id#73, class_id#74, category_id#75], Inner
                                 :                                   :                    :                       :- NativeSort [i_brand_id#70 ASC NULLS FIRST, i_class_id#71 ASC NULLS FIRST, i_category_id#72 ASC NULLS FIRST], false
                                 :                                   :                    :                       :  +- InputAdapter
                                 :                                   :                    :                       :     +- AQEShuffleRead coalesced
                                 :                                   :                    :                       :        +- ShuffleQueryStage X
                                 :                                   :                    :                       :           +- NativeShuffleExchange hashpartitioning(i_brand_id#70, i_class_id#71, i_category_id#72, 100), ENSURE_REQUIREMENTS, [plan_id=18]
                                 :                                   :                    :                       :              +- NativeFilter ((isnotnull(i_brand_id#70) AND isnotnull(i_class_id#71)) AND isnotnull(i_category_id#72))
                                 :                                   :                    :                       :                 +- InputAdapter [#69, #70, #71, #72]
                                 :                                   :                    :                       :                    +- NativeParquetScan  (FileScan parquet [i_item_sk#69,i_brand_id#70,i_class_id#71,i_category_id#72] Batched: true, DataFilters: [isnotnull(i_brand_id#70), isnotnull(i_class_id#71), isnotnull(i_category_id#72)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>)
                                 :                                   :                    :                       +- NativeSort [brand_id#73 ASC NULLS FIRST, class_id#74 ASC NULLS FIRST, category_id#75 ASC NULLS FIRST], false
                                 :                                   :                    :                          +- InputAdapter
                                 :                                   :                    :                             +- AQEShuffleRead coalesced
                                 :                                   :                    :                                +- ShuffleQueryStage X
                                 :                                   :                    :                                   +- NativeShuffleExchange hashpartitioning(brand_id#73, class_id#74, category_id#75, 100), ENSURE_REQUIREMENTS, [plan_id=19]
                                 :                                   :                    :                                      +- NativeSortMergeJoin [coalesce(brand_id#73, 0), isnull(brand_id#73), coalesce(class_id#74, 0), isnull(class_id#74), coalesce(category_id#75, 0), isnull(category_id#75)], [coalesce(i_brand_id#76, 0), isnull(i_brand_id#76), coalesce(i_class_id#77, 0), isnull(i_class_id#77), coalesce(i_category_id#78, 0), isnull(i_category_id#78)], LeftSemi
                                 :                                   :                    :                                         :- NativeSort [coalesce(brand_id#73, 0) ASC NULLS FIRST, isnull(brand_id#73) ASC NULLS FIRST, coalesce(class_id#74, 0) ASC NULLS FIRST, isnull(class_id#74) ASC NULLS FIRST, coalesce(category_id#75, 0) ASC NULLS FIRST, isnull(category_id#75) ASC NULLS FIRST], false
                                 :                                   :                    :                                         :  +- InputAdapter
                                 :                                   :                    :                                         :     +- AQEShuffleRead coalesced
                                 :                                   :                    :                                         :        +- ShuffleQueryStage X
                                 :                                   :                    :                                         :           +- NativeShuffleExchange hashpartitioning(coalesce(brand_id#73, 0), isnull(brand_id#73), coalesce(class_id#74, 0), isnull(class_id#74), coalesce(category_id#75, 0), isnull(category_id#75), 100), ENSURE_REQUIREMENTS, [plan_id=20]
                                 :                                   :                    :                                         :              +- NativeProject [brand_id#73, class_id#74, category_id#75]
                                 :                                   :                    :                                         :                 +- NativeHashAggregate HashAgg, List(brand_id#73, class_id#74, category_id#75), [brand_id#73, class_id#74, category_id#75], 3
                                 :                                   :                    :                                         :                    +- InputAdapter
                                 :                                   :                    :                                         :                       +- AQEShuffleRead coalesced
                                 :                                   :                    :                                         :                          +- ShuffleQueryStage X
                                 :                                   :                    :                                         :                             +- NativeShuffleExchange hashpartitioning(brand_id#73, class_id#74, category_id#75, 100), ENSURE_REQUIREMENTS, [plan_id=21]
                                 :                                   :                    :                                         :                                +- NativeHashAggregate HashAgg, [brand_id#73, class_id#74, category_id#75], 0
                                 :                                   :                    :                                         :                                   +- NativeProject [i_brand_id#79 AS brand_id#73, i_class_id#80 AS class_id#74, i_category_id#81 AS category_id#75]
                                 :                                   :                    :                                         :                                      +- NativeSortMergeJoin [ss_sold_date_sk#82], [d_date_sk#83], Inner
                                 :                                   :                    :                                         :                                         :- NativeSort [ss_sold_date_sk#82 ASC NULLS FIRST], false
                                 :                                   :                    :                                         :                                         :  +- InputAdapter
                                 :                                   :                    :                                         :                                         :     +- AQEShuffleRead coalesced
                                 :                                   :                    :                                         :                                         :        +- ShuffleQueryStage X
                                 :                                   :                    :                                         :                                         :           +- NativeShuffleExchange hashpartitioning(ss_sold_date_sk#82, 100), ENSURE_REQUIREMENTS, [plan_id=22]
                                 :                                   :                    :                                         :                                         :              +- NativeProject [ss_sold_date_sk#82, i_brand_id#79, i_class_id#80, i_category_id#81]
                                 :                                   :                    :                                         :                                         :                 +- NativeSortMergeJoin [ss_item_sk#84], [i_item_sk#85], Inner
                                 :                                   :                    :                                         :                                         :                    :- NativeSort [ss_item_sk#84 ASC NULLS FIRST], false
                                 :                                   :                    :                                         :                                         :                    :  +- InputAdapter
                                 :                                   :                    :                                         :                                         :                    :     +- AQEShuffleRead coalesced
                                 :                                   :                    :                                         :                                         :                    :        +- ShuffleQueryStage X
                                 :                                   :                    :                                         :                                         :                    :           +- NativeShuffleExchange hashpartitioning(ss_item_sk#84, 100), ENSURE_REQUIREMENTS, [plan_id=23]
                                 :                                   :                    :                                         :                                         :                    :              +- NativeFilter (isnotnull(ss_item_sk#84) AND isnotnull(ss_sold_date_sk#82))
                                 :                                   :                    :                                         :                                         :                    :                 +- InputAdapter [#82, #84]
                                 :                                   :                    :                                         :                                         :                    :                    +- NativeParquetScan  (FileScan parquet [ss_sold_date_sk#82,ss_item_sk#84] Batched: true, DataFilters: [isnotnull(ss_item_sk#84), isnotnull(ss_sold_date_sk#82)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>)
                                 :                                   :                    :                                         :                                         :                    +- NativeSort [i_item_sk#85 ASC NULLS FIRST], false
                                 :                                   :                    :                                         :                                         :                       +- InputAdapter
                                 :                                   :                    :                                         :                                         :                          +- AQEShuffleRead coalesced
                                 :                                   :                    :                                         :                                         :                             +- ShuffleQueryStage X
                                 :                                   :                    :                                         :                                         :                                +- NativeShuffleExchange hashpartitioning(i_item_sk#85, 100), ENSURE_REQUIREMENTS, [plan_id=24]
                                 :                                   :                    :                                         :                                         :                                   +- NativeSortMergeJoin [coalesce(i_brand_id#79, 0), isnull(i_brand_id#79), coalesce(i_class_id#80, 0), isnull(i_class_id#80), coalesce(i_category_id#81, 0), isnull(i_category_id#81)], [coalesce(i_brand_id#86, 0), isnull(i_brand_id#86), coalesce(i_class_id#87, 0), isnull(i_class_id#87), coalesce(i_category_id#88, 0), isnull(i_category_id#88)], LeftSemi
                                 :                                   :                    :                                         :                                         :                                      :- NativeSort [coalesce(i_brand_id#79, 0) ASC NULLS FIRST, isnull(i_brand_id#79) ASC NULLS FIRST, coalesce(i_class_id#80, 0) ASC NULLS FIRST, isnull(i_class_id#80) ASC NULLS FIRST, coalesce(i_category_id#81, 0) ASC NULLS FIRST, isnull(i_category_id#81) ASC NULLS FIRST], false
                                 :                                   :                    :                                         :                                         :                                      :  +- InputAdapter
                                 :                                   :                    :                                         :                                         :                                      :     +- AQEShuffleRead coalesced
                                 :                                   :                    :                                         :                                         :                                      :        +- ShuffleQueryStage X
                                 :                                   :                    :                                         :                                         :                                      :           +- NativeShuffleExchange hashpartitioning(coalesce(i_brand_id#79, 0), isnull(i_brand_id#79), coalesce(i_class_id#80, 0), isnull(i_class_id#80), coalesce(i_category_id#81, 0), isnull(i_category_id#81), 100), ENSURE_REQUIREMENTS, [plan_id=25]
                                 :                                   :                    :                                         :                                         :                                      :              +- NativeFilter (((isnotnull(i_item_sk#85) AND isnotnull(i_brand_id#79)) AND isnotnull(i_class_id#80)) AND isnotnull(i_category_id#81))
                                 :                                   :                    :                                         :                                         :                                      :                 +- InputAdapter [#85, #79, #80, #81]
                                 :                                   :                    :                                         :                                         :                                      :                    +- NativeParquetScan  (FileScan parquet [i_item_sk#85,i_brand_id#79,i_class_id#80,i_category_id#81] Batched: true, DataFilters: [isnotnull(i_item_sk#85), isnotnull(i_brand_id#79), isnotnull(i_class_id#80), isnotnull(..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>)
                                 :                                   :                    :                                         :                                         :                                      +- NativeSort [coalesce(i_brand_id#86, 0) ASC NULLS FIRST, isnull(i_brand_id#86) ASC NULLS FIRST, coalesce(i_class_id#87, 0) ASC NULLS FIRST, isnull(i_class_id#87) ASC NULLS FIRST, coalesce(i_category_id#88, 0) ASC NULLS FIRST, isnull(i_category_id#88) ASC NULLS FIRST], false
                                 :                                   :                    :                                         :                                         :                                         +- InputAdapter
                                 :                                   :                    :                                         :                                         :                                            +- AQEShuffleRead coalesced
                                 :                                   :                    :                                         :                                         :                                               +- ShuffleQueryStage X
                                 :                                   :                    :                                         :                                         :                                                  +- NativeShuffleExchange hashpartitioning(coalesce(i_brand_id#86, 0), isnull(i_brand_id#86), coalesce(i_class_id#87, 0), isnull(i_class_id#87), coalesce(i_category_id#88, 0), isnull(i_category_id#88), 100), ENSURE_REQUIREMENTS, [plan_id=26]
                                 :                                   :                    :                                         :                                         :                                                     +- NativeProject [i_brand_id#86, i_class_id#87, i_category_id#88]
                                 :                                   :                    :                                         :                                         :                                                        +- NativeSortMergeJoin [cs_sold_date_sk#89], [d_date_sk#36], Inner
                                 :                                   :                    :                                         :                                         :                                                           :- NativeSort [cs_sold_date_sk#89 ASC NULLS FIRST], false
                                 :                                   :                    :                                         :                                         :                                                           :  +- InputAdapter
                                 :                                   :                    :                                         :                                         :                                                           :     +- AQEShuffleRead coalesced
                                 :                                   :                    :                                         :                                         :                                                           :        +- ShuffleQueryStage X
                                 :                                   :                    :                                         :                                         :                                                           :           +- NativeShuffleExchange hashpartitioning(cs_sold_date_sk#89, 100), ENSURE_REQUIREMENTS, [plan_id=27]
                                 :                                   :                    :                                         :                                         :                                                           :              +- NativeProject [cs_sold_date_sk#89, i_brand_id#86, i_class_id#87, i_category_id#88]
                                 :                                   :                    :                                         :                                         :                                                           :                 +- NativeSortMergeJoin [cs_item_sk#90], [i_item_sk#91], Inner
                                 :                                   :                    :                                         :                                         :                                                           :                    :- NativeSort [cs_item_sk#90 ASC NULLS FIRST], false
                                 :                                   :                    :                                         :                                         :                                                           :                    :  +- InputAdapter
                                 :                                   :                    :                                         :                                         :                                                           :                    :     +- AQEShuffleRead coalesced
                                 :                                   :                    :                                         :                                         :                                                           :                    :        +- ShuffleQueryStage X
                                 :                                   :                    :                                         :                                         :                                                           :                    :           +- NativeShuffleExchange hashpartitioning(cs_item_sk#90, 100), ENSURE_REQUIREMENTS, [plan_id=28]
                                 :                                   :                    :                                         :                                         :                                                           :                    :              +- NativeFilter (isnotnull(cs_item_sk#90) AND isnotnull(cs_sold_date_sk#89))
                                 :                                   :                    :                                         :                                         :                                                           :                    :                 +- InputAdapter [#89, #90]
                                 :                                   :                    :                                         :                                         :                                                           :                    :                    +- NativeParquetScan  (FileScan parquet [cs_sold_date_sk#89,cs_item_sk#90] Batched: true, DataFilters: [isnotnull(cs_item_sk#90), isnotnull(cs_sold_date_sk#89)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int>)
                                 :                                   :                    :                                         :                                         :                                                           :                    +- NativeSort [i_item_sk#91 ASC NULLS FIRST], false
                                 :                                   :                    :                                         :                                         :                                                           :                       +- InputAdapter
                                 :                                   :                    :                                         :                                         :                                                           :                          +- AQEShuffleRead coalesced
                                 :                                   :                    :                                         :                                         :                                                           :                             +- ShuffleQueryStage X
                                 :                                   :                    :                                         :                                         :                                                           :                                +- NativeShuffleExchange hashpartitioning(i_item_sk#91, 100), ENSURE_REQUIREMENTS, [plan_id=29]
                                 :                                   :                    :                                         :                                         :                                                           :                                   +- NativeFilter isnotnull(i_item_sk#91)
                                 :                                   :                    :                                         :                                         :                                                           :                                      +- InputAdapter [#91, #86, #87, #88]
                                 :                                   :                    :                                         :                                         :                                                           :                                         +- NativeParquetScan  (FileScan parquet [i_item_sk#91,i_brand_id#86,i_class_id#87,i_category_id#88] Batched: true, DataFilters: [isnotnull(i_item_sk#91)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>)
                                 :                                   :                    :                                         :                                         :                                                           +- NativeSort [d_date_sk#36 ASC NULLS FIRST], false
                                 :                                   :                    :                                         :                                         :                                                              +- InputAdapter
                                 :                                   :                    :                                         :                                         :                                                                 +- AQEShuffleRead coalesced
                                 :                                   :                    :                                         :                                         :                                                                    +- ShuffleQueryStage X
                                 :                                   :                    :                                         :                                         :                                                                       +- NativeShuffleExchange hashpartitioning(d_date_sk#36, 100), ENSURE_REQUIREMENTS, [plan_id=4]
                                 :                                   :                    :                                         :                                         :                                                                          +- NativeProject [d_date_sk#36]
                                 :                                   :                    :                                         :                                         :                                                                             +- NativeFilter (((isnotnull(d_year#92) AND (d_year#92 >= 1999)) AND (d_year#92 <= 2001)) AND isnotnull(d_date_sk#36))
                                 :                                   :                    :                                         :                                         :                                                                                +- InputAdapter [#36, #92]
                                 :                                   :                    :                                         :                                         :                                                                                   +- NativeParquetScan  (FileScan parquet [d_date_sk#36,d_year#92] Batched: true, DataFilters: [isnotnull(d_year#92), (d_year#92 >= 1999), (d_year#92 <= 2001), isnotnull(d_date_sk#93..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>)
                                 :                                   :                    :                                         :                                         +- NativeSort [d_date_sk#83 ASC NULLS FIRST], false
                                 :                                   :                    :                                         :                                            +- InputAdapter
                                 :                                   :                    :                                         :                                               +- InputAdapter [#83]
                                 :                                   :                    :                                         :                                                  +- AQEShuffleRead coalesced
                                 :                                   :                    :                                         :                                                     +- ShuffleQueryStage X
                                 :                                   :                    :                                         :                                                        +- ReusedExchange [d_date_sk#83], NativeShuffleExchange hashpartitioning(d_date_sk#36, 100), ENSURE_REQUIREMENTS, [plan_id=4]
                                 :                                   :                    :                                         +- NativeSort [coalesce(i_brand_id#76, 0) ASC NULLS FIRST, isnull(i_brand_id#76) ASC NULLS FIRST, coalesce(i_class_id#77, 0) ASC NULLS FIRST, isnull(i_class_id#77) ASC NULLS FIRST, coalesce(i_category_id#78, 0) ASC NULLS FIRST, isnull(i_category_id#78) ASC NULLS FIRST], false
                                 :                                   :                    :                                            +- InputAdapter
                                 :                                   :                    :                                               +- AQEShuffleRead coalesced
                                 :                                   :                    :                                                  +- ShuffleQueryStage X
                                 :                                   :                    :                                                     +- NativeShuffleExchange hashpartitioning(coalesce(i_brand_id#76, 0), isnull(i_brand_id#76), coalesce(i_class_id#77, 0), isnull(i_class_id#77), coalesce(i_category_id#78, 0), isnull(i_category_id#78), 100), ENSURE_REQUIREMENTS, [plan_id=30]
                                 :                                   :                    :                                                        +- NativeProject [i_brand_id#76, i_class_id#77, i_category_id#78]
                                 :                                   :                    :                                                           +- NativeSortMergeJoin [ws_sold_date_sk#94], [d_date_sk#95], Inner
                                 :                                   :                    :                                                              :- NativeSort [ws_sold_date_sk#94 ASC NULLS FIRST], false
                                 :                                   :                    :                                                              :  +- InputAdapter
                                 :                                   :                    :                                                              :     +- AQEShuffleRead coalesced
                                 :                                   :                    :                                                              :        +- ShuffleQueryStage X
                                 :                                   :                    :                                                              :           +- NativeShuffleExchange hashpartitioning(ws_sold_date_sk#94, 100), ENSURE_REQUIREMENTS, [plan_id=31]
                                 :                                   :                    :                                                              :              +- NativeProject [ws_sold_date_sk#94, i_brand_id#76, i_class_id#77, i_category_id#78]
                                 :                                   :                    :                                                              :                 +- NativeSortMergeJoin [ws_item_sk#96], [i_item_sk#97], Inner
                                 :                                   :                    :                                                              :                    :- NativeSort [ws_item_sk#96 ASC NULLS FIRST], false
                                 :                                   :                    :                                                              :                    :  +- InputAdapter
                                 :                                   :                    :                                                              :                    :     +- AQEShuffleRead coalesced
                                 :                                   :                    :                                                              :                    :        +- ShuffleQueryStage X
                                 :                                   :                    :                                                              :                    :           +- NativeShuffleExchange hashpartitioning(ws_item_sk#96, 100), ENSURE_REQUIREMENTS, [plan_id=32]
                                 :                                   :                    :                                                              :                    :              +- NativeFilter (isnotnull(ws_item_sk#96) AND isnotnull(ws_sold_date_sk#94))
                                 :                                   :                    :                                                              :                    :                 +- InputAdapter [#94, #96]
                                 :                                   :                    :                                                              :                    :                    +- NativeParquetScan  (FileScan parquet [ws_sold_date_sk#94,ws_item_sk#96] Batched: true, DataFilters: [isnotnull(ws_item_sk#96), isnotnull(ws_sold_date_sk#94)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int>)
                                 :                                   :                    :                                                              :                    +- NativeSort [i_item_sk#97 ASC NULLS FIRST], false
                                 :                                   :                    :                                                              :                       +- InputAdapter
                                 :                                   :                    :                                                              :                          +- InputAdapter [#97, #76, #77, #78]
                                 :                                   :                    :                                                              :                             +- AQEShuffleRead coalesced
                                 :                                   :                    :                                                              :                                +- ShuffleQueryStage X
                                 :                                   :                    :                                                              :                                   +- ReusedExchange [i_item_sk#97, i_brand_id#76, i_class_id#77, i_category_id#78], NativeShuffleExchange hashpartitioning(i_item_sk#91, 100), ENSURE_REQUIREMENTS, [plan_id=29]
                                 :                                   :                    :                                                              +- NativeSort [d_date_sk#95 ASC NULLS FIRST], false
                                 :                                   :                    :                                                                 +- InputAdapter
                                 :                                   :                    :                                                                    +- InputAdapter [#95]
                                 :                                   :                    :                                                                       +- AQEShuffleRead coalesced
                                 :                                   :                    :                                                                          +- ShuffleQueryStage X
                                 :                                   :                    :                                                                             +- ReusedExchange [d_date_sk#95], NativeShuffleExchange hashpartitioning(d_date_sk#36, 100), ENSURE_REQUIREMENTS, [plan_id=4]
                                 :                                   :                    +- NativeSortMergeJoin [i_item_sk#67], [ss_item_sk#68], LeftSemi
                                 :                                   :                       :- NativeSort [i_item_sk#67 ASC NULLS FIRST], false
                                 :                                   :                       :  +- InputAdapter
                                 :                                   :                       :     +- InputAdapter [#67, #20, #21, #22]
                                 :                                   :                       :        +- AQEShuffleRead coalesced
                                 :                                   :                       :           +- ShuffleQueryStage X
                                 :                                   :                       :              +- ReusedExchange [i_item_sk#67, i_brand_id#20, i_class_id#21, i_category_id#22], NativeShuffleExchange hashpartitioning(i_item_sk#91, 100), ENSURE_REQUIREMENTS, [plan_id=29]
                                 :                                   :                       +- NativeSort [ss_item_sk#68 ASC NULLS FIRST], false
                                 :                                   :                          +- InputAdapter
                                 :                                   :                             +- AQEShuffleRead coalesced
                                 :                                   :                                +- ShuffleQueryStage X
                                 :                                   :                                   +- ReusedExchange [ss_item_sk#68], NativeShuffleExchange hashpartitioning(ss_item_sk#68, 100), ENSURE_REQUIREMENTS, [plan_id=17]
                                 :                                   +- NativeSort [d_date_sk#65 ASC NULLS FIRST], false
                                 :                                      +- InputAdapter
                                 :                                         +- AQEShuffleRead coalesced
                                 :                                            +- ShuffleQueryStage X
                                 :                                               +- NativeShuffleExchange hashpartitioning(d_date_sk#65, 100), ENSURE_REQUIREMENTS, [plan_id=33]
                                 :                                                  +- NativeProject [d_date_sk#65]
                                 :                                                     +- NativeFilter ((((isnotnull(d_year#98) AND isnotnull(d_moy#99)) AND (d_year#98 = 2001)) AND (d_moy#99 = 11)) AND isnotnull(d_date_sk#65))
                                 :                                                        +- InputAdapter [#65, #98, #99]
                                 :                                                           +- NativeParquetScan  (FileScan parquet [d_date_sk#65,d_year#98,d_moy#99] Batched: true, DataFilters: [isnotnull(d_year#98), isnotnull(d_moy#99), (d_year#98 = 2001), (d_moy#99 = 11), isno..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), EqualTo(d_year,2001), EqualTo(d_moy,11), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_moy:int>)
                                 :- NativeProject [sales#100, number_sales#101, catalog AS channel#102, i_brand_id#103, i_class_id#104, i_category_id#105]
                                 :  +- NativeFilter (isnotnull(sales#100) AND (cast(sales#100 as decimal(32,6)) > cast(ReusedSubquery Subquery subquery#23, [id=#24] as decimal(32,6))))
                                 :     :  +- ReusedSubquery Subquery subquery#23, [id=#24]
                                 :     +- NativeProject [i_brand_id#103, i_class_id#104, i_category_id#105, sum((cast(cs_quantity#106 as decimal(10,0)) * cs_list_price#107))#108 AS sales#100, count(1)#109 AS number_sales#101]
                                 :        +- NativeHashAggregate HashAgg, ArrayBuffer(i_brand_id#103, i_class_id#104, i_category_id#105), [i_brand_id#103, i_class_id#104, i_category_id#105], [sum((cast(cs_quantity#106 as decimal(10,0)) * cs_list_price#107)), count(1)], [sum((cast(cs_quantity#106 as decimal(10,0)) * cs_list_price#107))#108, count(1)#109], 3
                                 :           +- InputAdapter
                                 :              +- AQEShuffleRead coalesced
                                 :                 +- ShuffleQueryStage X
                                 :                    +- NativeShuffleExchange hashpartitioning(i_brand_id#103, i_class_id#104, i_category_id#105, 100), ENSURE_REQUIREMENTS, [plan_id=34]
                                 :                       +- NativeHashAggregate HashAgg, [i_brand_id#103, i_class_id#104, i_category_id#105], [partial_sum(_c3#110), partial_count(1)], [sum#111, isEmpty#112, count#113], 0
                                 :                          +- NativeProject [i_brand_id#103 AS i_brand_id#103, i_class_id#104 AS i_class_id#104, i_category_id#105 AS i_category_id#105, (cast(cs_quantity#106 as decimal(10,0)) * cs_list_price#107) AS _c3#110]
                                 :                             +- NativeProject [cs_quantity#106, cs_list_price#107, i_brand_id#103, i_class_id#104, i_category_id#105]
                                 :                                +- NativeSortMergeJoin [cs_sold_date_sk#114], [d_date_sk#115], Inner
                                 :                                   :- NativeSort [cs_sold_date_sk#114 ASC NULLS FIRST], false
                                 :                                   :  +- InputAdapter
                                 :                                   :     +- AQEShuffleRead coalesced
                                 :                                   :        +- ShuffleQueryStage X
                                 :                                   :           +- NativeShuffleExchange hashpartitioning(cs_sold_date_sk#114, 100), ENSURE_REQUIREMENTS, [plan_id=35]
                                 :                                   :              +- NativeProject [cs_sold_date_sk#114, cs_quantity#106, cs_list_price#107, i_brand_id#103, i_class_id#104, i_category_id#105]
                                 :                                   :                 +- NativeSortMergeJoin [cs_item_sk#116], [i_item_sk#117], Inner
                                 :                                   :                    :- NativeSortMergeJoin [cs_item_sk#116], [ss_item_sk#118], LeftSemi
                                 :                                   :                    :  :- NativeSort [cs_item_sk#116 ASC NULLS FIRST], false
                                 :                                   :                    :  :  +- InputAdapter
                                 :                                   :                    :  :     +- AQEShuffleRead coalesced
                                 :                                   :                    :  :        +- ShuffleQueryStage X
                                 :                                   :                    :  :           +- NativeShuffleExchange hashpartitioning(cs_item_sk#116, 100), ENSURE_REQUIREMENTS, [plan_id=36]
                                 :                                   :                    :  :              +- NativeFilter (isnotnull(cs_item_sk#116) AND isnotnull(cs_sold_date_sk#114))
                                 :                                   :                    :  :                 +- InputAdapter [#114, #116, #106, #107]
                                 :                                   :                    :  :                    +- NativeParquetScan  (FileScan parquet [cs_sold_date_sk#114,cs_item_sk#116,cs_quantity#106,cs_list_price#107] Batched: true, DataFilters: [isnotnull(cs_item_sk#116), isnotnull(cs_sold_date_sk#114)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>)
                                 :                                   :                    :  +- NativeSort [ss_item_sk#118 ASC NULLS FIRST], false
                                 :                                   :                    :     +- InputAdapter
                                 :                                   :                    :        +- InputAdapter [#118]
                                 :                                   :                    :           +- AQEShuffleRead coalesced
                                 :                                   :                    :              +- ShuffleQueryStage X
                                 :                                   :                    :                 +- ReusedExchange [ss_item_sk#118], NativeShuffleExchange hashpartitioning(ss_item_sk#68, 100), ENSURE_REQUIREMENTS, [plan_id=17]
                                 :                                   :                    +- NativeSortMergeJoin [i_item_sk#117], [ss_item_sk#118], LeftSemi
                                 :                                   :                       :- NativeSort [i_item_sk#117 ASC NULLS FIRST], false
                                 :                                   :                       :  +- InputAdapter
                                 :                                   :                       :     +- InputAdapter [#117, #103, #104, #105]
                                 :                                   :                       :        +- AQEShuffleRead coalesced
                                 :                                   :                       :           +- ShuffleQueryStage X
                                 :                                   :                       :              +- ReusedExchange [i_item_sk#117, i_brand_id#103, i_class_id#104, i_category_id#105], NativeShuffleExchange hashpartitioning(i_item_sk#91, 100), ENSURE_REQUIREMENTS, [plan_id=29]
                                 :                                   :                       +- NativeSort [ss_item_sk#118 ASC NULLS FIRST], false
                                 :                                   :                          +- InputAdapter
                                 :                                   :                             +- InputAdapter [#118]
                                 :                                   :                                +- AQEShuffleRead coalesced
                                 :                                   :                                   +- ShuffleQueryStage X
                                 :                                   :                                      +- ReusedExchange [ss_item_sk#118], NativeShuffleExchange hashpartitioning(ss_item_sk#68, 100), ENSURE_REQUIREMENTS, [plan_id=17]
                                 :                                   +- NativeSort [d_date_sk#115 ASC NULLS FIRST], false
                                 :                                      +- InputAdapter
                                 :                                         +- InputAdapter [#115]
                                 :                                            +- AQEShuffleRead coalesced
                                 :                                               +- ShuffleQueryStage X
                                 :                                                  +- ReusedExchange [d_date_sk#115], NativeShuffleExchange hashpartitioning(d_date_sk#65, 100), ENSURE_REQUIREMENTS, [plan_id=33]
                                 +- NativeProject [sales#119, number_sales#120, web AS channel#121, i_brand_id#122, i_class_id#123, i_category_id#124]
                                    +- NativeFilter (isnotnull(sales#119) AND (cast(sales#119 as decimal(32,6)) > cast(ReusedSubquery Subquery subquery#23, [id=#24] as decimal(32,6))))
                                       :  +- ReusedSubquery Subquery subquery#23, [id=#24]
                                       +- NativeProject [i_brand_id#122, i_class_id#123, i_category_id#124, sum((cast(ws_quantity#125 as decimal(10,0)) * ws_list_price#126))#127 AS sales#119, count(1)#128 AS number_sales#120]
                                          +- NativeHashAggregate HashAgg, ArrayBuffer(i_brand_id#122, i_class_id#123, i_category_id#124), [i_brand_id#122, i_class_id#123, i_category_id#124], [sum((cast(ws_quantity#125 as decimal(10,0)) * ws_list_price#126)), count(1)], [sum((cast(ws_quantity#125 as decimal(10,0)) * ws_list_price#126))#127, count(1)#128], 3
                                             +- InputAdapter
                                                +- AQEShuffleRead coalesced
                                                   +- ShuffleQueryStage X
                                                      +- NativeShuffleExchange hashpartitioning(i_brand_id#122, i_class_id#123, i_category_id#124, 100), ENSURE_REQUIREMENTS, [plan_id=37]
                                                         +- NativeHashAggregate HashAgg, [i_brand_id#122, i_class_id#123, i_category_id#124], [partial_sum(_c3#129), partial_count(1)], [sum#130, isEmpty#131, count#132], 0
                                                            +- NativeProject [i_brand_id#122 AS i_brand_id#122, i_class_id#123 AS i_class_id#123, i_category_id#124 AS i_category_id#124, (cast(ws_quantity#125 as decimal(10,0)) * ws_list_price#126) AS _c3#129]
                                                               +- NativeProject [ws_quantity#125, ws_list_price#126, i_brand_id#122, i_class_id#123, i_category_id#124]
                                                                  +- NativeSortMergeJoin [ws_sold_date_sk#133], [d_date_sk#134], Inner
                                                                     :- NativeSort [ws_sold_date_sk#133 ASC NULLS FIRST], false
                                                                     :  +- InputAdapter
                                                                     :     +- AQEShuffleRead coalesced
                                                                     :        +- ShuffleQueryStage X
                                                                     :           +- NativeShuffleExchange hashpartitioning(ws_sold_date_sk#133, 100), ENSURE_REQUIREMENTS, [plan_id=38]
                                                                     :              +- NativeProject [ws_sold_date_sk#133, ws_quantity#125, ws_list_price#126, i_brand_id#122, i_class_id#123, i_category_id#124]
                                                                     :                 +- NativeSortMergeJoin [ws_item_sk#135], [i_item_sk#136], Inner
                                                                     :                    :- NativeSortMergeJoin [ws_item_sk#135], [ss_item_sk#137], LeftSemi
                                                                     :                    :  :- NativeSort [ws_item_sk#135 ASC NULLS FIRST], false
                                                                     :                    :  :  +- InputAdapter
                                                                     :                    :  :     +- AQEShuffleRead coalesced
                                                                     :                    :  :        +- ShuffleQueryStage X
                                                                     :                    :  :           +- NativeShuffleExchange hashpartitioning(ws_item_sk#135, 100), ENSURE_REQUIREMENTS, [plan_id=39]
                                                                     :                    :  :              +- NativeFilter (isnotnull(ws_item_sk#135) AND isnotnull(ws_sold_date_sk#133))
                                                                     :                    :  :                 +- InputAdapter [#133, #135, #125, #126]
                                                                     :                    :  :                    +- NativeParquetScan  (FileScan parquet [ws_sold_date_sk#133,ws_item_sk#135,ws_quantity#125,ws_list_price#126] Batched: true, DataFilters: [isnotnull(ws_item_sk#135), isnotnull(ws_sold_date_sk#133)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>)
                                                                     :                    :  +- NativeSort [ss_item_sk#137 ASC NULLS FIRST], false
                                                                     :                    :     +- InputAdapter
                                                                     :                    :        +- InputAdapter [#137]
                                                                     :                    :           +- AQEShuffleRead coalesced
                                                                     :                    :              +- ShuffleQueryStage X
                                                                     :                    :                 +- ReusedExchange [ss_item_sk#137], NativeShuffleExchange hashpartitioning(ss_item_sk#68, 100), ENSURE_REQUIREMENTS, [plan_id=17]
                                                                     :                    +- NativeSortMergeJoin [i_item_sk#136], [ss_item_sk#137], LeftSemi
                                                                     :                       :- NativeSort [i_item_sk#136 ASC NULLS FIRST], false
                                                                     :                       :  +- InputAdapter
                                                                     :                       :     +- InputAdapter [#136, #122, #123, #124]
                                                                     :                       :        +- AQEShuffleRead coalesced
                                                                     :                       :           +- ShuffleQueryStage X
                                                                     :                       :              +- ReusedExchange [i_item_sk#136, i_brand_id#122, i_class_id#123, i_category_id#124], NativeShuffleExchange hashpartitioning(i_item_sk#91, 100), ENSURE_REQUIREMENTS, [plan_id=29]
                                                                     :                       +- NativeSort [ss_item_sk#137 ASC NULLS FIRST], false
                                                                     :                          +- InputAdapter
                                                                     :                             +- InputAdapter [#137]
                                                                     :                                +- AQEShuffleRead coalesced
                                                                     :                                   +- ShuffleQueryStage X
                                                                     :                                      +- ReusedExchange [ss_item_sk#137], NativeShuffleExchange hashpartitioning(ss_item_sk#68, 100), ENSURE_REQUIREMENTS, [plan_id=17]
                                                                     +- NativeSort [d_date_sk#134 ASC NULLS FIRST], false
                                                                        +- InputAdapter
                                                                           +- InputAdapter [#134]
                                                                              +- AQEShuffleRead coalesced
                                                                                 +- ShuffleQueryStage X
                                                                                    +- ReusedExchange [d_date_sk#134], NativeShuffleExchange hashpartitioning(d_date_sk#65, 100), ENSURE_REQUIREMENTS, [plan_id=33]
+- == Initial Plan ==
   TakeOrderedAndProject(limit=100, orderBy=[channel#1 ASC NULLS FIRST,i_brand_id#2 ASC NULLS FIRST,i_class_id#3 ASC NULLS FIRST,i_category_id#4 ASC NULLS FIRST], output=[channel#1,i_brand_id#2,i_class_id#3,i_category_id#4,sum(sales)#7,sum(number_sales)#10])
   +- HashAggregate(keys=[channel#1, i_brand_id#2, i_class_id#3, i_category_id#4, spark_grouping_id#11], functions=[sum(sales#5), sum(number_sales#8)], output=[channel#1, i_brand_id#2, i_class_id#3, i_category_id#4, sum(sales)#7, sum(number_sales)#10])
      +- Exchange hashpartitioning(channel#1, i_brand_id#2, i_class_id#3, i_category_id#4, spark_grouping_id#11, 100), ENSURE_REQUIREMENTS, [plan_id=40]
         +- HashAggregate(keys=[channel#1, i_brand_id#2, i_class_id#3, i_category_id#4, spark_grouping_id#11], functions=[partial_sum(sales#5), partial_sum(number_sales#8)], output=[channel#1, i_brand_id#2, i_class_id#3, i_category_id#4, spark_grouping_id#11, sum#138, isEmpty#139, sum#140])
            +- Expand [[sales#5, number_sales#8, channel#15, i_brand_id#16, i_class_id#17, i_category_id#18, 0], [sales#5, number_sales#8, channel#15, i_brand_id#16, i_class_id#17, null, 1], [sales#5, number_sales#8, channel#15, i_brand_id#16, null, null, 3], [sales#5, number_sales#8, channel#15, null, null, null, 7], [sales#5, number_sales#8, null, null, null, null, 15]], [sales#5, number_sales#8, channel#1, i_brand_id#2, i_class_id#3, i_category_id#4, spark_grouping_id#11]
               +- Union
                  :- Project [sales#5, number_sales#8, store AS channel#15, i_brand_id#20 AS i_brand_id#16, i_class_id#21 AS i_class_id#17, i_category_id#22 AS i_category_id#18]
                  :  +- Filter (isnotnull(sales#5) AND (cast(sales#5 as decimal(32,6)) > cast(Subquery subquery#23, [id=#24] as decimal(32,6))))
                  :     :  +- Subquery subquery#23, [id=#24]
                  :     :     +- AdaptiveSparkPlan isFinalPlan=true
                              +- == Final Plan ==
                                 NativeProject [avg((cast(quantity#25 as decimal(10,0)) * list_price#26))#27 AS average_sales#28]
                                 +- NativeHashAggregate HashAgg, List(), [avg((cast(quantity#25 as decimal(10,0)) * list_price#26))], [avg((cast(quantity#25 as decimal(10,0)) * list_price#26))#27], 0
                                    +- ShuffleQueryStage X
                                       +- NativeShuffleExchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=2]
                                          +- NativeHashAggregate HashAgg, [partial_avg(_c0#29)], [sum#30, count#31], 0
                                             +- NativeProject [(cast(quantity#25 as decimal(10,0)) * list_price#26) AS _c0#29]
                                                +- InputAdapter [#25, #26]
                                                   +- NativeUnion [quantity#25, list_price#26]
                                                      :- NativeProject [ss_quantity#32 AS quantity#25, ss_list_price#33 AS list_price#26]
                                                      :  +- NativeSortMergeJoin [ss_sold_date_sk#34], [d_date_sk#35], Inner
                                                      :     :- NativeSort [ss_sold_date_sk#34 ASC NULLS FIRST], false
                                                      :     :  +- InputAdapter
                                                      :     :     +- AQEShuffleRead coalesced
                                                      :     :        +- ShuffleQueryStage X
                                                      :     :           +- NativeShuffleExchange hashpartitioning(ss_sold_date_sk#34, 100), ENSURE_REQUIREMENTS, [plan_id=3]
                                                      :     :              +- NativeFilter isnotnull(ss_sold_date_sk#34)
                                                      :     :                 +- InputAdapter [#34, #32, #33]
                                                      :     :                    +- NativeParquetScan  (FileScan parquet [ss_sold_date_sk#34,ss_quantity#32,ss_list_price#33] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#34)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>)
                                                      :     +- NativeSort [d_date_sk#35 ASC NULLS FIRST], false
                                                      :        +- InputAdapter
                                                      :           +- InputAdapter [#35]
                                                      :              +- AQEShuffleRead coalesced
                                                      :                 +- ShuffleQueryStage X
                                                      :                    +- ReusedExchange [d_date_sk#35], NativeShuffleExchange hashpartitioning(d_date_sk#36, 100), ENSURE_REQUIREMENTS, [plan_id=4]
                                                      :- NativeProject [cs_quantity#37 AS quantity#38, cs_list_price#39 AS list_price#40]
                                                      :  +- NativeSortMergeJoin [cs_sold_date_sk#41], [d_date_sk#42], Inner
                                                      :     :- NativeSort [cs_sold_date_sk#41 ASC NULLS FIRST], false
                                                      :     :  +- InputAdapter
                                                      :     :     +- AQEShuffleRead coalesced
                                                      :     :        +- ShuffleQueryStage X
                                                      :     :           +- NativeShuffleExchange hashpartitioning(cs_sold_date_sk#41, 100), ENSURE_REQUIREMENTS, [plan_id=5]
                                                      :     :              +- NativeFilter isnotnull(cs_sold_date_sk#41)
                                                      :     :                 +- InputAdapter [#41, #37, #39]
                                                      :     :                    +- NativeParquetScan  (FileScan parquet [cs_sold_date_sk#41,cs_quantity#37,cs_list_price#39] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#41)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>)
                                                      :     +- NativeSort [d_date_sk#42 ASC NULLS FIRST], false
                                                      :        +- InputAdapter
                                                      :           +- InputAdapter [#42]
                                                      :              +- AQEShuffleRead coalesced
                                                      :                 +- ShuffleQueryStage X
                                                      :                    +- ReusedExchange [d_date_sk#42], NativeShuffleExchange hashpartitioning(d_date_sk#36, 100), ENSURE_REQUIREMENTS, [plan_id=4]
                                                      +- NativeProject [ws_quantity#43 AS quantity#44, ws_list_price#45 AS list_price#46]
                                                         +- NativeSortMergeJoin [ws_sold_date_sk#47], [d_date_sk#48], Inner
                                                            :- NativeSort [ws_sold_date_sk#47 ASC NULLS FIRST], false
                                                            :  +- InputAdapter
                                                            :     +- AQEShuffleRead coalesced
                                                            :        +- ShuffleQueryStage X
                                                            :           +- NativeShuffleExchange hashpartitioning(ws_sold_date_sk#47, 100), ENSURE_REQUIREMENTS, [plan_id=6]
                                                            :              +- NativeFilter isnotnull(ws_sold_date_sk#47)
                                                            :                 +- InputAdapter [#47, #43, #45]
                                                            :                    +- NativeParquetScan  (FileScan parquet [ws_sold_date_sk#47,ws_quantity#43,ws_list_price#45] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#47)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>)
                                                            +- NativeSort [d_date_sk#48 ASC NULLS FIRST], false
                                                               +- InputAdapter
                                                                  +- InputAdapter [#48]
                                                                     +- AQEShuffleRead coalesced
                                                                        +- ShuffleQueryStage X
                                                                           +- ReusedExchange [d_date_sk#48], NativeShuffleExchange hashpartitioning(d_date_sk#36, 100), ENSURE_REQUIREMENTS, [plan_id=4]
                              +- == Initial Plan ==
                                 HashAggregate(keys=[], functions=[avg((cast(quantity#25 as decimal(10,0)) * list_price#26))], output=[average_sales#28])
                                 +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=7]
                                    +- HashAggregate(keys=[], functions=[partial_avg((cast(quantity#25 as decimal(10,0)) * list_price#26))], output=[sum#49, count#50])
                                       +- Union
                                          :- Project [ss_quantity#32 AS quantity#25, ss_list_price#33 AS list_price#26]
                                          :  +- SortMergeJoin [ss_sold_date_sk#34], [d_date_sk#35], Inner
                                          :     :- Sort [ss_sold_date_sk#34 ASC NULLS FIRST], false, 0
                                          :     :  +- Exchange hashpartitioning(ss_sold_date_sk#34, 100), ENSURE_REQUIREMENTS, [plan_id=8]
                                          :     :     +- Filter isnotnull(ss_sold_date_sk#34)
                                          :     :        +- FileScan parquet [ss_sold_date_sk#34,ss_quantity#32,ss_list_price#33] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#34)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
                                          :     +- Sort [d_date_sk#35 ASC NULLS FIRST], false, 0
                                          :        +- Exchange hashpartitioning(d_date_sk#35, 100), ENSURE_REQUIREMENTS, [plan_id=9]
                                          :           +- Project [d_date_sk#35]
                                          :              +- Filter (((isnotnull(d_year#51) AND (d_year#51 >= 1999)) AND (d_year#51 <= 2001)) AND isnotnull(d_date_sk#35))
                                          :                 +- FileScan parquet [d_date_sk#35,d_year#51] Batched: true, DataFilters: [isnotnull(d_year#51), (d_year#51 >= 1999), (d_year#51 <= 2001), isnotnull(d_date_sk#52..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                          :- Project [cs_quantity#37 AS quantity#38, cs_list_price#39 AS list_price#40]
                                          :  +- SortMergeJoin [cs_sold_date_sk#41], [d_date_sk#42], Inner
                                          :     :- Sort [cs_sold_date_sk#41 ASC NULLS FIRST], false, 0
                                          :     :  +- Exchange hashpartitioning(cs_sold_date_sk#41, 100), ENSURE_REQUIREMENTS, [plan_id=10]
                                          :     :     +- Filter isnotnull(cs_sold_date_sk#41)
                                          :     :        +- FileScan parquet [cs_sold_date_sk#41,cs_quantity#37,cs_list_price#39] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#41)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>
                                          :     +- Sort [d_date_sk#42 ASC NULLS FIRST], false, 0
                                          :        +- Exchange hashpartitioning(d_date_sk#42, 100), ENSURE_REQUIREMENTS, [plan_id=11]
                                          :           +- Project [d_date_sk#42]
                                          :              +- Filter (((isnotnull(d_year#53) AND (d_year#53 >= 1999)) AND (d_year#53 <= 2001)) AND isnotnull(d_date_sk#42))
                                          :                 +- FileScan parquet [d_date_sk#42,d_year#53] Batched: true, DataFilters: [isnotnull(d_year#53), (d_year#53 >= 1999), (d_year#53 <= 2001), isnotnull(d_date_sk#52..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                          +- Project [ws_quantity#43 AS quantity#44, ws_list_price#45 AS list_price#46]
                                             +- SortMergeJoin [ws_sold_date_sk#47], [d_date_sk#48], Inner
                                                :- Sort [ws_sold_date_sk#47 ASC NULLS FIRST], false, 0
                                                :  +- Exchange hashpartitioning(ws_sold_date_sk#47, 100), ENSURE_REQUIREMENTS, [plan_id=12]
                                                :     +- Filter isnotnull(ws_sold_date_sk#47)
                                                :        +- FileScan parquet [ws_sold_date_sk#47,ws_quantity#43,ws_list_price#45] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#47)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
                                                +- Sort [d_date_sk#48 ASC NULLS FIRST], false, 0
                                                   +- Exchange hashpartitioning(d_date_sk#48, 100), ENSURE_REQUIREMENTS, [plan_id=13]
                                                      +- Project [d_date_sk#48]
                                                         +- Filter (((isnotnull(d_year#54) AND (d_year#54 >= 1999)) AND (d_year#54 <= 2001)) AND isnotnull(d_date_sk#48))
                                                            +- FileScan parquet [d_date_sk#48,d_year#54] Batched: true, DataFilters: [isnotnull(d_year#54), (d_year#54 >= 1999), (d_year#54 <= 2001), isnotnull(d_date_sk#55..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :     +- HashAggregate(keys=[i_brand_id#20, i_class_id#21, i_category_id#22], functions=[sum((cast(ss_quantity#56 as decimal(10,0)) * ss_list_price#57)), count(1)], output=[i_brand_id#20, i_class_id#21, i_category_id#22, sales#5, number_sales#8])
                  :        +- Exchange hashpartitioning(i_brand_id#20, i_class_id#21, i_category_id#22, 100), ENSURE_REQUIREMENTS, [plan_id=41]
                  :           +- HashAggregate(keys=[i_brand_id#20, i_class_id#21, i_category_id#22], functions=[partial_sum((cast(ss_quantity#56 as decimal(10,0)) * ss_list_price#57)), partial_count(1)], output=[i_brand_id#20, i_class_id#21, i_category_id#22, sum#141, isEmpty#142, count#143])
                  :              +- Project [ss_quantity#56, ss_list_price#57, i_brand_id#20, i_class_id#21, i_category_id#22]
                  :                 +- SortMergeJoin [ss_sold_date_sk#64], [d_date_sk#65], Inner
                  :                    :- Sort [ss_sold_date_sk#64 ASC NULLS FIRST], false, 0
                  :                    :  +- Exchange hashpartitioning(ss_sold_date_sk#64, 100), ENSURE_REQUIREMENTS, [plan_id=42]
                  :                    :     +- Project [ss_sold_date_sk#64, ss_quantity#56, ss_list_price#57, i_brand_id#20, i_class_id#21, i_category_id#22]
                  :                    :        +- SortMergeJoin [ss_item_sk#66], [i_item_sk#67], Inner
                  :                    :           :- SortMergeJoin [ss_item_sk#66], [ss_item_sk#68], LeftSemi
                  :                    :           :  :- Sort [ss_item_sk#66 ASC NULLS FIRST], false, 0
                  :                    :           :  :  +- Exchange hashpartitioning(ss_item_sk#66, 100), ENSURE_REQUIREMENTS, [plan_id=43]
                  :                    :           :  :     +- Filter (isnotnull(ss_item_sk#66) AND isnotnull(ss_sold_date_sk#64))
                  :                    :           :  :        +- FileScan parquet [ss_sold_date_sk#64,ss_item_sk#66,ss_quantity#56,ss_list_price#57] Batched: true, DataFilters: [isnotnull(ss_item_sk#66), isnotnull(ss_sold_date_sk#64)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
                  :                    :           :  +- Sort [ss_item_sk#68 ASC NULLS FIRST], false, 0
                  :                    :           :     +- Exchange hashpartitioning(ss_item_sk#68, 100), ENSURE_REQUIREMENTS, [plan_id=44]
                  :                    :           :        +- Project [i_item_sk#69 AS ss_item_sk#68]
                  :                    :           :           +- SortMergeJoin [i_brand_id#70, i_class_id#71, i_category_id#72], [brand_id#73, class_id#74, category_id#75], Inner
                  :                    :           :              :- Sort [i_brand_id#70 ASC NULLS FIRST, i_class_id#71 ASC NULLS FIRST, i_category_id#72 ASC NULLS FIRST], false, 0
                  :                    :           :              :  +- Exchange hashpartitioning(i_brand_id#70, i_class_id#71, i_category_id#72, 100), ENSURE_REQUIREMENTS, [plan_id=45]
                  :                    :           :              :     +- Filter ((isnotnull(i_brand_id#70) AND isnotnull(i_class_id#71)) AND isnotnull(i_category_id#72))
                  :                    :           :              :        +- FileScan parquet [i_item_sk#69,i_brand_id#70,i_class_id#71,i_category_id#72] Batched: true, DataFilters: [isnotnull(i_brand_id#70), isnotnull(i_class_id#71), isnotnull(i_category_id#72)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :           :              +- Sort [brand_id#73 ASC NULLS FIRST, class_id#74 ASC NULLS FIRST, category_id#75 ASC NULLS FIRST], false, 0
                  :                    :           :                 +- Exchange hashpartitioning(brand_id#73, class_id#74, category_id#75, 100), ENSURE_REQUIREMENTS, [plan_id=46]
                  :                    :           :                    +- SortMergeJoin [coalesce(brand_id#73, 0), isnull(brand_id#73), coalesce(class_id#74, 0), isnull(class_id#74), coalesce(category_id#75, 0), isnull(category_id#75)], [coalesce(i_brand_id#76, 0), isnull(i_brand_id#76), coalesce(i_class_id#77, 0), isnull(i_class_id#77), coalesce(i_category_id#78, 0), isnull(i_category_id#78)], LeftSemi
                  :                    :           :                       :- Sort [coalesce(brand_id#73, 0) ASC NULLS FIRST, isnull(brand_id#73) ASC NULLS FIRST, coalesce(class_id#74, 0) ASC NULLS FIRST, isnull(class_id#74) ASC NULLS FIRST, coalesce(category_id#75, 0) ASC NULLS FIRST, isnull(category_id#75) ASC NULLS FIRST], false, 0
                  :                    :           :                       :  +- Exchange hashpartitioning(coalesce(brand_id#73, 0), isnull(brand_id#73), coalesce(class_id#74, 0), isnull(class_id#74), coalesce(category_id#75, 0), isnull(category_id#75), 100), ENSURE_REQUIREMENTS, [plan_id=47]
                  :                    :           :                       :     +- HashAggregate(keys=[brand_id#73, class_id#74, category_id#75], functions=[], output=[brand_id#73, class_id#74, category_id#75])
                  :                    :           :                       :        +- Exchange hashpartitioning(brand_id#73, class_id#74, category_id#75, 100), ENSURE_REQUIREMENTS, [plan_id=48]
                  :                    :           :                       :           +- HashAggregate(keys=[brand_id#73, class_id#74, category_id#75], functions=[], output=[brand_id#73, class_id#74, category_id#75])
                  :                    :           :                       :              +- Project [i_brand_id#79 AS brand_id#73, i_class_id#80 AS class_id#74, i_category_id#81 AS category_id#75]
                  :                    :           :                       :                 +- SortMergeJoin [ss_sold_date_sk#82], [d_date_sk#83], Inner
                  :                    :           :                       :                    :- Sort [ss_sold_date_sk#82 ASC NULLS FIRST], false, 0
                  :                    :           :                       :                    :  +- Exchange hashpartitioning(ss_sold_date_sk#82, 100), ENSURE_REQUIREMENTS, [plan_id=49]
                  :                    :           :                       :                    :     +- Project [ss_sold_date_sk#82, i_brand_id#79, i_class_id#80, i_category_id#81]
                  :                    :           :                       :                    :        +- SortMergeJoin [ss_item_sk#84], [i_item_sk#85], Inner
                  :                    :           :                       :                    :           :- Sort [ss_item_sk#84 ASC NULLS FIRST], false, 0
                  :                    :           :                       :                    :           :  +- Exchange hashpartitioning(ss_item_sk#84, 100), ENSURE_REQUIREMENTS, [plan_id=50]
                  :                    :           :                       :                    :           :     +- Filter (isnotnull(ss_item_sk#84) AND isnotnull(ss_sold_date_sk#82))
                  :                    :           :                       :                    :           :        +- FileScan parquet [ss_sold_date_sk#82,ss_item_sk#84] Batched: true, DataFilters: [isnotnull(ss_item_sk#84), isnotnull(ss_sold_date_sk#82)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
                  :                    :           :                       :                    :           +- Sort [i_item_sk#85 ASC NULLS FIRST], false, 0
                  :                    :           :                       :                    :              +- Exchange hashpartitioning(i_item_sk#85, 100), ENSURE_REQUIREMENTS, [plan_id=51]
                  :                    :           :                       :                    :                 +- SortMergeJoin [coalesce(i_brand_id#79, 0), isnull(i_brand_id#79), coalesce(i_class_id#80, 0), isnull(i_class_id#80), coalesce(i_category_id#81, 0), isnull(i_category_id#81)], [coalesce(i_brand_id#86, 0), isnull(i_brand_id#86), coalesce(i_class_id#87, 0), isnull(i_class_id#87), coalesce(i_category_id#88, 0), isnull(i_category_id#88)], LeftSemi
                  :                    :           :                       :                    :                    :- Sort [coalesce(i_brand_id#79, 0) ASC NULLS FIRST, isnull(i_brand_id#79) ASC NULLS FIRST, coalesce(i_class_id#80, 0) ASC NULLS FIRST, isnull(i_class_id#80) ASC NULLS FIRST, coalesce(i_category_id#81, 0) ASC NULLS FIRST, isnull(i_category_id#81) ASC NULLS FIRST], false, 0
                  :                    :           :                       :                    :                    :  +- Exchange hashpartitioning(coalesce(i_brand_id#79, 0), isnull(i_brand_id#79), coalesce(i_class_id#80, 0), isnull(i_class_id#80), coalesce(i_category_id#81, 0), isnull(i_category_id#81), 100), ENSURE_REQUIREMENTS, [plan_id=52]
                  :                    :           :                       :                    :                    :     +- Filter (((isnotnull(i_item_sk#85) AND isnotnull(i_brand_id#79)) AND isnotnull(i_class_id#80)) AND isnotnull(i_category_id#81))
                  :                    :           :                       :                    :                    :        +- FileScan parquet [i_item_sk#85,i_brand_id#79,i_class_id#80,i_category_id#81] Batched: true, DataFilters: [isnotnull(i_item_sk#85), isnotnull(i_brand_id#79), isnotnull(i_class_id#80), isnotnull(..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :           :                       :                    :                    +- Sort [coalesce(i_brand_id#86, 0) ASC NULLS FIRST, isnull(i_brand_id#86) ASC NULLS FIRST, coalesce(i_class_id#87, 0) ASC NULLS FIRST, isnull(i_class_id#87) ASC NULLS FIRST, coalesce(i_category_id#88, 0) ASC NULLS FIRST, isnull(i_category_id#88) ASC NULLS FIRST], false, 0
                  :                    :           :                       :                    :                       +- Exchange hashpartitioning(coalesce(i_brand_id#86, 0), isnull(i_brand_id#86), coalesce(i_class_id#87, 0), isnull(i_class_id#87), coalesce(i_category_id#88, 0), isnull(i_category_id#88), 100), ENSURE_REQUIREMENTS, [plan_id=53]
                  :                    :           :                       :                    :                          +- Project [i_brand_id#86, i_class_id#87, i_category_id#88]
                  :                    :           :                       :                    :                             +- SortMergeJoin [cs_sold_date_sk#89], [d_date_sk#36], Inner
                  :                    :           :                       :                    :                                :- Sort [cs_sold_date_sk#89 ASC NULLS FIRST], false, 0
                  :                    :           :                       :                    :                                :  +- Exchange hashpartitioning(cs_sold_date_sk#89, 100), ENSURE_REQUIREMENTS, [plan_id=54]
                  :                    :           :                       :                    :                                :     +- Project [cs_sold_date_sk#89, i_brand_id#86, i_class_id#87, i_category_id#88]
                  :                    :           :                       :                    :                                :        +- SortMergeJoin [cs_item_sk#90], [i_item_sk#91], Inner
                  :                    :           :                       :                    :                                :           :- Sort [cs_item_sk#90 ASC NULLS FIRST], false, 0
                  :                    :           :                       :                    :                                :           :  +- Exchange hashpartitioning(cs_item_sk#90, 100), ENSURE_REQUIREMENTS, [plan_id=55]
                  :                    :           :                       :                    :                                :           :     +- Filter (isnotnull(cs_item_sk#90) AND isnotnull(cs_sold_date_sk#89))
                  :                    :           :                       :                    :                                :           :        +- FileScan parquet [cs_sold_date_sk#89,cs_item_sk#90] Batched: true, DataFilters: [isnotnull(cs_item_sk#90), isnotnull(cs_sold_date_sk#89)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int>
                  :                    :           :                       :                    :                                :           +- Sort [i_item_sk#91 ASC NULLS FIRST], false, 0
                  :                    :           :                       :                    :                                :              +- Exchange hashpartitioning(i_item_sk#91, 100), ENSURE_REQUIREMENTS, [plan_id=56]
                  :                    :           :                       :                    :                                :                 +- Filter isnotnull(i_item_sk#91)
                  :                    :           :                       :                    :                                :                    +- FileScan parquet [i_item_sk#91,i_brand_id#86,i_class_id#87,i_category_id#88] Batched: true, DataFilters: [isnotnull(i_item_sk#91)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :           :                       :                    :                                +- Sort [d_date_sk#36 ASC NULLS FIRST], false, 0
                  :                    :           :                       :                    :                                   +- Exchange hashpartitioning(d_date_sk#36, 100), ENSURE_REQUIREMENTS, [plan_id=57]
                  :                    :           :                       :                    :                                      +- Project [d_date_sk#36]
                  :                    :           :                       :                    :                                         +- Filter (((isnotnull(d_year#92) AND (d_year#92 >= 1999)) AND (d_year#92 <= 2001)) AND isnotnull(d_date_sk#36))
                  :                    :           :                       :                    :                                            +- FileScan parquet [d_date_sk#36,d_year#92] Batched: true, DataFilters: [isnotnull(d_year#92), (d_year#92 >= 1999), (d_year#92 <= 2001), isnotnull(d_date_sk#93..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :                    :           :                       :                    +- Sort [d_date_sk#83 ASC NULLS FIRST], false, 0
                  :                    :           :                       :                       +- Exchange hashpartitioning(d_date_sk#83, 100), ENSURE_REQUIREMENTS, [plan_id=58]
                  :                    :           :                       :                          +- Project [d_date_sk#83]
                  :                    :           :                       :                             +- Filter (((isnotnull(d_year#144) AND (d_year#144 >= 1999)) AND (d_year#144 <= 2001)) AND isnotnull(d_date_sk#83))
                  :                    :           :                       :                                +- FileScan parquet [d_date_sk#83,d_year#144] Batched: true, DataFilters: [isnotnull(d_year#144), (d_year#144 >= 1999), (d_year#144 <= 2001), isnotnull(d_date_sk#83)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :                    :           :                       +- Sort [coalesce(i_brand_id#76, 0) ASC NULLS FIRST, isnull(i_brand_id#76) ASC NULLS FIRST, coalesce(i_class_id#77, 0) ASC NULLS FIRST, isnull(i_class_id#77) ASC NULLS FIRST, coalesce(i_category_id#78, 0) ASC NULLS FIRST, isnull(i_category_id#78) ASC NULLS FIRST], false, 0
                  :                    :           :                          +- Exchange hashpartitioning(coalesce(i_brand_id#76, 0), isnull(i_brand_id#76), coalesce(i_class_id#77, 0), isnull(i_class_id#77), coalesce(i_category_id#78, 0), isnull(i_category_id#78), 100), ENSURE_REQUIREMENTS, [plan_id=59]
                  :                    :           :                             +- Project [i_brand_id#76, i_class_id#77, i_category_id#78]
                  :                    :           :                                +- SortMergeJoin [ws_sold_date_sk#94], [d_date_sk#95], Inner
                  :                    :           :                                   :- Sort [ws_sold_date_sk#94 ASC NULLS FIRST], false, 0
                  :                    :           :                                   :  +- Exchange hashpartitioning(ws_sold_date_sk#94, 100), ENSURE_REQUIREMENTS, [plan_id=60]
                  :                    :           :                                   :     +- Project [ws_sold_date_sk#94, i_brand_id#76, i_class_id#77, i_category_id#78]
                  :                    :           :                                   :        +- SortMergeJoin [ws_item_sk#96], [i_item_sk#97], Inner
                  :                    :           :                                   :           :- Sort [ws_item_sk#96 ASC NULLS FIRST], false, 0
                  :                    :           :                                   :           :  +- Exchange hashpartitioning(ws_item_sk#96, 100), ENSURE_REQUIREMENTS, [plan_id=61]
                  :                    :           :                                   :           :     +- Filter (isnotnull(ws_item_sk#96) AND isnotnull(ws_sold_date_sk#94))
                  :                    :           :                                   :           :        +- FileScan parquet [ws_sold_date_sk#94,ws_item_sk#96] Batched: true, DataFilters: [isnotnull(ws_item_sk#96), isnotnull(ws_sold_date_sk#94)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int>
                  :                    :           :                                   :           +- Sort [i_item_sk#97 ASC NULLS FIRST], false, 0
                  :                    :           :                                   :              +- Exchange hashpartitioning(i_item_sk#97, 100), ENSURE_REQUIREMENTS, [plan_id=62]
                  :                    :           :                                   :                 +- Filter isnotnull(i_item_sk#97)
                  :                    :           :                                   :                    +- FileScan parquet [i_item_sk#97,i_brand_id#76,i_class_id#77,i_category_id#78] Batched: true, DataFilters: [isnotnull(i_item_sk#97)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :           :                                   +- Sort [d_date_sk#95 ASC NULLS FIRST], false, 0
                  :                    :           :                                      +- Exchange hashpartitioning(d_date_sk#95, 100), ENSURE_REQUIREMENTS, [plan_id=63]
                  :                    :           :                                         +- Project [d_date_sk#95]
                  :                    :           :                                            +- Filter (((isnotnull(d_year#145) AND (d_year#145 >= 1999)) AND (d_year#145 <= 2001)) AND isnotnull(d_date_sk#95))
                  :                    :           :                                               +- FileScan parquet [d_date_sk#95,d_year#145] Batched: true, DataFilters: [isnotnull(d_year#145), (d_year#145 >= 1999), (d_year#145 <= 2001), isnotnull(d_date_sk#93..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :                    :           +- SortMergeJoin [i_item_sk#67], [ss_item_sk#68], LeftSemi
                  :                    :              :- Sort [i_item_sk#67 ASC NULLS FIRST], false, 0
                  :                    :              :  +- Exchange hashpartitioning(i_item_sk#67, 100), ENSURE_REQUIREMENTS, [plan_id=64]
                  :                    :              :     +- Filter isnotnull(i_item_sk#67)
                  :                    :              :        +- FileScan parquet [i_item_sk#67,i_brand_id#20,i_class_id#21,i_category_id#22] Batched: true, DataFilters: [isnotnull(i_item_sk#67)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :              +- Sort [ss_item_sk#68 ASC NULLS FIRST], false, 0
                  :                    :                 +- Exchange hashpartitioning(ss_item_sk#68, 100), ENSURE_REQUIREMENTS, [plan_id=65]
                  :                    :                    +- Project [i_item_sk#69 AS ss_item_sk#68]
                  :                    :                       +- SortMergeJoin [i_brand_id#70, i_class_id#71, i_category_id#72], [brand_id#73, class_id#74, category_id#75], Inner
                  :                    :                          :- Sort [i_brand_id#70 ASC NULLS FIRST, i_class_id#71 ASC NULLS FIRST, i_category_id#72 ASC NULLS FIRST], false, 0
                  :                    :                          :  +- Exchange hashpartitioning(i_brand_id#70, i_class_id#71, i_category_id#72, 100), ENSURE_REQUIREMENTS, [plan_id=66]
                  :                    :                          :     +- Filter ((isnotnull(i_brand_id#70) AND isnotnull(i_class_id#71)) AND isnotnull(i_category_id#72))
                  :                    :                          :        +- FileScan parquet [i_item_sk#69,i_brand_id#70,i_class_id#71,i_category_id#72] Batched: true, DataFilters: [isnotnull(i_brand_id#70), isnotnull(i_class_id#71), isnotnull(i_category_id#72)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :                          +- Sort [brand_id#73 ASC NULLS FIRST, class_id#74 ASC NULLS FIRST, category_id#75 ASC NULLS FIRST], false, 0
                  :                    :                             +- Exchange hashpartitioning(brand_id#73, class_id#74, category_id#75, 100), ENSURE_REQUIREMENTS, [plan_id=67]
                  :                    :                                +- SortMergeJoin [coalesce(brand_id#73, 0), isnull(brand_id#73), coalesce(class_id#74, 0), isnull(class_id#74), coalesce(category_id#75, 0), isnull(category_id#75)], [coalesce(i_brand_id#76, 0), isnull(i_brand_id#76), coalesce(i_class_id#77, 0), isnull(i_class_id#77), coalesce(i_category_id#78, 0), isnull(i_category_id#78)], LeftSemi
                  :                    :                                   :- Sort [coalesce(brand_id#73, 0) ASC NULLS FIRST, isnull(brand_id#73) ASC NULLS FIRST, coalesce(class_id#74, 0) ASC NULLS FIRST, isnull(class_id#74) ASC NULLS FIRST, coalesce(category_id#75, 0) ASC NULLS FIRST, isnull(category_id#75) ASC NULLS FIRST], false, 0
                  :                    :                                   :  +- Exchange hashpartitioning(coalesce(brand_id#73, 0), isnull(brand_id#73), coalesce(class_id#74, 0), isnull(class_id#74), coalesce(category_id#75, 0), isnull(category_id#75), 100), ENSURE_REQUIREMENTS, [plan_id=68]
                  :                    :                                   :     +- HashAggregate(keys=[brand_id#73, class_id#74, category_id#75], functions=[], output=[brand_id#73, class_id#74, category_id#75])
                  :                    :                                   :        +- Exchange hashpartitioning(brand_id#73, class_id#74, category_id#75, 100), ENSURE_REQUIREMENTS, [plan_id=69]
                  :                    :                                   :           +- HashAggregate(keys=[brand_id#73, class_id#74, category_id#75], functions=[], output=[brand_id#73, class_id#74, category_id#75])
                  :                    :                                   :              +- Project [i_brand_id#79 AS brand_id#73, i_class_id#80 AS class_id#74, i_category_id#81 AS category_id#75]
                  :                    :                                   :                 +- SortMergeJoin [ss_sold_date_sk#82], [d_date_sk#83], Inner
                  :                    :                                   :                    :- Sort [ss_sold_date_sk#82 ASC NULLS FIRST], false, 0
                  :                    :                                   :                    :  +- Exchange hashpartitioning(ss_sold_date_sk#82, 100), ENSURE_REQUIREMENTS, [plan_id=70]
                  :                    :                                   :                    :     +- Project [ss_sold_date_sk#82, i_brand_id#79, i_class_id#80, i_category_id#81]
                  :                    :                                   :                    :        +- SortMergeJoin [ss_item_sk#84], [i_item_sk#85], Inner
                  :                    :                                   :                    :           :- Sort [ss_item_sk#84 ASC NULLS FIRST], false, 0
                  :                    :                                   :                    :           :  +- Exchange hashpartitioning(ss_item_sk#84, 100), ENSURE_REQUIREMENTS, [plan_id=71]
                  :                    :                                   :                    :           :     +- Filter (isnotnull(ss_item_sk#84) AND isnotnull(ss_sold_date_sk#82))
                  :                    :                                   :                    :           :        +- FileScan parquet [ss_sold_date_sk#82,ss_item_sk#84] Batched: true, DataFilters: [isnotnull(ss_item_sk#84), isnotnull(ss_sold_date_sk#82)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
                  :                    :                                   :                    :           +- Sort [i_item_sk#85 ASC NULLS FIRST], false, 0
                  :                    :                                   :                    :              +- Exchange hashpartitioning(i_item_sk#85, 100), ENSURE_REQUIREMENTS, [plan_id=72]
                  :                    :                                   :                    :                 +- SortMergeJoin [coalesce(i_brand_id#79, 0), isnull(i_brand_id#79), coalesce(i_class_id#80, 0), isnull(i_class_id#80), coalesce(i_category_id#81, 0), isnull(i_category_id#81)], [coalesce(i_brand_id#86, 0), isnull(i_brand_id#86), coalesce(i_class_id#87, 0), isnull(i_class_id#87), coalesce(i_category_id#88, 0), isnull(i_category_id#88)], LeftSemi
                  :                    :                                   :                    :                    :- Sort [coalesce(i_brand_id#79, 0) ASC NULLS FIRST, isnull(i_brand_id#79) ASC NULLS FIRST, coalesce(i_class_id#80, 0) ASC NULLS FIRST, isnull(i_class_id#80) ASC NULLS FIRST, coalesce(i_category_id#81, 0) ASC NULLS FIRST, isnull(i_category_id#81) ASC NULLS FIRST], false, 0
                  :                    :                                   :                    :                    :  +- Exchange hashpartitioning(coalesce(i_brand_id#79, 0), isnull(i_brand_id#79), coalesce(i_class_id#80, 0), isnull(i_class_id#80), coalesce(i_category_id#81, 0), isnull(i_category_id#81), 100), ENSURE_REQUIREMENTS, [plan_id=73]
                  :                    :                                   :                    :                    :     +- Filter (((isnotnull(i_item_sk#85) AND isnotnull(i_brand_id#79)) AND isnotnull(i_class_id#80)) AND isnotnull(i_category_id#81))
                  :                    :                                   :                    :                    :        +- FileScan parquet [i_item_sk#85,i_brand_id#79,i_class_id#80,i_category_id#81] Batched: true, DataFilters: [isnotnull(i_item_sk#85), isnotnull(i_brand_id#79), isnotnull(i_class_id#80), isnotnull(..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :                                   :                    :                    +- Sort [coalesce(i_brand_id#86, 0) ASC NULLS FIRST, isnull(i_brand_id#86) ASC NULLS FIRST, coalesce(i_class_id#87, 0) ASC NULLS FIRST, isnull(i_class_id#87) ASC NULLS FIRST, coalesce(i_category_id#88, 0) ASC NULLS FIRST, isnull(i_category_id#88) ASC NULLS FIRST], false, 0
                  :                    :                                   :                    :                       +- Exchange hashpartitioning(coalesce(i_brand_id#86, 0), isnull(i_brand_id#86), coalesce(i_class_id#87, 0), isnull(i_class_id#87), coalesce(i_category_id#88, 0), isnull(i_category_id#88), 100), ENSURE_REQUIREMENTS, [plan_id=74]
                  :                    :                                   :                    :                          +- Project [i_brand_id#86, i_class_id#87, i_category_id#88]
                  :                    :                                   :                    :                             +- SortMergeJoin [cs_sold_date_sk#89], [d_date_sk#36], Inner
                  :                    :                                   :                    :                                :- Sort [cs_sold_date_sk#89 ASC NULLS FIRST], false, 0
                  :                    :                                   :                    :                                :  +- Exchange hashpartitioning(cs_sold_date_sk#89, 100), ENSURE_REQUIREMENTS, [plan_id=75]
                  :                    :                                   :                    :                                :     +- Project [cs_sold_date_sk#89, i_brand_id#86, i_class_id#87, i_category_id#88]
                  :                    :                                   :                    :                                :        +- SortMergeJoin [cs_item_sk#90], [i_item_sk#91], Inner
                  :                    :                                   :                    :                                :           :- Sort [cs_item_sk#90 ASC NULLS FIRST], false, 0
                  :                    :                                   :                    :                                :           :  +- Exchange hashpartitioning(cs_item_sk#90, 100), ENSURE_REQUIREMENTS, [plan_id=76]
                  :                    :                                   :                    :                                :           :     +- Filter (isnotnull(cs_item_sk#90) AND isnotnull(cs_sold_date_sk#89))
                  :                    :                                   :                    :                                :           :        +- FileScan parquet [cs_sold_date_sk#89,cs_item_sk#90] Batched: true, DataFilters: [isnotnull(cs_item_sk#90), isnotnull(cs_sold_date_sk#89)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int>
                  :                    :                                   :                    :                                :           +- Sort [i_item_sk#91 ASC NULLS FIRST], false, 0
                  :                    :                                   :                    :                                :              +- Exchange hashpartitioning(i_item_sk#91, 100), ENSURE_REQUIREMENTS, [plan_id=77]
                  :                    :                                   :                    :                                :                 +- Filter isnotnull(i_item_sk#91)
                  :                    :                                   :                    :                                :                    +- FileScan parquet [i_item_sk#91,i_brand_id#86,i_class_id#87,i_category_id#88] Batched: true, DataFilters: [isnotnull(i_item_sk#91)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :                                   :                    :                                +- Sort [d_date_sk#36 ASC NULLS FIRST], false, 0
                  :                    :                                   :                    :                                   +- Exchange hashpartitioning(d_date_sk#36, 100), ENSURE_REQUIREMENTS, [plan_id=78]
                  :                    :                                   :                    :                                      +- Project [d_date_sk#36]
                  :                    :                                   :                    :                                         +- Filter (((isnotnull(d_year#92) AND (d_year#92 >= 1999)) AND (d_year#92 <= 2001)) AND isnotnull(d_date_sk#36))
                  :                    :                                   :                    :                                            +- FileScan parquet [d_date_sk#36,d_year#92] Batched: true, DataFilters: [isnotnull(d_year#92), (d_year#92 >= 1999), (d_year#92 <= 2001), isnotnull(d_date_sk#93..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :                    :                                   :                    +- Sort [d_date_sk#83 ASC NULLS FIRST], false, 0
                  :                    :                                   :                       +- Exchange hashpartitioning(d_date_sk#83, 100), ENSURE_REQUIREMENTS, [plan_id=79]
                  :                    :                                   :                          +- Project [d_date_sk#83]
                  :                    :                                   :                             +- Filter (((isnotnull(d_year#144) AND (d_year#144 >= 1999)) AND (d_year#144 <= 2001)) AND isnotnull(d_date_sk#83))
                  :                    :                                   :                                +- FileScan parquet [d_date_sk#83,d_year#144] Batched: true, DataFilters: [isnotnull(d_year#144), (d_year#144 >= 1999), (d_year#144 <= 2001), isnotnull(d_date_sk#83)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :                    :                                   +- Sort [coalesce(i_brand_id#76, 0) ASC NULLS FIRST, isnull(i_brand_id#76) ASC NULLS FIRST, coalesce(i_class_id#77, 0) ASC NULLS FIRST, isnull(i_class_id#77) ASC NULLS FIRST, coalesce(i_category_id#78, 0) ASC NULLS FIRST, isnull(i_category_id#78) ASC NULLS FIRST], false, 0
                  :                    :                                      +- Exchange hashpartitioning(coalesce(i_brand_id#76, 0), isnull(i_brand_id#76), coalesce(i_class_id#77, 0), isnull(i_class_id#77), coalesce(i_category_id#78, 0), isnull(i_category_id#78), 100), ENSURE_REQUIREMENTS, [plan_id=80]
                  :                    :                                         +- Project [i_brand_id#76, i_class_id#77, i_category_id#78]
                  :                    :                                            +- SortMergeJoin [ws_sold_date_sk#94], [d_date_sk#95], Inner
                  :                    :                                               :- Sort [ws_sold_date_sk#94 ASC NULLS FIRST], false, 0
                  :                    :                                               :  +- Exchange hashpartitioning(ws_sold_date_sk#94, 100), ENSURE_REQUIREMENTS, [plan_id=81]
                  :                    :                                               :     +- Project [ws_sold_date_sk#94, i_brand_id#76, i_class_id#77, i_category_id#78]
                  :                    :                                               :        +- SortMergeJoin [ws_item_sk#96], [i_item_sk#97], Inner
                  :                    :                                               :           :- Sort [ws_item_sk#96 ASC NULLS FIRST], false, 0
                  :                    :                                               :           :  +- Exchange hashpartitioning(ws_item_sk#96, 100), ENSURE_REQUIREMENTS, [plan_id=82]
                  :                    :                                               :           :     +- Filter (isnotnull(ws_item_sk#96) AND isnotnull(ws_sold_date_sk#94))
                  :                    :                                               :           :        +- FileScan parquet [ws_sold_date_sk#94,ws_item_sk#96] Batched: true, DataFilters: [isnotnull(ws_item_sk#96), isnotnull(ws_sold_date_sk#94)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int>
                  :                    :                                               :           +- Sort [i_item_sk#97 ASC NULLS FIRST], false, 0
                  :                    :                                               :              +- Exchange hashpartitioning(i_item_sk#97, 100), ENSURE_REQUIREMENTS, [plan_id=83]
                  :                    :                                               :                 +- Filter isnotnull(i_item_sk#97)
                  :                    :                                               :                    +- FileScan parquet [i_item_sk#97,i_brand_id#76,i_class_id#77,i_category_id#78] Batched: true, DataFilters: [isnotnull(i_item_sk#97)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :                                               +- Sort [d_date_sk#95 ASC NULLS FIRST], false, 0
                  :                    :                                                  +- Exchange hashpartitioning(d_date_sk#95, 100), ENSURE_REQUIREMENTS, [plan_id=84]
                  :                    :                                                     +- Project [d_date_sk#95]
                  :                    :                                                        +- Filter (((isnotnull(d_year#145) AND (d_year#145 >= 1999)) AND (d_year#145 <= 2001)) AND isnotnull(d_date_sk#95))
                  :                    :                                                           +- FileScan parquet [d_date_sk#95,d_year#145] Batched: true, DataFilters: [isnotnull(d_year#145), (d_year#145 >= 1999), (d_year#145 <= 2001), isnotnull(d_date_sk#93..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :                    +- Sort [d_date_sk#65 ASC NULLS FIRST], false, 0
                  :                       +- Exchange hashpartitioning(d_date_sk#65, 100), ENSURE_REQUIREMENTS, [plan_id=85]
                  :                          +- Project [d_date_sk#65]
                  :                             +- Filter ((((isnotnull(d_year#98) AND isnotnull(d_moy#99)) AND (d_year#98 = 2001)) AND (d_moy#99 = 11)) AND isnotnull(d_date_sk#65))
                  :                                +- FileScan parquet [d_date_sk#65,d_year#98,d_moy#99] Batched: true, DataFilters: [isnotnull(d_year#98), isnotnull(d_moy#99), (d_year#98 = 2001), (d_moy#99 = 11), isno..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), EqualTo(d_year,2001), EqualTo(d_moy,11), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_moy:int>
                  :- Project [sales#100, number_sales#101, catalog AS channel#102, i_brand_id#103, i_class_id#104, i_category_id#105]
                  :  +- Filter (isnotnull(sales#100) AND (cast(sales#100 as decimal(32,6)) > cast(Subquery subquery#146, [id=#147] as decimal(32,6))))
                  :     :  +- Subquery subquery#146, [id=#147]
                  :     :     +- AdaptiveSparkPlan isFinalPlan=false
                  :     :        +- HashAggregate(keys=[], functions=[avg((cast(quantity#25 as decimal(10,0)) * list_price#26))], output=[average_sales#28])
                  :     :           +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=86]
                  :     :              +- HashAggregate(keys=[], functions=[partial_avg((cast(quantity#25 as decimal(10,0)) * list_price#26))], output=[sum#49, count#50])
                  :     :                 +- Union
                  :     :                    :- Project [ss_quantity#32 AS quantity#25, ss_list_price#33 AS list_price#26]
                  :     :                    :  +- SortMergeJoin [ss_sold_date_sk#34], [d_date_sk#35], Inner
                  :     :                    :     :- Sort [ss_sold_date_sk#34 ASC NULLS FIRST], false, 0
                  :     :                    :     :  +- Exchange hashpartitioning(ss_sold_date_sk#34, 100), ENSURE_REQUIREMENTS, [plan_id=87]
                  :     :                    :     :     +- Filter isnotnull(ss_sold_date_sk#34)
                  :     :                    :     :        +- FileScan parquet [ss_sold_date_sk#34,ss_quantity#32,ss_list_price#33] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#34)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
                  :     :                    :     +- Sort [d_date_sk#35 ASC NULLS FIRST], false, 0
                  :     :                    :        +- Exchange hashpartitioning(d_date_sk#35, 100), ENSURE_REQUIREMENTS, [plan_id=88]
                  :     :                    :           +- Project [d_date_sk#35]
                  :     :                    :              +- Filter (((isnotnull(d_year#51) AND (d_year#51 >= 1999)) AND (d_year#51 <= 2001)) AND isnotnull(d_date_sk#35))
                  :     :                    :                 +- FileScan parquet [d_date_sk#35,d_year#51] Batched: true, DataFilters: [isnotnull(d_year#51), (d_year#51 >= 1999), (d_year#51 <= 2001), isnotnull(d_date_sk#52..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :     :                    :- Project [cs_quantity#37 AS quantity#38, cs_list_price#39 AS list_price#40]
                  :     :                    :  +- SortMergeJoin [cs_sold_date_sk#41], [d_date_sk#42], Inner
                  :     :                    :     :- Sort [cs_sold_date_sk#41 ASC NULLS FIRST], false, 0
                  :     :                    :     :  +- Exchange hashpartitioning(cs_sold_date_sk#41, 100), ENSURE_REQUIREMENTS, [plan_id=89]
                  :     :                    :     :     +- Filter isnotnull(cs_sold_date_sk#41)
                  :     :                    :     :        +- FileScan parquet [cs_sold_date_sk#41,cs_quantity#37,cs_list_price#39] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#41)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>
                  :     :                    :     +- Sort [d_date_sk#42 ASC NULLS FIRST], false, 0
                  :     :                    :        +- Exchange hashpartitioning(d_date_sk#42, 100), ENSURE_REQUIREMENTS, [plan_id=90]
                  :     :                    :           +- Project [d_date_sk#42]
                  :     :                    :              +- Filter (((isnotnull(d_year#53) AND (d_year#53 >= 1999)) AND (d_year#53 <= 2001)) AND isnotnull(d_date_sk#42))
                  :     :                    :                 +- FileScan parquet [d_date_sk#42,d_year#53] Batched: true, DataFilters: [isnotnull(d_year#53), (d_year#53 >= 1999), (d_year#53 <= 2001), isnotnull(d_date_sk#52..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :     :                    +- Project [ws_quantity#43 AS quantity#44, ws_list_price#45 AS list_price#46]
                  :     :                       +- SortMergeJoin [ws_sold_date_sk#47], [d_date_sk#48], Inner
                  :     :                          :- Sort [ws_sold_date_sk#47 ASC NULLS FIRST], false, 0
                  :     :                          :  +- Exchange hashpartitioning(ws_sold_date_sk#47, 100), ENSURE_REQUIREMENTS, [plan_id=91]
                  :     :                          :     +- Filter isnotnull(ws_sold_date_sk#47)
                  :     :                          :        +- FileScan parquet [ws_sold_date_sk#47,ws_quantity#43,ws_list_price#45] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#47)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
                  :     :                          +- Sort [d_date_sk#48 ASC NULLS FIRST], false, 0
                  :     :                             +- Exchange hashpartitioning(d_date_sk#48, 100), ENSURE_REQUIREMENTS, [plan_id=92]
                  :     :                                +- Project [d_date_sk#48]
                  :     :                                   +- Filter (((isnotnull(d_year#54) AND (d_year#54 >= 1999)) AND (d_year#54 <= 2001)) AND isnotnull(d_date_sk#48))
                  :     :                                      +- FileScan parquet [d_date_sk#48,d_year#54] Batched: true, DataFilters: [isnotnull(d_year#54), (d_year#54 >= 1999), (d_year#54 <= 2001), isnotnull(d_date_sk#55..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :     +- HashAggregate(keys=[i_brand_id#103, i_class_id#104, i_category_id#105], functions=[sum((cast(cs_quantity#106 as decimal(10,0)) * cs_list_price#107)), count(1)], output=[i_brand_id#103, i_class_id#104, i_category_id#105, sales#100, number_sales#101])
                  :        +- Exchange hashpartitioning(i_brand_id#103, i_class_id#104, i_category_id#105, 100), ENSURE_REQUIREMENTS, [plan_id=93]
                  :           +- HashAggregate(keys=[i_brand_id#103, i_class_id#104, i_category_id#105], functions=[partial_sum((cast(cs_quantity#106 as decimal(10,0)) * cs_list_price#107)), partial_count(1)], output=[i_brand_id#103, i_class_id#104, i_category_id#105, sum#148, isEmpty#149, count#150])
                  :              +- Project [cs_quantity#106, cs_list_price#107, i_brand_id#103, i_class_id#104, i_category_id#105]
                  :                 +- SortMergeJoin [cs_sold_date_sk#114], [d_date_sk#115], Inner
                  :                    :- Sort [cs_sold_date_sk#114 ASC NULLS FIRST], false, 0
                  :                    :  +- Exchange hashpartitioning(cs_sold_date_sk#114, 100), ENSURE_REQUIREMENTS, [plan_id=94]
                  :                    :     +- Project [cs_sold_date_sk#114, cs_quantity#106, cs_list_price#107, i_brand_id#103, i_class_id#104, i_category_id#105]
                  :                    :        +- SortMergeJoin [cs_item_sk#116], [i_item_sk#117], Inner
                  :                    :           :- SortMergeJoin [cs_item_sk#116], [ss_item_sk#118], LeftSemi
                  :                    :           :  :- Sort [cs_item_sk#116 ASC NULLS FIRST], false, 0
                  :                    :           :  :  +- Exchange hashpartitioning(cs_item_sk#116, 100), ENSURE_REQUIREMENTS, [plan_id=95]
                  :                    :           :  :     +- Filter (isnotnull(cs_item_sk#116) AND isnotnull(cs_sold_date_sk#114))
                  :                    :           :  :        +- FileScan parquet [cs_sold_date_sk#114,cs_item_sk#116,cs_quantity#106,cs_list_price#107] Batched: true, DataFilters: [isnotnull(cs_item_sk#116), isnotnull(cs_sold_date_sk#114)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>
                  :                    :           :  +- Sort [ss_item_sk#118 ASC NULLS FIRST], false, 0
                  :                    :           :     +- Exchange hashpartitioning(ss_item_sk#118, 100), ENSURE_REQUIREMENTS, [plan_id=96]
                  :                    :           :        +- Project [i_item_sk#151 AS ss_item_sk#118]
                  :                    :           :           +- SortMergeJoin [i_brand_id#152, i_class_id#153, i_category_id#154], [brand_id#73, class_id#74, category_id#75], Inner
                  :                    :           :              :- Sort [i_brand_id#152 ASC NULLS FIRST, i_class_id#153 ASC NULLS FIRST, i_category_id#154 ASC NULLS FIRST], false, 0
                  :                    :           :              :  +- Exchange hashpartitioning(i_brand_id#152, i_class_id#153, i_category_id#154, 100), ENSURE_REQUIREMENTS, [plan_id=97]
                  :                    :           :              :     +- Filter ((isnotnull(i_brand_id#152) AND isnotnull(i_class_id#153)) AND isnotnull(i_category_id#154))
                  :                    :           :              :        +- FileScan parquet [i_item_sk#151,i_brand_id#152,i_class_id#153,i_category_id#154] Batched: true, DataFilters: [isnotnull(i_brand_id#152), isnotnull(i_class_id#153), isnotnull(i_category_id#154)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :           :              +- Sort [brand_id#73 ASC NULLS FIRST, class_id#74 ASC NULLS FIRST, category_id#75 ASC NULLS FIRST], false, 0
                  :                    :           :                 +- Exchange hashpartitioning(brand_id#73, class_id#74, category_id#75, 100), ENSURE_REQUIREMENTS, [plan_id=98]
                  :                    :           :                    +- SortMergeJoin [coalesce(brand_id#73, 0), isnull(brand_id#73), coalesce(class_id#74, 0), isnull(class_id#74), coalesce(category_id#75, 0), isnull(category_id#75)], [coalesce(i_brand_id#155, 0), isnull(i_brand_id#155), coalesce(i_class_id#156, 0), isnull(i_class_id#156), coalesce(i_category_id#157, 0), isnull(i_category_id#157)], LeftSemi
                  :                    :           :                       :- Sort [coalesce(brand_id#73, 0) ASC NULLS FIRST, isnull(brand_id#73) ASC NULLS FIRST, coalesce(class_id#74, 0) ASC NULLS FIRST, isnull(class_id#74) ASC NULLS FIRST, coalesce(category_id#75, 0) ASC NULLS FIRST, isnull(category_id#75) ASC NULLS FIRST], false, 0
                  :                    :           :                       :  +- Exchange hashpartitioning(coalesce(brand_id#73, 0), isnull(brand_id#73), coalesce(class_id#74, 0), isnull(class_id#74), coalesce(category_id#75, 0), isnull(category_id#75), 100), ENSURE_REQUIREMENTS, [plan_id=99]
                  :                    :           :                       :     +- HashAggregate(keys=[brand_id#73, class_id#74, category_id#75], functions=[], output=[brand_id#73, class_id#74, category_id#75])
                  :                    :           :                       :        +- Exchange hashpartitioning(brand_id#73, class_id#74, category_id#75, 100), ENSURE_REQUIREMENTS, [plan_id=100]
                  :                    :           :                       :           +- HashAggregate(keys=[brand_id#73, class_id#74, category_id#75], functions=[], output=[brand_id#73, class_id#74, category_id#75])
                  :                    :           :                       :              +- Project [i_brand_id#158 AS brand_id#73, i_class_id#159 AS class_id#74, i_category_id#160 AS category_id#75]
                  :                    :           :                       :                 +- SortMergeJoin [ss_sold_date_sk#161], [d_date_sk#162], Inner
                  :                    :           :                       :                    :- Sort [ss_sold_date_sk#161 ASC NULLS FIRST], false, 0
                  :                    :           :                       :                    :  +- Exchange hashpartitioning(ss_sold_date_sk#161, 100), ENSURE_REQUIREMENTS, [plan_id=101]
                  :                    :           :                       :                    :     +- Project [ss_sold_date_sk#161, i_brand_id#158, i_class_id#159, i_category_id#160]
                  :                    :           :                       :                    :        +- SortMergeJoin [ss_item_sk#163], [i_item_sk#164], Inner
                  :                    :           :                       :                    :           :- Sort [ss_item_sk#163 ASC NULLS FIRST], false, 0
                  :                    :           :                       :                    :           :  +- Exchange hashpartitioning(ss_item_sk#163, 100), ENSURE_REQUIREMENTS, [plan_id=102]
                  :                    :           :                       :                    :           :     +- Filter (isnotnull(ss_item_sk#163) AND isnotnull(ss_sold_date_sk#161))
                  :                    :           :                       :                    :           :        +- FileScan parquet [ss_sold_date_sk#161,ss_item_sk#163] Batched: true, DataFilters: [isnotnull(ss_item_sk#163), isnotnull(ss_sold_date_sk#161)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
                  :                    :           :                       :                    :           +- Sort [i_item_sk#164 ASC NULLS FIRST], false, 0
                  :                    :           :                       :                    :              +- Exchange hashpartitioning(i_item_sk#164, 100), ENSURE_REQUIREMENTS, [plan_id=103]
                  :                    :           :                       :                    :                 +- SortMergeJoin [coalesce(i_brand_id#158, 0), isnull(i_brand_id#158), coalesce(i_class_id#159, 0), isnull(i_class_id#159), coalesce(i_category_id#160, 0), isnull(i_category_id#160)], [coalesce(i_brand_id#165, 0), isnull(i_brand_id#165), coalesce(i_class_id#166, 0), isnull(i_class_id#166), coalesce(i_category_id#167, 0), isnull(i_category_id#167)], LeftSemi
                  :                    :           :                       :                    :                    :- Sort [coalesce(i_brand_id#158, 0) ASC NULLS FIRST, isnull(i_brand_id#158) ASC NULLS FIRST, coalesce(i_class_id#159, 0) ASC NULLS FIRST, isnull(i_class_id#159) ASC NULLS FIRST, coalesce(i_category_id#160, 0) ASC NULLS FIRST, isnull(i_category_id#160) ASC NULLS FIRST], false, 0
                  :                    :           :                       :                    :                    :  +- Exchange hashpartitioning(coalesce(i_brand_id#158, 0), isnull(i_brand_id#158), coalesce(i_class_id#159, 0), isnull(i_class_id#159), coalesce(i_category_id#160, 0), isnull(i_category_id#160), 100), ENSURE_REQUIREMENTS, [plan_id=104]
                  :                    :           :                       :                    :                    :     +- Filter (((isnotnull(i_item_sk#164) AND isnotnull(i_brand_id#158)) AND isnotnull(i_class_id#159)) AND isnotnull(i_category_id#160))
                  :                    :           :                       :                    :                    :        +- FileScan parquet [i_item_sk#164,i_brand_id#158,i_class_id#159,i_category_id#160] Batched: true, DataFilters: [isnotnull(i_item_sk#164), isnotnull(i_brand_id#158), isnotnull(i_class_id#159), isnotnull(..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :           :                       :                    :                    +- Sort [coalesce(i_brand_id#165, 0) ASC NULLS FIRST, isnull(i_brand_id#165) ASC NULLS FIRST, coalesce(i_class_id#166, 0) ASC NULLS FIRST, isnull(i_class_id#166) ASC NULLS FIRST, coalesce(i_category_id#167, 0) ASC NULLS FIRST, isnull(i_category_id#167) ASC NULLS FIRST], false, 0
                  :                    :           :                       :                    :                       +- Exchange hashpartitioning(coalesce(i_brand_id#165, 0), isnull(i_brand_id#165), coalesce(i_class_id#166, 0), isnull(i_class_id#166), coalesce(i_category_id#167, 0), isnull(i_category_id#167), 100), ENSURE_REQUIREMENTS, [plan_id=105]
                  :                    :           :                       :                    :                          +- Project [i_brand_id#165, i_class_id#166, i_category_id#167]
                  :                    :           :                       :                    :                             +- SortMergeJoin [cs_sold_date_sk#168], [d_date_sk#169], Inner
                  :                    :           :                       :                    :                                :- Sort [cs_sold_date_sk#168 ASC NULLS FIRST], false, 0
                  :                    :           :                       :                    :                                :  +- Exchange hashpartitioning(cs_sold_date_sk#168, 100), ENSURE_REQUIREMENTS, [plan_id=106]
                  :                    :           :                       :                    :                                :     +- Project [cs_sold_date_sk#168, i_brand_id#165, i_class_id#166, i_category_id#167]
                  :                    :           :                       :                    :                                :        +- SortMergeJoin [cs_item_sk#170], [i_item_sk#171], Inner
                  :                    :           :                       :                    :                                :           :- Sort [cs_item_sk#170 ASC NULLS FIRST], false, 0
                  :                    :           :                       :                    :                                :           :  +- Exchange hashpartitioning(cs_item_sk#170, 100), ENSURE_REQUIREMENTS, [plan_id=107]
                  :                    :           :                       :                    :                                :           :     +- Filter (isnotnull(cs_item_sk#170) AND isnotnull(cs_sold_date_sk#168))
                  :                    :           :                       :                    :                                :           :        +- FileScan parquet [cs_sold_date_sk#168,cs_item_sk#170] Batched: true, DataFilters: [isnotnull(cs_item_sk#170), isnotnull(cs_sold_date_sk#168)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int>
                  :                    :           :                       :                    :                                :           +- Sort [i_item_sk#171 ASC NULLS FIRST], false, 0
                  :                    :           :                       :                    :                                :              +- Exchange hashpartitioning(i_item_sk#171, 100), ENSURE_REQUIREMENTS, [plan_id=108]
                  :                    :           :                       :                    :                                :                 +- Filter isnotnull(i_item_sk#171)
                  :                    :           :                       :                    :                                :                    +- FileScan parquet [i_item_sk#171,i_brand_id#165,i_class_id#166,i_category_id#167] Batched: true, DataFilters: [isnotnull(i_item_sk#171)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :           :                       :                    :                                +- Sort [d_date_sk#169 ASC NULLS FIRST], false, 0
                  :                    :           :                       :                    :                                   +- Exchange hashpartitioning(d_date_sk#169, 100), ENSURE_REQUIREMENTS, [plan_id=109]
                  :                    :           :                       :                    :                                      +- Project [d_date_sk#169]
                  :                    :           :                       :                    :                                         +- Filter (((isnotnull(d_year#172) AND (d_year#172 >= 1999)) AND (d_year#172 <= 2001)) AND isnotnull(d_date_sk#169))
                  :                    :           :                       :                    :                                            +- FileScan parquet [d_date_sk#169,d_year#172] Batched: true, DataFilters: [isnotnull(d_year#172), (d_year#172 >= 1999), (d_year#172 <= 2001), isnotnull(d_date_sk#173..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :                    :           :                       :                    +- Sort [d_date_sk#162 ASC NULLS FIRST], false, 0
                  :                    :           :                       :                       +- Exchange hashpartitioning(d_date_sk#162, 100), ENSURE_REQUIREMENTS, [plan_id=110]
                  :                    :           :                       :                          +- Project [d_date_sk#162]
                  :                    :           :                       :                             +- Filter (((isnotnull(d_year#174) AND (d_year#174 >= 1999)) AND (d_year#174 <= 2001)) AND isnotnull(d_date_sk#162))
                  :                    :           :                       :                                +- FileScan parquet [d_date_sk#162,d_year#174] Batched: true, DataFilters: [isnotnull(d_year#174), (d_year#174 >= 1999), (d_year#174 <= 2001), isnotnull(d_date_sk#173..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :                    :           :                       +- Sort [coalesce(i_brand_id#155, 0) ASC NULLS FIRST, isnull(i_brand_id#155) ASC NULLS FIRST, coalesce(i_class_id#156, 0) ASC NULLS FIRST, isnull(i_class_id#156) ASC NULLS FIRST, coalesce(i_category_id#157, 0) ASC NULLS FIRST, isnull(i_category_id#157) ASC NULLS FIRST], false, 0
                  :                    :           :                          +- Exchange hashpartitioning(coalesce(i_brand_id#155, 0), isnull(i_brand_id#155), coalesce(i_class_id#156, 0), isnull(i_class_id#156), coalesce(i_category_id#157, 0), isnull(i_category_id#157), 100), ENSURE_REQUIREMENTS, [plan_id=111]
                  :                    :           :                             +- Project [i_brand_id#155, i_class_id#156, i_category_id#157]
                  :                    :           :                                +- SortMergeJoin [ws_sold_date_sk#175], [d_date_sk#176], Inner
                  :                    :           :                                   :- Sort [ws_sold_date_sk#175 ASC NULLS FIRST], false, 0
                  :                    :           :                                   :  +- Exchange hashpartitioning(ws_sold_date_sk#175, 100), ENSURE_REQUIREMENTS, [plan_id=112]
                  :                    :           :                                   :     +- Project [ws_sold_date_sk#175, i_brand_id#155, i_class_id#156, i_category_id#157]
                  :                    :           :                                   :        +- SortMergeJoin [ws_item_sk#177], [i_item_sk#178], Inner
                  :                    :           :                                   :           :- Sort [ws_item_sk#177 ASC NULLS FIRST], false, 0
                  :                    :           :                                   :           :  +- Exchange hashpartitioning(ws_item_sk#177, 100), ENSURE_REQUIREMENTS, [plan_id=113]
                  :                    :           :                                   :           :     +- Filter (isnotnull(ws_item_sk#177) AND isnotnull(ws_sold_date_sk#175))
                  :                    :           :                                   :           :        +- FileScan parquet [ws_sold_date_sk#175,ws_item_sk#177] Batched: true, DataFilters: [isnotnull(ws_item_sk#177), isnotnull(ws_sold_date_sk#175)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int>
                  :                    :           :                                   :           +- Sort [i_item_sk#178 ASC NULLS FIRST], false, 0
                  :                    :           :                                   :              +- Exchange hashpartitioning(i_item_sk#178, 100), ENSURE_REQUIREMENTS, [plan_id=114]
                  :                    :           :                                   :                 +- Filter isnotnull(i_item_sk#178)
                  :                    :           :                                   :                    +- FileScan parquet [i_item_sk#178,i_brand_id#155,i_class_id#156,i_category_id#157] Batched: true, DataFilters: [isnotnull(i_item_sk#178)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :           :                                   +- Sort [d_date_sk#176 ASC NULLS FIRST], false, 0
                  :                    :           :                                      +- Exchange hashpartitioning(d_date_sk#176, 100), ENSURE_REQUIREMENTS, [plan_id=115]
                  :                    :           :                                         +- Project [d_date_sk#176]
                  :                    :           :                                            +- Filter (((isnotnull(d_year#179) AND (d_year#179 >= 1999)) AND (d_year#179 <= 2001)) AND isnotnull(d_date_sk#176))
                  :                    :           :                                               +- FileScan parquet [d_date_sk#176,d_year#179] Batched: true, DataFilters: [isnotnull(d_year#179), (d_year#179 >= 1999), (d_year#179 <= 2001), isnotnull(d_date_sk#180..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :                    :           +- SortMergeJoin [i_item_sk#117], [ss_item_sk#118], LeftSemi
                  :                    :              :- Sort [i_item_sk#117 ASC NULLS FIRST], false, 0
                  :                    :              :  +- Exchange hashpartitioning(i_item_sk#117, 100), ENSURE_REQUIREMENTS, [plan_id=116]
                  :                    :              :     +- Filter isnotnull(i_item_sk#117)
                  :                    :              :        +- FileScan parquet [i_item_sk#117,i_brand_id#103,i_class_id#104,i_category_id#105] Batched: true, DataFilters: [isnotnull(i_item_sk#117)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :              +- Sort [ss_item_sk#118 ASC NULLS FIRST], false, 0
                  :                    :                 +- Exchange hashpartitioning(ss_item_sk#118, 100), ENSURE_REQUIREMENTS, [plan_id=117]
                  :                    :                    +- Project [i_item_sk#151 AS ss_item_sk#118]
                  :                    :                       +- SortMergeJoin [i_brand_id#152, i_class_id#153, i_category_id#154], [brand_id#73, class_id#74, category_id#75], Inner
                  :                    :                          :- Sort [i_brand_id#152 ASC NULLS FIRST, i_class_id#153 ASC NULLS FIRST, i_category_id#154 ASC NULLS FIRST], false, 0
                  :                    :                          :  +- Exchange hashpartitioning(i_brand_id#152, i_class_id#153, i_category_id#154, 100), ENSURE_REQUIREMENTS, [plan_id=118]
                  :                    :                          :     +- Filter ((isnotnull(i_brand_id#152) AND isnotnull(i_class_id#153)) AND isnotnull(i_category_id#154))
                  :                    :                          :        +- FileScan parquet [i_item_sk#151,i_brand_id#152,i_class_id#153,i_category_id#154] Batched: true, DataFilters: [isnotnull(i_brand_id#152), isnotnull(i_class_id#153), isnotnull(i_category_id#154)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :                          +- Sort [brand_id#73 ASC NULLS FIRST, class_id#74 ASC NULLS FIRST, category_id#75 ASC NULLS FIRST], false, 0
                  :                    :                             +- Exchange hashpartitioning(brand_id#73, class_id#74, category_id#75, 100), ENSURE_REQUIREMENTS, [plan_id=119]
                  :                    :                                +- SortMergeJoin [coalesce(brand_id#73, 0), isnull(brand_id#73), coalesce(class_id#74, 0), isnull(class_id#74), coalesce(category_id#75, 0), isnull(category_id#75)], [coalesce(i_brand_id#155, 0), isnull(i_brand_id#155), coalesce(i_class_id#156, 0), isnull(i_class_id#156), coalesce(i_category_id#157, 0), isnull(i_category_id#157)], LeftSemi
                  :                    :                                   :- Sort [coalesce(brand_id#73, 0) ASC NULLS FIRST, isnull(brand_id#73) ASC NULLS FIRST, coalesce(class_id#74, 0) ASC NULLS FIRST, isnull(class_id#74) ASC NULLS FIRST, coalesce(category_id#75, 0) ASC NULLS FIRST, isnull(category_id#75) ASC NULLS FIRST], false, 0
                  :                    :                                   :  +- Exchange hashpartitioning(coalesce(brand_id#73, 0), isnull(brand_id#73), coalesce(class_id#74, 0), isnull(class_id#74), coalesce(category_id#75, 0), isnull(category_id#75), 100), ENSURE_REQUIREMENTS, [plan_id=120]
                  :                    :                                   :     +- HashAggregate(keys=[brand_id#73, class_id#74, category_id#75], functions=[], output=[brand_id#73, class_id#74, category_id#75])
                  :                    :                                   :        +- Exchange hashpartitioning(brand_id#73, class_id#74, category_id#75, 100), ENSURE_REQUIREMENTS, [plan_id=121]
                  :                    :                                   :           +- HashAggregate(keys=[brand_id#73, class_id#74, category_id#75], functions=[], output=[brand_id#73, class_id#74, category_id#75])
                  :                    :                                   :              +- Project [i_brand_id#158 AS brand_id#73, i_class_id#159 AS class_id#74, i_category_id#160 AS category_id#75]
                  :                    :                                   :                 +- SortMergeJoin [ss_sold_date_sk#161], [d_date_sk#162], Inner
                  :                    :                                   :                    :- Sort [ss_sold_date_sk#161 ASC NULLS FIRST], false, 0
                  :                    :                                   :                    :  +- Exchange hashpartitioning(ss_sold_date_sk#161, 100), ENSURE_REQUIREMENTS, [plan_id=122]
                  :                    :                                   :                    :     +- Project [ss_sold_date_sk#161, i_brand_id#158, i_class_id#159, i_category_id#160]
                  :                    :                                   :                    :        +- SortMergeJoin [ss_item_sk#163], [i_item_sk#164], Inner
                  :                    :                                   :                    :           :- Sort [ss_item_sk#163 ASC NULLS FIRST], false, 0
                  :                    :                                   :                    :           :  +- Exchange hashpartitioning(ss_item_sk#163, 100), ENSURE_REQUIREMENTS, [plan_id=123]
                  :                    :                                   :                    :           :     +- Filter (isnotnull(ss_item_sk#163) AND isnotnull(ss_sold_date_sk#161))
                  :                    :                                   :                    :           :        +- FileScan parquet [ss_sold_date_sk#161,ss_item_sk#163] Batched: true, DataFilters: [isnotnull(ss_item_sk#163), isnotnull(ss_sold_date_sk#161)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
                  :                    :                                   :                    :           +- Sort [i_item_sk#164 ASC NULLS FIRST], false, 0
                  :                    :                                   :                    :              +- Exchange hashpartitioning(i_item_sk#164, 100), ENSURE_REQUIREMENTS, [plan_id=124]
                  :                    :                                   :                    :                 +- SortMergeJoin [coalesce(i_brand_id#158, 0), isnull(i_brand_id#158), coalesce(i_class_id#159, 0), isnull(i_class_id#159), coalesce(i_category_id#160, 0), isnull(i_category_id#160)], [coalesce(i_brand_id#165, 0), isnull(i_brand_id#165), coalesce(i_class_id#166, 0), isnull(i_class_id#166), coalesce(i_category_id#167, 0), isnull(i_category_id#167)], LeftSemi
                  :                    :                                   :                    :                    :- Sort [coalesce(i_brand_id#158, 0) ASC NULLS FIRST, isnull(i_brand_id#158) ASC NULLS FIRST, coalesce(i_class_id#159, 0) ASC NULLS FIRST, isnull(i_class_id#159) ASC NULLS FIRST, coalesce(i_category_id#160, 0) ASC NULLS FIRST, isnull(i_category_id#160) ASC NULLS FIRST], false, 0
                  :                    :                                   :                    :                    :  +- Exchange hashpartitioning(coalesce(i_brand_id#158, 0), isnull(i_brand_id#158), coalesce(i_class_id#159, 0), isnull(i_class_id#159), coalesce(i_category_id#160, 0), isnull(i_category_id#160), 100), ENSURE_REQUIREMENTS, [plan_id=125]
                  :                    :                                   :                    :                    :     +- Filter (((isnotnull(i_item_sk#164) AND isnotnull(i_brand_id#158)) AND isnotnull(i_class_id#159)) AND isnotnull(i_category_id#160))
                  :                    :                                   :                    :                    :        +- FileScan parquet [i_item_sk#164,i_brand_id#158,i_class_id#159,i_category_id#160] Batched: true, DataFilters: [isnotnull(i_item_sk#164), isnotnull(i_brand_id#158), isnotnull(i_class_id#159), isnotnull(..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :                                   :                    :                    +- Sort [coalesce(i_brand_id#165, 0) ASC NULLS FIRST, isnull(i_brand_id#165) ASC NULLS FIRST, coalesce(i_class_id#166, 0) ASC NULLS FIRST, isnull(i_class_id#166) ASC NULLS FIRST, coalesce(i_category_id#167, 0) ASC NULLS FIRST, isnull(i_category_id#167) ASC NULLS FIRST], false, 0
                  :                    :                                   :                    :                       +- Exchange hashpartitioning(coalesce(i_brand_id#165, 0), isnull(i_brand_id#165), coalesce(i_class_id#166, 0), isnull(i_class_id#166), coalesce(i_category_id#167, 0), isnull(i_category_id#167), 100), ENSURE_REQUIREMENTS, [plan_id=126]
                  :                    :                                   :                    :                          +- Project [i_brand_id#165, i_class_id#166, i_category_id#167]
                  :                    :                                   :                    :                             +- SortMergeJoin [cs_sold_date_sk#168], [d_date_sk#169], Inner
                  :                    :                                   :                    :                                :- Sort [cs_sold_date_sk#168 ASC NULLS FIRST], false, 0
                  :                    :                                   :                    :                                :  +- Exchange hashpartitioning(cs_sold_date_sk#168, 100), ENSURE_REQUIREMENTS, [plan_id=127]
                  :                    :                                   :                    :                                :     +- Project [cs_sold_date_sk#168, i_brand_id#165, i_class_id#166, i_category_id#167]
                  :                    :                                   :                    :                                :        +- SortMergeJoin [cs_item_sk#170], [i_item_sk#171], Inner
                  :                    :                                   :                    :                                :           :- Sort [cs_item_sk#170 ASC NULLS FIRST], false, 0
                  :                    :                                   :                    :                                :           :  +- Exchange hashpartitioning(cs_item_sk#170, 100), ENSURE_REQUIREMENTS, [plan_id=128]
                  :                    :                                   :                    :                                :           :     +- Filter (isnotnull(cs_item_sk#170) AND isnotnull(cs_sold_date_sk#168))
                  :                    :                                   :                    :                                :           :        +- FileScan parquet [cs_sold_date_sk#168,cs_item_sk#170] Batched: true, DataFilters: [isnotnull(cs_item_sk#170), isnotnull(cs_sold_date_sk#168)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int>
                  :                    :                                   :                    :                                :           +- Sort [i_item_sk#171 ASC NULLS FIRST], false, 0
                  :                    :                                   :                    :                                :              +- Exchange hashpartitioning(i_item_sk#171, 100), ENSURE_REQUIREMENTS, [plan_id=129]
                  :                    :                                   :                    :                                :                 +- Filter isnotnull(i_item_sk#171)
                  :                    :                                   :                    :                                :                    +- FileScan parquet [i_item_sk#171,i_brand_id#165,i_class_id#166,i_category_id#167] Batched: true, DataFilters: [isnotnull(i_item_sk#171)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :                                   :                    :                                +- Sort [d_date_sk#169 ASC NULLS FIRST], false, 0
                  :                    :                                   :                    :                                   +- Exchange hashpartitioning(d_date_sk#169, 100), ENSURE_REQUIREMENTS, [plan_id=130]
                  :                    :                                   :                    :                                      +- Project [d_date_sk#169]
                  :                    :                                   :                    :                                         +- Filter (((isnotnull(d_year#172) AND (d_year#172 >= 1999)) AND (d_year#172 <= 2001)) AND isnotnull(d_date_sk#169))
                  :                    :                                   :                    :                                            +- FileScan parquet [d_date_sk#169,d_year#172] Batched: true, DataFilters: [isnotnull(d_year#172), (d_year#172 >= 1999), (d_year#172 <= 2001), isnotnull(d_date_sk#173..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :                    :                                   :                    +- Sort [d_date_sk#162 ASC NULLS FIRST], false, 0
                  :                    :                                   :                       +- Exchange hashpartitioning(d_date_sk#162, 100), ENSURE_REQUIREMENTS, [plan_id=131]
                  :                    :                                   :                          +- Project [d_date_sk#162]
                  :                    :                                   :                             +- Filter (((isnotnull(d_year#174) AND (d_year#174 >= 1999)) AND (d_year#174 <= 2001)) AND isnotnull(d_date_sk#162))
                  :                    :                                   :                                +- FileScan parquet [d_date_sk#162,d_year#174] Batched: true, DataFilters: [isnotnull(d_year#174), (d_year#174 >= 1999), (d_year#174 <= 2001), isnotnull(d_date_sk#173..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :                    :                                   +- Sort [coalesce(i_brand_id#155, 0) ASC NULLS FIRST, isnull(i_brand_id#155) ASC NULLS FIRST, coalesce(i_class_id#156, 0) ASC NULLS FIRST, isnull(i_class_id#156) ASC NULLS FIRST, coalesce(i_category_id#157, 0) ASC NULLS FIRST, isnull(i_category_id#157) ASC NULLS FIRST], false, 0
                  :                    :                                      +- Exchange hashpartitioning(coalesce(i_brand_id#155, 0), isnull(i_brand_id#155), coalesce(i_class_id#156, 0), isnull(i_class_id#156), coalesce(i_category_id#157, 0), isnull(i_category_id#157), 100), ENSURE_REQUIREMENTS, [plan_id=132]
                  :                    :                                         +- Project [i_brand_id#155, i_class_id#156, i_category_id#157]
                  :                    :                                            +- SortMergeJoin [ws_sold_date_sk#175], [d_date_sk#176], Inner
                  :                    :                                               :- Sort [ws_sold_date_sk#175 ASC NULLS FIRST], false, 0
                  :                    :                                               :  +- Exchange hashpartitioning(ws_sold_date_sk#175, 100), ENSURE_REQUIREMENTS, [plan_id=133]
                  :                    :                                               :     +- Project [ws_sold_date_sk#175, i_brand_id#155, i_class_id#156, i_category_id#157]
                  :                    :                                               :        +- SortMergeJoin [ws_item_sk#177], [i_item_sk#178], Inner
                  :                    :                                               :           :- Sort [ws_item_sk#177 ASC NULLS FIRST], false, 0
                  :                    :                                               :           :  +- Exchange hashpartitioning(ws_item_sk#177, 100), ENSURE_REQUIREMENTS, [plan_id=134]
                  :                    :                                               :           :     +- Filter (isnotnull(ws_item_sk#177) AND isnotnull(ws_sold_date_sk#175))
                  :                    :                                               :           :        +- FileScan parquet [ws_sold_date_sk#175,ws_item_sk#177] Batched: true, DataFilters: [isnotnull(ws_item_sk#177), isnotnull(ws_sold_date_sk#175)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int>
                  :                    :                                               :           +- Sort [i_item_sk#178 ASC NULLS FIRST], false, 0
                  :                    :                                               :              +- Exchange hashpartitioning(i_item_sk#178, 100), ENSURE_REQUIREMENTS, [plan_id=135]
                  :                    :                                               :                 +- Filter isnotnull(i_item_sk#178)
                  :                    :                                               :                    +- FileScan parquet [i_item_sk#178,i_brand_id#155,i_class_id#156,i_category_id#157] Batched: true, DataFilters: [isnotnull(i_item_sk#178)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :                                               +- Sort [d_date_sk#176 ASC NULLS FIRST], false, 0
                  :                    :                                                  +- Exchange hashpartitioning(d_date_sk#176, 100), ENSURE_REQUIREMENTS, [plan_id=136]
                  :                    :                                                     +- Project [d_date_sk#176]
                  :                    :                                                        +- Filter (((isnotnull(d_year#179) AND (d_year#179 >= 1999)) AND (d_year#179 <= 2001)) AND isnotnull(d_date_sk#176))
                  :                    :                                                           +- FileScan parquet [d_date_sk#176,d_year#179] Batched: true, DataFilters: [isnotnull(d_year#179), (d_year#179 >= 1999), (d_year#179 <= 2001), isnotnull(d_date_sk#180..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :                    +- Sort [d_date_sk#115 ASC NULLS FIRST], false, 0
                  :                       +- Exchange hashpartitioning(d_date_sk#115, 100), ENSURE_REQUIREMENTS, [plan_id=137]
                  :                          +- Project [d_date_sk#115]
                  :                             +- Filter ((((isnotnull(d_year#181) AND isnotnull(d_moy#182)) AND (d_year#181 = 2001)) AND (d_moy#182 = 11)) AND isnotnull(d_date_sk#115))
                  :                                +- FileScan parquet [d_date_sk#115,d_year#181,d_moy#182] Batched: true, DataFilters: [isnotnull(d_year#181), isnotnull(d_moy#182), (d_year#181 = 2001), (d_moy#182 = 11), isno..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), EqualTo(d_year,2001), EqualTo(d_moy,11), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_moy:int>
                  +- Project [sales#119, number_sales#120, web AS channel#121, i_brand_id#122, i_class_id#123, i_category_id#124]
                     +- Filter (isnotnull(sales#119) AND (cast(sales#119 as decimal(32,6)) > cast(Subquery subquery#183, [id=#184] as decimal(32,6))))
                        :  +- Subquery subquery#183, [id=#184]
                        :     +- AdaptiveSparkPlan isFinalPlan=false
                        :        +- HashAggregate(keys=[], functions=[avg((cast(quantity#25 as decimal(10,0)) * list_price#26))], output=[average_sales#28])
                        :           +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=138]
                        :              +- HashAggregate(keys=[], functions=[partial_avg((cast(quantity#25 as decimal(10,0)) * list_price#26))], output=[sum#49, count#50])
                        :                 +- Union
                        :                    :- Project [ss_quantity#32 AS quantity#25, ss_list_price#33 AS list_price#26]
                        :                    :  +- SortMergeJoin [ss_sold_date_sk#34], [d_date_sk#35], Inner
                        :                    :     :- Sort [ss_sold_date_sk#34 ASC NULLS FIRST], false, 0
                        :                    :     :  +- Exchange hashpartitioning(ss_sold_date_sk#34, 100), ENSURE_REQUIREMENTS, [plan_id=139]
                        :                    :     :     +- Filter isnotnull(ss_sold_date_sk#34)
                        :                    :     :        +- FileScan parquet [ss_sold_date_sk#34,ss_quantity#32,ss_list_price#33] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#34)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
                        :                    :     +- Sort [d_date_sk#35 ASC NULLS FIRST], false, 0
                        :                    :        +- Exchange hashpartitioning(d_date_sk#35, 100), ENSURE_REQUIREMENTS, [plan_id=140]
                        :                    :           +- Project [d_date_sk#35]
                        :                    :              +- Filter (((isnotnull(d_year#51) AND (d_year#51 >= 1999)) AND (d_year#51 <= 2001)) AND isnotnull(d_date_sk#35))
                        :                    :                 +- FileScan parquet [d_date_sk#35,d_year#51] Batched: true, DataFilters: [isnotnull(d_year#51), (d_year#51 >= 1999), (d_year#51 <= 2001), isnotnull(d_date_sk#52..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                        :                    :- Project [cs_quantity#37 AS quantity#38, cs_list_price#39 AS list_price#40]
                        :                    :  +- SortMergeJoin [cs_sold_date_sk#41], [d_date_sk#42], Inner
                        :                    :     :- Sort [cs_sold_date_sk#41 ASC NULLS FIRST], false, 0
                        :                    :     :  +- Exchange hashpartitioning(cs_sold_date_sk#41, 100), ENSURE_REQUIREMENTS, [plan_id=141]
                        :                    :     :     +- Filter isnotnull(cs_sold_date_sk#41)
                        :                    :     :        +- FileScan parquet [cs_sold_date_sk#41,cs_quantity#37,cs_list_price#39] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#41)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>
                        :                    :     +- Sort [d_date_sk#42 ASC NULLS FIRST], false, 0
                        :                    :        +- Exchange hashpartitioning(d_date_sk#42, 100), ENSURE_REQUIREMENTS, [plan_id=142]
                        :                    :           +- Project [d_date_sk#42]
                        :                    :              +- Filter (((isnotnull(d_year#53) AND (d_year#53 >= 1999)) AND (d_year#53 <= 2001)) AND isnotnull(d_date_sk#42))
                        :                    :                 +- FileScan parquet [d_date_sk#42,d_year#53] Batched: true, DataFilters: [isnotnull(d_year#53), (d_year#53 >= 1999), (d_year#53 <= 2001), isnotnull(d_date_sk#52..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                        :                    +- Project [ws_quantity#43 AS quantity#44, ws_list_price#45 AS list_price#46]
                        :                       +- SortMergeJoin [ws_sold_date_sk#47], [d_date_sk#48], Inner
                        :                          :- Sort [ws_sold_date_sk#47 ASC NULLS FIRST], false, 0
                        :                          :  +- Exchange hashpartitioning(ws_sold_date_sk#47, 100), ENSURE_REQUIREMENTS, [plan_id=143]
                        :                          :     +- Filter isnotnull(ws_sold_date_sk#47)
                        :                          :        +- FileScan parquet [ws_sold_date_sk#47,ws_quantity#43,ws_list_price#45] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#47)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
                        :                          +- Sort [d_date_sk#48 ASC NULLS FIRST], false, 0
                        :                             +- Exchange hashpartitioning(d_date_sk#48, 100), ENSURE_REQUIREMENTS, [plan_id=144]
                        :                                +- Project [d_date_sk#48]
                        :                                   +- Filter (((isnotnull(d_year#54) AND (d_year#54 >= 1999)) AND (d_year#54 <= 2001)) AND isnotnull(d_date_sk#48))
                        :                                      +- FileScan parquet [d_date_sk#48,d_year#54] Batched: true, DataFilters: [isnotnull(d_year#54), (d_year#54 >= 1999), (d_year#54 <= 2001), isnotnull(d_date_sk#55..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                        +- HashAggregate(keys=[i_brand_id#122, i_class_id#123, i_category_id#124], functions=[sum((cast(ws_quantity#125 as decimal(10,0)) * ws_list_price#126)), count(1)], output=[i_brand_id#122, i_class_id#123, i_category_id#124, sales#119, number_sales#120])
                           +- Exchange hashpartitioning(i_brand_id#122, i_class_id#123, i_category_id#124, 100), ENSURE_REQUIREMENTS, [plan_id=145]
                              +- HashAggregate(keys=[i_brand_id#122, i_class_id#123, i_category_id#124], functions=[partial_sum((cast(ws_quantity#125 as decimal(10,0)) * ws_list_price#126)), partial_count(1)], output=[i_brand_id#122, i_class_id#123, i_category_id#124, sum#185, isEmpty#186, count#187])
                                 +- Project [ws_quantity#125, ws_list_price#126, i_brand_id#122, i_class_id#123, i_category_id#124]
                                    +- SortMergeJoin [ws_sold_date_sk#133], [d_date_sk#134], Inner
                                       :- Sort [ws_sold_date_sk#133 ASC NULLS FIRST], false, 0
                                       :  +- Exchange hashpartitioning(ws_sold_date_sk#133, 100), ENSURE_REQUIREMENTS, [plan_id=146]
                                       :     +- Project [ws_sold_date_sk#133, ws_quantity#125, ws_list_price#126, i_brand_id#122, i_class_id#123, i_category_id#124]
                                       :        +- SortMergeJoin [ws_item_sk#135], [i_item_sk#136], Inner
                                       :           :- SortMergeJoin [ws_item_sk#135], [ss_item_sk#137], LeftSemi
                                       :           :  :- Sort [ws_item_sk#135 ASC NULLS FIRST], false, 0
                                       :           :  :  +- Exchange hashpartitioning(ws_item_sk#135, 100), ENSURE_REQUIREMENTS, [plan_id=147]
                                       :           :  :     +- Filter (isnotnull(ws_item_sk#135) AND isnotnull(ws_sold_date_sk#133))
                                       :           :  :        +- FileScan parquet [ws_sold_date_sk#133,ws_item_sk#135,ws_quantity#125,ws_list_price#126] Batched: true, DataFilters: [isnotnull(ws_item_sk#135), isnotnull(ws_sold_date_sk#133)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
                                       :           :  +- Sort [ss_item_sk#137 ASC NULLS FIRST], false, 0
                                       :           :     +- Exchange hashpartitioning(ss_item_sk#137, 100), ENSURE_REQUIREMENTS, [plan_id=148]
                                       :           :        +- Project [i_item_sk#188 AS ss_item_sk#137]
                                       :           :           +- SortMergeJoin [i_brand_id#189, i_class_id#190, i_category_id#191], [brand_id#73, class_id#74, category_id#75], Inner
                                       :           :              :- Sort [i_brand_id#189 ASC NULLS FIRST, i_class_id#190 ASC NULLS FIRST, i_category_id#191 ASC NULLS FIRST], false, 0
                                       :           :              :  +- Exchange hashpartitioning(i_brand_id#189, i_class_id#190, i_category_id#191, 100), ENSURE_REQUIREMENTS, [plan_id=149]
                                       :           :              :     +- Filter ((isnotnull(i_brand_id#189) AND isnotnull(i_class_id#190)) AND isnotnull(i_category_id#191))
                                       :           :              :        +- FileScan parquet [i_item_sk#188,i_brand_id#189,i_class_id#190,i_category_id#191] Batched: true, DataFilters: [isnotnull(i_brand_id#189), isnotnull(i_class_id#190), isnotnull(i_category_id#191)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                                       :           :              +- Sort [brand_id#73 ASC NULLS FIRST, class_id#74 ASC NULLS FIRST, category_id#75 ASC NULLS FIRST], false, 0
                                       :           :                 +- Exchange hashpartitioning(brand_id#73, class_id#74, category_id#75, 100), ENSURE_REQUIREMENTS, [plan_id=150]
                                       :           :                    +- SortMergeJoin [coalesce(brand_id#73, 0), isnull(brand_id#73), coalesce(class_id#74, 0), isnull(class_id#74), coalesce(category_id#75, 0), isnull(category_id#75)], [coalesce(i_brand_id#192, 0), isnull(i_brand_id#192), coalesce(i_class_id#193, 0), isnull(i_class_id#193), coalesce(i_category_id#194, 0), isnull(i_category_id#194)], LeftSemi
                                       :           :                       :- Sort [coalesce(brand_id#73, 0) ASC NULLS FIRST, isnull(brand_id#73) ASC NULLS FIRST, coalesce(class_id#74, 0) ASC NULLS FIRST, isnull(class_id#74) ASC NULLS FIRST, coalesce(category_id#75, 0) ASC NULLS FIRST, isnull(category_id#75) ASC NULLS FIRST], false, 0
                                       :           :                       :  +- Exchange hashpartitioning(coalesce(brand_id#73, 0), isnull(brand_id#73), coalesce(class_id#74, 0), isnull(class_id#74), coalesce(category_id#75, 0), isnull(category_id#75), 100), ENSURE_REQUIREMENTS, [plan_id=151]
                                       :           :                       :     +- HashAggregate(keys=[brand_id#73, class_id#74, category_id#75], functions=[], output=[brand_id#73, class_id#74, category_id#75])
                                       :           :                       :        +- Exchange hashpartitioning(brand_id#73, class_id#74, category_id#75, 100), ENSURE_REQUIREMENTS, [plan_id=152]
                                       :           :                       :           +- HashAggregate(keys=[brand_id#73, class_id#74, category_id#75], functions=[], output=[brand_id#73, class_id#74, category_id#75])
                                       :           :                       :              +- Project [i_brand_id#195 AS brand_id#73, i_class_id#196 AS class_id#74, i_category_id#197 AS category_id#75]
                                       :           :                       :                 +- SortMergeJoin [ss_sold_date_sk#198], [d_date_sk#199], Inner
                                       :           :                       :                    :- Sort [ss_sold_date_sk#198 ASC NULLS FIRST], false, 0
                                       :           :                       :                    :  +- Exchange hashpartitioning(ss_sold_date_sk#198, 100), ENSURE_REQUIREMENTS, [plan_id=153]
                                       :           :                       :                    :     +- Project [ss_sold_date_sk#198, i_brand_id#195, i_class_id#196, i_category_id#197]
                                       :           :                       :                    :        +- SortMergeJoin [ss_item_sk#200], [i_item_sk#201], Inner
                                       :           :                       :                    :           :- Sort [ss_item_sk#200 ASC NULLS FIRST], false, 0
                                       :           :                       :                    :           :  +- Exchange hashpartitioning(ss_item_sk#200, 100), ENSURE_REQUIREMENTS, [plan_id=154]
                                       :           :                       :                    :           :     +- Filter (isnotnull(ss_item_sk#200) AND isnotnull(ss_sold_date_sk#198))
                                       :           :                       :                    :           :        +- FileScan parquet [ss_sold_date_sk#198,ss_item_sk#200] Batched: true, DataFilters: [isnotnull(ss_item_sk#200), isnotnull(ss_sold_date_sk#198)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
                                       :           :                       :                    :           +- Sort [i_item_sk#201 ASC NULLS FIRST], false, 0
                                       :           :                       :                    :              +- Exchange hashpartitioning(i_item_sk#201, 100), ENSURE_REQUIREMENTS, [plan_id=155]
                                       :           :                       :                    :                 +- SortMergeJoin [coalesce(i_brand_id#195, 0), isnull(i_brand_id#195), coalesce(i_class_id#196, 0), isnull(i_class_id#196), coalesce(i_category_id#197, 0), isnull(i_category_id#197)], [coalesce(i_brand_id#202, 0), isnull(i_brand_id#202), coalesce(i_class_id#203, 0), isnull(i_class_id#203), coalesce(i_category_id#204, 0), isnull(i_category_id#204)], LeftSemi
                                       :           :                       :                    :                    :- Sort [coalesce(i_brand_id#195, 0) ASC NULLS FIRST, isnull(i_brand_id#195) ASC NULLS FIRST, coalesce(i_class_id#196, 0) ASC NULLS FIRST, isnull(i_class_id#196) ASC NULLS FIRST, coalesce(i_category_id#197, 0) ASC NULLS FIRST, isnull(i_category_id#197) ASC NULLS FIRST], false, 0
                                       :           :                       :                    :                    :  +- Exchange hashpartitioning(coalesce(i_brand_id#195, 0), isnull(i_brand_id#195), coalesce(i_class_id#196, 0), isnull(i_class_id#196), coalesce(i_category_id#197, 0), isnull(i_category_id#197), 100), ENSURE_REQUIREMENTS, [plan_id=156]
                                       :           :                       :                    :                    :     +- Filter (((isnotnull(i_item_sk#201) AND isnotnull(i_brand_id#195)) AND isnotnull(i_class_id#196)) AND isnotnull(i_category_id#197))
                                       :           :                       :                    :                    :        +- FileScan parquet [i_item_sk#201,i_brand_id#195,i_class_id#196,i_category_id#197] Batched: true, DataFilters: [isnotnull(i_item_sk#201), isnotnull(i_brand_id#195), isnotnull(i_class_id#196), isnotnull(..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                                       :           :                       :                    :                    +- Sort [coalesce(i_brand_id#202, 0) ASC NULLS FIRST, isnull(i_brand_id#202) ASC NULLS FIRST, coalesce(i_class_id#203, 0) ASC NULLS FIRST, isnull(i_class_id#203) ASC NULLS FIRST, coalesce(i_category_id#204, 0) ASC NULLS FIRST, isnull(i_category_id#204) ASC NULLS FIRST], false, 0
                                       :           :                       :                    :                       +- Exchange hashpartitioning(coalesce(i_brand_id#202, 0), isnull(i_brand_id#202), coalesce(i_class_id#203, 0), isnull(i_class_id#203), coalesce(i_category_id#204, 0), isnull(i_category_id#204), 100), ENSURE_REQUIREMENTS, [plan_id=157]
                                       :           :                       :                    :                          +- Project [i_brand_id#202, i_class_id#203, i_category_id#204]
                                       :           :                       :                    :                             +- SortMergeJoin [cs_sold_date_sk#205], [d_date_sk#206], Inner
                                       :           :                       :                    :                                :- Sort [cs_sold_date_sk#205 ASC NULLS FIRST], false, 0
                                       :           :                       :                    :                                :  +- Exchange hashpartitioning(cs_sold_date_sk#205, 100), ENSURE_REQUIREMENTS, [plan_id=158]
                                       :           :                       :                    :                                :     +- Project [cs_sold_date_sk#205, i_brand_id#202, i_class_id#203, i_category_id#204]
                                       :           :                       :                    :                                :        +- SortMergeJoin [cs_item_sk#207], [i_item_sk#208], Inner
                                       :           :                       :                    :                                :           :- Sort [cs_item_sk#207 ASC NULLS FIRST], false, 0
                                       :           :                       :                    :                                :           :  +- Exchange hashpartitioning(cs_item_sk#207, 100), ENSURE_REQUIREMENTS, [plan_id=159]
                                       :           :                       :                    :                                :           :     +- Filter (isnotnull(cs_item_sk#207) AND isnotnull(cs_sold_date_sk#205))
                                       :           :                       :                    :                                :           :        +- FileScan parquet [cs_sold_date_sk#205,cs_item_sk#207] Batched: true, DataFilters: [isnotnull(cs_item_sk#207), isnotnull(cs_sold_date_sk#205)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int>
                                       :           :                       :                    :                                :           +- Sort [i_item_sk#208 ASC NULLS FIRST], false, 0
                                       :           :                       :                    :                                :              +- Exchange hashpartitioning(i_item_sk#208, 100), ENSURE_REQUIREMENTS, [plan_id=160]
                                       :           :                       :                    :                                :                 +- Filter isnotnull(i_item_sk#208)
                                       :           :                       :                    :                                :                    +- FileScan parquet [i_item_sk#208,i_brand_id#202,i_class_id#203,i_category_id#204] Batched: true, DataFilters: [isnotnull(i_item_sk#208)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                                       :           :                       :                    :                                +- Sort [d_date_sk#206 ASC NULLS FIRST], false, 0
                                       :           :                       :                    :                                   +- Exchange hashpartitioning(d_date_sk#206, 100), ENSURE_REQUIREMENTS, [plan_id=161]
                                       :           :                       :                    :                                      +- Project [d_date_sk#206]
                                       :           :                       :                    :                                         +- Filter (((isnotnull(d_year#209) AND (d_year#209 >= 1999)) AND (d_year#209 <= 2001)) AND isnotnull(d_date_sk#206))
                                       :           :                       :                    :                                            +- FileScan parquet [d_date_sk#206,d_year#209] Batched: true, DataFilters: [isnotnull(d_year#209), (d_year#209 >= 1999), (d_year#209 <= 2001), isnotnull(d_date_sk#210..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                       :           :                       :                    +- Sort [d_date_sk#199 ASC NULLS FIRST], false, 0
                                       :           :                       :                       +- Exchange hashpartitioning(d_date_sk#199, 100), ENSURE_REQUIREMENTS, [plan_id=162]
                                       :           :                       :                          +- Project [d_date_sk#199]
                                       :           :                       :                             +- Filter (((isnotnull(d_year#211) AND (d_year#211 >= 1999)) AND (d_year#211 <= 2001)) AND isnotnull(d_date_sk#199))
                                       :           :                       :                                +- FileScan parquet [d_date_sk#199,d_year#211] Batched: true, DataFilters: [isnotnull(d_year#211), (d_year#211 >= 1999), (d_year#211 <= 2001), isnotnull(d_date_sk#212..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                       :           :                       +- Sort [coalesce(i_brand_id#192, 0) ASC NULLS FIRST, isnull(i_brand_id#192) ASC NULLS FIRST, coalesce(i_class_id#193, 0) ASC NULLS FIRST, isnull(i_class_id#193) ASC NULLS FIRST, coalesce(i_category_id#194, 0) ASC NULLS FIRST, isnull(i_category_id#194) ASC NULLS FIRST], false, 0
                                       :           :                          +- Exchange hashpartitioning(coalesce(i_brand_id#192, 0), isnull(i_brand_id#192), coalesce(i_class_id#193, 0), isnull(i_class_id#193), coalesce(i_category_id#194, 0), isnull(i_category_id#194), 100), ENSURE_REQUIREMENTS, [plan_id=163]
                                       :           :                             +- Project [i_brand_id#192, i_class_id#193, i_category_id#194]
                                       :           :                                +- SortMergeJoin [ws_sold_date_sk#213], [d_date_sk#214], Inner
                                       :           :                                   :- Sort [ws_sold_date_sk#213 ASC NULLS FIRST], false, 0
                                       :           :                                   :  +- Exchange hashpartitioning(ws_sold_date_sk#213, 100), ENSURE_REQUIREMENTS, [plan_id=164]
                                       :           :                                   :     +- Project [ws_sold_date_sk#213, i_brand_id#192, i_class_id#193, i_category_id#194]
                                       :           :                                   :        +- SortMergeJoin [ws_item_sk#215], [i_item_sk#216], Inner
                                       :           :                                   :           :- Sort [ws_item_sk#215 ASC NULLS FIRST], false, 0
                                       :           :                                   :           :  +- Exchange hashpartitioning(ws_item_sk#215, 100), ENSURE_REQUIREMENTS, [plan_id=165]
                                       :           :                                   :           :     +- Filter (isnotnull(ws_item_sk#215) AND isnotnull(ws_sold_date_sk#213))
                                       :           :                                   :           :        +- FileScan parquet [ws_sold_date_sk#213,ws_item_sk#215] Batched: true, DataFilters: [isnotnull(ws_item_sk#215), isnotnull(ws_sold_date_sk#213)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int>
                                       :           :                                   :           +- Sort [i_item_sk#216 ASC NULLS FIRST], false, 0
                                       :           :                                   :              +- Exchange hashpartitioning(i_item_sk#216, 100), ENSURE_REQUIREMENTS, [plan_id=166]
                                       :           :                                   :                 +- Filter isnotnull(i_item_sk#216)
                                       :           :                                   :                    +- FileScan parquet [i_item_sk#216,i_brand_id#192,i_class_id#193,i_category_id#194] Batched: true, DataFilters: [isnotnull(i_item_sk#216)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                                       :           :                                   +- Sort [d_date_sk#214 ASC NULLS FIRST], false, 0
                                       :           :                                      +- Exchange hashpartitioning(d_date_sk#214, 100), ENSURE_REQUIREMENTS, [plan_id=167]
                                       :           :                                         +- Project [d_date_sk#214]
                                       :           :                                            +- Filter (((isnotnull(d_year#217) AND (d_year#217 >= 1999)) AND (d_year#217 <= 2001)) AND isnotnull(d_date_sk#214))
                                       :           :                                               +- FileScan parquet [d_date_sk#214,d_year#217] Batched: true, DataFilters: [isnotnull(d_year#217), (d_year#217 >= 1999), (d_year#217 <= 2001), isnotnull(d_date_sk#218..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                       :           +- SortMergeJoin [i_item_sk#136], [ss_item_sk#137], LeftSemi
                                       :              :- Sort [i_item_sk#136 ASC NULLS FIRST], false, 0
                                       :              :  +- Exchange hashpartitioning(i_item_sk#136, 100), ENSURE_REQUIREMENTS, [plan_id=168]
                                       :              :     +- Filter isnotnull(i_item_sk#136)
                                       :              :        +- FileScan parquet [i_item_sk#136,i_brand_id#122,i_class_id#123,i_category_id#124] Batched: true, DataFilters: [isnotnull(i_item_sk#136)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                                       :              +- Sort [ss_item_sk#137 ASC NULLS FIRST], false, 0
                                       :                 +- Exchange hashpartitioning(ss_item_sk#137, 100), ENSURE_REQUIREMENTS, [plan_id=169]
                                       :                    +- Project [i_item_sk#188 AS ss_item_sk#137]
                                       :                       +- SortMergeJoin [i_brand_id#189, i_class_id#190, i_category_id#191], [brand_id#73, class_id#74, category_id#75], Inner
                                       :                          :- Sort [i_brand_id#189 ASC NULLS FIRST, i_class_id#190 ASC NULLS FIRST, i_category_id#191 ASC NULLS FIRST], false, 0
                                       :                          :  +- Exchange hashpartitioning(i_brand_id#189, i_class_id#190, i_category_id#191, 100), ENSURE_REQUIREMENTS, [plan_id=170]
                                       :                          :     +- Filter ((isnotnull(i_brand_id#189) AND isnotnull(i_class_id#190)) AND isnotnull(i_category_id#191))
                                       :                          :        +- FileScan parquet [i_item_sk#188,i_brand_id#189,i_class_id#190,i_category_id#191] Batched: true, DataFilters: [isnotnull(i_brand_id#189), isnotnull(i_class_id#190), isnotnull(i_category_id#191)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                                       :                          +- Sort [brand_id#73 ASC NULLS FIRST, class_id#74 ASC NULLS FIRST, category_id#75 ASC NULLS FIRST], false, 0
                                       :                             +- Exchange hashpartitioning(brand_id#73, class_id#74, category_id#75, 100), ENSURE_REQUIREMENTS, [plan_id=171]
                                       :                                +- SortMergeJoin [coalesce(brand_id#73, 0), isnull(brand_id#73), coalesce(class_id#74, 0), isnull(class_id#74), coalesce(category_id#75, 0), isnull(category_id#75)], [coalesce(i_brand_id#192, 0), isnull(i_brand_id#192), coalesce(i_class_id#193, 0), isnull(i_class_id#193), coalesce(i_category_id#194, 0), isnull(i_category_id#194)], LeftSemi
                                       :                                   :- Sort [coalesce(brand_id#73, 0) ASC NULLS FIRST, isnull(brand_id#73) ASC NULLS FIRST, coalesce(class_id#74, 0) ASC NULLS FIRST, isnull(class_id#74) ASC NULLS FIRST, coalesce(category_id#75, 0) ASC NULLS FIRST, isnull(category_id#75) ASC NULLS FIRST], false, 0
                                       :                                   :  +- Exchange hashpartitioning(coalesce(brand_id#73, 0), isnull(brand_id#73), coalesce(class_id#74, 0), isnull(class_id#74), coalesce(category_id#75, 0), isnull(category_id#75), 100), ENSURE_REQUIREMENTS, [plan_id=172]
                                       :                                   :     +- HashAggregate(keys=[brand_id#73, class_id#74, category_id#75], functions=[], output=[brand_id#73, class_id#74, category_id#75])
                                       :                                   :        +- Exchange hashpartitioning(brand_id#73, class_id#74, category_id#75, 100), ENSURE_REQUIREMENTS, [plan_id=173]
                                       :                                   :           +- HashAggregate(keys=[brand_id#73, class_id#74, category_id#75], functions=[], output=[brand_id#73, class_id#74, category_id#75])
                                       :                                   :              +- Project [i_brand_id#195 AS brand_id#73, i_class_id#196 AS class_id#74, i_category_id#197 AS category_id#75]
                                       :                                   :                 +- SortMergeJoin [ss_sold_date_sk#198], [d_date_sk#199], Inner
                                       :                                   :                    :- Sort [ss_sold_date_sk#198 ASC NULLS FIRST], false, 0
                                       :                                   :                    :  +- Exchange hashpartitioning(ss_sold_date_sk#198, 100), ENSURE_REQUIREMENTS, [plan_id=174]
                                       :                                   :                    :     +- Project [ss_sold_date_sk#198, i_brand_id#195, i_class_id#196, i_category_id#197]
                                       :                                   :                    :        +- SortMergeJoin [ss_item_sk#200], [i_item_sk#201], Inner
                                       :                                   :                    :           :- Sort [ss_item_sk#200 ASC NULLS FIRST], false, 0
                                       :                                   :                    :           :  +- Exchange hashpartitioning(ss_item_sk#200, 100), ENSURE_REQUIREMENTS, [plan_id=175]
                                       :                                   :                    :           :     +- Filter (isnotnull(ss_item_sk#200) AND isnotnull(ss_sold_date_sk#198))
                                       :                                   :                    :           :        +- FileScan parquet [ss_sold_date_sk#198,ss_item_sk#200] Batched: true, DataFilters: [isnotnull(ss_item_sk#200), isnotnull(ss_sold_date_sk#198)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
                                       :                                   :                    :           +- Sort [i_item_sk#201 ASC NULLS FIRST], false, 0
                                       :                                   :                    :              +- Exchange hashpartitioning(i_item_sk#201, 100), ENSURE_REQUIREMENTS, [plan_id=176]
                                       :                                   :                    :                 +- SortMergeJoin [coalesce(i_brand_id#195, 0), isnull(i_brand_id#195), coalesce(i_class_id#196, 0), isnull(i_class_id#196), coalesce(i_category_id#197, 0), isnull(i_category_id#197)], [coalesce(i_brand_id#202, 0), isnull(i_brand_id#202), coalesce(i_class_id#203, 0), isnull(i_class_id#203), coalesce(i_category_id#204, 0), isnull(i_category_id#204)], LeftSemi
                                       :                                   :                    :                    :- Sort [coalesce(i_brand_id#195, 0) ASC NULLS FIRST, isnull(i_brand_id#195) ASC NULLS FIRST, coalesce(i_class_id#196, 0) ASC NULLS FIRST, isnull(i_class_id#196) ASC NULLS FIRST, coalesce(i_category_id#197, 0) ASC NULLS FIRST, isnull(i_category_id#197) ASC NULLS FIRST], false, 0
                                       :                                   :                    :                    :  +- Exchange hashpartitioning(coalesce(i_brand_id#195, 0), isnull(i_brand_id#195), coalesce(i_class_id#196, 0), isnull(i_class_id#196), coalesce(i_category_id#197, 0), isnull(i_category_id#197), 100), ENSURE_REQUIREMENTS, [plan_id=177]
                                       :                                   :                    :                    :     +- Filter (((isnotnull(i_item_sk#201) AND isnotnull(i_brand_id#195)) AND isnotnull(i_class_id#196)) AND isnotnull(i_category_id#197))
                                       :                                   :                    :                    :        +- FileScan parquet [i_item_sk#201,i_brand_id#195,i_class_id#196,i_category_id#197] Batched: true, DataFilters: [isnotnull(i_item_sk#201), isnotnull(i_brand_id#195), isnotnull(i_class_id#196), isnotnull(..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                                       :                                   :                    :                    +- Sort [coalesce(i_brand_id#202, 0) ASC NULLS FIRST, isnull(i_brand_id#202) ASC NULLS FIRST, coalesce(i_class_id#203, 0) ASC NULLS FIRST, isnull(i_class_id#203) ASC NULLS FIRST, coalesce(i_category_id#204, 0) ASC NULLS FIRST, isnull(i_category_id#204) ASC NULLS FIRST], false, 0
                                       :                                   :                    :                       +- Exchange hashpartitioning(coalesce(i_brand_id#202, 0), isnull(i_brand_id#202), coalesce(i_class_id#203, 0), isnull(i_class_id#203), coalesce(i_category_id#204, 0), isnull(i_category_id#204), 100), ENSURE_REQUIREMENTS, [plan_id=178]
                                       :                                   :                    :                          +- Project [i_brand_id#202, i_class_id#203, i_category_id#204]
                                       :                                   :                    :                             +- SortMergeJoin [cs_sold_date_sk#205], [d_date_sk#206], Inner
                                       :                                   :                    :                                :- Sort [cs_sold_date_sk#205 ASC NULLS FIRST], false, 0
                                       :                                   :                    :                                :  +- Exchange hashpartitioning(cs_sold_date_sk#205, 100), ENSURE_REQUIREMENTS, [plan_id=179]
                                       :                                   :                    :                                :     +- Project [cs_sold_date_sk#205, i_brand_id#202, i_class_id#203, i_category_id#204]
                                       :                                   :                    :                                :        +- SortMergeJoin [cs_item_sk#207], [i_item_sk#208], Inner
                                       :                                   :                    :                                :           :- Sort [cs_item_sk#207 ASC NULLS FIRST], false, 0
                                       :                                   :                    :                                :           :  +- Exchange hashpartitioning(cs_item_sk#207, 100), ENSURE_REQUIREMENTS, [plan_id=180]
                                       :                                   :                    :                                :           :     +- Filter (isnotnull(cs_item_sk#207) AND isnotnull(cs_sold_date_sk#205))
                                       :                                   :                    :                                :           :        +- FileScan parquet [cs_sold_date_sk#205,cs_item_sk#207] Batched: true, DataFilters: [isnotnull(cs_item_sk#207), isnotnull(cs_sold_date_sk#205)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int>
                                       :                                   :                    :                                :           +- Sort [i_item_sk#208 ASC NULLS FIRST], false, 0
                                       :                                   :                    :                                :              +- Exchange hashpartitioning(i_item_sk#208, 100), ENSURE_REQUIREMENTS, [plan_id=181]
                                       :                                   :                    :                                :                 +- Filter isnotnull(i_item_sk#208)
                                       :                                   :                    :                                :                    +- FileScan parquet [i_item_sk#208,i_brand_id#202,i_class_id#203,i_category_id#204] Batched: true, DataFilters: [isnotnull(i_item_sk#208)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                                       :                                   :                    :                                +- Sort [d_date_sk#206 ASC NULLS FIRST], false, 0
                                       :                                   :                    :                                   +- Exchange hashpartitioning(d_date_sk#206, 100), ENSURE_REQUIREMENTS, [plan_id=182]
                                       :                                   :                    :                                      +- Project [d_date_sk#206]
                                       :                                   :                    :                                         +- Filter (((isnotnull(d_year#209) AND (d_year#209 >= 1999)) AND (d_year#209 <= 2001)) AND isnotnull(d_date_sk#206))
                                       :                                   :                    :                                            +- FileScan parquet [d_date_sk#206,d_year#209] Batched: true, DataFilters: [isnotnull(d_year#209), (d_year#209 >= 1999), (d_year#209 <= 2001), isnotnull(d_date_sk#210..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                       :                                   :                    +- Sort [d_date_sk#199 ASC NULLS FIRST], false, 0
                                       :                                   :                       +- Exchange hashpartitioning(d_date_sk#199, 100), ENSURE_REQUIREMENTS, [plan_id=183]
                                       :                                   :                          +- Project [d_date_sk#199]
                                       :                                   :                             +- Filter (((isnotnull(d_year#211) AND (d_year#211 >= 1999)) AND (d_year#211 <= 2001)) AND isnotnull(d_date_sk#199))
                                       :                                   :                                +- FileScan parquet [d_date_sk#199,d_year#211] Batched: true, DataFilters: [isnotnull(d_year#211), (d_year#211 >= 1999), (d_year#211 <= 2001), isnotnull(d_date_sk#212..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                       :                                   +- Sort [coalesce(i_brand_id#192, 0) ASC NULLS FIRST, isnull(i_brand_id#192) ASC NULLS FIRST, coalesce(i_class_id#193, 0) ASC NULLS FIRST, isnull(i_class_id#193) ASC NULLS FIRST, coalesce(i_category_id#194, 0) ASC NULLS FIRST, isnull(i_category_id#194) ASC NULLS FIRST], false, 0
                                       :                                      +- Exchange hashpartitioning(coalesce(i_brand_id#192, 0), isnull(i_brand_id#192), coalesce(i_class_id#193, 0), isnull(i_class_id#193), coalesce(i_category_id#194, 0), isnull(i_category_id#194), 100), ENSURE_REQUIREMENTS, [plan_id=184]
                                       :                                         +- Project [i_brand_id#192, i_class_id#193, i_category_id#194]
                                       :                                            +- SortMergeJoin [ws_sold_date_sk#213], [d_date_sk#214], Inner
                                       :                                               :- Sort [ws_sold_date_sk#213 ASC NULLS FIRST], false, 0
                                       :                                               :  +- Exchange hashpartitioning(ws_sold_date_sk#213, 100), ENSURE_REQUIREMENTS, [plan_id=185]
                                       :                                               :     +- Project [ws_sold_date_sk#213, i_brand_id#192, i_class_id#193, i_category_id#194]
                                       :                                               :        +- SortMergeJoin [ws_item_sk#215], [i_item_sk#216], Inner
                                       :                                               :           :- Sort [ws_item_sk#215 ASC NULLS FIRST], false, 0
                                       :                                               :           :  +- Exchange hashpartitioning(ws_item_sk#215, 100), ENSURE_REQUIREMENTS, [plan_id=186]
                                       :                                               :           :     +- Filter (isnotnull(ws_item_sk#215) AND isnotnull(ws_sold_date_sk#213))
                                       :                                               :           :        +- FileScan parquet [ws_sold_date_sk#213,ws_item_sk#215] Batched: true, DataFilters: [isnotnull(ws_item_sk#215), isnotnull(ws_sold_date_sk#213)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int>
                                       :                                               :           +- Sort [i_item_sk#216 ASC NULLS FIRST], false, 0
                                       :                                               :              +- Exchange hashpartitioning(i_item_sk#216, 100), ENSURE_REQUIREMENTS, [plan_id=187]
                                       :                                               :                 +- Filter isnotnull(i_item_sk#216)
                                       :                                               :                    +- FileScan parquet [i_item_sk#216,i_brand_id#192,i_class_id#193,i_category_id#194] Batched: true, DataFilters: [isnotnull(i_item_sk#216)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                                       :                                               +- Sort [d_date_sk#214 ASC NULLS FIRST], false, 0
                                       :                                                  +- Exchange hashpartitioning(d_date_sk#214, 100), ENSURE_REQUIREMENTS, [plan_id=188]
                                       :                                                     +- Project [d_date_sk#214]
                                       :                                                        +- Filter (((isnotnull(d_year#217) AND (d_year#217 >= 1999)) AND (d_year#217 <= 2001)) AND isnotnull(d_date_sk#214))
                                       :                                                           +- FileScan parquet [d_date_sk#214,d_year#217] Batched: true, DataFilters: [isnotnull(d_year#217), (d_year#217 >= 1999), (d_year#217 <= 2001), isnotnull(d_date_sk#218..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                       +- Sort [d_date_sk#134 ASC NULLS FIRST], false, 0
                                          +- Exchange hashpartitioning(d_date_sk#134, 100), ENSURE_REQUIREMENTS, [plan_id=189]
                                             +- Project [d_date_sk#134]
                                                +- Filter ((((isnotnull(d_year#219) AND isnotnull(d_moy#220)) AND (d_year#219 = 2001)) AND (d_moy#220 = 11)) AND isnotnull(d_date_sk#134))
                                                   +- FileScan parquet [d_date_sk#134,d_year#219,d_moy#220] Batched: true, DataFilters: [isnotnull(d_year#219), isnotnull(d_moy#220), (d_year#219 = 2001), (d_moy#220 = 11), isno..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/<warehouse_dir>], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), EqualTo(d_year,2001), EqualTo(d_moy,11), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_moy:int>
