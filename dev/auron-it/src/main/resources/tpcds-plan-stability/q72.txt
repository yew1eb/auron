== Physical Plan ==
AdaptiveSparkPlan (248)
+- == Final Plan ==
   NativeTakeOrdered (158)
   +- NativeProject (157)
      +- NativeHashAggregate (156)
         +- InputAdapter (155)
            +- AQEShuffleRead (154)
               +- ShuffleQueryStage (153), Statistics(sizeInBytes=262.1 KiB, rowCount=2.06E+3)
                  +- NativeShuffleExchange (152)
                     +- NativeHashAggregate (151)
                        +- NativeProject (150)
                           +- NativeSortMergeJoin LeftOuter (149)
                              :- NativeSort (140)
                              :  +- InputAdapter (139)
                              :     +- AQEShuffleRead (138)
                              :        +- ShuffleQueryStage (137), Statistics(sizeInBytes=268.2 KiB, rowCount=2.08E+3)
                              :           +- NativeShuffleExchange (136)
                              :              +- NativeProject (135)
                              :                 +- NativeSortMergeJoin LeftOuter (134)
                              :                    :- NativeSort (125)
                              :                    :  +- InputAdapter (124)
                              :                    :     +- AQEShuffleRead (123)
                              :                    :        +- ShuffleQueryStage (122), Statistics(sizeInBytes=276.7 KiB, rowCount=2.08E+3)
                              :                    :           +- NativeShuffleExchange (121)
                              :                    :              +- ConvertToNative (120)
                              :                    :                 +- * Project (119)
                              :                    :                    +- * SortMergeJoin Inner (118)
                              :                    :                       :- NativeSort (109)
                              :                    :                       :  +- InputAdapter (108)
                              :                    :                       :     +- AQEShuffleRead (107)
                              :                    :                       :        +- ShuffleQueryStage (106), Statistics(sizeInBytes=309.3 KiB, rowCount=2.17E+3)
                              :                    :                       :           +- NativeShuffleExchange (105)
                              :                    :                       :              +- NativeProject (104)
                              :                    :                       :                 +- NativeSortMergeJoin Inner (103)
                              :                    :                       :                    :- NativeSort (94)
                              :                    :                       :                    :  +- InputAdapter (93)
                              :                    :                       :                    :     +- AQEShuffleRead (92)
                              :                    :                       :                    :        +- ShuffleQueryStage (91), Statistics(sizeInBytes=55.2 MiB, rowCount=3.85E+5)
                              :                    :                       :                    :           +- NativeShuffleExchange (90)
                              :                    :                       :                    :              +- NativeProject (89)
                              :                    :                       :                    :                 +- NativeSortMergeJoin Inner (88)
                              :                    :                       :                    :                    :- NativeSort (78)
                              :                    :                       :                    :                    :  +- InputAdapter (77)
                              :                    :                       :                    :                    :     +- AQEShuffleRead (76)
                              :                    :                       :                    :                    :        +- ShuffleQueryStage (75), Statistics(sizeInBytes=254.6 MiB, rowCount=1.82E+6)
                              :                    :                       :                    :                    :           +- NativeShuffleExchange (74)
                              :                    :                       :                    :                    :              +- NativeProject (73)
                              :                    :                       :                    :                    :                 +- NativeSortMergeJoin Inner (72)
                              :                    :                       :                    :                    :                    :- NativeSort (62)
                              :                    :                       :                    :                    :                    :  +- InputAdapter (61)
                              :                    :                       :                    :                    :                    :     +- AQEShuffleRead (60)
                              :                    :                       :                    :                    :                    :        +- ShuffleQueryStage (59), Statistics(sizeInBytes=1614.5 MiB, rowCount=1.12E+7)
                              :                    :                       :                    :                    :                    :           +- NativeShuffleExchange (58)
                              :                    :                       :                    :                    :                    :              +- NativeProject (57)
                              :                    :                       :                    :                    :                    :                 +- NativeSortMergeJoin Inner (56)
                              :                    :                       :                    :                    :                    :                    :- NativeSort (48)
                              :                    :                       :                    :                    :                    :                    :  +- ShuffleQueryStage (47), Statistics(sizeInBytes=8.0 GiB, rowCount=5.59E+7)
                              :                    :                       :                    :                    :                    :                    :     +- NativeShuffleExchange (46)
                              :                    :                       :                    :                    :                    :                    :        +- NativeProject (45)
                              :                    :                       :                    :                    :                    :                    :           +- NativeSortMergeJoin Inner (44)
                              :                    :                       :                    :                    :                    :                    :              :- NativeSort (37)
                              :                    :                       :                    :                    :                    :                    :              :  +- ShuffleQueryStage (36), Statistics(sizeInBytes=2.6 GiB, rowCount=5.59E+7)
                              :                    :                       :                    :                    :                    :                    :              :     +- NativeShuffleExchange (35)
                              :                    :                       :                    :                    :                    :                    :              :        +- NativeProject (34)
                              :                    :                       :                    :                    :                    :                    :              :           +- NativeSortMergeJoin Inner (33)
                              :                    :                       :                    :                    :                    :                    :              :              :- NativeSort (24)
                              :                    :                       :                    :                    :                    :                    :              :              :  +- InputAdapter (23)
                              :                    :                       :                    :                    :                    :                    :              :              :     +- AQEShuffleRead (22)
                              :                    :                       :                    :                    :                    :                    :              :              :        +- ShuffleQueryStage (21), Statistics(sizeInBytes=1928.3 MiB, rowCount=5.59E+7)
                              :                    :                       :                    :                    :                    :                    :              :              :           +- NativeShuffleExchange (20)
                              :                    :                       :                    :                    :                    :                    :              :              :              +- ConvertToNative (19)
                              :                    :                       :                    :                    :                    :                    :              :              :                 +- * Project (18)
                              :                    :                       :                    :                    :                    :                    :              :              :                    +- * SortMergeJoin Inner (17)
                              :                    :                       :                    :                    :                    :                    :              :              :                       :- NativeSort (8)
                              :                    :                       :                    :                    :                    :                    :              :              :                       :  +- InputAdapter (7)
                              :                    :                       :                    :                    :                    :                    :              :              :                       :     +- AQEShuffleRead (6)
                              :                    :                       :                    :                    :                    :                    :              :              :                       :        +- ShuffleQueryStage (5), Statistics(sizeInBytes=43.9 MiB, rowCount=1.43E+6)
                              :                    :                       :                    :                    :                    :                    :              :              :                       :           +- NativeShuffleExchange (4)
                              :                    :                       :                    :                    :                    :                    :              :              :                       :              +- NativeFilter (3)
                              :                    :                       :                    :                    :                    :                    :              :              :                       :                 +- InputAdapter (2)
                              :                    :                       :                    :                    :                    :                    :              :              :                       :                    +- NativeParquetScan  (1)
                              :                    :                       :                    :                    :                    :                    :              :              :                       +- NativeSort (16)
                              :                    :                       :                    :                    :                    :                    :              :              :                          +- InputAdapter (15)
                              :                    :                       :                    :                    :                    :                    :              :              :                             +- AQEShuffleRead (14)
                              :                    :                       :                    :                    :                    :                    :              :              :                                +- ShuffleQueryStage (13), Statistics(sizeInBytes=171.1 MiB, rowCount=1.12E+7)
                              :                    :                       :                    :                    :                    :                    :              :              :                                   +- NativeShuffleExchange (12)
                              :                    :                       :                    :                    :                    :                    :              :              :                                      +- NativeFilter (11)
                              :                    :                       :                    :                    :                    :                    :              :              :                                         +- InputAdapter (10)
                              :                    :                       :                    :                    :                    :                    :              :              :                                            +- NativeParquetScan  (9)
                              :                    :                       :                    :                    :                    :                    :              :              +- NativeSort (32)
                              :                    :                       :                    :                    :                    :                    :              :                 +- InputAdapter (31)
                              :                    :                       :                    :                    :                    :                    :              :                    +- AQEShuffleRead (30)
                              :                    :                       :                    :                    :                    :                    :              :                       +- ShuffleQueryStage (29), Statistics(sizeInBytes=530.0 B, rowCount=5)
                              :                    :                       :                    :                    :                    :                    :              :                          +- NativeShuffleExchange (28)
                              :                    :                       :                    :                    :                    :                    :              :                             +- NativeFilter (27)
                              :                    :                       :                    :                    :                    :                    :              :                                +- InputAdapter (26)
                              :                    :                       :                    :                    :                    :                    :              :                                   +- NativeParquetScan  (25)
                              :                    :                       :                    :                    :                    :                    :              +- NativeSort (43)
                              :                    :                       :                    :                    :                    :                    :                 +- ShuffleQueryStage (42), Statistics(sizeInBytes=2.4 MiB, rowCount=1.80E+4)
                              :                    :                       :                    :                    :                    :                    :                    +- NativeShuffleExchange (41)
                              :                    :                       :                    :                    :                    :                    :                       +- NativeFilter (40)
                              :                    :                       :                    :                    :                    :                    :                          +- InputAdapter (39)
                              :                    :                       :                    :                    :                    :                    :                             +- NativeParquetScan  (38)
                              :                    :                       :                    :                    :                    :                    +- NativeSort (55)
                              :                    :                       :                    :                    :                    :                       +- ShuffleQueryStage (54), Statistics(sizeInBytes=1508.7 KiB, rowCount=3.84E+5)
                              :                    :                       :                    :                    :                    :                          +- NativeShuffleExchange (53)
                              :                    :                       :                    :                    :                    :                             +- NativeProject (52)
                              :                    :                       :                    :                    :                    :                                +- NativeFilter (51)
                              :                    :                       :                    :                    :                    :                                   +- InputAdapter (50)
                              :                    :                       :                    :                    :                    :                                      +- NativeParquetScan  (49)
                              :                    :                       :                    :                    :                    +- NativeSort (71)
                              :                    :                       :                    :                    :                       +- InputAdapter (70)
                              :                    :                       :                    :                    :                          +- AQEShuffleRead (69)
                              :                    :                       :                    :                    :                             +- ShuffleQueryStage (68), Statistics(sizeInBytes=4.9 KiB, rowCount=1.20E+3)
                              :                    :                       :                    :                    :                                +- NativeShuffleExchange (67)
                              :                    :                       :                    :                    :                                   +- NativeProject (66)
                              :                    :                       :                    :                    :                                      +- NativeFilter (65)
                              :                    :                       :                    :                    :                                         +- InputAdapter (64)
                              :                    :                       :                    :                    :                                            +- NativeParquetScan  (63)
                              :                    :                       :                    :                    +- NativeSort (87)
                              :                    :                       :                    :                       +- InputAdapter (86)
                              :                    :                       :                    :                          +- AQEShuffleRead (85)
                              :                    :                       :                    :                             +- ShuffleQueryStage (84), Statistics(sizeInBytes=4.8 KiB, rowCount=365)
                              :                    :                       :                    :                                +- NativeShuffleExchange (83)
                              :                    :                       :                    :                                   +- NativeProject (82)
                              :                    :                       :                    :                                      +- NativeFilter (81)
                              :                    :                       :                    :                                         +- InputAdapter (80)
                              :                    :                       :                    :                                            +- NativeParquetScan  (79)
                              :                    :                       :                    +- NativeSort (102)
                              :                    :                       :                       +- InputAdapter (101)
                              :                    :                       :                          +- AQEShuffleRead (100)
                              :                    :                       :                             +- ShuffleQueryStage (99), Statistics(sizeInBytes=573.8 KiB, rowCount=7.30E+4)
                              :                    :                       :                                +- NativeShuffleExchange (98)
                              :                    :                       :                                   +- NativeFilter (97)
                              :                    :                       :                                      +- InputAdapter (96)
                              :                    :                       :                                         +- NativeParquetScan  (95)
                              :                    :                       +- NativeSort (117)
                              :                    :                          +- InputAdapter (116)
                              :                    :                             +- AQEShuffleRead (115)
                              :                    :                                +- ShuffleQueryStage (114), Statistics(sizeInBytes=573.8 KiB, rowCount=7.30E+4)
                              :                    :                                   +- NativeShuffleExchange (113)
                              :                    :                                      +- NativeFilter (112)
                              :                    :                                         +- InputAdapter (111)
                              :                    :                                            +- NativeParquetScan  (110)
                              :                    +- NativeSort (133)
                              :                       +- InputAdapter (132)
                              :                          +- AQEShuffleRead (131)
                              :                             +- ShuffleQueryStage (130), Statistics(sizeInBytes=1408.0 B, rowCount=300)
                              :                                +- NativeShuffleExchange (129)
                              :                                   +- NativeFilter (128)
                              :                                      +- InputAdapter (127)
                              :                                         +- NativeParquetScan  (126)
                              +- NativeSort (148)
                                 +- InputAdapter (147)
                                    +- AQEShuffleRead (146)
                                       +- ShuffleQueryStage (145), Statistics(sizeInBytes=1131.6 KiB, rowCount=1.44E+5)
                                          +- NativeShuffleExchange (144)
                                             +- NativeFilter (143)
                                                +- InputAdapter (142)
                                                   +- NativeParquetScan  (141)
+- == Initial Plan ==
   TakeOrderedAndProject (247)
   +- HashAggregate (246)
      +- Exchange (245)
         +- HashAggregate (244)
            +- Project (243)
               +- SortMergeJoin LeftOuter (242)
                  :- Sort (237)
                  :  +- Exchange (236)
                  :     +- Project (235)
                  :        +- SortMergeJoin LeftOuter (234)
                  :           :- Sort (229)
                  :           :  +- Exchange (228)
                  :           :     +- Project (227)
                  :           :        +- SortMergeJoin Inner (226)
                  :           :           :- Sort (221)
                  :           :           :  +- Exchange (220)
                  :           :           :     +- Project (219)
                  :           :           :        +- SortMergeJoin Inner (218)
                  :           :           :           :- Sort (213)
                  :           :           :           :  +- Exchange (212)
                  :           :           :           :     +- Project (211)
                  :           :           :           :        +- SortMergeJoin Inner (210)
                  :           :           :           :           :- Sort (204)
                  :           :           :           :           :  +- Exchange (203)
                  :           :           :           :           :     +- Project (202)
                  :           :           :           :           :        +- SortMergeJoin Inner (201)
                  :           :           :           :           :           :- Sort (195)
                  :           :           :           :           :           :  +- Exchange (194)
                  :           :           :           :           :           :     +- Project (193)
                  :           :           :           :           :           :        +- SortMergeJoin Inner (192)
                  :           :           :           :           :           :           :- Sort (186)
                  :           :           :           :           :           :           :  +- Exchange (185)
                  :           :           :           :           :           :           :     +- Project (184)
                  :           :           :           :           :           :           :        +- SortMergeJoin Inner (183)
                  :           :           :           :           :           :           :           :- Sort (178)
                  :           :           :           :           :           :           :           :  +- Exchange (177)
                  :           :           :           :           :           :           :           :     +- Project (176)
                  :           :           :           :           :           :           :           :        +- SortMergeJoin Inner (175)
                  :           :           :           :           :           :           :           :           :- Sort (170)
                  :           :           :           :           :           :           :           :           :  +- Exchange (169)
                  :           :           :           :           :           :           :           :           :     +- Project (168)
                  :           :           :           :           :           :           :           :           :        +- SortMergeJoin Inner (167)
                  :           :           :           :           :           :           :           :           :           :- Sort (162)
                  :           :           :           :           :           :           :           :           :           :  +- Exchange (161)
                  :           :           :           :           :           :           :           :           :           :     +- Filter (160)
                  :           :           :           :           :           :           :           :           :           :        +- Scan parquet  (159)
                  :           :           :           :           :           :           :           :           :           +- Sort (166)
                  :           :           :           :           :           :           :           :           :              +- Exchange (165)
                  :           :           :           :           :           :           :           :           :                 +- Filter (164)
                  :           :           :           :           :           :           :           :           :                    +- Scan parquet  (163)
                  :           :           :           :           :           :           :           :           +- Sort (174)
                  :           :           :           :           :           :           :           :              +- Exchange (173)
                  :           :           :           :           :           :           :           :                 +- Filter (172)
                  :           :           :           :           :           :           :           :                    +- Scan parquet  (171)
                  :           :           :           :           :           :           :           +- Sort (182)
                  :           :           :           :           :           :           :              +- Exchange (181)
                  :           :           :           :           :           :           :                 +- Filter (180)
                  :           :           :           :           :           :           :                    +- Scan parquet  (179)
                  :           :           :           :           :           :           +- Sort (191)
                  :           :           :           :           :           :              +- Exchange (190)
                  :           :           :           :           :           :                 +- Project (189)
                  :           :           :           :           :           :                    +- Filter (188)
                  :           :           :           :           :           :                       +- Scan parquet  (187)
                  :           :           :           :           :           +- Sort (200)
                  :           :           :           :           :              +- Exchange (199)
                  :           :           :           :           :                 +- Project (198)
                  :           :           :           :           :                    +- Filter (197)
                  :           :           :           :           :                       +- Scan parquet  (196)
                  :           :           :           :           +- Sort (209)
                  :           :           :           :              +- Exchange (208)
                  :           :           :           :                 +- Project (207)
                  :           :           :           :                    +- Filter (206)
                  :           :           :           :                       +- Scan parquet  (205)
                  :           :           :           +- Sort (217)
                  :           :           :              +- Exchange (216)
                  :           :           :                 +- Filter (215)
                  :           :           :                    +- Scan parquet  (214)
                  :           :           +- Sort (225)
                  :           :              +- Exchange (224)
                  :           :                 +- Filter (223)
                  :           :                    +- Scan parquet  (222)
                  :           +- Sort (233)
                  :              +- Exchange (232)
                  :                 +- Filter (231)
                  :                    +- Scan parquet  (230)
                  +- Sort (241)
                     +- Exchange (240)
                        +- Filter (239)
                           +- Scan parquet  (238)


(159) Scan parquet 
Output [8]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_bill_cdemo_sk#3, cs_bill_hdemo_sk#4, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, cs_quantity#8]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(cs_quantity), IsNotNull(cs_item_sk), IsNotNull(cs_bill_cdemo_sk), IsNotNull(cs_bill_hdemo_sk), IsNotNull(cs_sold_date_sk), IsNotNull(cs_ship_date_sk)]
ReadSchema: struct<cs_sold_date_sk:int,cs_ship_date_sk:int,cs_bill_cdemo_sk:int,cs_bill_hdemo_sk:int,cs_item_sk:int,cs_promo_sk:int,cs_order_number:int,cs_quantity:int>

(2) InputAdapter
Input [8]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_bill_cdemo_sk#3, cs_bill_hdemo_sk#4, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, cs_quantity#8]
Arguments: [#1, #2, #3, #4, #5, #6, #7, #8]

(3) NativeFilter
Input [8]: [#1#1, #2#2, #3#3, #4#4, #5#5, #6#6, #7#7, #8#8]
Condition : (((((isnotnull(cs_quantity#8) AND isnotnull(cs_item_sk#5)) AND isnotnull(cs_bill_cdemo_sk#3)) AND isnotnull(cs_bill_hdemo_sk#4)) AND isnotnull(cs_sold_date_sk#1)) AND isnotnull(cs_ship_date_sk#2))

(4) NativeShuffleExchange
Input [8]: [#1#1, #2#2, #3#3, #4#4, #5#5, #6#6, #7#7, #8#8]
Arguments: hashpartitioning(cs_item_sk#5, 5), ENSURE_REQUIREMENTS, [plan_id=1]

(5) ShuffleQueryStage
Output [8]: [#1#1, #2#2, #3#3, #4#4, #5#5, #6#6, #7#7, #8#8]
Arguments: X

(6) AQEShuffleRead
Input [8]: [#1#1, #2#2, #3#3, #4#4, #5#5, #6#6, #7#7, #8#8]
Arguments: coalesced

(7) InputAdapter
Input [8]: [#1#1, #2#2, #3#3, #4#4, #5#5, #6#6, #7#7, #8#8]

(8) NativeSort
Input [8]: [#1#1, #2#2, #3#3, #4#4, #5#5, #6#6, #7#7, #8#8]
Arguments: [cs_item_sk#5 ASC NULLS FIRST], false

(163) Scan parquet 
Output [4]: [inv_date_sk#9, inv_item_sk#10, inv_warehouse_sk#11, inv_quantity_on_hand#12]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(inv_quantity_on_hand), IsNotNull(inv_item_sk), IsNotNull(inv_warehouse_sk), IsNotNull(inv_date_sk)]
ReadSchema: struct<inv_date_sk:int,inv_item_sk:int,inv_warehouse_sk:int,inv_quantity_on_hand:int>

(10) InputAdapter
Input [4]: [inv_date_sk#9, inv_item_sk#10, inv_warehouse_sk#11, inv_quantity_on_hand#12]
Arguments: [#9, #10, #11, #12]

(11) NativeFilter
Input [4]: [#9#9, #10#10, #11#11, #12#12]
Condition : (((isnotnull(inv_quantity_on_hand#12) AND isnotnull(inv_item_sk#10)) AND isnotnull(inv_warehouse_sk#11)) AND isnotnull(inv_date_sk#9))

(12) NativeShuffleExchange
Input [4]: [#9#9, #10#10, #11#11, #12#12]
Arguments: hashpartitioning(inv_item_sk#10, 5), ENSURE_REQUIREMENTS, [plan_id=2]

(13) ShuffleQueryStage
Output [4]: [#9#9, #10#10, #11#11, #12#12]
Arguments: X

(14) AQEShuffleRead
Input [4]: [#9#9, #10#10, #11#11, #12#12]
Arguments: coalesced

(15) InputAdapter
Input [4]: [#9#9, #10#10, #11#11, #12#12]

(16) NativeSort
Input [4]: [#9#9, #10#10, #11#11, #12#12]
Arguments: [inv_item_sk#10 ASC NULLS FIRST], false

(17) SortMergeJoin [codegen id : 1]
Left keys [1]: [cs_item_sk#5]
Right keys [1]: [inv_item_sk#10]
Join type: Inner
Join condition: (inv_quantity_on_hand#12 < cs_quantity#8)

(18) Project [codegen id : 1]
Output [9]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_bill_cdemo_sk#3, cs_bill_hdemo_sk#4, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, inv_warehouse_sk#11]
Input [12]: [#1#1, #2#2, #3#3, #4#4, #5#5, #6#6, #7#7, #8#8, #9#9, #10#10, #11#11, #12#12]

(19) ConvertToNative
Input [9]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_bill_cdemo_sk#3, cs_bill_hdemo_sk#4, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, inv_warehouse_sk#11]

(20) NativeShuffleExchange
Input [9]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_bill_cdemo_sk#3, cs_bill_hdemo_sk#4, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, inv_warehouse_sk#11]
Arguments: hashpartitioning(inv_warehouse_sk#11, 5), ENSURE_REQUIREMENTS, [plan_id=3]

(21) ShuffleQueryStage
Output [9]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_bill_cdemo_sk#3, cs_bill_hdemo_sk#4, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, inv_warehouse_sk#11]
Arguments: X

(22) AQEShuffleRead
Input [9]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_bill_cdemo_sk#3, cs_bill_hdemo_sk#4, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, inv_warehouse_sk#11]
Arguments: coalesced

(23) InputAdapter
Input [9]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_bill_cdemo_sk#3, cs_bill_hdemo_sk#4, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, inv_warehouse_sk#11]

(24) NativeSort
Input [9]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_bill_cdemo_sk#3, cs_bill_hdemo_sk#4, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, inv_warehouse_sk#11]
Arguments: [inv_warehouse_sk#11 ASC NULLS FIRST], false

(171) Scan parquet 
Output [2]: [w_warehouse_sk#13, w_warehouse_name#14]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(w_warehouse_sk)]
ReadSchema: struct<w_warehouse_sk:int,w_warehouse_name:string>

(26) InputAdapter
Input [2]: [w_warehouse_sk#13, w_warehouse_name#14]
Arguments: [#13, #14]

(27) NativeFilter
Input [2]: [#13#13, #14#14]
Condition : isnotnull(w_warehouse_sk#13)

(28) NativeShuffleExchange
Input [2]: [#13#13, #14#14]
Arguments: hashpartitioning(w_warehouse_sk#13, 5), ENSURE_REQUIREMENTS, [plan_id=4]

(29) ShuffleQueryStage
Output [2]: [#13#13, #14#14]
Arguments: X

(30) AQEShuffleRead
Input [2]: [#13#13, #14#14]
Arguments: coalesced

(31) InputAdapter
Input [2]: [#13#13, #14#14]

(32) NativeSort
Input [2]: [#13#13, #14#14]
Arguments: [w_warehouse_sk#13 ASC NULLS FIRST], false

(33) NativeSortMergeJoin
Left keys [1]: [inv_warehouse_sk#11]
Right keys [1]: [w_warehouse_sk#13]
Join type: Inner
Join condition: None

(34) NativeProject
Output [9]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_bill_cdemo_sk#3, cs_bill_hdemo_sk#4, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14]
Input [11]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_bill_cdemo_sk#3, cs_bill_hdemo_sk#4, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, inv_warehouse_sk#11, #13#13, #14#14]

(35) NativeShuffleExchange
Input [9]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_bill_cdemo_sk#3, cs_bill_hdemo_sk#4, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14]
Arguments: hashpartitioning(cs_item_sk#5, 5), ENSURE_REQUIREMENTS, [plan_id=5]

(36) ShuffleQueryStage
Output [9]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_bill_cdemo_sk#3, cs_bill_hdemo_sk#4, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14]
Arguments: X

(37) NativeSort
Input [9]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_bill_cdemo_sk#3, cs_bill_hdemo_sk#4, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14]
Arguments: [cs_item_sk#5 ASC NULLS FIRST], false

(179) Scan parquet 
Output [2]: [i_item_sk#15, i_item_desc#16]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(i_item_sk)]
ReadSchema: struct<i_item_sk:int,i_item_desc:string>

(39) InputAdapter
Input [2]: [i_item_sk#15, i_item_desc#16]
Arguments: [#15, #16]

(40) NativeFilter
Input [2]: [#15#15, #16#16]
Condition : isnotnull(i_item_sk#15)

(41) NativeShuffleExchange
Input [2]: [#15#15, #16#16]
Arguments: hashpartitioning(i_item_sk#15, 5), ENSURE_REQUIREMENTS, [plan_id=6]

(42) ShuffleQueryStage
Output [2]: [#15#15, #16#16]
Arguments: X

(43) NativeSort
Input [2]: [#15#15, #16#16]
Arguments: [i_item_sk#15 ASC NULLS FIRST], false

(44) NativeSortMergeJoin
Left keys [1]: [cs_item_sk#5]
Right keys [1]: [i_item_sk#15]
Join type: Inner
Join condition: None

(45) NativeProject
Output [10]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_bill_cdemo_sk#3, cs_bill_hdemo_sk#4, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14, i_item_desc#16]
Input [11]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_bill_cdemo_sk#3, cs_bill_hdemo_sk#4, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14, #15#15, #16#16]

(46) NativeShuffleExchange
Input [10]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_bill_cdemo_sk#3, cs_bill_hdemo_sk#4, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14, i_item_desc#16]
Arguments: hashpartitioning(cs_bill_cdemo_sk#3, 5), ENSURE_REQUIREMENTS, [plan_id=7]

(47) ShuffleQueryStage
Output [10]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_bill_cdemo_sk#3, cs_bill_hdemo_sk#4, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14, i_item_desc#16]
Arguments: X

(48) NativeSort
Input [10]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_bill_cdemo_sk#3, cs_bill_hdemo_sk#4, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14, i_item_desc#16]
Arguments: [cs_bill_cdemo_sk#3 ASC NULLS FIRST], false

(187) Scan parquet 
Output [2]: [cd_demo_sk#17, cd_marital_status#18]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(cd_marital_status), EqualTo(cd_marital_status,D), IsNotNull(cd_demo_sk)]
ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>

(50) InputAdapter
Input [2]: [cd_demo_sk#17, cd_marital_status#18]
Arguments: [#17, #18]

(51) NativeFilter
Input [2]: [#17#17, #18#18]
Condition : ((isnotnull(cd_marital_status#18) AND (cd_marital_status#18 = D)) AND isnotnull(cd_demo_sk#17))

(52) NativeProject
Output [1]: [cd_demo_sk#17]
Input [2]: [#17#17, #18#18]

(53) NativeShuffleExchange
Input [1]: [cd_demo_sk#17]
Arguments: hashpartitioning(cd_demo_sk#17, 5), ENSURE_REQUIREMENTS, [plan_id=8]

(54) ShuffleQueryStage
Output [1]: [cd_demo_sk#17]
Arguments: X

(55) NativeSort
Input [1]: [cd_demo_sk#17]
Arguments: [cd_demo_sk#17 ASC NULLS FIRST], false

(56) NativeSortMergeJoin
Left keys [1]: [cs_bill_cdemo_sk#3]
Right keys [1]: [cd_demo_sk#17]
Join type: Inner
Join condition: None

(57) NativeProject
Output [9]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_bill_hdemo_sk#4, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14, i_item_desc#16]
Input [11]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_bill_cdemo_sk#3, cs_bill_hdemo_sk#4, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14, i_item_desc#16, cd_demo_sk#17]

(58) NativeShuffleExchange
Input [9]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_bill_hdemo_sk#4, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14, i_item_desc#16]
Arguments: hashpartitioning(cs_bill_hdemo_sk#4, 5), ENSURE_REQUIREMENTS, [plan_id=9]

(59) ShuffleQueryStage
Output [9]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_bill_hdemo_sk#4, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14, i_item_desc#16]
Arguments: X

(60) AQEShuffleRead
Input [9]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_bill_hdemo_sk#4, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14, i_item_desc#16]
Arguments: coalesced

(61) InputAdapter
Input [9]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_bill_hdemo_sk#4, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14, i_item_desc#16]

(62) NativeSort
Input [9]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_bill_hdemo_sk#4, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14, i_item_desc#16]
Arguments: [cs_bill_hdemo_sk#4 ASC NULLS FIRST], false

(196) Scan parquet 
Output [2]: [hd_demo_sk#19, hd_buy_potential#20]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(hd_buy_potential), EqualTo(hd_buy_potential,>10000), IsNotNull(hd_demo_sk)]
ReadSchema: struct<hd_demo_sk:int,hd_buy_potential:string>

(64) InputAdapter
Input [2]: [hd_demo_sk#19, hd_buy_potential#20]
Arguments: [#19, #20]

(65) NativeFilter
Input [2]: [#19#19, #20#20]
Condition : ((isnotnull(hd_buy_potential#20) AND (hd_buy_potential#20 = >10000)) AND isnotnull(hd_demo_sk#19))

(66) NativeProject
Output [1]: [hd_demo_sk#19]
Input [2]: [#19#19, #20#20]

(67) NativeShuffleExchange
Input [1]: [hd_demo_sk#19]
Arguments: hashpartitioning(hd_demo_sk#19, 5), ENSURE_REQUIREMENTS, [plan_id=10]

(68) ShuffleQueryStage
Output [1]: [hd_demo_sk#19]
Arguments: X

(69) AQEShuffleRead
Input [1]: [hd_demo_sk#19]
Arguments: coalesced

(70) InputAdapter
Input [1]: [hd_demo_sk#19]

(71) NativeSort
Input [1]: [hd_demo_sk#19]
Arguments: [hd_demo_sk#19 ASC NULLS FIRST], false

(72) NativeSortMergeJoin
Left keys [1]: [cs_bill_hdemo_sk#4]
Right keys [1]: [hd_demo_sk#19]
Join type: Inner
Join condition: None

(73) NativeProject
Output [8]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14, i_item_desc#16]
Input [10]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_bill_hdemo_sk#4, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14, i_item_desc#16, hd_demo_sk#19]

(74) NativeShuffleExchange
Input [8]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14, i_item_desc#16]
Arguments: hashpartitioning(cs_sold_date_sk#1, 5), ENSURE_REQUIREMENTS, [plan_id=11]

(75) ShuffleQueryStage
Output [8]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14, i_item_desc#16]
Arguments: X

(76) AQEShuffleRead
Input [8]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14, i_item_desc#16]
Arguments: coalesced

(77) InputAdapter
Input [8]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14, i_item_desc#16]

(78) NativeSort
Input [8]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14, i_item_desc#16]
Arguments: [cs_sold_date_sk#1 ASC NULLS FIRST], false

(205) Scan parquet 
Output [4]: [d_date_sk#21, d_date#22, d_week_seq#23, d_year#24]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(d_year), EqualTo(d_year,1999), IsNotNull(d_date_sk), IsNotNull(d_week_seq), IsNotNull(d_date)]
ReadSchema: struct<d_date_sk:int,d_date:date,d_week_seq:int,d_year:int>

(80) InputAdapter
Input [4]: [d_date_sk#21, d_date#22, d_week_seq#23, d_year#24]
Arguments: [#21, #22, #23, #24]

(81) NativeFilter
Input [4]: [#21#21, #22#22, #23#23, #24#24]
Condition : ((((isnotnull(d_year#24) AND (d_year#24 = 1999)) AND isnotnull(d_date_sk#21)) AND isnotnull(d_week_seq#23)) AND isnotnull(d_date#22))

(82) NativeProject
Output [3]: [d_date_sk#21, d_date#22, d_week_seq#23]
Input [4]: [#21#21, #22#22, #23#23, #24#24]

(83) NativeShuffleExchange
Input [3]: [d_date_sk#21, d_date#22, d_week_seq#23]
Arguments: hashpartitioning(d_date_sk#21, 5), ENSURE_REQUIREMENTS, [plan_id=12]

(84) ShuffleQueryStage
Output [3]: [d_date_sk#21, d_date#22, d_week_seq#23]
Arguments: X

(85) AQEShuffleRead
Input [3]: [d_date_sk#21, d_date#22, d_week_seq#23]
Arguments: coalesced

(86) InputAdapter
Input [3]: [d_date_sk#21, d_date#22, d_week_seq#23]

(87) NativeSort
Input [3]: [d_date_sk#21, d_date#22, d_week_seq#23]
Arguments: [d_date_sk#21 ASC NULLS FIRST], false

(88) NativeSortMergeJoin
Left keys [1]: [cs_sold_date_sk#1]
Right keys [1]: [d_date_sk#21]
Join type: Inner
Join condition: None

(89) NativeProject
Output [9]: [cs_ship_date_sk#2, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14, i_item_desc#16, d_date#22, d_week_seq#23]
Input [11]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14, i_item_desc#16, d_date_sk#21, d_date#22, d_week_seq#23]

(90) NativeShuffleExchange
Input [9]: [cs_ship_date_sk#2, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14, i_item_desc#16, d_date#22, d_week_seq#23]
Arguments: hashpartitioning(d_week_seq#23, inv_date_sk#9, 5), ENSURE_REQUIREMENTS, [plan_id=13]

(91) ShuffleQueryStage
Output [9]: [cs_ship_date_sk#2, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14, i_item_desc#16, d_date#22, d_week_seq#23]
Arguments: X

(92) AQEShuffleRead
Input [9]: [cs_ship_date_sk#2, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14, i_item_desc#16, d_date#22, d_week_seq#23]
Arguments: coalesced

(93) InputAdapter
Input [9]: [cs_ship_date_sk#2, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14, i_item_desc#16, d_date#22, d_week_seq#23]

(94) NativeSort
Input [9]: [cs_ship_date_sk#2, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14, i_item_desc#16, d_date#22, d_week_seq#23]
Arguments: [d_week_seq#23 ASC NULLS FIRST, inv_date_sk#9 ASC NULLS FIRST], false

(214) Scan parquet 
Output [2]: [d_date_sk#25, d_week_seq#26]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(d_week_seq), IsNotNull(d_date_sk)]
ReadSchema: struct<d_date_sk:int,d_week_seq:int>

(96) InputAdapter
Input [2]: [d_date_sk#25, d_week_seq#26]
Arguments: [#25, #26]

(97) NativeFilter
Input [2]: [#25#25, #26#26]
Condition : (isnotnull(d_week_seq#26) AND isnotnull(d_date_sk#25))

(98) NativeShuffleExchange
Input [2]: [#25#25, #26#26]
Arguments: hashpartitioning(d_week_seq#26, d_date_sk#25, 5), ENSURE_REQUIREMENTS, [plan_id=14]

(99) ShuffleQueryStage
Output [2]: [#25#25, #26#26]
Arguments: X

(100) AQEShuffleRead
Input [2]: [#25#25, #26#26]
Arguments: coalesced

(101) InputAdapter
Input [2]: [#25#25, #26#26]

(102) NativeSort
Input [2]: [#25#25, #26#26]
Arguments: [d_week_seq#26 ASC NULLS FIRST, d_date_sk#25 ASC NULLS FIRST], false

(103) NativeSortMergeJoin
Left keys [2]: [d_week_seq#23, inv_date_sk#9]
Right keys [2]: [d_week_seq#26, d_date_sk#25]
Join type: Inner
Join condition: None

(104) NativeProject
Output [8]: [cs_ship_date_sk#2, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, w_warehouse_name#14, i_item_desc#16, d_date#22, d_week_seq#23]
Input [11]: [cs_ship_date_sk#2, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14, i_item_desc#16, d_date#22, d_week_seq#23, #25#25, #26#26]

(105) NativeShuffleExchange
Input [8]: [cs_ship_date_sk#2, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, w_warehouse_name#14, i_item_desc#16, d_date#22, d_week_seq#23]
Arguments: hashpartitioning(cs_ship_date_sk#2, 5), ENSURE_REQUIREMENTS, [plan_id=15]

(106) ShuffleQueryStage
Output [8]: [cs_ship_date_sk#2, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, w_warehouse_name#14, i_item_desc#16, d_date#22, d_week_seq#23]
Arguments: X

(107) AQEShuffleRead
Input [8]: [cs_ship_date_sk#2, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, w_warehouse_name#14, i_item_desc#16, d_date#22, d_week_seq#23]
Arguments: coalesced

(108) InputAdapter
Input [8]: [cs_ship_date_sk#2, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, w_warehouse_name#14, i_item_desc#16, d_date#22, d_week_seq#23]

(109) NativeSort
Input [8]: [cs_ship_date_sk#2, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, w_warehouse_name#14, i_item_desc#16, d_date#22, d_week_seq#23]
Arguments: [cs_ship_date_sk#2 ASC NULLS FIRST], false

(222) Scan parquet 
Output [2]: [d_date_sk#27, d_date#28]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(d_date), IsNotNull(d_date_sk)]
ReadSchema: struct<d_date_sk:int,d_date:date>

(111) InputAdapter
Input [2]: [d_date_sk#27, d_date#28]
Arguments: [#27, #28]

(112) NativeFilter
Input [2]: [#27#27, #28#28]
Condition : (isnotnull(d_date#28) AND isnotnull(d_date_sk#27))

(113) NativeShuffleExchange
Input [2]: [#27#27, #28#28]
Arguments: hashpartitioning(d_date_sk#27, 5), ENSURE_REQUIREMENTS, [plan_id=16]

(114) ShuffleQueryStage
Output [2]: [#27#27, #28#28]
Arguments: X

(115) AQEShuffleRead
Input [2]: [#27#27, #28#28]
Arguments: coalesced

(116) InputAdapter
Input [2]: [#27#27, #28#28]

(117) NativeSort
Input [2]: [#27#27, #28#28]
Arguments: [d_date_sk#27 ASC NULLS FIRST], false

(118) SortMergeJoin [codegen id : 2]
Left keys [1]: [cs_ship_date_sk#2]
Right keys [1]: [d_date_sk#27]
Join type: Inner
Join condition: (d_date#28 > date_add(d_date#22, 5))

(119) Project [codegen id : 2]
Output [6]: [cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, w_warehouse_name#14, i_item_desc#16, d_week_seq#23]
Input [10]: [cs_ship_date_sk#2, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, w_warehouse_name#14, i_item_desc#16, d_date#22, d_week_seq#23, #27#27, #28#28]

(120) ConvertToNative
Input [6]: [cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, w_warehouse_name#14, i_item_desc#16, d_week_seq#23]

(121) NativeShuffleExchange
Input [6]: [cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, w_warehouse_name#14, i_item_desc#16, d_week_seq#23]
Arguments: hashpartitioning(cs_promo_sk#6, 5), ENSURE_REQUIREMENTS, [plan_id=17]

(122) ShuffleQueryStage
Output [6]: [cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, w_warehouse_name#14, i_item_desc#16, d_week_seq#23]
Arguments: X

(123) AQEShuffleRead
Input [6]: [cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, w_warehouse_name#14, i_item_desc#16, d_week_seq#23]
Arguments: coalesced

(124) InputAdapter
Input [6]: [cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, w_warehouse_name#14, i_item_desc#16, d_week_seq#23]

(125) NativeSort
Input [6]: [cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, w_warehouse_name#14, i_item_desc#16, d_week_seq#23]
Arguments: [cs_promo_sk#6 ASC NULLS FIRST], false

(230) Scan parquet 
Output [1]: [p_promo_sk#29]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(p_promo_sk)]
ReadSchema: struct<p_promo_sk:int>

(127) InputAdapter
Input [1]: [p_promo_sk#29]
Arguments: [#29]

(128) NativeFilter
Input [1]: [#29#29]
Condition : isnotnull(p_promo_sk#29)

(129) NativeShuffleExchange
Input [1]: [#29#29]
Arguments: hashpartitioning(p_promo_sk#29, 5), ENSURE_REQUIREMENTS, [plan_id=18]

(130) ShuffleQueryStage
Output [1]: [#29#29]
Arguments: X

(131) AQEShuffleRead
Input [1]: [#29#29]
Arguments: coalesced

(132) InputAdapter
Input [1]: [#29#29]

(133) NativeSort
Input [1]: [#29#29]
Arguments: [p_promo_sk#29 ASC NULLS FIRST], false

(134) NativeSortMergeJoin
Left keys [1]: [cs_promo_sk#6]
Right keys [1]: [p_promo_sk#29]
Join type: LeftOuter
Join condition: None

(135) NativeProject
Output [5]: [cs_item_sk#5, cs_order_number#7, w_warehouse_name#14, i_item_desc#16, d_week_seq#23]
Input [7]: [cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, w_warehouse_name#14, i_item_desc#16, d_week_seq#23, #29#29]

(136) NativeShuffleExchange
Input [5]: [cs_item_sk#5, cs_order_number#7, w_warehouse_name#14, i_item_desc#16, d_week_seq#23]
Arguments: hashpartitioning(cs_item_sk#5, cs_order_number#7, 5), ENSURE_REQUIREMENTS, [plan_id=19]

(137) ShuffleQueryStage
Output [5]: [cs_item_sk#5, cs_order_number#7, w_warehouse_name#14, i_item_desc#16, d_week_seq#23]
Arguments: X

(138) AQEShuffleRead
Input [5]: [cs_item_sk#5, cs_order_number#7, w_warehouse_name#14, i_item_desc#16, d_week_seq#23]
Arguments: coalesced

(139) InputAdapter
Input [5]: [cs_item_sk#5, cs_order_number#7, w_warehouse_name#14, i_item_desc#16, d_week_seq#23]

(140) NativeSort
Input [5]: [cs_item_sk#5, cs_order_number#7, w_warehouse_name#14, i_item_desc#16, d_week_seq#23]
Arguments: [cs_item_sk#5 ASC NULLS FIRST, cs_order_number#7 ASC NULLS FIRST], false

(238) Scan parquet 
Output [2]: [cr_item_sk#30, cr_order_number#31]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(cr_item_sk), IsNotNull(cr_order_number)]
ReadSchema: struct<cr_item_sk:int,cr_order_number:int>

(142) InputAdapter
Input [2]: [cr_item_sk#30, cr_order_number#31]
Arguments: [#30, #31]

(143) NativeFilter
Input [2]: [#30#30, #31#31]
Condition : (isnotnull(cr_item_sk#30) AND isnotnull(cr_order_number#31))

(144) NativeShuffleExchange
Input [2]: [#30#30, #31#31]
Arguments: hashpartitioning(cr_item_sk#30, cr_order_number#31, 5), ENSURE_REQUIREMENTS, [plan_id=20]

(145) ShuffleQueryStage
Output [2]: [#30#30, #31#31]
Arguments: X

(146) AQEShuffleRead
Input [2]: [#30#30, #31#31]
Arguments: coalesced

(147) InputAdapter
Input [2]: [#30#30, #31#31]

(148) NativeSort
Input [2]: [#30#30, #31#31]
Arguments: [cr_item_sk#30 ASC NULLS FIRST, cr_order_number#31 ASC NULLS FIRST], false

(149) NativeSortMergeJoin
Left keys [2]: [cs_item_sk#5, cs_order_number#7]
Right keys [2]: [cr_item_sk#30, cr_order_number#31]
Join type: LeftOuter
Join condition: None

(150) NativeProject
Output [3]: [w_warehouse_name#14, i_item_desc#16, d_week_seq#23]
Input [7]: [cs_item_sk#5, cs_order_number#7, w_warehouse_name#14, i_item_desc#16, d_week_seq#23, #30#30, #31#31]

(151) NativeHashAggregate
Input [3]: [w_warehouse_name#14, i_item_desc#16, d_week_seq#23]
Keys [3]: [i_item_desc#16, w_warehouse_name#14, d_week_seq#23]
Functions [1]: [partial_count(1)]
Aggregate Attributes [1]: [count#32]
Results [4]: [i_item_desc#16, w_warehouse_name#14, d_week_seq#23, #33#33]

(152) NativeShuffleExchange
Input [4]: [i_item_desc#16, w_warehouse_name#14, d_week_seq#23, #33#33]
Arguments: hashpartitioning(i_item_desc#16, w_warehouse_name#14, d_week_seq#23, 5), ENSURE_REQUIREMENTS, [plan_id=21]

(153) ShuffleQueryStage
Output [4]: [i_item_desc#16, w_warehouse_name#14, d_week_seq#23, #33#33]
Arguments: X

(154) AQEShuffleRead
Input [4]: [i_item_desc#16, w_warehouse_name#14, d_week_seq#23, #33#33]
Arguments: coalesced

(155) InputAdapter
Input [4]: [i_item_desc#16, w_warehouse_name#14, d_week_seq#23, #33#33]

(156) NativeHashAggregate
Input [4]: [i_item_desc#16, w_warehouse_name#14, d_week_seq#23, #33#33]
Keys [3]: [i_item_desc#16, w_warehouse_name#14, d_week_seq#23]
Functions [1]: [count(1)]
Aggregate Attributes [1]: [count(1)#34]
Results [4]: [i_item_desc#16, w_warehouse_name#14, d_week_seq#23, count(1)#34]

(157) NativeProject
Output [6]: [i_item_desc#16, w_warehouse_name#14, d_week_seq#23, count(1)#34 AS no_promo#35, count(1)#34 AS promo#36, count(1)#34 AS total_cnt#37]
Input [4]: [i_item_desc#16, w_warehouse_name#14, d_week_seq#23, count(1)#34]

(158) NativeTakeOrdered
Input [6]: [i_item_desc#16, w_warehouse_name#14, d_week_seq#23, no_promo#35, promo#36, total_cnt#37]
Arguments: X, [total_cnt#37 DESC NULLS LAST, i_item_desc#16 ASC NULLS FIRST, w_warehouse_name#14 ASC NULLS FIRST, d_week_seq#23 ASC NULLS FIRST]

(159) Scan parquet 
Output [8]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_bill_cdemo_sk#3, cs_bill_hdemo_sk#4, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, cs_quantity#8]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(cs_quantity), IsNotNull(cs_item_sk), IsNotNull(cs_bill_cdemo_sk), IsNotNull(cs_bill_hdemo_sk), IsNotNull(cs_sold_date_sk), IsNotNull(cs_ship_date_sk)]
ReadSchema: struct<cs_sold_date_sk:int,cs_ship_date_sk:int,cs_bill_cdemo_sk:int,cs_bill_hdemo_sk:int,cs_item_sk:int,cs_promo_sk:int,cs_order_number:int,cs_quantity:int>

(160) Filter
Input [8]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_bill_cdemo_sk#3, cs_bill_hdemo_sk#4, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, cs_quantity#8]
Condition : (((((isnotnull(cs_quantity#8) AND isnotnull(cs_item_sk#5)) AND isnotnull(cs_bill_cdemo_sk#3)) AND isnotnull(cs_bill_hdemo_sk#4)) AND isnotnull(cs_sold_date_sk#1)) AND isnotnull(cs_ship_date_sk#2))

(161) Exchange
Input [8]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_bill_cdemo_sk#3, cs_bill_hdemo_sk#4, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, cs_quantity#8]
Arguments: hashpartitioning(cs_item_sk#5, 5), ENSURE_REQUIREMENTS, [plan_id=22]

(162) Sort
Input [8]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_bill_cdemo_sk#3, cs_bill_hdemo_sk#4, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, cs_quantity#8]
Arguments: [cs_item_sk#5 ASC NULLS FIRST], false, 0

(163) Scan parquet 
Output [4]: [inv_date_sk#9, inv_item_sk#10, inv_warehouse_sk#11, inv_quantity_on_hand#12]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(inv_quantity_on_hand), IsNotNull(inv_item_sk), IsNotNull(inv_warehouse_sk), IsNotNull(inv_date_sk)]
ReadSchema: struct<inv_date_sk:int,inv_item_sk:int,inv_warehouse_sk:int,inv_quantity_on_hand:int>

(164) Filter
Input [4]: [inv_date_sk#9, inv_item_sk#10, inv_warehouse_sk#11, inv_quantity_on_hand#12]
Condition : (((isnotnull(inv_quantity_on_hand#12) AND isnotnull(inv_item_sk#10)) AND isnotnull(inv_warehouse_sk#11)) AND isnotnull(inv_date_sk#9))

(165) Exchange
Input [4]: [inv_date_sk#9, inv_item_sk#10, inv_warehouse_sk#11, inv_quantity_on_hand#12]
Arguments: hashpartitioning(inv_item_sk#10, 5), ENSURE_REQUIREMENTS, [plan_id=23]

(166) Sort
Input [4]: [inv_date_sk#9, inv_item_sk#10, inv_warehouse_sk#11, inv_quantity_on_hand#12]
Arguments: [inv_item_sk#10 ASC NULLS FIRST], false, 0

(167) SortMergeJoin
Left keys [1]: [cs_item_sk#5]
Right keys [1]: [inv_item_sk#10]
Join type: Inner
Join condition: (inv_quantity_on_hand#12 < cs_quantity#8)

(168) Project
Output [9]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_bill_cdemo_sk#3, cs_bill_hdemo_sk#4, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, inv_warehouse_sk#11]
Input [12]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_bill_cdemo_sk#3, cs_bill_hdemo_sk#4, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, cs_quantity#8, inv_date_sk#9, inv_item_sk#10, inv_warehouse_sk#11, inv_quantity_on_hand#12]

(169) Exchange
Input [9]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_bill_cdemo_sk#3, cs_bill_hdemo_sk#4, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, inv_warehouse_sk#11]
Arguments: hashpartitioning(inv_warehouse_sk#11, 5), ENSURE_REQUIREMENTS, [plan_id=24]

(170) Sort
Input [9]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_bill_cdemo_sk#3, cs_bill_hdemo_sk#4, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, inv_warehouse_sk#11]
Arguments: [inv_warehouse_sk#11 ASC NULLS FIRST], false, 0

(171) Scan parquet 
Output [2]: [w_warehouse_sk#13, w_warehouse_name#14]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(w_warehouse_sk)]
ReadSchema: struct<w_warehouse_sk:int,w_warehouse_name:string>

(172) Filter
Input [2]: [w_warehouse_sk#13, w_warehouse_name#14]
Condition : isnotnull(w_warehouse_sk#13)

(173) Exchange
Input [2]: [w_warehouse_sk#13, w_warehouse_name#14]
Arguments: hashpartitioning(w_warehouse_sk#13, 5), ENSURE_REQUIREMENTS, [plan_id=25]

(174) Sort
Input [2]: [w_warehouse_sk#13, w_warehouse_name#14]
Arguments: [w_warehouse_sk#13 ASC NULLS FIRST], false, 0

(175) SortMergeJoin
Left keys [1]: [inv_warehouse_sk#11]
Right keys [1]: [w_warehouse_sk#13]
Join type: Inner
Join condition: None

(176) Project
Output [9]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_bill_cdemo_sk#3, cs_bill_hdemo_sk#4, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14]
Input [11]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_bill_cdemo_sk#3, cs_bill_hdemo_sk#4, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, inv_warehouse_sk#11, w_warehouse_sk#13, w_warehouse_name#14]

(177) Exchange
Input [9]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_bill_cdemo_sk#3, cs_bill_hdemo_sk#4, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14]
Arguments: hashpartitioning(cs_item_sk#5, 5), ENSURE_REQUIREMENTS, [plan_id=26]

(178) Sort
Input [9]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_bill_cdemo_sk#3, cs_bill_hdemo_sk#4, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14]
Arguments: [cs_item_sk#5 ASC NULLS FIRST], false, 0

(179) Scan parquet 
Output [2]: [i_item_sk#15, i_item_desc#16]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(i_item_sk)]
ReadSchema: struct<i_item_sk:int,i_item_desc:string>

(180) Filter
Input [2]: [i_item_sk#15, i_item_desc#16]
Condition : isnotnull(i_item_sk#15)

(181) Exchange
Input [2]: [i_item_sk#15, i_item_desc#16]
Arguments: hashpartitioning(i_item_sk#15, 5), ENSURE_REQUIREMENTS, [plan_id=27]

(182) Sort
Input [2]: [i_item_sk#15, i_item_desc#16]
Arguments: [i_item_sk#15 ASC NULLS FIRST], false, 0

(183) SortMergeJoin
Left keys [1]: [cs_item_sk#5]
Right keys [1]: [i_item_sk#15]
Join type: Inner
Join condition: None

(184) Project
Output [10]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_bill_cdemo_sk#3, cs_bill_hdemo_sk#4, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14, i_item_desc#16]
Input [11]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_bill_cdemo_sk#3, cs_bill_hdemo_sk#4, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14, i_item_sk#15, i_item_desc#16]

(185) Exchange
Input [10]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_bill_cdemo_sk#3, cs_bill_hdemo_sk#4, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14, i_item_desc#16]
Arguments: hashpartitioning(cs_bill_cdemo_sk#3, 5), ENSURE_REQUIREMENTS, [plan_id=28]

(186) Sort
Input [10]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_bill_cdemo_sk#3, cs_bill_hdemo_sk#4, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14, i_item_desc#16]
Arguments: [cs_bill_cdemo_sk#3 ASC NULLS FIRST], false, 0

(187) Scan parquet 
Output [2]: [cd_demo_sk#17, cd_marital_status#18]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(cd_marital_status), EqualTo(cd_marital_status,D), IsNotNull(cd_demo_sk)]
ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>

(188) Filter
Input [2]: [cd_demo_sk#17, cd_marital_status#18]
Condition : ((isnotnull(cd_marital_status#18) AND (cd_marital_status#18 = D)) AND isnotnull(cd_demo_sk#17))

(189) Project
Output [1]: [cd_demo_sk#17]
Input [2]: [cd_demo_sk#17, cd_marital_status#18]

(190) Exchange
Input [1]: [cd_demo_sk#17]
Arguments: hashpartitioning(cd_demo_sk#17, 5), ENSURE_REQUIREMENTS, [plan_id=29]

(191) Sort
Input [1]: [cd_demo_sk#17]
Arguments: [cd_demo_sk#17 ASC NULLS FIRST], false, 0

(192) SortMergeJoin
Left keys [1]: [cs_bill_cdemo_sk#3]
Right keys [1]: [cd_demo_sk#17]
Join type: Inner
Join condition: None

(193) Project
Output [9]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_bill_hdemo_sk#4, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14, i_item_desc#16]
Input [11]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_bill_cdemo_sk#3, cs_bill_hdemo_sk#4, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14, i_item_desc#16, cd_demo_sk#17]

(194) Exchange
Input [9]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_bill_hdemo_sk#4, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14, i_item_desc#16]
Arguments: hashpartitioning(cs_bill_hdemo_sk#4, 5), ENSURE_REQUIREMENTS, [plan_id=30]

(195) Sort
Input [9]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_bill_hdemo_sk#4, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14, i_item_desc#16]
Arguments: [cs_bill_hdemo_sk#4 ASC NULLS FIRST], false, 0

(196) Scan parquet 
Output [2]: [hd_demo_sk#19, hd_buy_potential#20]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(hd_buy_potential), EqualTo(hd_buy_potential,>10000), IsNotNull(hd_demo_sk)]
ReadSchema: struct<hd_demo_sk:int,hd_buy_potential:string>

(197) Filter
Input [2]: [hd_demo_sk#19, hd_buy_potential#20]
Condition : ((isnotnull(hd_buy_potential#20) AND (hd_buy_potential#20 = >10000)) AND isnotnull(hd_demo_sk#19))

(198) Project
Output [1]: [hd_demo_sk#19]
Input [2]: [hd_demo_sk#19, hd_buy_potential#20]

(199) Exchange
Input [1]: [hd_demo_sk#19]
Arguments: hashpartitioning(hd_demo_sk#19, 5), ENSURE_REQUIREMENTS, [plan_id=31]

(200) Sort
Input [1]: [hd_demo_sk#19]
Arguments: [hd_demo_sk#19 ASC NULLS FIRST], false, 0

(201) SortMergeJoin
Left keys [1]: [cs_bill_hdemo_sk#4]
Right keys [1]: [hd_demo_sk#19]
Join type: Inner
Join condition: None

(202) Project
Output [8]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14, i_item_desc#16]
Input [10]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_bill_hdemo_sk#4, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14, i_item_desc#16, hd_demo_sk#19]

(203) Exchange
Input [8]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14, i_item_desc#16]
Arguments: hashpartitioning(cs_sold_date_sk#1, 5), ENSURE_REQUIREMENTS, [plan_id=32]

(204) Sort
Input [8]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14, i_item_desc#16]
Arguments: [cs_sold_date_sk#1 ASC NULLS FIRST], false, 0

(205) Scan parquet 
Output [4]: [d_date_sk#21, d_date#22, d_week_seq#23, d_year#24]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(d_year), EqualTo(d_year,1999), IsNotNull(d_date_sk), IsNotNull(d_week_seq), IsNotNull(d_date)]
ReadSchema: struct<d_date_sk:int,d_date:date,d_week_seq:int,d_year:int>

(206) Filter
Input [4]: [d_date_sk#21, d_date#22, d_week_seq#23, d_year#24]
Condition : ((((isnotnull(d_year#24) AND (d_year#24 = 1999)) AND isnotnull(d_date_sk#21)) AND isnotnull(d_week_seq#23)) AND isnotnull(d_date#22))

(207) Project
Output [3]: [d_date_sk#21, d_date#22, d_week_seq#23]
Input [4]: [d_date_sk#21, d_date#22, d_week_seq#23, d_year#24]

(208) Exchange
Input [3]: [d_date_sk#21, d_date#22, d_week_seq#23]
Arguments: hashpartitioning(d_date_sk#21, 5), ENSURE_REQUIREMENTS, [plan_id=33]

(209) Sort
Input [3]: [d_date_sk#21, d_date#22, d_week_seq#23]
Arguments: [d_date_sk#21 ASC NULLS FIRST], false, 0

(210) SortMergeJoin
Left keys [1]: [cs_sold_date_sk#1]
Right keys [1]: [d_date_sk#21]
Join type: Inner
Join condition: None

(211) Project
Output [9]: [cs_ship_date_sk#2, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14, i_item_desc#16, d_date#22, d_week_seq#23]
Input [11]: [cs_sold_date_sk#1, cs_ship_date_sk#2, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14, i_item_desc#16, d_date_sk#21, d_date#22, d_week_seq#23]

(212) Exchange
Input [9]: [cs_ship_date_sk#2, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14, i_item_desc#16, d_date#22, d_week_seq#23]
Arguments: hashpartitioning(d_week_seq#23, inv_date_sk#9, 5), ENSURE_REQUIREMENTS, [plan_id=34]

(213) Sort
Input [9]: [cs_ship_date_sk#2, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14, i_item_desc#16, d_date#22, d_week_seq#23]
Arguments: [d_week_seq#23 ASC NULLS FIRST, inv_date_sk#9 ASC NULLS FIRST], false, 0

(214) Scan parquet 
Output [2]: [d_date_sk#25, d_week_seq#26]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(d_week_seq), IsNotNull(d_date_sk)]
ReadSchema: struct<d_date_sk:int,d_week_seq:int>

(215) Filter
Input [2]: [d_date_sk#25, d_week_seq#26]
Condition : (isnotnull(d_week_seq#26) AND isnotnull(d_date_sk#25))

(216) Exchange
Input [2]: [d_date_sk#25, d_week_seq#26]
Arguments: hashpartitioning(d_week_seq#26, d_date_sk#25, 5), ENSURE_REQUIREMENTS, [plan_id=35]

(217) Sort
Input [2]: [d_date_sk#25, d_week_seq#26]
Arguments: [d_week_seq#26 ASC NULLS FIRST, d_date_sk#25 ASC NULLS FIRST], false, 0

(218) SortMergeJoin
Left keys [2]: [d_week_seq#23, inv_date_sk#9]
Right keys [2]: [d_week_seq#26, d_date_sk#25]
Join type: Inner
Join condition: None

(219) Project
Output [8]: [cs_ship_date_sk#2, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, w_warehouse_name#14, i_item_desc#16, d_date#22, d_week_seq#23]
Input [11]: [cs_ship_date_sk#2, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, inv_date_sk#9, w_warehouse_name#14, i_item_desc#16, d_date#22, d_week_seq#23, d_date_sk#25, d_week_seq#26]

(220) Exchange
Input [8]: [cs_ship_date_sk#2, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, w_warehouse_name#14, i_item_desc#16, d_date#22, d_week_seq#23]
Arguments: hashpartitioning(cs_ship_date_sk#2, 5), ENSURE_REQUIREMENTS, [plan_id=36]

(221) Sort
Input [8]: [cs_ship_date_sk#2, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, w_warehouse_name#14, i_item_desc#16, d_date#22, d_week_seq#23]
Arguments: [cs_ship_date_sk#2 ASC NULLS FIRST], false, 0

(222) Scan parquet 
Output [2]: [d_date_sk#27, d_date#28]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(d_date), IsNotNull(d_date_sk)]
ReadSchema: struct<d_date_sk:int,d_date:date>

(223) Filter
Input [2]: [d_date_sk#27, d_date#28]
Condition : (isnotnull(d_date#28) AND isnotnull(d_date_sk#27))

(224) Exchange
Input [2]: [d_date_sk#27, d_date#28]
Arguments: hashpartitioning(d_date_sk#27, 5), ENSURE_REQUIREMENTS, [plan_id=37]

(225) Sort
Input [2]: [d_date_sk#27, d_date#28]
Arguments: [d_date_sk#27 ASC NULLS FIRST], false, 0

(226) SortMergeJoin
Left keys [1]: [cs_ship_date_sk#2]
Right keys [1]: [d_date_sk#27]
Join type: Inner
Join condition: (d_date#28 > date_add(d_date#22, 5))

(227) Project
Output [6]: [cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, w_warehouse_name#14, i_item_desc#16, d_week_seq#23]
Input [10]: [cs_ship_date_sk#2, cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, w_warehouse_name#14, i_item_desc#16, d_date#22, d_week_seq#23, d_date_sk#27, d_date#28]

(228) Exchange
Input [6]: [cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, w_warehouse_name#14, i_item_desc#16, d_week_seq#23]
Arguments: hashpartitioning(cs_promo_sk#6, 5), ENSURE_REQUIREMENTS, [plan_id=38]

(229) Sort
Input [6]: [cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, w_warehouse_name#14, i_item_desc#16, d_week_seq#23]
Arguments: [cs_promo_sk#6 ASC NULLS FIRST], false, 0

(230) Scan parquet 
Output [1]: [p_promo_sk#29]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(p_promo_sk)]
ReadSchema: struct<p_promo_sk:int>

(231) Filter
Input [1]: [p_promo_sk#29]
Condition : isnotnull(p_promo_sk#29)

(232) Exchange
Input [1]: [p_promo_sk#29]
Arguments: hashpartitioning(p_promo_sk#29, 5), ENSURE_REQUIREMENTS, [plan_id=39]

(233) Sort
Input [1]: [p_promo_sk#29]
Arguments: [p_promo_sk#29 ASC NULLS FIRST], false, 0

(234) SortMergeJoin
Left keys [1]: [cs_promo_sk#6]
Right keys [1]: [p_promo_sk#29]
Join type: LeftOuter
Join condition: None

(235) Project
Output [5]: [cs_item_sk#5, cs_order_number#7, w_warehouse_name#14, i_item_desc#16, d_week_seq#23]
Input [7]: [cs_item_sk#5, cs_promo_sk#6, cs_order_number#7, w_warehouse_name#14, i_item_desc#16, d_week_seq#23, p_promo_sk#29]

(236) Exchange
Input [5]: [cs_item_sk#5, cs_order_number#7, w_warehouse_name#14, i_item_desc#16, d_week_seq#23]
Arguments: hashpartitioning(cs_item_sk#5, cs_order_number#7, 5), ENSURE_REQUIREMENTS, [plan_id=40]

(237) Sort
Input [5]: [cs_item_sk#5, cs_order_number#7, w_warehouse_name#14, i_item_desc#16, d_week_seq#23]
Arguments: [cs_item_sk#5 ASC NULLS FIRST, cs_order_number#7 ASC NULLS FIRST], false, 0

(238) Scan parquet 
Output [2]: [cr_item_sk#30, cr_order_number#31]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(cr_item_sk), IsNotNull(cr_order_number)]
ReadSchema: struct<cr_item_sk:int,cr_order_number:int>

(239) Filter
Input [2]: [cr_item_sk#30, cr_order_number#31]
Condition : (isnotnull(cr_item_sk#30) AND isnotnull(cr_order_number#31))

(240) Exchange
Input [2]: [cr_item_sk#30, cr_order_number#31]
Arguments: hashpartitioning(cr_item_sk#30, cr_order_number#31, 5), ENSURE_REQUIREMENTS, [plan_id=41]

(241) Sort
Input [2]: [cr_item_sk#30, cr_order_number#31]
Arguments: [cr_item_sk#30 ASC NULLS FIRST, cr_order_number#31 ASC NULLS FIRST], false, 0

(242) SortMergeJoin
Left keys [2]: [cs_item_sk#5, cs_order_number#7]
Right keys [2]: [cr_item_sk#30, cr_order_number#31]
Join type: LeftOuter
Join condition: None

(243) Project
Output [3]: [w_warehouse_name#14, i_item_desc#16, d_week_seq#23]
Input [7]: [cs_item_sk#5, cs_order_number#7, w_warehouse_name#14, i_item_desc#16, d_week_seq#23, cr_item_sk#30, cr_order_number#31]

(244) HashAggregate
Input [3]: [w_warehouse_name#14, i_item_desc#16, d_week_seq#23]
Keys [3]: [i_item_desc#16, w_warehouse_name#14, d_week_seq#23]
Functions [1]: [partial_count(1)]
Aggregate Attributes [1]: [count#32]
Results [4]: [i_item_desc#16, w_warehouse_name#14, d_week_seq#23, count#38]

(245) Exchange
Input [4]: [i_item_desc#16, w_warehouse_name#14, d_week_seq#23, count#38]
Arguments: hashpartitioning(i_item_desc#16, w_warehouse_name#14, d_week_seq#23, 5), ENSURE_REQUIREMENTS, [plan_id=42]

(246) HashAggregate
Input [4]: [i_item_desc#16, w_warehouse_name#14, d_week_seq#23, count#38]
Keys [3]: [i_item_desc#16, w_warehouse_name#14, d_week_seq#23]
Functions [1]: [count(1)]
Aggregate Attributes [1]: [count(1)#34]
Results [6]: [i_item_desc#16, w_warehouse_name#14, d_week_seq#23, count(1)#34 AS no_promo#35, count(1)#34 AS promo#36, count(1)#34 AS total_cnt#37]

(247) TakeOrderedAndProject
Input [6]: [i_item_desc#16, w_warehouse_name#14, d_week_seq#23, no_promo#35, promo#36, total_cnt#37]
Arguments: X, [total_cnt#37 DESC NULLS LAST, i_item_desc#16 ASC NULLS FIRST, w_warehouse_name#14 ASC NULLS FIRST, d_week_seq#23 ASC NULLS FIRST], [i_item_desc#16, w_warehouse_name#14, d_week_seq#23, no_promo#35, promo#36, total_cnt#37]

(248) AdaptiveSparkPlan
Output [6]: [i_item_desc#16, w_warehouse_name#14, d_week_seq#23, no_promo#35, promo#36, total_cnt#37]
Arguments: isFinalPlan=true

