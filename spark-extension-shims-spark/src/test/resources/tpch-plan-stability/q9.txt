== Physical Plan ==
AdaptiveSparkPlan (138)
+- == Final Plan ==
   NativeSort (89)
   +- ConvertToNative (88)
      +- AQEShuffleRead (87)
         +- ShuffleQueryStage (86), Statistics(sizeInBytes=9.8 KiB, rowCount=173)
            +- Exchange (85)
               +- * HashAggregate (84)
                  +- AQEShuffleRead (83)
                     +- ShuffleQueryStage (82), Statistics(sizeInBytes=11.1 KiB, rowCount=173)
                        +- Exchange (81)
                           +- * HashAggregate (80)
                              +- * Project (79)
                                 +- NativeSortMergeJoin Inner (78)
                                    :- NativeSort (69)
                                    :  +- InputAdapter (68)
                                    :     +- AQEShuffleRead (67)
                                    :        +- ShuffleQueryStage (66), Statistics(sizeInBytes=240.4 KiB, rowCount=3.22E+3)
                                    :           +- NativeShuffleExchange (65)
                                    :              +- NativeProject (64)
                                    :                 +- NativeSortMergeJoin Inner (63)
                                    :                    :- NativeSort (54)
                                    :                    :  +- InputAdapter (53)
                                    :                    :     +- AQEShuffleRead (52)
                                    :                    :        +- ShuffleQueryStage (51), Statistics(sizeInBytes=252.9 KiB, rowCount=3.22E+3)
                                    :                    :           +- NativeShuffleExchange (50)
                                    :                    :              +- NativeProject (49)
                                    :                    :                 +- NativeSortMergeJoin Inner (48)
                                    :                    :                    :- NativeSort (39)
                                    :                    :                    :  +- InputAdapter (38)
                                    :                    :                    :     +- AQEShuffleRead (37)
                                    :                    :                    :        +- ShuffleQueryStage (36), Statistics(sizeInBytes=253.1 KiB, rowCount=3.22E+3)
                                    :                    :                    :           +- NativeShuffleExchange (35)
                                    :                    :                    :              +- NativeProject (34)
                                    :                    :                    :                 +- NativeSortMergeJoin Inner (33)
                                    :                    :                    :                    :- NativeSort (24)
                                    :                    :                    :                    :  +- InputAdapter (23)
                                    :                    :                    :                    :     +- AQEShuffleRead (22)
                                    :                    :                    :                    :        +- ShuffleQueryStage (21), Statistics(sizeInBytes=227.8 KiB, rowCount=3.22E+3)
                                    :                    :                    :                    :           +- NativeShuffleExchange (20)
                                    :                    :                    :                    :              +- NativeProject (19)
                                    :                    :                    :                    :                 +- NativeSortMergeJoin Inner (18)
                                    :                    :                    :                    :                    :- NativeSort (9)
                                    :                    :                    :                    :                    :  +- InputAdapter (8)
                                    :                    :                    :                    :                    :     +- AQEShuffleRead (7)
                                    :                    :                    :                    :                    :        +- ShuffleQueryStage (6), Statistics(sizeInBytes=1064.0 B, rowCount=107)
                                    :                    :                    :                    :                    :           +- NativeShuffleExchange (5)
                                    :                    :                    :                    :                    :              +- NativeProject (4)
                                    :                    :                    :                    :                    :                 +- NativeFilter (3)
                                    :                    :                    :                    :                    :                    +- InputAdapter (2)
                                    :                    :                    :                    :                    :                       +- NativeParquetScan  (1)
                                    :                    :                    :                    :                    +- NativeSort (17)
                                    :                    :                    :                    :                       +- InputAdapter (16)
                                    :                    :                    :                    :                          +- AQEShuffleRead (15)
                                    :                    :                    :                    :                             +- ShuffleQueryStage (14), Statistics(sizeInBytes=4.1 MiB, rowCount=6.02E+4)
                                    :                    :                    :                    :                                +- NativeShuffleExchange (13)
                                    :                    :                    :                    :                                   +- NativeFilter (12)
                                    :                    :                    :                    :                                      +- InputAdapter (11)
                                    :                    :                    :                    :                                         +- NativeParquetScan  (10)
                                    :                    :                    :                    +- NativeSort (32)
                                    :                    :                    :                       +- InputAdapter (31)
                                    :                    :                    :                          +- AQEShuffleRead (30)
                                    :                    :                    :                             +- ShuffleQueryStage (29), Statistics(sizeInBytes=1992.0 B, rowCount=100)
                                    :                    :                    :                                +- NativeShuffleExchange (28)
                                    :                    :                    :                                   +- NativeFilter (27)
                                    :                    :                    :                                      +- InputAdapter (26)
                                    :                    :                    :                                         +- NativeParquetScan  (25)
                                    :                    :                    +- NativeSort (47)
                                    :                    :                       +- InputAdapter (46)
                                    :                    :                          +- AQEShuffleRead (45)
                                    :                    :                             +- ShuffleQueryStage (44), Statistics(sizeInBytes=250.6 KiB, rowCount=8.00E+3)
                                    :                    :                                +- NativeShuffleExchange (43)
                                    :                    :                                   +- NativeFilter (42)
                                    :                    :                                      +- InputAdapter (41)
                                    :                    :                                         +- NativeParquetScan  (40)
                                    :                    +- NativeSort (62)
                                    :                       +- InputAdapter (61)
                                    :                          +- AQEShuffleRead (60)
                                    :                             +- ShuffleQueryStage (59), Statistics(sizeInBytes=176.5 KiB, rowCount=1.50E+4)
                                    :                                +- NativeShuffleExchange (58)
                                    :                                   +- NativeFilter (57)
                                    :                                      +- InputAdapter (56)
                                    :                                         +- NativeParquetScan  (55)
                                    +- NativeSort (77)
                                       +- InputAdapter (76)
                                          +- AQEShuffleRead (75)
                                             +- ShuffleQueryStage (74), Statistics(sizeInBytes=997.0 B, rowCount=25)
                                                +- NativeShuffleExchange (73)
                                                   +- NativeFilter (72)
                                                      +- InputAdapter (71)
                                                         +- NativeParquetScan  (70)
+- == Initial Plan ==
   Sort (137)
   +- Exchange (136)
      +- HashAggregate (135)
         +- Exchange (134)
            +- HashAggregate (133)
               +- Project (132)
                  +- SortMergeJoin Inner (131)
                     :- Sort (126)
                     :  +- Exchange (125)
                     :     +- Project (124)
                     :        +- SortMergeJoin Inner (123)
                     :           :- Sort (118)
                     :           :  +- Exchange (117)
                     :           :     +- Project (116)
                     :           :        +- SortMergeJoin Inner (115)
                     :           :           :- Sort (110)
                     :           :           :  +- Exchange (109)
                     :           :           :     +- Project (108)
                     :           :           :        +- SortMergeJoin Inner (107)
                     :           :           :           :- Sort (102)
                     :           :           :           :  +- Exchange (101)
                     :           :           :           :     +- Project (100)
                     :           :           :           :        +- SortMergeJoin Inner (99)
                     :           :           :           :           :- Sort (94)
                     :           :           :           :           :  +- Exchange (93)
                     :           :           :           :           :     +- Project (92)
                     :           :           :           :           :        +- Filter (91)
                     :           :           :           :           :           +- Scan parquet  (90)
                     :           :           :           :           +- Sort (98)
                     :           :           :           :              +- Exchange (97)
                     :           :           :           :                 +- Filter (96)
                     :           :           :           :                    +- Scan parquet  (95)
                     :           :           :           +- Sort (106)
                     :           :           :              +- Exchange (105)
                     :           :           :                 +- Filter (104)
                     :           :           :                    +- Scan parquet  (103)
                     :           :           +- Sort (114)
                     :           :              +- Exchange (113)
                     :           :                 +- Filter (112)
                     :           :                    +- Scan parquet  (111)
                     :           +- Sort (122)
                     :              +- Exchange (121)
                     :                 +- Filter (120)
                     :                    +- Scan parquet  (119)
                     +- Sort (130)
                        +- Exchange (129)
                           +- Filter (128)
                              +- Scan parquet  (127)


(90) Scan parquet 
Output [2]: [p_partkey#1, p_name#2]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(p_name), StringContains(p_name,green), IsNotNull(p_partkey)]
ReadSchema: struct<p_partkey:bigint,p_name:string>

(2) InputAdapter
Input [2]: [p_partkey#1, p_name#2]
Arguments: [#3, #2]

(3) NativeFilter
Input [2]: [#3#1, #2#2]
Condition : ((isnotnull(p_name#2) AND Contains(p_name#2, green)) AND isnotnull(p_partkey#1))

(4) NativeProject
Output [1]: [p_partkey#1]
Input [2]: [#3#1, #2#2]

(5) NativeShuffleExchange
Input [1]: [p_partkey#1]
Arguments: hashpartitioning(p_partkey#1, 5), ENSURE_REQUIREMENTS, [plan_id=1]

(6) ShuffleQueryStage
Output [1]: [p_partkey#1]
Arguments: X

(7) AQEShuffleRead
Input [1]: [p_partkey#1]
Arguments: coalesced

(8) InputAdapter
Input [1]: [p_partkey#1]

(9) NativeSort
Input [1]: [p_partkey#1]
Arguments: [p_partkey#1 ASC NULLS FIRST], false

(95) Scan parquet 
Output [6]: [l_orderkey#4, l_partkey#5, l_suppkey#6, l_quantity#7, l_extendedprice#8, l_discount#9]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(l_partkey), IsNotNull(l_suppkey), IsNotNull(l_orderkey)]
ReadSchema: struct<l_orderkey:bigint,l_partkey:bigint,l_suppkey:bigint,l_quantity:decimal(12,2),l_extendedprice:decimal(12,2),l_discount:decimal(12,2)>

(11) InputAdapter
Input [6]: [l_orderkey#4, l_partkey#5, l_suppkey#6, l_quantity#7, l_extendedprice#8, l_discount#9]
Arguments: [#10, #11, #12, #7, #8, #9]

(12) NativeFilter
Input [6]: [#10#4, #11#5, #12#6, #7#7, #8#8, #9#9]
Condition : ((isnotnull(l_partkey#5) AND isnotnull(l_suppkey#6)) AND isnotnull(l_orderkey#4))

(13) NativeShuffleExchange
Input [6]: [#10#4, #11#5, #12#6, #7#7, #8#8, #9#9]
Arguments: hashpartitioning(l_partkey#5, 5), ENSURE_REQUIREMENTS, [plan_id=2]

(14) ShuffleQueryStage
Output [6]: [#10#4, #11#5, #12#6, #7#7, #8#8, #9#9]
Arguments: X

(15) AQEShuffleRead
Input [6]: [#10#4, #11#5, #12#6, #7#7, #8#8, #9#9]
Arguments: coalesced

(16) InputAdapter
Input [6]: [#10#4, #11#5, #12#6, #7#7, #8#8, #9#9]

(17) NativeSort
Input [6]: [#10#4, #11#5, #12#6, #7#7, #8#8, #9#9]
Arguments: [l_partkey#5 ASC NULLS FIRST], false

(18) NativeSortMergeJoin
Left keys [1]: [p_partkey#1]
Right keys [1]: [l_partkey#5]
Join type: Inner
Join condition: None

(19) NativeProject
Output [6]: [l_orderkey#4, l_partkey#5, l_suppkey#6, l_quantity#7, l_extendedprice#8, l_discount#9]
Input [7]: [p_partkey#1, #10#4, #11#5, #12#6, #7#7, #8#8, #9#9]

(20) NativeShuffleExchange
Input [6]: [l_orderkey#4, l_partkey#5, l_suppkey#6, l_quantity#7, l_extendedprice#8, l_discount#9]
Arguments: hashpartitioning(l_suppkey#6, 5), ENSURE_REQUIREMENTS, [plan_id=3]

(21) ShuffleQueryStage
Output [6]: [l_orderkey#4, l_partkey#5, l_suppkey#6, l_quantity#7, l_extendedprice#8, l_discount#9]
Arguments: X

(22) AQEShuffleRead
Input [6]: [l_orderkey#4, l_partkey#5, l_suppkey#6, l_quantity#7, l_extendedprice#8, l_discount#9]
Arguments: coalesced

(23) InputAdapter
Input [6]: [l_orderkey#4, l_partkey#5, l_suppkey#6, l_quantity#7, l_extendedprice#8, l_discount#9]

(24) NativeSort
Input [6]: [l_orderkey#4, l_partkey#5, l_suppkey#6, l_quantity#7, l_extendedprice#8, l_discount#9]
Arguments: [l_suppkey#6 ASC NULLS FIRST], false

(103) Scan parquet 
Output [2]: [s_suppkey#13, s_nationkey#14]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(s_suppkey), IsNotNull(s_nationkey)]
ReadSchema: struct<s_suppkey:bigint,s_nationkey:bigint>

(26) InputAdapter
Input [2]: [s_suppkey#13, s_nationkey#14]
Arguments: [#15, #16]

(27) NativeFilter
Input [2]: [#15#13, #16#14]
Condition : (isnotnull(s_suppkey#13) AND isnotnull(s_nationkey#14))

(28) NativeShuffleExchange
Input [2]: [#15#13, #16#14]
Arguments: hashpartitioning(s_suppkey#13, 5), ENSURE_REQUIREMENTS, [plan_id=4]

(29) ShuffleQueryStage
Output [2]: [#15#13, #16#14]
Arguments: X

(30) AQEShuffleRead
Input [2]: [#15#13, #16#14]
Arguments: coalesced

(31) InputAdapter
Input [2]: [#15#13, #16#14]

(32) NativeSort
Input [2]: [#15#13, #16#14]
Arguments: [s_suppkey#13 ASC NULLS FIRST], false

(33) NativeSortMergeJoin
Left keys [1]: [l_suppkey#6]
Right keys [1]: [s_suppkey#13]
Join type: Inner
Join condition: None

(34) NativeProject
Output [7]: [l_orderkey#4, l_partkey#5, l_suppkey#6, l_quantity#7, l_extendedprice#8, l_discount#9, s_nationkey#14]
Input [8]: [l_orderkey#4, l_partkey#5, l_suppkey#6, l_quantity#7, l_extendedprice#8, l_discount#9, #15#13, #16#14]

(35) NativeShuffleExchange
Input [7]: [l_orderkey#4, l_partkey#5, l_suppkey#6, l_quantity#7, l_extendedprice#8, l_discount#9, s_nationkey#14]
Arguments: hashpartitioning(l_suppkey#6, l_partkey#5, 5), ENSURE_REQUIREMENTS, [plan_id=5]

(36) ShuffleQueryStage
Output [7]: [l_orderkey#4, l_partkey#5, l_suppkey#6, l_quantity#7, l_extendedprice#8, l_discount#9, s_nationkey#14]
Arguments: X

(37) AQEShuffleRead
Input [7]: [l_orderkey#4, l_partkey#5, l_suppkey#6, l_quantity#7, l_extendedprice#8, l_discount#9, s_nationkey#14]
Arguments: coalesced

(38) InputAdapter
Input [7]: [l_orderkey#4, l_partkey#5, l_suppkey#6, l_quantity#7, l_extendedprice#8, l_discount#9, s_nationkey#14]

(39) NativeSort
Input [7]: [l_orderkey#4, l_partkey#5, l_suppkey#6, l_quantity#7, l_extendedprice#8, l_discount#9, s_nationkey#14]
Arguments: [l_suppkey#6 ASC NULLS FIRST, l_partkey#5 ASC NULLS FIRST], false

(111) Scan parquet 
Output [3]: [ps_partkey#17, ps_suppkey#18, ps_supplycost#19]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(ps_suppkey), IsNotNull(ps_partkey)]
ReadSchema: struct<ps_partkey:bigint,ps_suppkey:bigint,ps_supplycost:decimal(12,2)>

(41) InputAdapter
Input [3]: [ps_partkey#17, ps_suppkey#18, ps_supplycost#19]
Arguments: [#20, #21, #19]

(42) NativeFilter
Input [3]: [#20#17, #21#18, #19#19]
Condition : (isnotnull(ps_suppkey#18) AND isnotnull(ps_partkey#17))

(43) NativeShuffleExchange
Input [3]: [#20#17, #21#18, #19#19]
Arguments: hashpartitioning(ps_suppkey#18, ps_partkey#17, 5), ENSURE_REQUIREMENTS, [plan_id=6]

(44) ShuffleQueryStage
Output [3]: [#20#17, #21#18, #19#19]
Arguments: X

(45) AQEShuffleRead
Input [3]: [#20#17, #21#18, #19#19]
Arguments: coalesced

(46) InputAdapter
Input [3]: [#20#17, #21#18, #19#19]

(47) NativeSort
Input [3]: [#20#17, #21#18, #19#19]
Arguments: [ps_suppkey#18 ASC NULLS FIRST, ps_partkey#17 ASC NULLS FIRST], false

(48) NativeSortMergeJoin
Left keys [2]: [l_suppkey#6, l_partkey#5]
Right keys [2]: [ps_suppkey#18, ps_partkey#17]
Join type: Inner
Join condition: None

(49) NativeProject
Output [6]: [l_orderkey#4, l_quantity#7, l_extendedprice#8, l_discount#9, s_nationkey#14, ps_supplycost#19]
Input [10]: [l_orderkey#4, l_partkey#5, l_suppkey#6, l_quantity#7, l_extendedprice#8, l_discount#9, s_nationkey#14, #20#17, #21#18, #19#19]

(50) NativeShuffleExchange
Input [6]: [l_orderkey#4, l_quantity#7, l_extendedprice#8, l_discount#9, s_nationkey#14, ps_supplycost#19]
Arguments: hashpartitioning(l_orderkey#4, 5), ENSURE_REQUIREMENTS, [plan_id=7]

(51) ShuffleQueryStage
Output [6]: [l_orderkey#4, l_quantity#7, l_extendedprice#8, l_discount#9, s_nationkey#14, ps_supplycost#19]
Arguments: X

(52) AQEShuffleRead
Input [6]: [l_orderkey#4, l_quantity#7, l_extendedprice#8, l_discount#9, s_nationkey#14, ps_supplycost#19]
Arguments: coalesced

(53) InputAdapter
Input [6]: [l_orderkey#4, l_quantity#7, l_extendedprice#8, l_discount#9, s_nationkey#14, ps_supplycost#19]

(54) NativeSort
Input [6]: [l_orderkey#4, l_quantity#7, l_extendedprice#8, l_discount#9, s_nationkey#14, ps_supplycost#19]
Arguments: [l_orderkey#4 ASC NULLS FIRST], false

(119) Scan parquet 
Output [2]: [o_orderkey#22, o_orderdate#23]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(o_orderkey)]
ReadSchema: struct<o_orderkey:bigint,o_orderdate:date>

(56) InputAdapter
Input [2]: [o_orderkey#22, o_orderdate#23]
Arguments: [#24, #23]

(57) NativeFilter
Input [2]: [#24#22, #23#23]
Condition : isnotnull(o_orderkey#22)

(58) NativeShuffleExchange
Input [2]: [#24#22, #23#23]
Arguments: hashpartitioning(o_orderkey#22, 5), ENSURE_REQUIREMENTS, [plan_id=8]

(59) ShuffleQueryStage
Output [2]: [#24#22, #23#23]
Arguments: X

(60) AQEShuffleRead
Input [2]: [#24#22, #23#23]
Arguments: coalesced

(61) InputAdapter
Input [2]: [#24#22, #23#23]

(62) NativeSort
Input [2]: [#24#22, #23#23]
Arguments: [o_orderkey#22 ASC NULLS FIRST], false

(63) NativeSortMergeJoin
Left keys [1]: [l_orderkey#4]
Right keys [1]: [o_orderkey#22]
Join type: Inner
Join condition: None

(64) NativeProject
Output [6]: [l_quantity#7, l_extendedprice#8, l_discount#9, s_nationkey#14, ps_supplycost#19, o_orderdate#23]
Input [8]: [l_orderkey#4, l_quantity#7, l_extendedprice#8, l_discount#9, s_nationkey#14, ps_supplycost#19, #24#22, #23#23]

(65) NativeShuffleExchange
Input [6]: [l_quantity#7, l_extendedprice#8, l_discount#9, s_nationkey#14, ps_supplycost#19, o_orderdate#23]
Arguments: hashpartitioning(s_nationkey#14, 5), ENSURE_REQUIREMENTS, [plan_id=9]

(66) ShuffleQueryStage
Output [6]: [l_quantity#7, l_extendedprice#8, l_discount#9, s_nationkey#14, ps_supplycost#19, o_orderdate#23]
Arguments: X

(67) AQEShuffleRead
Input [6]: [l_quantity#7, l_extendedprice#8, l_discount#9, s_nationkey#14, ps_supplycost#19, o_orderdate#23]
Arguments: coalesced

(68) InputAdapter
Input [6]: [l_quantity#7, l_extendedprice#8, l_discount#9, s_nationkey#14, ps_supplycost#19, o_orderdate#23]

(69) NativeSort
Input [6]: [l_quantity#7, l_extendedprice#8, l_discount#9, s_nationkey#14, ps_supplycost#19, o_orderdate#23]
Arguments: [s_nationkey#14 ASC NULLS FIRST], false

(127) Scan parquet 
Output [2]: [n_nationkey#25, n_name#26]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(n_nationkey)]
ReadSchema: struct<n_nationkey:bigint,n_name:string>

(71) InputAdapter
Input [2]: [n_nationkey#25, n_name#26]
Arguments: [#27, #26]

(72) NativeFilter
Input [2]: [#27#25, #26#26]
Condition : isnotnull(n_nationkey#25)

(73) NativeShuffleExchange
Input [2]: [#27#25, #26#26]
Arguments: hashpartitioning(n_nationkey#25, 5), ENSURE_REQUIREMENTS, [plan_id=10]

(74) ShuffleQueryStage
Output [2]: [#27#25, #26#26]
Arguments: X

(75) AQEShuffleRead
Input [2]: [#27#25, #26#26]
Arguments: coalesced

(76) InputAdapter
Input [2]: [#27#25, #26#26]

(77) NativeSort
Input [2]: [#27#25, #26#26]
Arguments: [n_nationkey#25 ASC NULLS FIRST], false

(78) NativeSortMergeJoin
Left keys [1]: [s_nationkey#14]
Right keys [1]: [n_nationkey#25]
Join type: Inner
Join condition: None

(79) Project [codegen id : 1]
Output [3]: [n_name#26 AS nation#28, year(o_orderdate#23) AS o_year#29, ((l_extendedprice#8 * (1 - l_discount#9)) - (ps_supplycost#19 * l_quantity#7)) AS amount#30]
Input [8]: [l_quantity#7, l_extendedprice#8, l_discount#9, s_nationkey#14, ps_supplycost#19, o_orderdate#23, #27#25, #26#26]

(80) HashAggregate [codegen id : 1]
Input [3]: [nation#28, o_year#29, amount#30]
Keys [2]: [nation#28, o_year#29]
Functions [1]: [partial_sum(amount#30)]
Aggregate Attributes [2]: [sum#31, isEmpty#32]
Results [4]: [nation#28, o_year#29, sum#33, isEmpty#34]

(81) Exchange
Input [4]: [nation#28, o_year#29, sum#33, isEmpty#34]
Arguments: hashpartitioning(nation#28, o_year#29, 5), ENSURE_REQUIREMENTS, [plan_id=11]

(82) ShuffleQueryStage
Output [4]: [nation#28, o_year#29, sum#33, isEmpty#34]
Arguments: X

(83) AQEShuffleRead
Input [4]: [nation#28, o_year#29, sum#33, isEmpty#34]
Arguments: coalesced

(84) HashAggregate [codegen id : 2]
Input [4]: [nation#28, o_year#29, sum#33, isEmpty#34]
Keys [2]: [nation#28, o_year#29]
Functions [1]: [sum(amount#30)]
Aggregate Attributes [1]: [sum(amount#30)#35]
Results [3]: [nation#28, o_year#29, sum(amount#30)#35 AS sum_profit#36]

(85) Exchange
Input [3]: [nation#28, o_year#29, sum_profit#36]
Arguments: rangepartitioning(nation#28 ASC NULLS FIRST, o_year#29 DESC NULLS LAST, 5), ENSURE_REQUIREMENTS, [plan_id=12]

(86) ShuffleQueryStage
Output [3]: [nation#28, o_year#29, sum_profit#36]
Arguments: X

(87) AQEShuffleRead
Input [3]: [nation#28, o_year#29, sum_profit#36]
Arguments: coalesced

(88) ConvertToNative
Input [3]: [nation#28, o_year#29, sum_profit#36]

(89) NativeSort
Input [3]: [nation#28, o_year#29, sum_profit#36]
Arguments: [nation#28 ASC NULLS FIRST, o_year#29 DESC NULLS LAST], true

(90) Scan parquet 
Output [2]: [p_partkey#1, p_name#2]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(p_name), StringContains(p_name,green), IsNotNull(p_partkey)]
ReadSchema: struct<p_partkey:bigint,p_name:string>

(91) Filter
Input [2]: [p_partkey#1, p_name#2]
Condition : ((isnotnull(p_name#2) AND Contains(p_name#2, green)) AND isnotnull(p_partkey#1))

(92) Project
Output [1]: [p_partkey#1]
Input [2]: [p_partkey#1, p_name#2]

(93) Exchange
Input [1]: [p_partkey#1]
Arguments: hashpartitioning(p_partkey#1, 5), ENSURE_REQUIREMENTS, [plan_id=13]

(94) Sort
Input [1]: [p_partkey#1]
Arguments: [p_partkey#1 ASC NULLS FIRST], false, 0

(95) Scan parquet 
Output [6]: [l_orderkey#4, l_partkey#5, l_suppkey#6, l_quantity#7, l_extendedprice#8, l_discount#9]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(l_partkey), IsNotNull(l_suppkey), IsNotNull(l_orderkey)]
ReadSchema: struct<l_orderkey:bigint,l_partkey:bigint,l_suppkey:bigint,l_quantity:decimal(12,2),l_extendedprice:decimal(12,2),l_discount:decimal(12,2)>

(96) Filter
Input [6]: [l_orderkey#4, l_partkey#5, l_suppkey#6, l_quantity#7, l_extendedprice#8, l_discount#9]
Condition : ((isnotnull(l_partkey#5) AND isnotnull(l_suppkey#6)) AND isnotnull(l_orderkey#4))

(97) Exchange
Input [6]: [l_orderkey#4, l_partkey#5, l_suppkey#6, l_quantity#7, l_extendedprice#8, l_discount#9]
Arguments: hashpartitioning(l_partkey#5, 5), ENSURE_REQUIREMENTS, [plan_id=14]

(98) Sort
Input [6]: [l_orderkey#4, l_partkey#5, l_suppkey#6, l_quantity#7, l_extendedprice#8, l_discount#9]
Arguments: [l_partkey#5 ASC NULLS FIRST], false, 0

(99) SortMergeJoin
Left keys [1]: [p_partkey#1]
Right keys [1]: [l_partkey#5]
Join type: Inner
Join condition: None

(100) Project
Output [6]: [l_orderkey#4, l_partkey#5, l_suppkey#6, l_quantity#7, l_extendedprice#8, l_discount#9]
Input [7]: [p_partkey#1, l_orderkey#4, l_partkey#5, l_suppkey#6, l_quantity#7, l_extendedprice#8, l_discount#9]

(101) Exchange
Input [6]: [l_orderkey#4, l_partkey#5, l_suppkey#6, l_quantity#7, l_extendedprice#8, l_discount#9]
Arguments: hashpartitioning(l_suppkey#6, 5), ENSURE_REQUIREMENTS, [plan_id=15]

(102) Sort
Input [6]: [l_orderkey#4, l_partkey#5, l_suppkey#6, l_quantity#7, l_extendedprice#8, l_discount#9]
Arguments: [l_suppkey#6 ASC NULLS FIRST], false, 0

(103) Scan parquet 
Output [2]: [s_suppkey#13, s_nationkey#14]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(s_suppkey), IsNotNull(s_nationkey)]
ReadSchema: struct<s_suppkey:bigint,s_nationkey:bigint>

(104) Filter
Input [2]: [s_suppkey#13, s_nationkey#14]
Condition : (isnotnull(s_suppkey#13) AND isnotnull(s_nationkey#14))

(105) Exchange
Input [2]: [s_suppkey#13, s_nationkey#14]
Arguments: hashpartitioning(s_suppkey#13, 5), ENSURE_REQUIREMENTS, [plan_id=16]

(106) Sort
Input [2]: [s_suppkey#13, s_nationkey#14]
Arguments: [s_suppkey#13 ASC NULLS FIRST], false, 0

(107) SortMergeJoin
Left keys [1]: [l_suppkey#6]
Right keys [1]: [s_suppkey#13]
Join type: Inner
Join condition: None

(108) Project
Output [7]: [l_orderkey#4, l_partkey#5, l_suppkey#6, l_quantity#7, l_extendedprice#8, l_discount#9, s_nationkey#14]
Input [8]: [l_orderkey#4, l_partkey#5, l_suppkey#6, l_quantity#7, l_extendedprice#8, l_discount#9, s_suppkey#13, s_nationkey#14]

(109) Exchange
Input [7]: [l_orderkey#4, l_partkey#5, l_suppkey#6, l_quantity#7, l_extendedprice#8, l_discount#9, s_nationkey#14]
Arguments: hashpartitioning(l_suppkey#6, l_partkey#5, 5), ENSURE_REQUIREMENTS, [plan_id=17]

(110) Sort
Input [7]: [l_orderkey#4, l_partkey#5, l_suppkey#6, l_quantity#7, l_extendedprice#8, l_discount#9, s_nationkey#14]
Arguments: [l_suppkey#6 ASC NULLS FIRST, l_partkey#5 ASC NULLS FIRST], false, 0

(111) Scan parquet 
Output [3]: [ps_partkey#17, ps_suppkey#18, ps_supplycost#19]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(ps_suppkey), IsNotNull(ps_partkey)]
ReadSchema: struct<ps_partkey:bigint,ps_suppkey:bigint,ps_supplycost:decimal(12,2)>

(112) Filter
Input [3]: [ps_partkey#17, ps_suppkey#18, ps_supplycost#19]
Condition : (isnotnull(ps_suppkey#18) AND isnotnull(ps_partkey#17))

(113) Exchange
Input [3]: [ps_partkey#17, ps_suppkey#18, ps_supplycost#19]
Arguments: hashpartitioning(ps_suppkey#18, ps_partkey#17, 5), ENSURE_REQUIREMENTS, [plan_id=18]

(114) Sort
Input [3]: [ps_partkey#17, ps_suppkey#18, ps_supplycost#19]
Arguments: [ps_suppkey#18 ASC NULLS FIRST, ps_partkey#17 ASC NULLS FIRST], false, 0

(115) SortMergeJoin
Left keys [2]: [l_suppkey#6, l_partkey#5]
Right keys [2]: [ps_suppkey#18, ps_partkey#17]
Join type: Inner
Join condition: None

(116) Project
Output [6]: [l_orderkey#4, l_quantity#7, l_extendedprice#8, l_discount#9, s_nationkey#14, ps_supplycost#19]
Input [10]: [l_orderkey#4, l_partkey#5, l_suppkey#6, l_quantity#7, l_extendedprice#8, l_discount#9, s_nationkey#14, ps_partkey#17, ps_suppkey#18, ps_supplycost#19]

(117) Exchange
Input [6]: [l_orderkey#4, l_quantity#7, l_extendedprice#8, l_discount#9, s_nationkey#14, ps_supplycost#19]
Arguments: hashpartitioning(l_orderkey#4, 5), ENSURE_REQUIREMENTS, [plan_id=19]

(118) Sort
Input [6]: [l_orderkey#4, l_quantity#7, l_extendedprice#8, l_discount#9, s_nationkey#14, ps_supplycost#19]
Arguments: [l_orderkey#4 ASC NULLS FIRST], false, 0

(119) Scan parquet 
Output [2]: [o_orderkey#22, o_orderdate#23]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(o_orderkey)]
ReadSchema: struct<o_orderkey:bigint,o_orderdate:date>

(120) Filter
Input [2]: [o_orderkey#22, o_orderdate#23]
Condition : isnotnull(o_orderkey#22)

(121) Exchange
Input [2]: [o_orderkey#22, o_orderdate#23]
Arguments: hashpartitioning(o_orderkey#22, 5), ENSURE_REQUIREMENTS, [plan_id=20]

(122) Sort
Input [2]: [o_orderkey#22, o_orderdate#23]
Arguments: [o_orderkey#22 ASC NULLS FIRST], false, 0

(123) SortMergeJoin
Left keys [1]: [l_orderkey#4]
Right keys [1]: [o_orderkey#22]
Join type: Inner
Join condition: None

(124) Project
Output [6]: [l_quantity#7, l_extendedprice#8, l_discount#9, s_nationkey#14, ps_supplycost#19, o_orderdate#23]
Input [8]: [l_orderkey#4, l_quantity#7, l_extendedprice#8, l_discount#9, s_nationkey#14, ps_supplycost#19, o_orderkey#22, o_orderdate#23]

(125) Exchange
Input [6]: [l_quantity#7, l_extendedprice#8, l_discount#9, s_nationkey#14, ps_supplycost#19, o_orderdate#23]
Arguments: hashpartitioning(s_nationkey#14, 5), ENSURE_REQUIREMENTS, [plan_id=21]

(126) Sort
Input [6]: [l_quantity#7, l_extendedprice#8, l_discount#9, s_nationkey#14, ps_supplycost#19, o_orderdate#23]
Arguments: [s_nationkey#14 ASC NULLS FIRST], false, 0

(127) Scan parquet 
Output [2]: [n_nationkey#25, n_name#26]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(n_nationkey)]
ReadSchema: struct<n_nationkey:bigint,n_name:string>

(128) Filter
Input [2]: [n_nationkey#25, n_name#26]
Condition : isnotnull(n_nationkey#25)

(129) Exchange
Input [2]: [n_nationkey#25, n_name#26]
Arguments: hashpartitioning(n_nationkey#25, 5), ENSURE_REQUIREMENTS, [plan_id=22]

(130) Sort
Input [2]: [n_nationkey#25, n_name#26]
Arguments: [n_nationkey#25 ASC NULLS FIRST], false, 0

(131) SortMergeJoin
Left keys [1]: [s_nationkey#14]
Right keys [1]: [n_nationkey#25]
Join type: Inner
Join condition: None

(132) Project
Output [3]: [n_name#26 AS nation#28, year(o_orderdate#23) AS o_year#29, ((l_extendedprice#8 * (1 - l_discount#9)) - (ps_supplycost#19 * l_quantity#7)) AS amount#30]
Input [8]: [l_quantity#7, l_extendedprice#8, l_discount#9, s_nationkey#14, ps_supplycost#19, o_orderdate#23, n_nationkey#25, n_name#26]

(133) HashAggregate
Input [3]: [nation#28, o_year#29, amount#30]
Keys [2]: [nation#28, o_year#29]
Functions [1]: [partial_sum(amount#30)]
Aggregate Attributes [2]: [sum#31, isEmpty#32]
Results [4]: [nation#28, o_year#29, sum#33, isEmpty#34]

(134) Exchange
Input [4]: [nation#28, o_year#29, sum#33, isEmpty#34]
Arguments: hashpartitioning(nation#28, o_year#29, 5), ENSURE_REQUIREMENTS, [plan_id=23]

(135) HashAggregate
Input [4]: [nation#28, o_year#29, sum#33, isEmpty#34]
Keys [2]: [nation#28, o_year#29]
Functions [1]: [sum(amount#30)]
Aggregate Attributes [1]: [sum(amount#30)#35]
Results [3]: [nation#28, o_year#29, sum(amount#30)#35 AS sum_profit#36]

(136) Exchange
Input [3]: [nation#28, o_year#29, sum_profit#36]
Arguments: rangepartitioning(nation#28 ASC NULLS FIRST, o_year#29 DESC NULLS LAST, 5), ENSURE_REQUIREMENTS, [plan_id=24]

(137) Sort
Input [3]: [nation#28, o_year#29, sum_profit#36]
Arguments: [nation#28 ASC NULLS FIRST, o_year#29 DESC NULLS LAST], true, 0

(138) AdaptiveSparkPlan
Output [3]: [nation#28, o_year#29, sum_profit#36]
Arguments: isFinalPlan=true

