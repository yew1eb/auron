== Physical Plan ==
AdaptiveSparkPlan (71)
+- == Final Plan ==
   NativeSort (45)
   +- ConvertToNative (44)
      +- AQEShuffleRead (43)
         +- ShuffleQueryStage (42), Statistics(sizeInBytes=14.0 KiB, rowCount=359)
            +- Exchange (41)
               +- * Filter (40)
                  +- * HashAggregate (39)
                     +- AQEShuffleRead (38)
                        +- ShuffleQueryStage (37), Statistics(sizeInBytes=17.5 KiB, rowCount=374)
                           +- Exchange (36)
                              +- * HashAggregate (35)
                                 +- NativeProject (34)
                                    +- NativeSortMergeJoin Inner (33)
                                       :- NativeSort (23)
                                       :  +- InputAdapter (22)
                                       :     +- AQEShuffleRead (21)
                                       :        +- ShuffleQueryStage (20), Statistics(sizeInBytes=282.0 KiB, rowCount=8.00E+3)
                                       :           +- NativeShuffleExchange (19)
                                       :              +- NativeProject (18)
                                       :                 +- NativeSortMergeJoin Inner (17)
                                       :                    :- NativeSort (8)
                                       :                    :  +- InputAdapter (7)
                                       :                    :     +- AQEShuffleRead (6)
                                       :                    :        +- ShuffleQueryStage (5), Statistics(sizeInBytes=282.0 KiB, rowCount=8.00E+3)
                                       :                    :           +- NativeShuffleExchange (4)
                                       :                    :              +- NativeFilter (3)
                                       :                    :                 +- InputAdapter (2)
                                       :                    :                    +- NativeParquetScan  (1)
                                       :                    +- NativeSort (16)
                                       :                       +- InputAdapter (15)
                                       :                          +- AQEShuffleRead (14)
                                       :                             +- ShuffleQueryStage (13), Statistics(sizeInBytes=1992.0 B, rowCount=100)
                                       :                                +- NativeShuffleExchange (12)
                                       :                                   +- NativeFilter (11)
                                       :                                      +- InputAdapter (10)
                                       :                                         +- NativeParquetScan  (9)
                                       +- NativeSort (32)
                                          +- InputAdapter (31)
                                             +- AQEShuffleRead (30)
                                                +- ShuffleQueryStage (29), Statistics(sizeInBytes=216.0 B, rowCount=1)
                                                   +- NativeShuffleExchange (28)
                                                      +- NativeProject (27)
                                                         +- NativeFilter (26)
                                                            +- InputAdapter (25)
                                                               +- NativeParquetScan  (24)
+- == Initial Plan ==
   Sort (70)
   +- Exchange (69)
      +- Filter (68)
         +- HashAggregate (67)
            +- Exchange (66)
               +- HashAggregate (65)
                  +- Project (64)
                     +- SortMergeJoin Inner (63)
                        :- Sort (57)
                        :  +- Exchange (56)
                        :     +- Project (55)
                        :        +- SortMergeJoin Inner (54)
                        :           :- Sort (49)
                        :           :  +- Exchange (48)
                        :           :     +- Filter (47)
                        :           :        +- Scan parquet  (46)
                        :           +- Sort (53)
                        :              +- Exchange (52)
                        :                 +- Filter (51)
                        :                    +- Scan parquet  (50)
                        +- Sort (62)
                           +- Exchange (61)
                              +- Project (60)
                                 +- Filter (59)
                                    +- Scan parquet  (58)


(46) Scan parquet 
Output [4]: [ps_partkey#1, ps_suppkey#2, ps_availqty#3, ps_supplycost#4]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(ps_suppkey)]
ReadSchema: struct<ps_partkey:bigint,ps_suppkey:bigint,ps_availqty:int,ps_supplycost:decimal(12,2)>

(2) InputAdapter
Input [4]: [ps_partkey#1, ps_suppkey#2, ps_availqty#3, ps_supplycost#4]
Arguments: [#5, #6, #3, #4]

(3) NativeFilter
Input [4]: [#5#1, #6#2, #3#3, #4#4]
Condition : isnotnull(ps_suppkey#2)

(4) NativeShuffleExchange
Input [4]: [#5#1, #6#2, #3#3, #4#4]
Arguments: hashpartitioning(ps_suppkey#2, 5), ENSURE_REQUIREMENTS, [plan_id=1]

(5) ShuffleQueryStage
Output [4]: [#5#1, #6#2, #3#3, #4#4]
Arguments: X

(6) AQEShuffleRead
Input [4]: [#5#1, #6#2, #3#3, #4#4]
Arguments: coalesced

(7) InputAdapter
Input [4]: [#5#1, #6#2, #3#3, #4#4]

(8) NativeSort
Input [4]: [#5#1, #6#2, #3#3, #4#4]
Arguments: [ps_suppkey#2 ASC NULLS FIRST], false

(50) Scan parquet 
Output [2]: [s_suppkey#7, s_nationkey#8]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(s_suppkey), IsNotNull(s_nationkey)]
ReadSchema: struct<s_suppkey:bigint,s_nationkey:bigint>

(10) InputAdapter
Input [2]: [s_suppkey#7, s_nationkey#8]
Arguments: [#9, #10]

(11) NativeFilter
Input [2]: [#9#7, #10#8]
Condition : (isnotnull(s_suppkey#7) AND isnotnull(s_nationkey#8))

(12) NativeShuffleExchange
Input [2]: [#9#7, #10#8]
Arguments: hashpartitioning(s_suppkey#7, 5), ENSURE_REQUIREMENTS, [plan_id=2]

(13) ShuffleQueryStage
Output [2]: [#9#7, #10#8]
Arguments: X

(14) AQEShuffleRead
Input [2]: [#9#7, #10#8]
Arguments: coalesced

(15) InputAdapter
Input [2]: [#9#7, #10#8]

(16) NativeSort
Input [2]: [#9#7, #10#8]
Arguments: [s_suppkey#7 ASC NULLS FIRST], false

(17) NativeSortMergeJoin
Left keys [1]: [ps_suppkey#2]
Right keys [1]: [s_suppkey#7]
Join type: Inner
Join condition: None

(18) NativeProject
Output [4]: [ps_partkey#1, ps_availqty#3, ps_supplycost#4, s_nationkey#8]
Input [6]: [#5#1, #6#2, #3#3, #4#4, #9#7, #10#8]

(19) NativeShuffleExchange
Input [4]: [ps_partkey#1, ps_availqty#3, ps_supplycost#4, s_nationkey#8]
Arguments: hashpartitioning(s_nationkey#8, 5), ENSURE_REQUIREMENTS, [plan_id=3]

(20) ShuffleQueryStage
Output [4]: [ps_partkey#1, ps_availqty#3, ps_supplycost#4, s_nationkey#8]
Arguments: X

(21) AQEShuffleRead
Input [4]: [ps_partkey#1, ps_availqty#3, ps_supplycost#4, s_nationkey#8]
Arguments: coalesced

(22) InputAdapter
Input [4]: [ps_partkey#1, ps_availqty#3, ps_supplycost#4, s_nationkey#8]

(23) NativeSort
Input [4]: [ps_partkey#1, ps_availqty#3, ps_supplycost#4, s_nationkey#8]
Arguments: [s_nationkey#8 ASC NULLS FIRST], false

(58) Scan parquet 
Output [2]: [n_nationkey#11, n_name#12]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(n_name), EqualTo(n_name,GERMANY), IsNotNull(n_nationkey)]
ReadSchema: struct<n_nationkey:bigint,n_name:string>

(25) InputAdapter
Input [2]: [n_nationkey#11, n_name#12]
Arguments: [#13, #12]

(26) NativeFilter
Input [2]: [#13#11, #12#12]
Condition : ((isnotnull(n_name#12) AND (n_name#12 = GERMANY)) AND isnotnull(n_nationkey#11))

(27) NativeProject
Output [1]: [n_nationkey#11]
Input [2]: [#13#11, #12#12]

(28) NativeShuffleExchange
Input [1]: [n_nationkey#11]
Arguments: hashpartitioning(n_nationkey#11, 5), ENSURE_REQUIREMENTS, [plan_id=4]

(29) ShuffleQueryStage
Output [1]: [n_nationkey#11]
Arguments: X

(30) AQEShuffleRead
Input [1]: [n_nationkey#11]
Arguments: coalesced

(31) InputAdapter
Input [1]: [n_nationkey#11]

(32) NativeSort
Input [1]: [n_nationkey#11]
Arguments: [n_nationkey#11 ASC NULLS FIRST], false

(33) NativeSortMergeJoin
Left keys [1]: [s_nationkey#8]
Right keys [1]: [n_nationkey#11]
Join type: Inner
Join condition: None

(34) NativeProject
Output [3]: [ps_partkey#1, ps_availqty#3, ps_supplycost#4]
Input [5]: [ps_partkey#1, ps_availqty#3, ps_supplycost#4, s_nationkey#8, n_nationkey#11]

(35) HashAggregate [codegen id : 1]
Input [3]: [ps_partkey#1, ps_availqty#3, ps_supplycost#4]
Keys [1]: [ps_partkey#1]
Functions [1]: [partial_sum((ps_supplycost#4 * cast(ps_availqty#3 as decimal(10,0))))]
Aggregate Attributes [2]: [sum#14, isEmpty#15]
Results [3]: [ps_partkey#1, sum#16, isEmpty#17]

(36) Exchange
Input [3]: [ps_partkey#1, sum#16, isEmpty#17]
Arguments: hashpartitioning(ps_partkey#1, 5), ENSURE_REQUIREMENTS, [plan_id=5]

(37) ShuffleQueryStage
Output [3]: [ps_partkey#1, sum#16, isEmpty#17]
Arguments: X

(38) AQEShuffleRead
Input [3]: [ps_partkey#1, sum#16, isEmpty#17]
Arguments: coalesced

(39) HashAggregate [codegen id : 2]
Input [3]: [ps_partkey#1, sum#16, isEmpty#17]
Keys [1]: [ps_partkey#1]
Functions [1]: [sum((ps_supplycost#4 * cast(ps_availqty#3 as decimal(10,0))))]
Aggregate Attributes [1]: [sum((ps_supplycost#4 * cast(ps_availqty#3 as decimal(10,0))))#18]
Results [2]: [ps_partkey#1, sum((ps_supplycost#4 * cast(ps_availqty#3 as decimal(10,0))))#18 AS value#19]

(40) Filter [codegen id : 2]
Input [2]: [ps_partkey#1, value#19]
Condition : (isnotnull(value#19) AND (cast(value#19 as decimal(38,6)) > Subquery subquery#20, [id=#21]))

(41) Exchange
Input [2]: [ps_partkey#1, value#19]
Arguments: rangepartitioning(value#19 DESC NULLS LAST, 5), ENSURE_REQUIREMENTS, [plan_id=6]

(42) ShuffleQueryStage
Output [2]: [ps_partkey#1, value#19]
Arguments: X

(43) AQEShuffleRead
Input [2]: [ps_partkey#1, value#19]
Arguments: coalesced

(44) ConvertToNative
Input [2]: [ps_partkey#1, value#19]

(45) NativeSort
Input [2]: [ps_partkey#1, value#19]
Arguments: [value#19 DESC NULLS LAST], true

(46) Scan parquet 
Output [4]: [ps_partkey#1, ps_suppkey#2, ps_availqty#3, ps_supplycost#4]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(ps_suppkey)]
ReadSchema: struct<ps_partkey:bigint,ps_suppkey:bigint,ps_availqty:int,ps_supplycost:decimal(12,2)>

(47) Filter
Input [4]: [ps_partkey#1, ps_suppkey#2, ps_availqty#3, ps_supplycost#4]
Condition : isnotnull(ps_suppkey#2)

(48) Exchange
Input [4]: [ps_partkey#1, ps_suppkey#2, ps_availqty#3, ps_supplycost#4]
Arguments: hashpartitioning(ps_suppkey#2, 5), ENSURE_REQUIREMENTS, [plan_id=7]

(49) Sort
Input [4]: [ps_partkey#1, ps_suppkey#2, ps_availqty#3, ps_supplycost#4]
Arguments: [ps_suppkey#2 ASC NULLS FIRST], false, 0

(50) Scan parquet 
Output [2]: [s_suppkey#7, s_nationkey#8]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(s_suppkey), IsNotNull(s_nationkey)]
ReadSchema: struct<s_suppkey:bigint,s_nationkey:bigint>

(51) Filter
Input [2]: [s_suppkey#7, s_nationkey#8]
Condition : (isnotnull(s_suppkey#7) AND isnotnull(s_nationkey#8))

(52) Exchange
Input [2]: [s_suppkey#7, s_nationkey#8]
Arguments: hashpartitioning(s_suppkey#7, 5), ENSURE_REQUIREMENTS, [plan_id=8]

(53) Sort
Input [2]: [s_suppkey#7, s_nationkey#8]
Arguments: [s_suppkey#7 ASC NULLS FIRST], false, 0

(54) SortMergeJoin
Left keys [1]: [ps_suppkey#2]
Right keys [1]: [s_suppkey#7]
Join type: Inner
Join condition: None

(55) Project
Output [4]: [ps_partkey#1, ps_availqty#3, ps_supplycost#4, s_nationkey#8]
Input [6]: [ps_partkey#1, ps_suppkey#2, ps_availqty#3, ps_supplycost#4, s_suppkey#7, s_nationkey#8]

(56) Exchange
Input [4]: [ps_partkey#1, ps_availqty#3, ps_supplycost#4, s_nationkey#8]
Arguments: hashpartitioning(s_nationkey#8, 5), ENSURE_REQUIREMENTS, [plan_id=9]

(57) Sort
Input [4]: [ps_partkey#1, ps_availqty#3, ps_supplycost#4, s_nationkey#8]
Arguments: [s_nationkey#8 ASC NULLS FIRST], false, 0

(58) Scan parquet 
Output [2]: [n_nationkey#11, n_name#12]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(n_name), EqualTo(n_name,GERMANY), IsNotNull(n_nationkey)]
ReadSchema: struct<n_nationkey:bigint,n_name:string>

(59) Filter
Input [2]: [n_nationkey#11, n_name#12]
Condition : ((isnotnull(n_name#12) AND (n_name#12 = GERMANY)) AND isnotnull(n_nationkey#11))

(60) Project
Output [1]: [n_nationkey#11]
Input [2]: [n_nationkey#11, n_name#12]

(61) Exchange
Input [1]: [n_nationkey#11]
Arguments: hashpartitioning(n_nationkey#11, 5), ENSURE_REQUIREMENTS, [plan_id=10]

(62) Sort
Input [1]: [n_nationkey#11]
Arguments: [n_nationkey#11 ASC NULLS FIRST], false, 0

(63) SortMergeJoin
Left keys [1]: [s_nationkey#8]
Right keys [1]: [n_nationkey#11]
Join type: Inner
Join condition: None

(64) Project
Output [3]: [ps_partkey#1, ps_availqty#3, ps_supplycost#4]
Input [5]: [ps_partkey#1, ps_availqty#3, ps_supplycost#4, s_nationkey#8, n_nationkey#11]

(65) HashAggregate
Input [3]: [ps_partkey#1, ps_availqty#3, ps_supplycost#4]
Keys [1]: [ps_partkey#1]
Functions [1]: [partial_sum((ps_supplycost#4 * cast(ps_availqty#3 as decimal(10,0))))]
Aggregate Attributes [2]: [sum#14, isEmpty#15]
Results [3]: [ps_partkey#1, sum#16, isEmpty#17]

(66) Exchange
Input [3]: [ps_partkey#1, sum#16, isEmpty#17]
Arguments: hashpartitioning(ps_partkey#1, 5), ENSURE_REQUIREMENTS, [plan_id=11]

(67) HashAggregate
Input [3]: [ps_partkey#1, sum#16, isEmpty#17]
Keys [1]: [ps_partkey#1]
Functions [1]: [sum((ps_supplycost#4 * cast(ps_availqty#3 as decimal(10,0))))]
Aggregate Attributes [1]: [sum((ps_supplycost#4 * cast(ps_availqty#3 as decimal(10,0))))#18]
Results [2]: [ps_partkey#1, sum((ps_supplycost#4 * cast(ps_availqty#3 as decimal(10,0))))#18 AS value#19]

(68) Filter
Input [2]: [ps_partkey#1, value#19]
Condition : (isnotnull(value#19) AND (cast(value#19 as decimal(38,6)) > Subquery subquery#20, [id=#21]))

(69) Exchange
Input [2]: [ps_partkey#1, value#19]
Arguments: rangepartitioning(value#19 DESC NULLS LAST, 5), ENSURE_REQUIREMENTS, [plan_id=12]

(70) Sort
Input [2]: [ps_partkey#1, value#19]
Arguments: [value#19 DESC NULLS LAST], true, 0

(71) AdaptiveSparkPlan
Output [2]: [ps_partkey#1, value#19]
Arguments: isFinalPlan=true

===== Subqueries =====

Subquery:1 Hosting operator id = 40 Hosting Expression = Subquery subquery#20, [id=#21]
AdaptiveSparkPlan (127)
+- == Final Plan ==
   * HashAggregate (104)
   +- ShuffleQueryStage (103), Statistics(sizeInBytes=40.0 B, rowCount=1)
      +- Exchange (102)
         +- * HashAggregate (101)
            +- NativeProject (100)
               +- NativeSortMergeJoin Inner (99)
                  :- NativeSort (92)
                  :  +- InputAdapter (91)
                  :     +- AQEShuffleRead (90)
                  :        +- ShuffleQueryStage (89), Statistics(sizeInBytes=219.3 KiB, rowCount=8.00E+3)
                  :           +- NativeShuffleExchange (88)
                  :              +- NativeProject (87)
                  :                 +- NativeSortMergeJoin Inner (86)
                  :                    :- NativeSort (79)
                  :                    :  +- InputAdapter (78)
                  :                    :     +- AQEShuffleRead (77)
                  :                    :        +- ShuffleQueryStage (76), Statistics(sizeInBytes=219.3 KiB, rowCount=8.00E+3)
                  :                    :           +- NativeShuffleExchange (75)
                  :                    :              +- NativeFilter (74)
                  :                    :                 +- InputAdapter (73)
                  :                    :                    +- NativeParquetScan  (72)
                  :                    +- NativeSort (85)
                  :                       +- InputAdapter (84)
                  :                          +- InputAdapter (83)
                  :                             +- AQEShuffleRead (82)
                  :                                +- ShuffleQueryStage (81), Statistics(sizeInBytes=1992.0 B, rowCount=100)
                  :                                   +- ReusedExchange (80)
                  +- NativeSort (98)
                     +- InputAdapter (97)
                        +- InputAdapter (96)
                           +- AQEShuffleRead (95)
                              +- ShuffleQueryStage (94), Statistics(sizeInBytes=216.0 B, rowCount=1)
                                 +- ReusedExchange (93)
+- == Initial Plan ==
   HashAggregate (126)
   +- Exchange (125)
      +- HashAggregate (124)
         +- Project (123)
            +- SortMergeJoin Inner (122)
               :- Sort (116)
               :  +- Exchange (115)
               :     +- Project (114)
               :        +- SortMergeJoin Inner (113)
               :           :- Sort (108)
               :           :  +- Exchange (107)
               :           :     +- Filter (106)
               :           :        +- Scan parquet  (105)
               :           +- Sort (112)
               :              +- Exchange (111)
               :                 +- Filter (110)
               :                    +- Scan parquet  (109)
               +- Sort (121)
                  +- Exchange (120)
                     +- Project (119)
                        +- Filter (118)
                           +- Scan parquet  (117)


(105) Scan parquet 
Output [3]: [ps_suppkey#22, ps_availqty#23, ps_supplycost#24]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(ps_suppkey)]
ReadSchema: struct<ps_suppkey:bigint,ps_availqty:int,ps_supplycost:decimal(12,2)>

(73) InputAdapter
Input [3]: [ps_suppkey#22, ps_availqty#23, ps_supplycost#24]
Arguments: [#25, #23, #24]

(74) NativeFilter
Input [3]: [#25#22, #23#23, #24#24]
Condition : isnotnull(ps_suppkey#22)

(75) NativeShuffleExchange
Input [3]: [#25#22, #23#23, #24#24]
Arguments: hashpartitioning(ps_suppkey#22, 5), ENSURE_REQUIREMENTS, [plan_id=13]

(76) ShuffleQueryStage
Output [3]: [#25#22, #23#23, #24#24]
Arguments: X

(77) AQEShuffleRead
Input [3]: [#25#22, #23#23, #24#24]
Arguments: coalesced

(78) InputAdapter
Input [3]: [#25#22, #23#23, #24#24]

(79) NativeSort
Input [3]: [#25#22, #23#23, #24#24]
Arguments: [ps_suppkey#22 ASC NULLS FIRST], false

(80) ReusedExchange [Reuses operator id: 12]
Output [2]: [s_suppkey#26, s_nationkey#27]

(81) ShuffleQueryStage
Output [2]: [s_suppkey#26, s_nationkey#27]
Arguments: X

(82) AQEShuffleRead
Input [2]: [s_suppkey#26, s_nationkey#27]
Arguments: coalesced

(83) InputAdapter
Input [2]: [s_suppkey#26, s_nationkey#27]
Arguments: [#28, #29]

(84) InputAdapter
Input [2]: [#28#26, #29#27]

(85) NativeSort
Input [2]: [#28#26, #29#27]
Arguments: [s_suppkey#26 ASC NULLS FIRST], false

(86) NativeSortMergeJoin
Left keys [1]: [ps_suppkey#22]
Right keys [1]: [s_suppkey#26]
Join type: Inner
Join condition: None

(87) NativeProject
Output [3]: [ps_availqty#23, ps_supplycost#24, s_nationkey#27]
Input [5]: [#25#22, #23#23, #24#24, #28#26, #29#27]

(88) NativeShuffleExchange
Input [3]: [ps_availqty#23, ps_supplycost#24, s_nationkey#27]
Arguments: hashpartitioning(s_nationkey#27, 5), ENSURE_REQUIREMENTS, [plan_id=14]

(89) ShuffleQueryStage
Output [3]: [ps_availqty#23, ps_supplycost#24, s_nationkey#27]
Arguments: X

(90) AQEShuffleRead
Input [3]: [ps_availqty#23, ps_supplycost#24, s_nationkey#27]
Arguments: coalesced

(91) InputAdapter
Input [3]: [ps_availqty#23, ps_supplycost#24, s_nationkey#27]

(92) NativeSort
Input [3]: [ps_availqty#23, ps_supplycost#24, s_nationkey#27]
Arguments: [s_nationkey#27 ASC NULLS FIRST], false

(93) ReusedExchange [Reuses operator id: 28]
Output [1]: [n_nationkey#30]

(94) ShuffleQueryStage
Output [1]: [n_nationkey#30]
Arguments: X

(95) AQEShuffleRead
Input [1]: [n_nationkey#30]
Arguments: coalesced

(96) InputAdapter
Input [1]: [n_nationkey#30]
Arguments: [#31]

(97) InputAdapter
Input [1]: [#31#30]

(98) NativeSort
Input [1]: [#31#30]
Arguments: [n_nationkey#30 ASC NULLS FIRST], false

(99) NativeSortMergeJoin
Left keys [1]: [s_nationkey#27]
Right keys [1]: [n_nationkey#30]
Join type: Inner
Join condition: None

(100) NativeProject
Output [2]: [ps_availqty#23, ps_supplycost#24]
Input [4]: [ps_availqty#23, ps_supplycost#24, s_nationkey#27, #31#30]

(101) HashAggregate [codegen id : 1]
Input [2]: [ps_availqty#23, ps_supplycost#24]
Keys: []
Functions [1]: [partial_sum((ps_supplycost#24 * cast(ps_availqty#23 as decimal(10,0))))]
Aggregate Attributes [2]: [sum#32, isEmpty#33]
Results [2]: [sum#34, isEmpty#35]

(102) Exchange
Input [2]: [sum#34, isEmpty#35]
Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=15]

(103) ShuffleQueryStage
Output [2]: [sum#34, isEmpty#35]
Arguments: X

(104) HashAggregate [codegen id : 2]
Input [2]: [sum#34, isEmpty#35]
Keys: []
Functions [1]: [sum((ps_supplycost#24 * cast(ps_availqty#23 as decimal(10,0))))]
Aggregate Attributes [1]: [sum((ps_supplycost#24 * cast(ps_availqty#23 as decimal(10,0))))#36]
Results [1]: [(sum((ps_supplycost#24 * cast(ps_availqty#23 as decimal(10,0))))#36 * 0.0001000000) AS (sum((ps_supplycost * ps_availqty)) * 0.0001000000)#37]

(105) Scan parquet 
Output [3]: [ps_suppkey#22, ps_availqty#23, ps_supplycost#24]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(ps_suppkey)]
ReadSchema: struct<ps_suppkey:bigint,ps_availqty:int,ps_supplycost:decimal(12,2)>

(106) Filter
Input [3]: [ps_suppkey#22, ps_availqty#23, ps_supplycost#24]
Condition : isnotnull(ps_suppkey#22)

(107) Exchange
Input [3]: [ps_suppkey#22, ps_availqty#23, ps_supplycost#24]
Arguments: hashpartitioning(ps_suppkey#22, 5), ENSURE_REQUIREMENTS, [plan_id=16]

(108) Sort
Input [3]: [ps_suppkey#22, ps_availqty#23, ps_supplycost#24]
Arguments: [ps_suppkey#22 ASC NULLS FIRST], false, 0

(109) Scan parquet 
Output [2]: [s_suppkey#26, s_nationkey#27]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(s_suppkey), IsNotNull(s_nationkey)]
ReadSchema: struct<s_suppkey:bigint,s_nationkey:bigint>

(110) Filter
Input [2]: [s_suppkey#26, s_nationkey#27]
Condition : (isnotnull(s_suppkey#26) AND isnotnull(s_nationkey#27))

(111) Exchange
Input [2]: [s_suppkey#26, s_nationkey#27]
Arguments: hashpartitioning(s_suppkey#26, 5), ENSURE_REQUIREMENTS, [plan_id=17]

(112) Sort
Input [2]: [s_suppkey#26, s_nationkey#27]
Arguments: [s_suppkey#26 ASC NULLS FIRST], false, 0

(113) SortMergeJoin
Left keys [1]: [ps_suppkey#22]
Right keys [1]: [s_suppkey#26]
Join type: Inner
Join condition: None

(114) Project
Output [3]: [ps_availqty#23, ps_supplycost#24, s_nationkey#27]
Input [5]: [ps_suppkey#22, ps_availqty#23, ps_supplycost#24, s_suppkey#26, s_nationkey#27]

(115) Exchange
Input [3]: [ps_availqty#23, ps_supplycost#24, s_nationkey#27]
Arguments: hashpartitioning(s_nationkey#27, 5), ENSURE_REQUIREMENTS, [plan_id=18]

(116) Sort
Input [3]: [ps_availqty#23, ps_supplycost#24, s_nationkey#27]
Arguments: [s_nationkey#27 ASC NULLS FIRST], false, 0

(117) Scan parquet 
Output [2]: [n_nationkey#30, n_name#38]
Batched: true
Location: InMemoryFileIndex [file:/<warehouse_dir>]
PushedFilters: [IsNotNull(n_name), EqualTo(n_name,GERMANY), IsNotNull(n_nationkey)]
ReadSchema: struct<n_nationkey:bigint,n_name:string>

(118) Filter
Input [2]: [n_nationkey#30, n_name#38]
Condition : ((isnotnull(n_name#38) AND (n_name#38 = GERMANY)) AND isnotnull(n_nationkey#30))

(119) Project
Output [1]: [n_nationkey#30]
Input [2]: [n_nationkey#30, n_name#38]

(120) Exchange
Input [1]: [n_nationkey#30]
Arguments: hashpartitioning(n_nationkey#30, 5), ENSURE_REQUIREMENTS, [plan_id=19]

(121) Sort
Input [1]: [n_nationkey#30]
Arguments: [n_nationkey#30 ASC NULLS FIRST], false, 0

(122) SortMergeJoin
Left keys [1]: [s_nationkey#27]
Right keys [1]: [n_nationkey#30]
Join type: Inner
Join condition: None

(123) Project
Output [2]: [ps_availqty#23, ps_supplycost#24]
Input [4]: [ps_availqty#23, ps_supplycost#24, s_nationkey#27, n_nationkey#30]

(124) HashAggregate
Input [2]: [ps_availqty#23, ps_supplycost#24]
Keys: []
Functions [1]: [partial_sum((ps_supplycost#24 * cast(ps_availqty#23 as decimal(10,0))))]
Aggregate Attributes [2]: [sum#32, isEmpty#33]
Results [2]: [sum#34, isEmpty#35]

(125) Exchange
Input [2]: [sum#34, isEmpty#35]
Arguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=20]

(126) HashAggregate
Input [2]: [sum#34, isEmpty#35]
Keys: []
Functions [1]: [sum((ps_supplycost#24 * cast(ps_availqty#23 as decimal(10,0))))]
Aggregate Attributes [1]: [sum((ps_supplycost#24 * cast(ps_availqty#23 as decimal(10,0))))#36]
Results [1]: [(sum((ps_supplycost#24 * cast(ps_availqty#23 as decimal(10,0))))#36 * 0.0001000000) AS (sum((ps_supplycost * ps_availqty)) * 0.0001000000)#37]

(127) AdaptiveSparkPlan
Output [1]: [(sum((ps_supplycost * ps_availqty)) * 0.0001000000)#37]
Arguments: isFinalPlan=true


